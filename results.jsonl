{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'", "execution_status": "VALID", "query_result": [["4"]], "spark_error": null, "total_time": 16.412766933441162, "spark_time": 3.273699998855591, "translation_time": 13.139066934585571, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='3d2ffd55-dd1d-4c6d-9899-5cc493c73256'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='461537d8-aef9-4e6c-b9a2-04409e229b1b'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(School) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}", "Observation: content='The original query has a minor deviation from best practices regarding quoting identifiers, as specified in the prompt\\'s checklist (\"Properly quoting identifiers\" and \"Use ` for the in-query strings\"). While the query would likely execute correctly in Spark SQL without backticks for simple identifiers like `School`, `schools`, `County`, and `GSoffered`, it\\'s good practice to quote them, especially when the instruction explicitly mentions it.\\n\\nHere\\'s the rewritten query with identifiers properly quoted using backticks:\\n\\n```sql\\nSELECT COUNT(`School`) FROM `schools` WHERE `County` = \\'Amador\\' AND `GSoffered` = \\'9-12\\'\\n```' name='query_checker_sql_db' tool_call_id='a10dc4b1-f4d6-4158-8002-4db2bbea3d43'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\"}"], "input_tokens": 3632, "output_tokens": 2041, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(School) FROM schools WHERE County = \\'Amador\\' AND GSoffered = \\'9-12\\'\"}'}\nTool: The original query has a minor deviation from best practices regarding quoting identifiers, as specified in the prompt's checklist (\"Properly quoting identifiers\" and \"Use ` for the in-query strings\"). While the query would likely execute correctly in Spark SQL without backticks for simple identifiers like `School`, `schools`, `County`, and `GSoffered`, it's good practice to quote them, especially when the instruction explicitly mentions it.\n\nHere's the rewritten query with identifiers properly quoted using backticks:\n\n```sql\nSELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\n```", "final_answer": "", "replica": 0, "timestamp": 1768936332.4906695}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'", "execution_status": "VALID", "query_result": [["4"]], "spark_error": null, "total_time": 15.735047340393066, "spark_time": 0.46300220489501953, "translation_time": 15.272045135498047, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d06de125-ac48-4100-bbe7-5703262d42d9'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='9b3ad5c7-e05f-4a0a-ae4d-97fb8e7ca84d'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(School) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}", "Observation: content='The original query has a minor issue regarding the explicit instruction to \"Use ` for the in-query strings\", which typically refers to quoting identifiers in Spark SQL for robustness and clarity, especially if names contain special characters or are reserved keywords (though not strictly necessary for simple names like these).\\n\\nHere\\'s the corrected query with backticks around identifiers:\\n\\n```sql\\nSELECT COUNT(`School`) FROM `schools` WHERE `County` = \\'Amador\\' AND `GSoffered` = \\'9-12\\'\\n```' name='query_checker_sql_db' tool_call_id='a48aafb9-aebd-415b-ace3-eeac06f9cc51'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\"}"], "input_tokens": 3598, "output_tokens": 2226, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(School) FROM schools WHERE County = \\'Amador\\' AND GSoffered = \\'9-12\\'\"}'}\nTool: The original query has a minor issue regarding the explicit instruction to \"Use ` for the in-query strings\", which typically refers to quoting identifiers in Spark SQL for robustness and clarity, especially if names contain special characters or are reserved keywords (though not strictly necessary for simple names like these).\n\nHere's the corrected query with backticks around identifiers:\n\n```sql\nSELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\n```", "final_answer": "", "replica": 1, "timestamp": 1768936350.3062909}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'", "execution_status": "VALID", "query_result": [["4"]], "spark_error": null, "total_time": 15.581921577453613, "spark_time": 0.2819702625274658, "translation_time": 15.299951314926147, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='9e699ada-5179-4b90-86f8-cfb06fa11395'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f443676e-1d44-4b66-9d84-764f0e1c9dc8'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(*) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}", "Observation: content='The query has a potential mistake regarding the proper quoting of identifiers, as suggested by the instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While `County` and `GSoffered` are simple names and might work without backticks in Spark SQL, it\\'s a best practice and often required for identifiers that contain special characters, spaces, or conflict with reserved keywords. Adhering to the instruction, identifiers should be enclosed in backticks.\\n\\nHere\\'s the rewritten query:\\n\\n```sql\\nSELECT COUNT(*) FROM schools WHERE `County` = \\'Amador\\' AND `GSoffered` = \\'9-12\\'\\n```' name='query_checker_sql_db' tool_call_id='9b7459d1-cd48-459d-86dc-d818fd2f5f92'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\"}"], "input_tokens": 3625, "output_tokens": 1888, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(*) FROM schools WHERE County = \\'Amador\\' AND GSoffered = \\'9-12\\'\"}'}\nTool: The query has a potential mistake regarding the proper quoting of identifiers, as suggested by the instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While `County` and `GSoffered` are simple names and might work without backticks in Spark SQL, it's a best practice and often required for identifiers that contain special characters, spaces, or conflict with reserved keywords. Adhering to the instruction, identifiers should be enclosed in backticks.\n\nHere's the rewritten query:\n\n```sql\nSELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\n```", "final_answer": "", "replica": 2, "timestamp": 1768936367.440282}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'", "execution_status": "VALID", "query_result": [["4"]], "spark_error": null, "total_time": 13.456907510757446, "spark_time": 0.2259969711303711, "translation_time": 13.230910539627075, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='76091156-01f2-4d63-884a-ecf9f2364856'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='80dcc60a-9583-4abb-bddb-990ff0bf8b56'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(School) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}", "Observation: content='The original query has a minor deviation from best practices regarding quoting identifiers, as specified in the prompt\\'s checklist (\"Properly quoting identifiers\" and \"Use ` for the in-query strings\"). While the query would likely execute correctly in Spark SQL without backticks for simple identifiers like `School`, `schools`, `County`, and `GSoffered`, it\\'s good practice to quote them, especially when the instruction explicitly mentions it.\\n\\nHere\\'s the rewritten query with identifiers properly quoted using backticks:\\n\\n```sql\\nSELECT COUNT(`School`) FROM `schools` WHERE `County` = \\'Amador\\' AND `GSoffered` = \\'9-12\\'\\n```' name='query_checker_sql_db' tool_call_id='d5af2644-b4cb-4fbc-8012-67dfbfacf83c'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\"}"], "input_tokens": 3632, "output_tokens": 1812, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(School) FROM schools WHERE County = \\'Amador\\' AND GSoffered = \\'9-12\\'\"}'}\nTool: The original query has a minor deviation from best practices regarding quoting identifiers, as specified in the prompt's checklist (\"Properly quoting identifiers\" and \"Use ` for the in-query strings\"). While the query would likely execute correctly in Spark SQL without backticks for simple identifiers like `School`, `schools`, `County`, and `GSoffered`, it's good practice to quote them, especially when the instruction explicitly mentions it.\n\nHere's the rewritten query with identifiers properly quoted using backticks:\n\n```sql\nSELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\n```", "final_answer": "", "replica": 3, "timestamp": 1768936382.5522902}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'", "execution_status": "VALID", "query_result": [["3"]], "spark_error": null, "total_time": 22.90429425239563, "spark_time": 1.2084777355194092, "translation_time": 21.69581651687622, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='dfb86c10-ccd4-4c9b-b338-1dcbfdc007ea'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a7c3e89b-4205-411a-8ef5-a1e6956e66f4'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='118f9ed4-3977-4acd-9951-1254da1215f8'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'\"}", "Observation: content=\"The provided Spark SQL query is well-formed and adheres to common best practices for Spark SQL.\\n\\nLet's review the potential mistakes:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**:\\n    *   `'Amador'` is a string literal, likely matching a string column `County Name`.\\n    *   `'9'` and `'12'` are string literals. While `Low Grade` and `High Grade` could potentially be integer columns, it's also very common for grade columns to be stored as strings (e.g., to accommodate 'K' for Kindergarten, 'PK' for Pre-Kindergarten, etc.). Spark SQL is generally flexible with implicit type conversion for simple numeric strings when comparing to numeric columns. If `Low Grade` and `High Grade` are string columns, then the current comparison is perfectly correct. If they are integer columns, Spark SQL would implicitly cast '9' and '12' to integers, which would work correctly. Therefore, this is not considered a critical mistake.\\n*   **Properly quoting identifiers**: All identifiers (`School Name`, `County Name`, `Low Grade`, `High Grade`) are correctly quoted using backticks (` `), which is the standard for Spark SQL, especially for names containing spaces.\\n*   **Use ` for the in-query strings**: This point likely refers to quoting identifiers, which is handled correctly. String literals ('Amador', '9', '12') are correctly enclosed in single quotes.\\n*   **Using the correct number of arguments for functions**: `COUNT(DISTINCT `School Name`)` correctly uses `COUNT` with `DISTINCT` on a single column.\\n*   **Casting to the correct data type**: Not explicitly used, and implicit casting (if needed for grades) is handled by Spark SQL.\\n*   **Using the proper columns for joins**: Not applicable, no joins are present.\\n\\nThe query is robust and correctly written.\\n\\n```sql\\nSELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'\\n```\" name='query_checker_sql_db' tool_call_id='f2d2dbd5-9d8c-4588-b00c-2cc617ede679'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'\"}"], "input_tokens": 5668, "output_tokens": 2994, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = \\'Amador\\' AND `Low Grade` = \\'9\\' AND `High Grade` = \\'12\\'\"}'}\nTool: The provided Spark SQL query is well-formed and adheres to common best practices for Spark SQL.\n\nLet's review the potential mistakes:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**:\n    *   `'Amador'` is a string literal, likely matching a string column `County Name`.\n    *   `'9'` and `'12'` are string literals. While `Low Grade` and `High Grade` could potentially be integer columns, it's also very common for grade columns to be stored as strings (e.g., to accommodate 'K' for Kindergarten, 'PK' for Pre-Kindergarten, etc.). Spark SQL is generally flexible with implicit type conversion for simple numeric strings when comparing to numeric columns. If `Low Grade` and `High Grade` are string columns, then the current comparison is perfectly correct. If they are integer columns, Spark SQL would implicitly cast '9' and '12' to integers, which would work correctly. Therefore, this is not considered a critical mistake.\n*   **Properly quoting identifiers**: All identifiers (`School Name`, `County Name`, `Low Grade`, `High Grade`) are correctly quoted using backticks (` `), which is the standard for Spark SQL, especially for names containing spaces.\n*   **Use ` for the in-query strings**: This point likely refers to quoting identifiers, which is handled correctly. String literals ('Amador', '9', '12') are correctly enclosed in single quotes.\n*   **Using the correct number of arguments for functions**: `COUNT(DISTINCT `School Name`)` correctly uses `COUNT` with `DISTINCT` on a single column.\n*   **Casting to the correct data type**: Not explicitly used, and implicit casting (if needed for grades) is handled by Spark SQL.\n*   **Using the proper columns for joins**: Not applicable, no joins are present.\n\nThe query is robust and correctly written.\n\n```sql\nSELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'\n```", "final_answer": "", "replica": 4, "timestamp": 1768936406.8785129}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(*) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'", "execution_status": "VALID", "query_result": [["4"]], "spark_error": null, "total_time": 11.458023309707642, "spark_time": 0.24642324447631836, "translation_time": 11.211600065231323, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0be9ff6e-050c-4248-a725-13b7a84623cb'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f363b32f-f587-4f7c-9eb8-bb84b92df50b'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(*) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}", "Observation: content=\"SELECT COUNT(*) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\" name='query_checker_sql_db' tool_call_id='185bf198-c66d-40bf-bd36-e92207041b3e'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(*) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}"], "input_tokens": 3504, "output_tokens": 1500, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(*) FROM schools WHERE County = \\'Amador\\' AND GSoffered = \\'9-12\\'\"}'}\nTool: SELECT COUNT(*) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'", "final_answer": "", "replica": 5, "timestamp": 1768936419.5921018}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'", "execution_status": "VALID", "query_result": [["3"]], "spark_error": null, "total_time": 21.297927141189575, "spark_time": 0.423997163772583, "translation_time": 20.873929977416992, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='43053533-c6ba-4a08-8fb1-46494bbb079f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='2b2f9fc7-5373-4433-be16-3bca330b598c'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='9d186e62-c71a-4b52-be65-cbfacced5928'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'\"}", "Observation: content=\"The provided Spark SQL query is well-formed and adheres to common best practices for Spark SQL.\\n\\nLet's review the potential mistakes:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**:\\n    *   `'Amador'` is a string literal, likely matching a string column `County Name`.\\n    *   `'9'` and `'12'` are string literals. While `Low Grade` and `High Grade` could potentially be integer columns, it's also very common for grade columns to be stored as strings (e.g., to accommodate 'K' for Kindergarten, 'PK' for Pre-Kindergarten, etc.). Spark SQL is generally flexible with implicit type conversion for simple numeric strings when comparing to numeric columns. If `Low Grade` and `High Grade` are string columns, then the current comparison is perfectly correct. If they are integer columns, Spark SQL would implicitly cast '9' and '12' to integers, which would work correctly. Therefore, this is not considered a critical mistake.\\n*   **Properly quoting identifiers**: All identifiers (`School Name`, `County Name`, `Low Grade`, `High Grade`) are correctly quoted using backticks (` `), which is the standard for Spark SQL, especially for names containing spaces.\\n*   **Use ` for the in-query strings**: This point likely refers to quoting identifiers, which is handled correctly. String literals ('Amador', '9', '12') are correctly enclosed in single quotes.\\n*   **Using the correct number of arguments for functions**: `COUNT(DISTINCT `School Name`)` correctly uses `COUNT` with `DISTINCT` on a single column.\\n*   **Casting to the correct data type**: Not explicitly used, and implicit casting (if needed for grades) is handled by Spark SQL.\\n*   **Using the proper columns for joins**: Not applicable, no joins are present.\\n\\nThe query is robust and correctly written.\\n\\n```sql\\nSELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'\\n```\" name='query_checker_sql_db' tool_call_id='4aa5205d-d8f4-46e3-8375-1915fa8db7d4'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'\"}"], "input_tokens": 5668, "output_tokens": 2994, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = \\'Amador\\' AND `Low Grade` = \\'9\\' AND `High Grade` = \\'12\\'\"}'}\nTool: The provided Spark SQL query is well-formed and adheres to common best practices for Spark SQL.\n\nLet's review the potential mistakes:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**:\n    *   `'Amador'` is a string literal, likely matching a string column `County Name`.\n    *   `'9'` and `'12'` are string literals. While `Low Grade` and `High Grade` could potentially be integer columns, it's also very common for grade columns to be stored as strings (e.g., to accommodate 'K' for Kindergarten, 'PK' for Pre-Kindergarten, etc.). Spark SQL is generally flexible with implicit type conversion for simple numeric strings when comparing to numeric columns. If `Low Grade` and `High Grade` are string columns, then the current comparison is perfectly correct. If they are integer columns, Spark SQL would implicitly cast '9' and '12' to integers, which would work correctly. Therefore, this is not considered a critical mistake.\n*   **Properly quoting identifiers**: All identifiers (`School Name`, `County Name`, `Low Grade`, `High Grade`) are correctly quoted using backticks (` `), which is the standard for Spark SQL, especially for names containing spaces.\n*   **Use ` for the in-query strings**: This point likely refers to quoting identifiers, which is handled correctly. String literals ('Amador', '9', '12') are correctly enclosed in single quotes.\n*   **Using the correct number of arguments for functions**: `COUNT(DISTINCT `School Name`)` correctly uses `COUNT` with `DISTINCT` on a single column.\n*   **Casting to the correct data type**: Not explicitly used, and implicit casting (if needed for grades) is handled by Spark SQL.\n*   **Using the proper columns for joins**: Not applicable, no joins are present.\n\nThe query is robust and correctly written.\n\n```sql\nSELECT COUNT(DISTINCT `School Name`) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'\n```", "final_answer": "", "replica": 6, "timestamp": 1768936442.641986}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'", "execution_status": "VALID", "query_result": [["4"]], "spark_error": null, "total_time": 14.510796546936035, "spark_time": 0.13100957870483398, "translation_time": 14.379786968231201, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d26f43b5-d933-4796-9543-811f11c9a9e5'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='d7b4a4b2-ae1e-4f23-8f8b-8acb7c5060ba'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(School) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}", "Observation: content='The original query has a minor issue regarding the explicit instruction to \"Use ` for the in-query strings\", which typically refers to quoting identifiers in Spark SQL for robustness and clarity, especially if names contain special characters or are reserved keywords (though not strictly necessary for simple names like these).\\n\\nHere\\'s the corrected query with backticks around identifiers:\\n\\n```sql\\nSELECT COUNT(`School`) FROM `schools` WHERE `County` = \\'Amador\\' AND `GSoffered` = \\'9-12\\'\\n```' name='query_checker_sql_db' tool_call_id='6722fd91-4c65-405a-b084-fc2d5113586b'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\"}"], "input_tokens": 3598, "output_tokens": 1985, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(School) FROM schools WHERE County = \\'Amador\\' AND GSoffered = \\'9-12\\'\"}'}\nTool: The original query has a minor issue regarding the explicit instruction to \"Use ` for the in-query strings\", which typically refers to quoting identifiers in Spark SQL for robustness and clarity, especially if names contain special characters or are reserved keywords (though not strictly necessary for simple names like these).\n\nHere's the corrected query with backticks around identifiers:\n\n```sql\nSELECT COUNT(`School`) FROM `schools` WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\n```", "final_answer": "", "replica": 7, "timestamp": 1768936458.1137772}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'", "execution_status": "VALID", "query_result": [["4"]], "spark_error": null, "total_time": 15.846717834472656, "spark_time": 0.1530008316040039, "translation_time": 15.693717002868652, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='5dd4fcba-1e8e-4623-92c7-25b4fa610c93'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='fcb22d29-3a8a-49d2-aa03-a3457b4161a9'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(*) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}", "Observation: content='The query has a potential mistake regarding the proper quoting of identifiers, as suggested by the instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While `County` and `GSoffered` are simple names and might work without backticks in Spark SQL, it\\'s a best practice and often required for identifiers that contain special characters, spaces, or conflict with reserved keywords. Adhering to the instruction, identifiers should be enclosed in backticks.\\n\\nHere\\'s the rewritten query:\\n\\n```sql\\nSELECT COUNT(*) FROM schools WHERE `County` = \\'Amador\\' AND `GSoffered` = \\'9-12\\'\\n```' name='query_checker_sql_db' tool_call_id='d37ea957-d90f-46d5-83a4-e4615504fd57'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\"}"], "input_tokens": 3625, "output_tokens": 1888, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(*) FROM schools WHERE County = \\'Amador\\' AND GSoffered = \\'9-12\\'\"}'}\nTool: The query has a potential mistake regarding the proper quoting of identifiers, as suggested by the instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While `County` and `GSoffered` are simple names and might work without backticks in Spark SQL, it's a best practice and often required for identifiers that contain special characters, spaces, or conflict with reserved keywords. Adhering to the instruction, identifiers should be enclosed in backticks.\n\nHere's the rewritten query:\n\n```sql\nSELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\n```", "final_answer": "", "replica": 8, "timestamp": 1768936477.412291}
{"query_id": 20, "provider": "google", "db": "california_schools", "nl_query": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12? ", "gold_sqlite": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "gold_spark": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'", "execution_status": "VALID", "query_result": [["4"]], "spark_error": null, "total_time": 16.20687222480774, "spark_time": 0.17000126838684082, "translation_time": 16.0368709564209, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='aaed3270-734e-4d2e-8eba-d1b9d1b0664d'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='9a864119-8d63-45a6-80e8-465ebf0237fd'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(*) FROM schools WHERE County = 'Amador' AND GSoffered = '9-12'\"}", "Observation: content='The query has a potential mistake regarding the proper quoting of identifiers, as suggested by the instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While `County` and `GSoffered` are simple names and might work without backticks in Spark SQL, it\\'s a best practice and often required for identifiers that contain special characters, spaces, or conflict with reserved keywords. Adhering to the instruction, identifiers should be enclosed in backticks.\\n\\nHere\\'s the rewritten query:\\n\\n```sql\\nSELECT COUNT(*) FROM schools WHERE `County` = \\'Amador\\' AND `GSoffered` = \\'9-12\\'\\n```' name='query_checker_sql_db' tool_call_id='69bd14d8-9e13-40f2-8bac-fca4a5615d3e'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\"}"], "input_tokens": 3625, "output_tokens": 1888, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: How many schools in Amador which the Low Grade is 9 and the High Grade is 12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(*) FROM schools WHERE County = \\'Amador\\' AND GSoffered = \\'9-12\\'\"}'}\nTool: The query has a potential mistake regarding the proper quoting of identifiers, as suggested by the instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While `County` and `GSoffered` are simple names and might work without backticks in Spark SQL, it's a best practice and often required for identifiers that contain special characters, spaces, or conflict with reserved keywords. Adhering to the instruction, identifiers should be enclosed in backticks.\n\nHere's the rewritten query:\n\n```sql\nSELECT COUNT(*) FROM schools WHERE `County` = 'Amador' AND `GSoffered` = '9-12'\n```", "final_answer": "", "replica": 9, "timestamp": 1768936494.7321548}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 14.207276582717896, "spark_time": 1.8670454025268555, "translation_time": 12.34023118019104, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='41a18e86-f8b2-4817-9364-5d0f9977a345'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='91eb9666-e5db-4636-8e3c-a57c9d94b191'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"The query appears to be correct and follows Spark SQL conventions.\\n- Identifiers with spaces (`Free Meal Count (K-12)`, `FRPM Count (K-12)`) are properly quoted using backticks (` `).\\n- String literals (`'Los Angeles'`) use single quotes.\\n- The join condition `T1.CDSCode = T2.CDSCode` is logical for linking school data.\\n- The `COUNT(DISTINCT ...)` function is used correctly.\\n- Comparison operators (`>`, `<`) are used correctly for exclusive ranges.\\n- There are no `NOT IN` with potential NULL issues, `UNION` vs `UNION ALL` issues, or obvious data type mismatches.\\n\\n```sql\\nSELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\\n```\" name='query_checker_sql_db' tool_call_id='5ae20bd4-e9d1-4009-84f0-7f6e03325253'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4348, "output_tokens": 2065, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = \\'Los Angeles\\' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\"}'}\nTool: The query appears to be correct and follows Spark SQL conventions.\n- Identifiers with spaces (`Free Meal Count (K-12)`, `FRPM Count (K-12)`) are properly quoted using backticks (` `).\n- String literals (`'Los Angeles'`) use single quotes.\n- The join condition `T1.CDSCode = T2.CDSCode` is logical for linking school data.\n- The `COUNT(DISTINCT ...)` function is used correctly.\n- Comparison operators (`>`, `<`) are used correctly for exclusive ranges.\n- There are no `NOT IN` with potential NULL issues, `UNION` vs `UNION ALL` issues, or obvious data type mismatches.\n\n```sql\nSELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\n```", "final_answer": "", "replica": 0, "timestamp": 1768936510.0494318}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 16.76079297065735, "spark_time": 0.2987706661224365, "translation_time": 16.462022304534912, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c8faee59-ddeb-4d31-b147-7b4c772eed68'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='6f4939f3-8958-4520-9988-761ed9592600'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers**: Identifiers with spaces (e.g., `School Name`, `Free Meal Count (K-12)`, `FRPM Count (K-12)`) are correctly quoted using backticks (` `). Other identifiers without spaces are not quoted, which is also correct.\\n*   **String Literals**: The string literal `'Los Angeles'` is correctly enclosed in single quotes.\\n*   **Data Types**: The comparisons `T2.City = 'Los Angeles'`, `T1.`Free Meal Count (K-12)` > 500`, and `T1.`FRPM Count (K-12)` < 700` assume appropriate data types (string for City, numeric for counts), which is standard and likely correct.\\n*   **Join Condition**: `T1.CDSCode = T2.CDSCode` is a logical and common way to join these two tables, assuming `CDSCode` is the unique identifier for schools.\\n*   **Function Usage**: `COUNT(DISTINCT T1.`School Name`)` is used correctly to count unique school names.\\n*   Other potential mistakes like `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, and explicit casting are not present in this query.\\n\\nTherefore, the original query is reproduced as it is already correct.\\n\\n```sql\\nSELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\\n```\" name='query_checker_sql_db' tool_call_id='e33e26a7-f9ed-4b25-a27f-03905c243255'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4525, "output_tokens": 2169, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Los Angeles\\' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers**: Identifiers with spaces (e.g., `School Name`, `Free Meal Count (K-12)`, `FRPM Count (K-12)`) are correctly quoted using backticks (` `). Other identifiers without spaces are not quoted, which is also correct.\n*   **String Literals**: The string literal `'Los Angeles'` is correctly enclosed in single quotes.\n*   **Data Types**: The comparisons `T2.City = 'Los Angeles'`, `T1.`Free Meal Count (K-12)` > 500`, and `T1.`FRPM Count (K-12)` < 700` assume appropriate data types (string for City, numeric for counts), which is standard and likely correct.\n*   **Join Condition**: `T1.CDSCode = T2.CDSCode` is a logical and common way to join these two tables, assuming `CDSCode` is the unique identifier for schools.\n*   **Function Usage**: `COUNT(DISTINCT T1.`School Name`)` is used correctly to count unique school names.\n*   Other potential mistakes like `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, and explicit casting are not present in this query.\n\nTherefore, the original query is reproduced as it is already correct.\n\n```sql\nSELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\n```", "final_answer": "", "replica": 1, "timestamp": 1768936527.7432036}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 11.067609071731567, "spark_time": 0.29200005531311035, "translation_time": 10.775609016418457, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='012107f0-0a65-4305-b662-d33b25871262'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='7f1a43bf-cd27-4ed1-8479-674a5a8eaf22'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"```sql\\nSELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\\n```\" name='query_checker_sql_db' tool_call_id='348d4a2d-ad29-4ecd-a546-48bab2ae8277'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4197, "output_tokens": 1707, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = \\'Los Angeles\\' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\"}'}\nTool: ```sql\nSELECT COUNT(DISTINCT T1.School) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Los Angeles' AND T2.`Free Meal Count (K-12)` > 500 AND T2.`FRPM Count (K-12)` < 700\n```", "final_answer": "", "replica": 2, "timestamp": 1768936539.688523}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 13.345117807388306, "spark_time": 0.37000441551208496, "translation_time": 12.97511339187622, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d61a2a01-3f00-4751-b3c1-a7d1d425ee80'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='851fc94a-c327-46b0-9525-07a873de290f'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\" name='query_checker_sql_db' tool_call_id='2fa36ae8-840b-4b66-baf2-433e25a30393'", "Action: query_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4196, "output_tokens": 2050, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Los Angeles\\' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}'}\nTool: SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "final_answer": "", "replica": 3, "timestamp": 1768936554.6267145}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 16.192195177078247, "spark_time": 0.5430271625518799, "translation_time": 15.649168014526367, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b30f6855-1ca6-4529-8d76-14717057d24e'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='9c041e84-1679-4370-b452-37cdaa7ab868'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\" name='query_checker_sql_db' tool_call_id='a5e905bc-76e8-4cd0-8905-59418742c47a'", "Action: query_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4196, "output_tokens": 1911, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Los Angeles\\' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}'}\nTool: SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "final_answer": "", "replica": 4, "timestamp": 1768936571.9859316}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 13.787885665893555, "spark_time": 0.47500133514404297, "translation_time": 13.312884330749512, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='528c5de0-6c46-45c3-beb9-0fe990ef867c'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='5c747a28-bad2-4872-9970-0800f5e7cc4f'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\" name='query_checker_sql_db' tool_call_id='09610b6d-9083-4bf5-9481-50d05224659a'", "Action: query_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4196, "output_tokens": 1911, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Los Angeles\\' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}'}\nTool: SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "final_answer": "", "replica": 5, "timestamp": 1768936586.6783476}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 15.61902403831482, "spark_time": 0.3789534568786621, "translation_time": 15.240070581436157, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='3d14ee91-7228-4ee2-bdbf-207d68854e84'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='041a6365-3361-438a-bd92-05e137b05ad7'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\" name='query_checker_sql_db' tool_call_id='55e356f2-77cb-4a70-a457-bc4fae825ab3'", "Action: query_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4196, "output_tokens": 1911, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Los Angeles\\' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}'}\nTool: SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "final_answer": "", "replica": 6, "timestamp": 1768936603.2813756}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 15.14308500289917, "spark_time": 0.3535637855529785, "translation_time": 14.789521217346191, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='21c5c940-c6dd-47ab-97ac-8937025824df'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='189533bb-14ad-43b0-8827-c84a0d6ba932'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"```sql\\nSELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\\n```\" name='query_checker_sql_db' tool_call_id='11eaf260-5010-4540-acc6-2eaffa103260'", "Action: query_sql_db\nAction Input: {'query': \"SELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4203, "output_tokens": 2276, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Los Angeles\\' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}'}\nTool: ```sql\nSELECT COUNT(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\n```", "final_answer": "", "replica": 7, "timestamp": 1768936619.6134408}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 17.726059675216675, "spark_time": 0.4360020160675049, "translation_time": 17.29005765914917, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='e3e25ae8-77a2-4197-a1aa-d9011d253357'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='d7a719f0-3fc1-4ae2-b4b7-f85c3baefe71'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"The query appears to be correct and follows the best practices outlined.\\n\\n*   `NOT IN` and `UNION` are not used.\\n*   `BETWEEN` is not used.\\n*   Data types in predicates seem appropriate (string comparison for `City`, numeric comparisons for counts).\\n*   Identifiers with spaces (`School Name`, `Free Meal Count (K-12)`, `FRPM Count (K-12)`) are correctly quoted using backticks.\\n*   String literals like `'Los Angeles'` are correctly quoted with single quotes.\\n*   `count(DISTINCT ...)` uses the correct number of arguments.\\n*   No explicit casting is used, and it doesn't seem necessary given the comparisons.\\n*   The join condition `T1.CDSCode = T2.CDSCode` uses appropriate columns for linking school data.\\n\\n```sql\\nSELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\\n```\" name='query_checker_sql_db' tool_call_id='94467efc-8f88-480c-9e9f-081804b2929f'", "Action: query_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4386, "output_tokens": 1827, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Los Angeles\\' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}'}\nTool: The query appears to be correct and follows the best practices outlined.\n\n*   `NOT IN` and `UNION` are not used.\n*   `BETWEEN` is not used.\n*   Data types in predicates seem appropriate (string comparison for `City`, numeric comparisons for counts).\n*   Identifiers with spaces (`School Name`, `Free Meal Count (K-12)`, `FRPM Count (K-12)`) are correctly quoted using backticks.\n*   String literals like `'Los Angeles'` are correctly quoted with single quotes.\n*   `count(DISTINCT ...)` uses the correct number of arguments.\n*   No explicit casting is used, and it doesn't seem necessary given the comparisons.\n*   The join condition `T1.CDSCode = T2.CDSCode` uses appropriate columns for linking school data.\n\n```sql\nSELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\n```", "final_answer": "", "replica": 8, "timestamp": 1768936639.9603543}
{"query_id": 21, "provider": "google", "db": "california_schools", "nl_query": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? ", "gold_sqlite": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)`< 700", "gold_spark": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "execution_status": "VALID", "query_result": [["75"]], "spark_error": null, "total_time": 15.006627082824707, "spark_time": 0.24799895286560059, "translation_time": 14.758628129959106, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='55b1444d-0426-4efc-8f16-1c9bc244bd8f'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='6a7f3a2a-27dd-44c5-9636-952097bd1cdb'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}", "Observation: content=\"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\" name='query_checker_sql_db' tool_call_id='d1b45b5f-cb1a-4e02-bb51-c40fe959a3ee'", "Action: query_sql_db\nAction Input: {'query': \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}"], "input_tokens": 4196, "output_tokens": 2048, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Los Angeles\\' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700\"}'}\nTool: SELECT count(DISTINCT T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700", "final_answer": "", "replica": 9, "timestamp": 1768936656.3470798}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `s`.`school_name`, SUM(`sa`.`test_takers`) AS `total_test_takers` FROM `schools` AS `s` JOIN `satscores` AS `sa` ON `s`.`school_name` = `sa`.`school_name` WHERE `s`.`county` = 'Contra Costa' GROUP BY `s`.`school_name` ORDER BY `total_test_takers` DESC LIMIT 1", "execution_status": "ERROR", "query_result": null, "spark_error": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `s`.`school_name` cannot be resolved. Did you mean one of the following? [`s`.`School`, `sa`.`cname`, `sa`.`dname`, `sa`.`sname`, `s`.`EILName`]. SQLSTATE: 42703; line 1 pos 123;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Sort ['total_test_takers DESC NULLS LAST], true\n      +- 'Aggregate ['s.school_name], ['s.school_name, 'SUM('sa.test_takers) AS total_test_takers#2566]\n         +- 'Filter ('s.county = Contra Costa)\n            +- 'Join Inner, ('s.school_name = 'sa.school_name)\n               :- SubqueryAlias s\n               :  +- SubqueryAlias schools\n               :     +- View (`schools`, [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields])\n               :        +- LocalRelation [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields]\n               +- SubqueryAlias sa\n                  +- SubqueryAlias satscores\n                     +- View (`satscores`, [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39])\n                        +- LocalRelation [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39]\n", "total_time": 28.168798685073853, "spark_time": 0.5664300918579102, "translation_time": 27.602368593215942, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='2faf807c-ffec-4202-80bf-99e71325e7cc'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='ded637aa-a9c5-46cf-8600-1105919ba96a'", "Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='eefa6276-2486-49e0-87eb-0ab414c90ca7'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='b931bc38-8efa-4589-a0c3-8de13b3e6bab'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.school_name, SUM(sa.test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS sa ON s.school_name = sa.school_name WHERE s.county = 'Contra Costa' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1\"}", "Observation: content='The original query is syntactically correct and would execute successfully in Spark SQL. Most of the common mistakes listed are not present in the query.\\n\\nHowever, the instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" suggests a preference for using backticks (`` ` ``) to quote identifiers in Spark SQL, even when they don\\'t strictly require it (i.e., they don\\'t contain special characters or conflict with keywords). This practice enhances robustness and clarity.\\n\\nThe instruction \"Use ` for the in-query strings\" is slightly ambiguous. If it literally meant string literals (like `\\'Contra Costa\\'`), using backticks for them would be syntactically incorrect in Spark SQL (string literals require single quotes). Assuming this instruction is intended to reinforce the use of backticks for identifiers, the query can be made more robust by quoting all table and column identifiers with backticks.\\n\\nHere\\'s the rewritten query with identifiers properly quoted using backticks:\\n\\n```sql\\nSELECT `s`.`school_name`, SUM(`sa`.`test_takers`) AS `total_test_takers`\\nFROM `schools` AS `s`\\nJOIN `satscores` AS `sa` ON `s`.`school_name` = `sa`.`school_name`\\nWHERE `s`.`county` = \\'Contra Costa\\'\\nGROUP BY `s`.`school_name`\\nORDER BY `total_test_takers` DESC\\nLIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='b8b2fef2-a4f2-4235-8300-6d924bbb6b36'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`school_name`, SUM(`sa`.`test_takers`) AS `total_test_takers` FROM `schools` AS `s` JOIN `satscores` AS `sa` ON `s`.`school_name` = `sa`.`school_name` WHERE `s`.`county` = 'Contra Costa' GROUP BY `s`.`school_name` ORDER BY `total_test_takers` DESC LIMIT 1\"}"], "input_tokens": 5137, "output_tokens": 3602, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.school_name, SUM(sa.test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS sa ON s.school_name = sa.school_name WHERE s.county = \\'Contra Costa\\' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1\"}'}\nTool: The original query is syntactically correct and would execute successfully in Spark SQL. Most of the common mistakes listed are not present in the query.\n\nHowever, the instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" suggests a preference for using backticks (`` ` ``) to quote identifiers in Spark SQL, even when they don't strictly require it (i.e., they don't contain special characters or conflict with keywords). This practice enhances robustness and clarity.\n\nThe instruction \"Use ` for the in-query strings\" is slightly ambiguous. If it literally meant string literals (like `'Contra Costa'`), using backticks for them would be syntactically incorrect in Spark SQL (string literals require single quotes). Assuming this instruction is intended to reinforce the use of backticks for identifiers, the query can be made more robust by quoting all table and column identifiers with backticks.\n\nHere's the rewritten query with identifiers properly quoted using backticks:\n\n```sql\nSELECT `s`.`school_name`, SUM(`sa`.`test_takers`) AS `total_test_takers`\nFROM `schools` AS `s`\nJOIN `satscores` AS `sa` ON `s`.`school_name` = `sa`.`school_name`\nWHERE `s`.`county` = 'Contra Costa'\nGROUP BY `s`.`school_name`\nORDER BY `total_test_takers` DESC\nLIMIT 1\n```", "final_answer": "", "replica": 0, "timestamp": 1768936684.7138777}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 20.662597179412842, "spark_time": 2.7978298664093018, "translation_time": 17.86476731300354, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cac2279a-cfdd-4867-8c44-995df2cb9e43'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='09d4712c-c4c9-413a-bdb7-7c407fc39c0d'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\\n*   **Using BETWEEN for exclusive ranges**: The query does not use `BETWEEN`.\\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.cds` and the filter `T2.cname = 'Contra Costa'` assume compatible data types, which is standard for such operations. `SUM(T2.NumTstTakr)` correctly aggregates a numeric column.\\n*   **Properly quoting identifiers**: Identifiers like `sname`, `NumTstTakr`, `CDSCode`, `cds`, `cname` are standard SQL identifiers and do not require backticks unless they are reserved keywords or contain special characters/spaces. In Spark SQL, unquoted identifiers are generally treated as case-insensitive.\\n*   **Use ` for the in-query strings**: String literals in Spark SQL (and standard SQL) are enclosed in single quotes (`'`). The query correctly uses `'Contra Costa'`. Backticks (`` ` ``) are typically used for quoting identifiers, not string literals.\\n*   **Using the correct number of arguments for functions**: `SUM(T2.NumTstTakr)` correctly uses one argument for the `SUM` aggregate function.\\n*   **Casting to the correct data type**: No explicit casting is used or appears necessary.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` correctly links the `schools` and `satscores` tables based on their respective code columns.\\n\\nThe query is well-formed and follows standard Spark SQL syntax.\\n\\n```sql\\nSELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='ff8c49db-f3d8-40df-81df-f5a824ebc010'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}"], "input_tokens": 4167, "output_tokens": 2500, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = \\'Contra Costa\\' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\n*   **Using BETWEEN for exclusive ranges**: The query does not use `BETWEEN`.\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.cds` and the filter `T2.cname = 'Contra Costa'` assume compatible data types, which is standard for such operations. `SUM(T2.NumTstTakr)` correctly aggregates a numeric column.\n*   **Properly quoting identifiers**: Identifiers like `sname`, `NumTstTakr`, `CDSCode`, `cds`, `cname` are standard SQL identifiers and do not require backticks unless they are reserved keywords or contain special characters/spaces. In Spark SQL, unquoted identifiers are generally treated as case-insensitive.\n*   **Use ` for the in-query strings**: String literals in Spark SQL (and standard SQL) are enclosed in single quotes (`'`). The query correctly uses `'Contra Costa'`. Backticks (`` ` ``) are typically used for quoting identifiers, not string literals.\n*   **Using the correct number of arguments for functions**: `SUM(T2.NumTstTakr)` correctly uses one argument for the `SUM` aggregate function.\n*   **Casting to the correct data type**: No explicit casting is used or appears necessary.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` correctly links the `schools` and `satscores` tables based on their respective code columns.\n\nThe query is well-formed and follows standard Spark SQL syntax.\n\n```sql\nSELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\n```", "final_answer": "", "replica": 1, "timestamp": 1768936707.7080867}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 11.938071012496948, "spark_time": 0.38254880905151367, "translation_time": 11.555522203445435, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='275d8400-7f9b-4423-9b26-fb6bd272ab43'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='c07fb00c-d3ea-4fd1-ac6f-77c31526b464'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}", "Observation: content=\"```sql\\nSELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='a6786c2e-1277-4f25-ae6a-d97ba15685ef'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}"], "input_tokens": 3755, "output_tokens": 1658, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = \\'Contra Costa\\' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}'}\nTool: ```sql\nSELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\n```", "final_answer": "", "replica": 2, "timestamp": 1768936720.469264}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["None", "1724"]], "spark_error": null, "total_time": 15.635101079940796, "spark_time": 0.2590024471282959, "translation_time": 15.3760986328125, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='077086ed-d9f4-440e-a64c-6af11f1ae929'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='ddb1109f-f653-47c0-a4bc-6f99b18d8b1d'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULLs.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (`cname = 'Contra Costa'`) are consistent (string comparison).\\n*   Identifiers (`sname`, `NumTstTakr`, `satscores`, `cname`) are unquoted, which is acceptable in Spark SQL if they don't contain special characters or reserved keywords.\\n*   String literals (`'Contra Costa'`) are correctly quoted with single quotes.\\n*   No functions are used.\\n*   No explicit casting is performed or needed.\\n*   No joins are involved.\\n\\nThe query correctly selects the school name and number of test takers for the school with the highest number of test takers in 'Contra Costa' county.\\n\\n```sql\\nSELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='f5dd3a48-484e-49d4-8bd0-4c81433711c3'", "Action: query_sql_db\nAction Input: {'query': \"SELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\"}"], "input_tokens": 3837, "output_tokens": 1592, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT sname, NumTstTakr FROM satscores WHERE cname = \\'Contra Costa\\' ORDER BY NumTstTakr DESC LIMIT 1;\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULLs.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (`cname = 'Contra Costa'`) are consistent (string comparison).\n*   Identifiers (`sname`, `NumTstTakr`, `satscores`, `cname`) are unquoted, which is acceptable in Spark SQL if they don't contain special characters or reserved keywords.\n*   String literals (`'Contra Costa'`) are correctly quoted with single quotes.\n*   No functions are used.\n*   No explicit casting is performed or needed.\n*   No joins are involved.\n\nThe query correctly selects the school name and number of test takers for the school with the highest number of test takers in 'Contra Costa' county.\n\n```sql\nSELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\n```", "final_answer": "", "replica": 3, "timestamp": 1768936736.960366}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 18.1712384223938, "spark_time": 0.22900104522705078, "translation_time": 17.942237377166748, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c30064e2-67a3-40bf-8607-6637c295a06f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='aafa3da0-b7fc-485f-92d0-3bf5f59947e0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\\n*   **Using BETWEEN for exclusive ranges**: The query does not use `BETWEEN`.\\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.cds` and the filter `T2.cname = 'Contra Costa'` assume compatible data types, which is standard for such operations. `SUM(T2.NumTstTakr)` correctly aggregates a numeric column.\\n*   **Properly quoting identifiers**: Identifiers like `sname`, `NumTstTakr`, `CDSCode`, `cds`, `cname` are standard SQL identifiers and do not require backticks unless they are reserved keywords or contain special characters/spaces. In Spark SQL, unquoted identifiers are generally treated as case-insensitive.\\n*   **Use ` for the in-query strings**: String literals in Spark SQL (and standard SQL) are enclosed in single quotes (`'`). The query correctly uses `'Contra Costa'`. Backticks (`` ` ``) are typically used for quoting identifiers, not string literals.\\n*   **Using the correct number of arguments for functions**: `SUM(T2.NumTstTakr)` correctly uses one argument for the `SUM` aggregate function.\\n*   **Casting to the correct data type**: No explicit casting is used or appears necessary.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` correctly links the `schools` and `satscores` tables based on their respective code columns.\\n\\nThe query is well-formed and follows standard Spark SQL syntax.\\n\\n```sql\\nSELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='4d00d599-587e-46d8-bca2-c2a0f74003be'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}"], "input_tokens": 4167, "output_tokens": 2497, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = \\'Contra Costa\\' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\n*   **Using BETWEEN for exclusive ranges**: The query does not use `BETWEEN`.\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.cds` and the filter `T2.cname = 'Contra Costa'` assume compatible data types, which is standard for such operations. `SUM(T2.NumTstTakr)` correctly aggregates a numeric column.\n*   **Properly quoting identifiers**: Identifiers like `sname`, `NumTstTakr`, `CDSCode`, `cds`, `cname` are standard SQL identifiers and do not require backticks unless they are reserved keywords or contain special characters/spaces. In Spark SQL, unquoted identifiers are generally treated as case-insensitive.\n*   **Use ` for the in-query strings**: String literals in Spark SQL (and standard SQL) are enclosed in single quotes (`'`). The query correctly uses `'Contra Costa'`. Backticks (`` ` ``) are typically used for quoting identifiers, not string literals.\n*   **Using the correct number of arguments for functions**: `SUM(T2.NumTstTakr)` correctly uses one argument for the `SUM` aggregate function.\n*   **Casting to the correct data type**: No explicit casting is used or appears necessary.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` correctly links the `schools` and `satscores` tables based on their respective code columns.\n\nThe query is well-formed and follows standard Spark SQL syntax.\n\n```sql\nSELECT T2.sname, SUM(T2.NumTstTakr) AS TotalTestTakers FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.cname = 'Contra Costa' GROUP BY T2.sname ORDER BY TotalTestTakers DESC LIMIT 1\n```", "final_answer": "", "replica": 4, "timestamp": 1768936756.1225736}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.school_name, SUM(sa.num_test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS sa ON s.school_name = sa.school_name WHERE s.county = 'Contra Costa' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1;", "execution_status": "ERROR", "query_result": null, "spark_error": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `s`.`school_name` cannot be resolved. Did you mean one of the following? [`s`.`School`, `sa`.`cname`, `sa`.`dname`, `sa`.`sname`, `s`.`EILName`]. SQLSTATE: 42703; line 1 pos 109;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Sort ['total_test_takers DESC NULLS LAST], true\n      +- 'Aggregate ['s.school_name], ['s.school_name, 'SUM('sa.num_test_takers) AS total_test_takers#3045]\n         +- 'Filter ('s.county = Contra Costa)\n            +- 'Join Inner, ('s.school_name = 'sa.school_name)\n               :- SubqueryAlias s\n               :  +- SubqueryAlias schools\n               :     +- View (`schools`, [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields])\n               :        +- LocalRelation [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields]\n               +- SubqueryAlias sa\n                  +- SubqueryAlias satscores\n                     +- View (`satscores`, [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39])\n                        +- LocalRelation [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39]\n", "total_time": 12.602409601211548, "spark_time": 0.10500097274780273, "translation_time": 12.497408628463745, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='4a5d58c9-ec8d-440a-8fe9-65554594e722'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='faf18eeb-9934-4c56-b1e1-fcbebe227016'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.school_name, SUM(sa.num_test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS sa ON s.school_name = sa.school_name WHERE s.county = 'Contra Costa' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1;\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION when UNION ALL should have been used**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: `s.school_name = sa.school_name` assumes compatible string types, which is standard. `s.county = 'Contra Costa'` correctly compares a column to a string literal.\\n*   **Properly quoting identifiers**: Column and table names are simple and do not require special quoting (like backticks).\\n*   **Use `` ` `` for the in-query strings**: String literals like `'Contra Costa'` are correctly enclosed in single quotes. Backticks (`` ` ``) are used for quoting identifiers (table names, column names) in Spark SQL, not string literals. The query correctly uses single quotes for the string literal.\\n*   **Using the correct number of arguments for functions**: `SUM(sa.num_test_takers)` uses `SUM` with one argument, which is correct.\\n*   **Casting to the correct data type**: No explicit casting is needed; `SUM` will handle numeric types appropriately.\\n*   **Using the proper columns for joins**: `s.school_name = sa.school_name` is a logical join condition to link schools with their SAT scores.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT s.school_name, SUM(sa.num_test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS sa ON s.school_name = sa.school_name WHERE s.county = 'Contra Costa' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='63de0069-7301-4e06-8ed3-65b2a4989c03'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.school_name, SUM(sa.num_test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS sa ON s.school_name = sa.school_name WHERE s.county = 'Contra Costa' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1;\"}"], "input_tokens": 3549, "output_tokens": 1983, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.school_name, SUM(sa.num_test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS sa ON s.school_name = sa.school_name WHERE s.county = \\'Contra Costa\\' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1;\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION when UNION ALL should have been used**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: `s.school_name = sa.school_name` assumes compatible string types, which is standard. `s.county = 'Contra Costa'` correctly compares a column to a string literal.\n*   **Properly quoting identifiers**: Column and table names are simple and do not require special quoting (like backticks).\n*   **Use `` ` `` for the in-query strings**: String literals like `'Contra Costa'` are correctly enclosed in single quotes. Backticks (`` ` ``) are used for quoting identifiers (table names, column names) in Spark SQL, not string literals. The query correctly uses single quotes for the string literal.\n*   **Using the correct number of arguments for functions**: `SUM(sa.num_test_takers)` uses `SUM` with one argument, which is correct.\n*   **Casting to the correct data type**: No explicit casting is needed; `SUM` will handle numeric types appropriately.\n*   **Using the proper columns for joins**: `s.school_name = sa.school_name` is a logical join condition to link schools with their SAT scores.\n\nThe query is correct as written.\n\n```sql\nSELECT s.school_name, SUM(sa.num_test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS sa ON s.school_name = sa.school_name WHERE s.county = 'Contra Costa' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1;\n```", "final_answer": "", "replica": 5, "timestamp": 1768936768.8929827}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT `sname`, `NumTstTakr` FROM `satscores` WHERE `cname` = 'Contra Costa' ORDER BY `NumTstTakr` DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["None", "1724"]], "spark_error": null, "total_time": 19.8733913898468, "spark_time": 0.4499979019165039, "translation_time": 19.423393487930298, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='443d0efa-69af-4322-8214-19b7e95ed080'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='743bb053-19a0-47a2-869d-9caad6e10db0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\"}", "Observation: content='The original query is mostly correct and would execute successfully in Spark SQL. However, based on the specific instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", it implies that identifiers (table names, column names) should be enclosed in backticks (`` ` ``) for best practice and consistency, even when not strictly necessary for simple names.\\n\\nThe original query uses unquoted identifiers: `sname`, `NumTstTakr`, `satscores`, `cname`.\\n\\nRewriting the query to properly quote all identifiers with backticks:\\n\\n```sql\\nSELECT `sname`, `NumTstTakr` FROM `satscores` WHERE `cname` = \\'Contra Costa\\' ORDER BY `NumTstTakr` DESC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='716f7821-3f79-4a26-8e3f-d5dac4e1a878'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `sname`, `NumTstTakr` FROM `satscores` WHERE `cname` = 'Contra Costa' ORDER BY `NumTstTakr` DESC LIMIT 1;\"}"], "input_tokens": 3764, "output_tokens": 2213, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT sname, NumTstTakr FROM satscores WHERE cname = \\'Contra Costa\\' ORDER BY NumTstTakr DESC LIMIT 1;\"}'}\nTool: The original query is mostly correct and would execute successfully in Spark SQL. However, based on the specific instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", it implies that identifiers (table names, column names) should be enclosed in backticks (`` ` ``) for best practice and consistency, even when not strictly necessary for simple names.\n\nThe original query uses unquoted identifiers: `sname`, `NumTstTakr`, `satscores`, `cname`.\n\nRewriting the query to properly quote all identifiers with backticks:\n\n```sql\nSELECT `sname`, `NumTstTakr` FROM `satscores` WHERE `cname` = 'Contra Costa' ORDER BY `NumTstTakr` DESC LIMIT 1;\n```", "final_answer": "", "replica": 6, "timestamp": 1768936789.7743971}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["None", "1724"]], "spark_error": null, "total_time": 14.86872673034668, "spark_time": 0.056005001068115234, "translation_time": 14.812721729278564, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='eb9ad664-fb3c-4c22-9eb8-3f45586ab40f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='5cd02334-cc93-42ca-a894-8317c88fcd61'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULLs.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (`cname = 'Contra Costa'`) are consistent (string comparison).\\n*   Identifiers (`sname`, `NumTstTakr`, `satscores`, `cname`) are unquoted, which is acceptable in Spark SQL if they don't contain special characters or reserved keywords.\\n*   String literals (`'Contra Costa'`) are correctly quoted with single quotes.\\n*   No functions are used.\\n*   No explicit casting is performed or needed.\\n*   No joins are involved.\\n\\nThe query correctly selects the school name and number of test takers for the school with the highest number of test takers in 'Contra Costa' county.\\n\\n```sql\\nSELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='a4ad7a71-d867-4583-85ac-c9d1db05e9b8'", "Action: query_sql_db\nAction Input: {'query': \"SELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\"}"], "input_tokens": 3837, "output_tokens": 1592, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT sname, NumTstTakr FROM satscores WHERE cname = \\'Contra Costa\\' ORDER BY NumTstTakr DESC LIMIT 1;\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULLs.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (`cname = 'Contra Costa'`) are consistent (string comparison).\n*   Identifiers (`sname`, `NumTstTakr`, `satscores`, `cname`) are unquoted, which is acceptable in Spark SQL if they don't contain special characters or reserved keywords.\n*   String literals (`'Contra Costa'`) are correctly quoted with single quotes.\n*   No functions are used.\n*   No explicit casting is performed or needed.\n*   No joins are involved.\n\nThe query correctly selects the school name and number of test takers for the school with the highest number of test takers in 'Contra Costa' county.\n\n```sql\nSELECT sname, NumTstTakr FROM satscores WHERE cname = 'Contra Costa' ORDER BY NumTstTakr DESC LIMIT 1;\n```", "final_answer": "", "replica": 7, "timestamp": 1768936806.2942832}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.school_name FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.school_name = T2.school_name WHERE T1.county = 'Contra Costa' GROUP BY T1.school_name ORDER BY SUM(T2.test_takers) DESC LIMIT 1", "execution_status": "ERROR", "query_result": null, "spark_error": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `T1`.`school_name` cannot be resolved. Did you mean one of the following? [`T1`.`School`, `T1`.`Phone`, `T2`.`cname`, `T1`.`ClosedDate`, `T1`.`County`]. SQLSTATE: 42703; line 1 pos 71;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Sort ['SUM('T2.test_takers) DESC NULLS LAST], true\n      +- 'Aggregate ['T1.school_name], ['T1.school_name]\n         +- 'Filter ('T1.county = Contra Costa)\n            +- 'Join Inner, ('T1.school_name = 'T2.school_name)\n               :- SubqueryAlias T1\n               :  +- SubqueryAlias schools\n               :     +- View (`schools`, [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields])\n               :        +- LocalRelation [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields]\n               +- SubqueryAlias T2\n                  +- SubqueryAlias satscores\n                     +- View (`satscores`, [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39])\n                        +- LocalRelation [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39]\n", "total_time": 26.577367067337036, "spark_time": 0.06199979782104492, "translation_time": 26.51536726951599, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='572e42f8-68a0-49c6-96ed-0c2896b31f59'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='0d957c7d-cf30-4427-9cf4-f65f5b133c93'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='cc218fa3-c743-4dff-b873-70883090dec9'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='a6857cf2-9f52-4179-adc2-fe408d2214d9'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.school_name FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.school_name = T2.school_name WHERE T1.county = 'Contra Costa' GROUP BY T1.school_name ORDER BY SUM(T2.test_takers) DESC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values:** Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used:** Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges:** Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates:** The predicates `T1.county = 'Contra Costa'` and `T1.school_name = T2.school_name` assume compatible string types, which is standard. `SUM(T2.test_takers)` assumes `test_takers` is a numeric type, which is appropriate for summation. No obvious mismatches.\\n*   **Properly quoting identifiers:** Identifiers like `school_name`, `county`, `test_takers` do not contain special characters or keywords, so they do not strictly require quoting with backticks (`` ` ``) in Spark SQL. The current form is acceptable.\\n*   **Use ` for the in-query strings:** In Spark SQL, string literals are enclosed in single quotes (`'string'`). Using backticks (`` `string` ``) for string literals would be incorrect syntax. The query correctly uses single quotes for `'Contra Costa'`.\\n*   **Using the correct number of arguments for functions:** `SUM(T2.test_takers)` correctly uses one argument for the `SUM` aggregate function.\\n*   **Casting to the correct data type:** No explicit `CAST` is used, and the implicit type handling for the operations seems correct.\\n*   **Using the proper columns for joins:** The join condition `T1.school_name = T2.school_name` is a logical and common way to link school information between `schools` and `satscores` tables.\\n\\nThe query is syntactically correct and follows common best practices for Spark SQL.\\n\\n```sql\\nSELECT T1.school_name FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.school_name = T2.school_name WHERE T1.county = 'Contra Costa' GROUP BY T1.school_name ORDER BY SUM(T2.test_takers) DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='a81a3aab-87a6-4f21-bcc7-7d5d7e77c131'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.school_name FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.school_name = T2.school_name WHERE T1.county = 'Contra Costa' GROUP BY T1.school_name ORDER BY SUM(T2.test_takers) DESC LIMIT 1\"}"], "input_tokens": 5300, "output_tokens": 3105, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.school_name FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.school_name = T2.school_name WHERE T1.county = \\'Contra Costa\\' GROUP BY T1.school_name ORDER BY SUM(T2.test_takers) DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values:** Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used:** Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges:** Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates:** The predicates `T1.county = 'Contra Costa'` and `T1.school_name = T2.school_name` assume compatible string types, which is standard. `SUM(T2.test_takers)` assumes `test_takers` is a numeric type, which is appropriate for summation. No obvious mismatches.\n*   **Properly quoting identifiers:** Identifiers like `school_name`, `county`, `test_takers` do not contain special characters or keywords, so they do not strictly require quoting with backticks (`` ` ``) in Spark SQL. The current form is acceptable.\n*   **Use ` for the in-query strings:** In Spark SQL, string literals are enclosed in single quotes (`'string'`). Using backticks (`` `string` ``) for string literals would be incorrect syntax. The query correctly uses single quotes for `'Contra Costa'`.\n*   **Using the correct number of arguments for functions:** `SUM(T2.test_takers)` correctly uses one argument for the `SUM` aggregate function.\n*   **Casting to the correct data type:** No explicit `CAST` is used, and the implicit type handling for the operations seems correct.\n*   **Using the proper columns for joins:** The join condition `T1.school_name = T2.school_name` is a logical and common way to link school information between `schools` and `satscores` tables.\n\nThe query is syntactically correct and follows common best practices for Spark SQL.\n\n```sql\nSELECT T1.school_name FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.school_name = T2.school_name WHERE T1.county = 'Contra Costa' GROUP BY T1.school_name ORDER BY SUM(T2.test_takers) DESC LIMIT 1\n```", "final_answer": "", "replica": 8, "timestamp": 1768936833.0526414}
{"query_id": 22, "provider": "google", "db": "california_schools", "nl_query": "Which school in Contra Costa has the highest number of test takers? ", "gold_sqlite": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1", "gold_spark": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND NOT sname IS NULL ORDER BY NumTstTakr DESC LIMIT 1", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `s`.`school_name`, SUM(`ss`.`test_takers`) AS `total_test_takers` FROM `schools` AS `s` JOIN `satscores` AS `ss` ON `s`.`school_name` = `ss`.`school_name` WHERE `s`.`county` = 'Contra Costa' GROUP BY `s`.`school_name` ORDER BY `total_test_takers` DESC LIMIT 1", "execution_status": "ERROR", "query_result": null, "spark_error": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `s`.`school_name` cannot be resolved. Did you mean one of the following? [`s`.`School`, `ss`.`cname`, `ss`.`dname`, `ss`.`sname`, `s`.`EILName`]. SQLSTATE: 42703; line 1 pos 123;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Sort ['total_test_takers DESC NULLS LAST], true\n      +- 'Aggregate ['s.school_name], ['s.school_name, 'SUM('ss.test_takers) AS total_test_takers#3294]\n         +- 'Filter ('s.county = Contra Costa)\n            +- 'Join Inner, ('s.school_name = 'ss.school_name)\n               :- SubqueryAlias s\n               :  +- SubqueryAlias schools\n               :     +- View (`schools`, [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields])\n               :        +- LocalRelation [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields]\n               +- SubqueryAlias ss\n                  +- SubqueryAlias satscores\n                     +- View (`satscores`, [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39])\n                        +- LocalRelation [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39]\n", "total_time": 23.94298529624939, "spark_time": 0.08851790428161621, "translation_time": 23.854467391967773, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='e0d5205e-bdc9-45fa-8eca-b4c1023eee49'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='3956acc5-208a-45b3-940a-a7d8d4d4f7a3'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='b7cb1554-0216-4f37-8c4e-bcb0fc4d3d49'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.school_name, SUM(ss.test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS ss ON s.school_name = ss.school_name WHERE s.county = 'Contra Costa' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1\"}", "Observation: content='The original query is mostly correct and would likely execute successfully in Spark SQL. However, based on the specific instructions provided, there\\'s one point that can be improved:\\n\\n*   **Properly quoting identifiers / Use `` ` `` for the in-query strings**: The prompt explicitly mentions using backticks (`` ` ``) for \"in-query strings,\" which in the context of SQL usually refers to identifiers (table names, column names, aliases) when they need quoting. While the identifiers in the original query (`school_name`, `test_takers`, `schools`, `satscores`, `s`, `ss`, `county`, `total_test_takers`) do not strictly *require* quoting as they don\\'t contain spaces or special characters and are not keywords, it is a good practice in Spark SQL to quote all identifiers with backticks for consistency and robustness, especially to avoid potential issues with case sensitivity or reserved keywords.\\n\\nApplying this improvement, the rewritten query would be:\\n\\n```sql\\nSELECT `s`.`school_name`, SUM(`ss`.`test_takers`) AS `total_test_takers`\\nFROM `schools` AS `s`\\nJOIN `satscores` AS `ss` ON `s`.`school_name` = `ss`.`school_name`\\nWHERE `s`.`county` = \\'Contra Costa\\'\\nGROUP BY `s`.`school_name`\\nORDER BY `total_test_takers` DESC\\nLIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='1a125e49-6e2f-489a-9676-c3cfb3b4007f'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`school_name`, SUM(`ss`.`test_takers`) AS `total_test_takers` FROM `schools` AS `s` JOIN `satscores` AS `ss` ON `s`.`school_name` = `ss`.`school_name` WHERE `s`.`county` = 'Contra Costa' GROUP BY `s`.`school_name` ORDER BY `total_test_takers` DESC LIMIT 1\"}"], "input_tokens": 4281, "output_tokens": 3078, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which school in Contra Costa has the highest number of test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.school_name, SUM(ss.test_takers) AS total_test_takers FROM schools AS s JOIN satscores AS ss ON s.school_name = ss.school_name WHERE s.county = \\'Contra Costa\\' GROUP BY s.school_name ORDER BY total_test_takers DESC LIMIT 1\"}'}\nTool: The original query is mostly correct and would likely execute successfully in Spark SQL. However, based on the specific instructions provided, there's one point that can be improved:\n\n*   **Properly quoting identifiers / Use `` ` `` for the in-query strings**: The prompt explicitly mentions using backticks (`` ` ``) for \"in-query strings,\" which in the context of SQL usually refers to identifiers (table names, column names, aliases) when they need quoting. While the identifiers in the original query (`school_name`, `test_takers`, `schools`, `satscores`, `s`, `ss`, `county`, `total_test_takers`) do not strictly *require* quoting as they don't contain spaces or special characters and are not keywords, it is a good practice in Spark SQL to quote all identifiers with backticks for consistency and robustness, especially to avoid potential issues with case sensitivity or reserved keywords.\n\nApplying this improvement, the rewritten query would be:\n\n```sql\nSELECT `s`.`school_name`, SUM(`ss`.`test_takers`) AS `total_test_takers`\nFROM `schools` AS `s`\nJOIN `satscores` AS `ss` ON `s`.`school_name` = `ss`.`school_name`\nWHERE `s`.`county` = 'Contra Costa'\nGROUP BY `s`.`school_name`\nORDER BY `total_test_takers` DESC\nLIMIT 1\n```", "final_answer": "", "replica": 9, "timestamp": 1768936857.421747}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 18.469175338745117, "spark_time": 0.883772611618042, "translation_time": 17.585402727127075, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1fd79f86-f8b2-4ef1-bf9d-350fc6fd0970'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='99f5f855-6aa4-48cb-9f70-916475219024'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='0f713dd2-8dd1-4ceb-91e7-8ff3b4c0dd94'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **`NOT IN` with `NULL` values**: Not used.\\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\\n*   **`BETWEEN` for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The subtraction of `Enrollment` columns and comparison with `30` is likely between numeric types, which is correct. Join conditions on `CDSCode` and `School Name` are between compatible types (likely string/integer and string respectively).\\n*   **Properly quoting identifiers**: Identifiers with spaces like `` `School Name` ``, `` `Enrollment (K-12)` ``, and `` `Enrollment (Ages 5-17)` `` are correctly quoted with backticks. Other identifiers without spaces are correctly used without backticks.\\n*   **Use `` ` `` for the in-query strings**: This point likely refers to identifiers that need quoting. String literals (e.g., `', '`) are correctly enclosed in single quotes, which is the standard for string literals in SQL. Identifiers are correctly quoted with backticks.\\n*   **Using the correct number of arguments for functions**: The `CONCAT` function is used with the correct number of arguments.\\n*   **Casting to the correct data type**: No explicit casts are needed, as implicit type handling seems appropriate for the operations performed.\\n*   **Using the proper columns for joins**: The join conditions `f.CDSCode = s.CDSCode` and `f.`School Name` = s.School` are appropriate for linking school records between the two tables.\\n\\n```sql\\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='8087d0dc-f19c-45af-bf76-43c0743e17d4'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 5813, "output_tokens": 2665, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **`NOT IN` with `NULL` values**: Not used.\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\n*   **`BETWEEN` for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The subtraction of `Enrollment` columns and comparison with `30` is likely between numeric types, which is correct. Join conditions on `CDSCode` and `School Name` are between compatible types (likely string/integer and string respectively).\n*   **Properly quoting identifiers**: Identifiers with spaces like `` `School Name` ``, `` `Enrollment (K-12)` ``, and `` `Enrollment (Ages 5-17)` `` are correctly quoted with backticks. Other identifiers without spaces are correctly used without backticks.\n*   **Use `` ` `` for the in-query strings**: This point likely refers to identifiers that need quoting. String literals (e.g., `', '`) are correctly enclosed in single quotes, which is the standard for string literals in SQL. Identifiers are correctly quoted with backticks.\n*   **Using the correct number of arguments for functions**: The `CONCAT` function is used with the correct number of arguments.\n*   **Casting to the correct data type**: No explicit casts are needed, as implicit type handling seems appropriate for the operations performed.\n*   **Using the proper columns for joins**: The join conditions `f.CDSCode = s.CDSCode` and `f.`School Name` = s.School` are appropriate for linking school records between the two tables.\n\n```sql\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 0, "timestamp": 1768936877.6190562}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["De Anza Senior High", "5000 Valley View Road, Richmond, CA 94803-2599"], ["Gompers (Samuel) Continuation", "831 Chanslor Avenue, Richmond, CA 94801-3533"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["California Virtual Academy High @ Maricopa", "50 Moreland Rd, Simi Valley, CA 93065-1800"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["District Office", "3699 North Holly Avenue, Baldwin Park, CA 91706-5397"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["Morningside High", "10500 South Yukon Avenue, Inglewood, CA 90303-2003"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Belmont SH-LA Teacher Preparatory Academy", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["RFK Community Schools- for the Visual Arts and Humanities", "701 South Catalina Street, Los Angeles, CA 90005-1943"], ["Alain Leroy Locke College Prep Academy", "325 East 111th Street, Los Angeles, CA 90061-3003"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["RFK Community Schools-UCLA Community K-12", "700 South Mariposa Avenue, Los Angeles, CA 90005-2001"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["Sylmar Senior High", "13050 Borden Avenue, Sylmar, CA 91342-4251"], ["William Howard Taft Charter High", "5461 Winnetka Avenue, Woodland Hills, CA 91364-2548"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Benjamin Banneker Special Education Center", "14024 South San Pedro Street, Los Angeles, CA 90061-2659"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Alphonso B. Perez Special Education Center", "4540 Michigan Avenue, Los Angeles, CA 90022-1130"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Vista High (Continuation)", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["Muir Charter", "12338 McCourtney Road, Grass Valley, CA 95949-9756"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Albert Schweitzer Elementary", "229 South Dale Avenue, Anaheim, CA 92804-2006"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Laurel Ruff Center", "5325 Garfield Avenue, Sacramento, CA 95841-3103"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["District Office", "1130 Fifth Avenue, Chula Vista, CA 91911-2812"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["District Office", "555 Franklin Street, San Francisco, CA 94102-5207"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School.", "555 Portola Drive, San Francisco, CA 94131-1616"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Mount Pleasant High", "1750 South White Road, San Jose, CA 95127-4760"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Athenour Elementary", "5200 Dent Ave, San Jose, CA 95118-2258"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 20.095779180526733, "spark_time": 0.44499874114990234, "translation_time": 19.65078043937683, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a0c55c4f-3602-4bcf-ac0e-3cf3bc510694'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='adc0fce8-86ad-45ca-b9a6-c3dc3f95f64d'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='a28511c8-2243-4293-ab16-a4f1aedb3673'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers**: Backticks (`) are correctly used for identifiers containing spaces (e.g., ``School Name``, ``Enrollment (K-12)``). Simple identifiers (e.g., `Street`, `City`, `CDSCode`) do not require backticks, but using them would also be acceptable.\\n*   **String Literals**: Single quotes (`'`) are correctly used for string literals within the `CONCAT` function (e.g., `', '`, `' '`). Backticks are for identifiers, not string literals.\\n*   **Data Types**: The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` compares numeric values, which is appropriate. The join condition `f.CDSCode = s.CDSCode` assumes compatible data types for `CDSCode` in both tables, which is standard for join keys.\\n*   **Function Usage**: `CONCAT` is used with the correct number of arguments to form the full address.\\n*   **Join Columns**: `CDSCode` is a common and logical column to join school-related tables.\\n\\n```sql\\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='f1158c2e-84b7-4266-b9ac-88bfa3b3d186'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 5688, "output_tokens": 1986, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers**: Backticks (`) are correctly used for identifiers containing spaces (e.g., ``School Name``, ``Enrollment (K-12)``). Simple identifiers (e.g., `Street`, `City`, `CDSCode`) do not require backticks, but using them would also be acceptable.\n*   **String Literals**: Single quotes (`'`) are correctly used for string literals within the `CONCAT` function (e.g., `', '`, `' '`). Backticks are for identifiers, not string literals.\n*   **Data Types**: The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` compares numeric values, which is appropriate. The join condition `f.CDSCode = s.CDSCode` assumes compatible data types for `CDSCode` in both tables, which is standard for join keys.\n*   **Function Usage**: `CONCAT` is used with the correct number of arguments to form the full address.\n*   **Join Columns**: `CDSCode` is a common and logical column to join school-related tables.\n\n```sql\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 1, "timestamp": 1768936899.293816}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 22.322304010391235, "spark_time": 0.24299836158752441, "translation_time": 22.07930564880371, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='30dc6906-c56a-44f3-8d1e-a27e551d6b59'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='b3050a1c-6467-432a-9ca4-04a8e017c519'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='3e6cc29b-8f7c-4d58-8cf5-c223236b68c5'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **`NOT IN` with `NULL` values**: Not used.\\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\\n*   **`BETWEEN` for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The subtraction of `Enrollment` columns and comparison with `30` is likely between numeric types, which is correct. Join conditions on `CDSCode` and `School Name` are between compatible types (likely string/integer and string respectively).\\n*   **Properly quoting identifiers**: Identifiers with spaces like `` `School Name` ``, `` `Enrollment (K-12)` ``, and `` `Enrollment (Ages 5-17)` `` are correctly quoted with backticks. Other identifiers without spaces are correctly used without backticks.\\n*   **Use `` ` `` for the in-query strings**: This point likely refers to identifiers that need quoting. String literals (e.g., `', '`) are correctly enclosed in single quotes, which is the standard for string literals in SQL. Identifiers are correctly quoted with backticks.\\n*   **Using the correct number of arguments for functions**: The `CONCAT` function is used with the correct number of arguments.\\n*   **Casting to the correct data type**: No explicit casts are needed, as implicit type handling seems appropriate for the operations performed.\\n*   **Using the proper columns for joins**: The join conditions `f.CDSCode = s.CDSCode` and `f.`School Name` = s.School` are appropriate for linking school records between the two tables.\\n\\n```sql\\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='a5d444bf-333b-491b-ba28-f879304d068b'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 5813, "output_tokens": 2665, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **`NOT IN` with `NULL` values**: Not used.\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\n*   **`BETWEEN` for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The subtraction of `Enrollment` columns and comparison with `30` is likely between numeric types, which is correct. Join conditions on `CDSCode` and `School Name` are between compatible types (likely string/integer and string respectively).\n*   **Properly quoting identifiers**: Identifiers with spaces like `` `School Name` ``, `` `Enrollment (K-12)` ``, and `` `Enrollment (Ages 5-17)` `` are correctly quoted with backticks. Other identifiers without spaces are correctly used without backticks.\n*   **Use `` ` `` for the in-query strings**: This point likely refers to identifiers that need quoting. String literals (e.g., `', '`) are correctly enclosed in single quotes, which is the standard for string literals in SQL. Identifiers are correctly quoted with backticks.\n*   **Using the correct number of arguments for functions**: The `CONCAT` function is used with the correct number of arguments.\n*   **Casting to the correct data type**: No explicit casts are needed, as implicit type handling seems appropriate for the operations performed.\n*   **Using the proper columns for joins**: The join conditions `f.CDSCode = s.CDSCode` and `f.`School Name` = s.School` are appropriate for linking school records between the two tables.\n\n```sql\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 2, "timestamp": 1768936922.6491163}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 22.277384042739868, "spark_time": 0.24231481552124023, "translation_time": 22.035069227218628, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='58e818d3-a78e-4af8-a35a-a43753daaf41'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='2e435bdd-7ab0-4909-a06c-60d50f0d1f1d'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='2dc8d877-310f-453f-9f7a-a99cdd29b5c8'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\\n\\nHere's a breakdown of the checks:\\n\\n1.  **Using NOT IN with NULL values**: Not present in the query.\\n2.  **Using UNION when UNION ALL should have been used**: Not present in the query.\\n3.  **Using BETWEEN for exclusive ranges**: Not present in the query.\\n4.  **Data type mismatch in predicates**:\\n    *   `f.`Enrollment (K-12)`` and `f.`Enrollment (Ages 5-17)`` are likely numeric, and their subtraction and comparison to `30` (an integer) is valid.\\n    *   `f.CDSCode = s.CDSCode` and `f.`School Name` = s.School` are standard join conditions, assuming `CDSCode` and `School Name`/`School` columns have compatible data types (e.g., string to string, integer to integer). This is generally safe.\\n5.  **Properly quoting identifiers**: Identifiers with spaces like `School Name`, `Enrollment (K-12)`, and `Enrollment (Ages 5-17)` are correctly quoted using backticks (`` ` ``), which is the standard for Spark SQL.\\n6.  **Use `` ` `` for the in-query strings**: This point usually refers to identifiers. String literals (like `', '` and `' '` in the `CONCAT` function) are correctly enclosed in single quotes (`'`), which is the standard SQL syntax for string literals. Backticks are for identifiers, not string literals. The query follows this correctly.\\n7.  **Using the correct number of arguments for functions**: The `CONCAT` function is used with the correct number of arguments to concatenate the street components and literal separators.\\n8.  **Casting to the correct data type**: No explicit casts are used, and none appear necessary given the operations. Spark SQL handles implicit type coercion for common operations.\\n9.  **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode AND f.`School Name` = s.School` uses two common and robust identifiers (`CDSCode` and `School Name`) to link the `frpm` and `schools` tables, ensuring accurate matching.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='738affdc-04fe-49cd-9e6f-03dc130f9671'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 5961, "output_tokens": 2654, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\n\nHere's a breakdown of the checks:\n\n1.  **Using NOT IN with NULL values**: Not present in the query.\n2.  **Using UNION when UNION ALL should have been used**: Not present in the query.\n3.  **Using BETWEEN for exclusive ranges**: Not present in the query.\n4.  **Data type mismatch in predicates**:\n    *   `f.`Enrollment (K-12)`` and `f.`Enrollment (Ages 5-17)`` are likely numeric, and their subtraction and comparison to `30` (an integer) is valid.\n    *   `f.CDSCode = s.CDSCode` and `f.`School Name` = s.School` are standard join conditions, assuming `CDSCode` and `School Name`/`School` columns have compatible data types (e.g., string to string, integer to integer). This is generally safe.\n5.  **Properly quoting identifiers**: Identifiers with spaces like `School Name`, `Enrollment (K-12)`, and `Enrollment (Ages 5-17)` are correctly quoted using backticks (`` ` ``), which is the standard for Spark SQL.\n6.  **Use `` ` `` for the in-query strings**: This point usually refers to identifiers. String literals (like `', '` and `' '` in the `CONCAT` function) are correctly enclosed in single quotes (`'`), which is the standard SQL syntax for string literals. Backticks are for identifiers, not string literals. The query follows this correctly.\n7.  **Using the correct number of arguments for functions**: The `CONCAT` function is used with the correct number of arguments to concatenate the street components and literal separators.\n8.  **Casting to the correct data type**: No explicit casts are used, and none appear necessary given the operations. Spark SQL handles implicit type coercion for common operations.\n9.  **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode AND f.`School Name` = s.School` uses two common and robust identifiers (`CDSCode` and `School Name`) to link the `frpm` and `schools` tables, ensuring accurate matching.\n\nThe query is correct as written.\n\n```sql\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 3, "timestamp": 1768936945.7555504}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["De Anza Senior High", "5000 Valley View Road, Richmond, CA 94803-2599"], ["Gompers (Samuel) Continuation", "831 Chanslor Avenue, Richmond, CA 94801-3533"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["California Virtual Academy High @ Maricopa", "50 Moreland Rd, Simi Valley, CA 93065-1800"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["District Office", "3699 North Holly Avenue, Baldwin Park, CA 91706-5397"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["Morningside High", "10500 South Yukon Avenue, Inglewood, CA 90303-2003"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Belmont SH-LA Teacher Preparatory Academy", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["RFK Community Schools- for the Visual Arts and Humanities", "701 South Catalina Street, Los Angeles, CA 90005-1943"], ["Alain Leroy Locke College Prep Academy", "325 East 111th Street, Los Angeles, CA 90061-3003"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["RFK Community Schools-UCLA Community K-12", "700 South Mariposa Avenue, Los Angeles, CA 90005-2001"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["Sylmar Senior High", "13050 Borden Avenue, Sylmar, CA 91342-4251"], ["William Howard Taft Charter High", "5461 Winnetka Avenue, Woodland Hills, CA 91364-2548"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Benjamin Banneker Special Education Center", "14024 South San Pedro Street, Los Angeles, CA 90061-2659"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Alphonso B. Perez Special Education Center", "4540 Michigan Avenue, Los Angeles, CA 90022-1130"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Vista High (Continuation)", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["Muir Charter", "12338 McCourtney Road, Grass Valley, CA 95949-9756"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Albert Schweitzer Elementary", "229 South Dale Avenue, Anaheim, CA 92804-2006"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Laurel Ruff Center", "5325 Garfield Avenue, Sacramento, CA 95841-3103"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["District Office", "1130 Fifth Avenue, Chula Vista, CA 91911-2812"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["District Office", "555 Franklin Street, San Francisco, CA 94102-5207"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School.", "555 Portola Drive, San Francisco, CA 94131-1616"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Mount Pleasant High", "1750 South White Road, San Jose, CA 95127-4760"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Athenour Elementary", "5200 Dent Ave, San Jose, CA 95118-2258"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 17.30550479888916, "spark_time": 0.22417330741882324, "translation_time": 17.081331491470337, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c6313c8f-ddf1-4f8c-8988-15f401ef9135'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a72fc287-8a62-487a-aab1-37e0460f49f1'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='ced3c447-464c-433a-a256-93eb86ef7d45'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers**: Backticks (`) are correctly used for identifiers containing spaces (e.g., ``School Name``, ``Enrollment (K-12)``). Simple identifiers (e.g., `Street`, `City`, `CDSCode`) do not require backticks, but using them would also be acceptable.\\n*   **String Literals**: Single quotes (`'`) are correctly used for string literals within the `CONCAT` function (e.g., `', '`, `' '`). Backticks are for identifiers, not string literals.\\n*   **Data Types**: The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` compares numeric values, which is appropriate. The join condition `f.CDSCode = s.CDSCode` assumes compatible data types for `CDSCode` in both tables, which is standard for join keys.\\n*   **Function Usage**: `CONCAT` is used with the correct number of arguments to form the full address.\\n*   **Join Columns**: `CDSCode` is a common and logical column to join school-related tables.\\n\\n```sql\\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='d003e6bd-c32e-4333-9747-301202c3f3ec'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 5688, "output_tokens": 1986, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers**: Backticks (`) are correctly used for identifiers containing spaces (e.g., ``School Name``, ``Enrollment (K-12)``). Simple identifiers (e.g., `Street`, `City`, `CDSCode`) do not require backticks, but using them would also be acceptable.\n*   **String Literals**: Single quotes (`'`) are correctly used for string literals within the `CONCAT` function (e.g., `', '`, `' '`). Backticks are for identifiers, not string literals.\n*   **Data Types**: The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` compares numeric values, which is appropriate. The join condition `f.CDSCode = s.CDSCode` assumes compatible data types for `CDSCode` in both tables, which is standard for join keys.\n*   **Function Usage**: `CONCAT` is used with the correct number of arguments to form the full address.\n*   **Join Columns**: `CDSCode` is a common and logical column to join school-related tables.\n\n```sql\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 4, "timestamp": 1768936964.0309088}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["De Anza Senior High", "5000 Valley View Road, Richmond, CA 94803-2599"], ["Gompers (Samuel) Continuation", "831 Chanslor Avenue, Richmond, CA 94801-3533"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["California Virtual Academy High @ Maricopa", "50 Moreland Rd, Simi Valley, CA 93065-1800"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["District Office", "3699 North Holly Avenue, Baldwin Park, CA 91706-5397"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["Morningside High", "10500 South Yukon Avenue, Inglewood, CA 90303-2003"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Belmont SH-LA Teacher Preparatory Academy", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["RFK Community Schools- for the Visual Arts and Humanities", "701 South Catalina Street, Los Angeles, CA 90005-1943"], ["Alain Leroy Locke College Prep Academy", "325 East 111th Street, Los Angeles, CA 90061-3003"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["RFK Community Schools-UCLA Community K-12", "700 South Mariposa Avenue, Los Angeles, CA 90005-2001"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["Sylmar Senior High", "13050 Borden Avenue, Sylmar, CA 91342-4251"], ["William Howard Taft Charter High", "5461 Winnetka Avenue, Woodland Hills, CA 91364-2548"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Benjamin Banneker Special Education Center", "14024 South San Pedro Street, Los Angeles, CA 90061-2659"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Alphonso B. Perez Special Education Center", "4540 Michigan Avenue, Los Angeles, CA 90022-1130"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Vista High (Continuation)", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["Muir Charter", "12338 McCourtney Road, Grass Valley, CA 95949-9756"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Albert Schweitzer Elementary", "229 South Dale Avenue, Anaheim, CA 92804-2006"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Laurel Ruff Center", "5325 Garfield Avenue, Sacramento, CA 95841-3103"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["District Office", "1130 Fifth Avenue, Chula Vista, CA 91911-2812"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["District Office", "555 Franklin Street, San Francisco, CA 94102-5207"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School.", "555 Portola Drive, San Francisco, CA 94131-1616"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Mount Pleasant High", "1750 South White Road, San Jose, CA 95127-4760"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Athenour Elementary", "5200 Dent Ave, San Jose, CA 95118-2258"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 14.511130332946777, "spark_time": 0.22403287887573242, "translation_time": 14.287097454071045, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='357bf718-fd72-4f50-abcf-45e040b7edc1'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='c34723ea-1cd4-4ad4-b7b2-6b4cd552a2f8'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='a6882664-cf96-4cda-b122-84897f7d8d58'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers**: Backticks (`) are correctly used for identifiers containing spaces (e.g., ``School Name``, ``Enrollment (K-12)``). Simple identifiers (e.g., `Street`, `City`, `CDSCode`) do not require backticks, but using them would also be acceptable.\\n*   **String Literals**: Single quotes (`'`) are correctly used for string literals within the `CONCAT` function (e.g., `', '`, `' '`). Backticks are for identifiers, not string literals.\\n*   **Data Types**: The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` compares numeric values, which is appropriate. The join condition `f.CDSCode = s.CDSCode` assumes compatible data types for `CDSCode` in both tables, which is standard for join keys.\\n*   **Function Usage**: `CONCAT` is used with the correct number of arguments to form the full address.\\n*   **Join Columns**: `CDSCode` is a common and logical column to join school-related tables.\\n\\n```sql\\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='87f82099-7fde-47d3-9d6e-833347c70cd1'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 5688, "output_tokens": 1986, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers**: Backticks (`) are correctly used for identifiers containing spaces (e.g., ``School Name``, ``Enrollment (K-12)``). Simple identifiers (e.g., `Street`, `City`, `CDSCode`) do not require backticks, but using them would also be acceptable.\n*   **String Literals**: Single quotes (`'`) are correctly used for string literals within the `CONCAT` function (e.g., `', '`, `' '`). Backticks are for identifiers, not string literals.\n*   **Data Types**: The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` compares numeric values, which is appropriate. The join condition `f.CDSCode = s.CDSCode` assumes compatible data types for `CDSCode` in both tables, which is standard for join keys.\n*   **Function Usage**: `CONCAT` is used with the correct number of arguments to form the full address.\n*   **Join Columns**: `CDSCode` is a common and logical column to join school-related tables.\n\n```sql\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 5, "timestamp": 1768936979.3875582}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["De Anza High", "5000 Valley View Road, Richmond, CA 94803-2599"], ["Greenwood Academy", "831 Chanslor Avenue, Richmond, CA 94801-3533"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["Insight School of California", "50 Moreland Rd, Simi Valley, CA 93065-1800"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["None", "3699 North Holly Avenue, Baldwin Park, CA 91706-5397"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["Morningside High School", "10500 South Yukon Avenue, Inglewood, CA 90303-2003"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Los Angeles Teacher Preparatory Academy", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["School for the Visual Arts and Humanities", "701 South Catalina Street, Los Angeles, CA 90005-1943"], ["Alain Leroy Locke College Preparatory Academy", "325 East 111th Street, Los Angeles, CA 90061-3003"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["UCLA Community K-12", "700 South Mariposa Avenue, Los Angeles, CA 90005-2001"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["Sylmar Charter High", "13050 Borden Avenue, Sylmar, CA 91342-4251"], ["Taft Charter High", "5461 Winnetka Avenue, Woodland Hills, CA 91364-2548"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Benjamin Banneker Career and Transition Center", "14024 South San Pedro Street, Los Angeles, CA 90061-2659"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Alfonso B. Perez Special Education Center", "4540 Michigan Avenue, Los Angeles, CA 90022-1130"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Vista High", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["John Muir Charter Schools", "12338 McCourtney Road, Grass Valley, CA 95949-9756"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Dr. Albert Schweitzer", "229 South Dale Avenue, Anaheim, CA 92804-2006"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Laurel Ruff Transition", "5325 Garfield Avenue, Sacramento, CA 95841-3103"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["None", "1130 Fifth Avenue, Chula Vista, CA 91911-2812"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["None", "555 Franklin Street, San Francisco, CA 94102-5207"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "555 Portola Drive, San Francisco, CA 94131-1616"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Mt. Pleasant High", "1750 South White Road, San Jose, CA 95127-4760"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Athenour Early Childhood Education Center", "5200 Dent Ave, San Jose, CA 95118-2258"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 20.965810537338257, "spark_time": 0.2515604496002197, "translation_time": 20.714250087738037, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a3504c3a-5ab9-4f81-8c42-05eca84c0e3f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='ec036b32-c79c-4724-a2b8-8fb3911fb3e9'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Quoting identifiers:** Column names with spaces (`Enrollment (K-12)`, `Enrollment (Ages 5-17)`) are correctly quoted using backticks (` `). Other standard column names and aliases do not require quoting.\\n*   **Data types:** The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` assumes these are numeric types, which is appropriate for enrollment figures. The comparison `> 30` is also valid for numeric types.\\n*   **Functions:** `CONCAT` is used correctly with the appropriate number of arguments and string literals are properly enclosed in single quotes.\\n*   **Joins:** The join condition `s.CDSCode = f.CDSCode` uses the correct columns for linking the two tables.\\n*   Other potential issues like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, and explicit casting are not present in this query.\\n\\nHere is the original query, as it is correct:\\n\\n```sql\\nSELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='dd4f5633-ab5a-4afc-a6e4-919b2c8586ef'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 4616, "output_tokens": 1926, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **Quoting identifiers:** Column names with spaces (`Enrollment (K-12)`, `Enrollment (Ages 5-17)`) are correctly quoted using backticks (` `). Other standard column names and aliases do not require quoting.\n*   **Data types:** The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` assumes these are numeric types, which is appropriate for enrollment figures. The comparison `> 30` is also valid for numeric types.\n*   **Functions:** `CONCAT` is used correctly with the appropriate number of arguments and string literals are properly enclosed in single quotes.\n*   **Joins:** The join condition `s.CDSCode = f.CDSCode` uses the correct columns for linking the two tables.\n*   Other potential issues like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, and explicit casting are not present in this query.\n\nHere is the original query, as it is correct:\n\n```sql\nSELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 6, "timestamp": 1768937001.3113694}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 16.663599014282227, "spark_time": 0.21747946739196777, "translation_time": 16.44611954689026, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='109463b4-c126-4a2f-836a-b4840b3a11fc'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='87d2c956-eacd-4ee2-9107-d8c95e7fc76a'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='6e1d5e08-935b-42ac-926e-7a112cc39069'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\\n\\nHere's a breakdown of the checks:\\n\\n1.  **Using NOT IN with NULL values**: Not present in the query.\\n2.  **Using UNION when UNION ALL should have been used**: Not present in the query.\\n3.  **Using BETWEEN for exclusive ranges**: Not present in the query.\\n4.  **Data type mismatch in predicates**:\\n    *   `f.`Enrollment (K-12)`` and `f.`Enrollment (Ages 5-17)`` are likely numeric, and their subtraction and comparison to `30` (an integer) is valid.\\n    *   `f.CDSCode = s.CDSCode` and `f.`School Name` = s.School` are standard join conditions, assuming `CDSCode` and `School Name`/`School` columns have compatible data types (e.g., string to string, integer to integer). This is generally safe.\\n5.  **Properly quoting identifiers**: Identifiers with spaces like `School Name`, `Enrollment (K-12)`, and `Enrollment (Ages 5-17)` are correctly quoted using backticks (`` ` ``), which is the standard for Spark SQL.\\n6.  **Use `` ` `` for the in-query strings**: This point usually refers to identifiers. String literals (like `', '` and `' '` in the `CONCAT` function) are correctly enclosed in single quotes (`'`), which is the standard SQL syntax for string literals. Backticks are for identifiers, not string literals. The query follows this correctly.\\n7.  **Using the correct number of arguments for functions**: The `CONCAT` function is used with the correct number of arguments to concatenate the street components and literal separators.\\n8.  **Casting to the correct data type**: No explicit casts are used, and none appear necessary given the operations. Spark SQL handles implicit type coercion for common operations.\\n9.  **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode AND f.`School Name` = s.School` uses two common and robust identifiers (`CDSCode` and `School Name`) to link the `frpm` and `schools` tables, ensuring accurate matching.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='470945ac-805f-4033-b8ea-639897c27859'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 5961, "output_tokens": 2655, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\n\nHere's a breakdown of the checks:\n\n1.  **Using NOT IN with NULL values**: Not present in the query.\n2.  **Using UNION when UNION ALL should have been used**: Not present in the query.\n3.  **Using BETWEEN for exclusive ranges**: Not present in the query.\n4.  **Data type mismatch in predicates**:\n    *   `f.`Enrollment (K-12)`` and `f.`Enrollment (Ages 5-17)`` are likely numeric, and their subtraction and comparison to `30` (an integer) is valid.\n    *   `f.CDSCode = s.CDSCode` and `f.`School Name` = s.School` are standard join conditions, assuming `CDSCode` and `School Name`/`School` columns have compatible data types (e.g., string to string, integer to integer). This is generally safe.\n5.  **Properly quoting identifiers**: Identifiers with spaces like `School Name`, `Enrollment (K-12)`, and `Enrollment (Ages 5-17)` are correctly quoted using backticks (`` ` ``), which is the standard for Spark SQL.\n6.  **Use `` ` `` for the in-query strings**: This point usually refers to identifiers. String literals (like `', '` and `' '` in the `CONCAT` function) are correctly enclosed in single quotes (`'`), which is the standard SQL syntax for string literals. Backticks are for identifiers, not string literals. The query follows this correctly.\n7.  **Using the correct number of arguments for functions**: The `CONCAT` function is used with the correct number of arguments to concatenate the street components and literal separators.\n8.  **Casting to the correct data type**: No explicit casts are used, and none appear necessary given the operations. Spark SQL handles implicit type coercion for common operations.\n9.  **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode AND f.`School Name` = s.School` uses two common and robust identifiers (`CDSCode` and `School Name`) to link the `frpm` and `schools` tables, ensuring accurate matching.\n\nThe query is correct as written.\n\n```sql\nSELECT f.`School Name`, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 7, "timestamp": 1768937019.1130507}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["De Anza High", "5000 Valley View Road, Richmond, CA 94803-2599"], ["Greenwood Academy", "831 Chanslor Avenue, Richmond, CA 94801-3533"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["Insight School of California", "50 Moreland Rd, Simi Valley, CA 93065-1800"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["None", "3699 North Holly Avenue, Baldwin Park, CA 91706-5397"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["Morningside High School", "10500 South Yukon Avenue, Inglewood, CA 90303-2003"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Los Angeles Teacher Preparatory Academy", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["School for the Visual Arts and Humanities", "701 South Catalina Street, Los Angeles, CA 90005-1943"], ["Alain Leroy Locke College Preparatory Academy", "325 East 111th Street, Los Angeles, CA 90061-3003"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["UCLA Community K-12", "700 South Mariposa Avenue, Los Angeles, CA 90005-2001"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["Sylmar Charter High", "13050 Borden Avenue, Sylmar, CA 91342-4251"], ["Taft Charter High", "5461 Winnetka Avenue, Woodland Hills, CA 91364-2548"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Benjamin Banneker Career and Transition Center", "14024 South San Pedro Street, Los Angeles, CA 90061-2659"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Alfonso B. Perez Special Education Center", "4540 Michigan Avenue, Los Angeles, CA 90022-1130"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Vista High", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["John Muir Charter Schools", "12338 McCourtney Road, Grass Valley, CA 95949-9756"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Dr. Albert Schweitzer", "229 South Dale Avenue, Anaheim, CA 92804-2006"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Laurel Ruff Transition", "5325 Garfield Avenue, Sacramento, CA 95841-3103"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["None", "1130 Fifth Avenue, Chula Vista, CA 91911-2812"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["None", "555 Franklin Street, San Francisco, CA 94102-5207"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "555 Portola Drive, San Francisco, CA 94131-1616"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Mt. Pleasant High", "1750 South White Road, San Jose, CA 95127-4760"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Athenour Early Childhood Education Center", "5200 Dent Ave, San Jose, CA 95118-2258"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 14.596375703811646, "spark_time": 0.37999463081359863, "translation_time": 14.216381072998047, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c8c2cc6c-45a1-4de8-b200-2f0b5c3000cf'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='d6985039-22b8-44e1-8951-4d43545eb0c0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The query appears to be correct and follows Spark SQL conventions.\\n\\n*   Identifiers with spaces (`Enrollment (K-12)`, `Enrollment (Ages 5-17)`) are correctly quoted using backticks (` `).\\n*   String literals within `CONCAT` (`', '`, `' '`) are correctly enclosed in single quotes (`'`).\\n*   The `CONCAT` function is used with the correct number of arguments.\\n*   The join condition `s.CDSCode = f.CDSCode` uses appropriate columns.\\n*   The predicate `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30` involves numeric operations and comparison, which is generally fine assuming the enrollment columns are numeric types.\\n*   There are no instances of `NOT IN` with NULLs, `UNION` vs `UNION ALL` issues, or `BETWEEN` for exclusive ranges.\\n*   No explicit casting is used, and none seems immediately necessary.\\n\\n```sql\\nSELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='fbb60695-59a6-4351-b9d9-8f133a73a292'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 4581, "output_tokens": 2052, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The query appears to be correct and follows Spark SQL conventions.\n\n*   Identifiers with spaces (`Enrollment (K-12)`, `Enrollment (Ages 5-17)`) are correctly quoted using backticks (` `).\n*   String literals within `CONCAT` (`', '`, `' '`) are correctly enclosed in single quotes (`'`).\n*   The `CONCAT` function is used with the correct number of arguments.\n*   The join condition `s.CDSCode = f.CDSCode` uses appropriate columns.\n*   The predicate `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30` involves numeric operations and comparison, which is generally fine assuming the enrollment columns are numeric types.\n*   There are no instances of `NOT IN` with NULLs, `UNION` vs `UNION ALL` issues, or `BETWEEN` for exclusive ranges.\n*   No explicit casting is used, and none seems immediately necessary.\n\n```sql\nSELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 8, "timestamp": 1768937035.2324736}
{"query_id": 23, "provider": "google", "db": "california_schools", "nl_query": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "gold_spark": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30", "execution_status": "VALID", "query_result": [["Alameda County Community", "313 West Winton Avenue, Hayward, CA 94544-1136"], ["California School for the Deaf-Fremont", "39350 Gallaudet Drive, Fremont, CA 94538-2308"], ["Alameda High", "2201 Encinal Avenue, Alameda, CA 94501-4406"], ["Encinal High", "210 Central Avenue, Alameda, CA 94501-3278"], ["Island High (Continuation)", "1900 Third Street, Alameda, CA 94501-1851"], ["Albany High", "603 Key Route Boulevard, Albany, CA 94706-1422"], ["Ocean View Elementary", "1000 Jackson Street, Albany, CA 94706-1904"], ["Berkeley High", "1980 Allston Way, Berkeley, CA 94704-1463"], ["Castro Valley High", "19400 Santa Maria Avenue, Castro Valley, CA 94546-3400"], ["Independent Elementary", "21201 Independent School Road, Castro Valley, CA 94552-4826"], ["American High", "36300 Fremont Boulevard, Fremont, CA 94536-3511"], ["Robertson High (Continuation)", "4455 Seneca Park Avenue, Fremont, CA 94538-4028"], ["Irvington High", "41800 Blacow Road, Fremont, CA 94538-3353"], ["John F. Kennedy High", "39999 Blacow Road, Fremont, CA 94538-1913"], ["Washington High", "38442 Fremont Boulevard, Fremont, CA 94536-6031"], ["Brier Elementary", "39201 Sundale Drive, Fremont, CA 94538-1916"], ["J. Haley Durham Elementary", "40292 Leslie Street, Fremont, CA 94538-3520"], ["Parkmont Elementary", "2601 Parkside Drive, Fremont, CA 94536-5246"], ["Brookvale Elementary", "3400 Nicolet Avenue, Fremont, CA 94536-3598"], ["Fred E. Weibel Elementary", "45135 South Grimmer Boulevard, Fremont, CA 94539-6631"], ["Brenkwitz High", "22100 Princeton Street, Hayward, CA 94541-3817"], ["Hayward High", "1633 East Avenue, Hayward, CA 94541-5314"], ["Mt. Eden High", "2300 Panama Street, Hayward, CA 94545-4662"], ["Tennyson High", "27035 Whitman Road, Hayward, CA 94544-4099"], ["Del Valle Continuation High", "2253 Fifth Street, Livermore, CA 94550-4549"], ["Granada High", "400 Wall Street, Livermore, CA 94550-4066"], ["Livermore High", "600 Maple Street, Livermore, CA 94550-3298"], ["Newark Memorial High", "39375 Cedar Boulevard, Newark, CA 94560-5007"], ["Core Learning Academy at Conley-Caraballo High", "541 Blanche Street, Hayward, CA 94544-7700"], ["James Logan High", "1800 H Street, Union City, CA 94587-3321"], ["Civicorps Corpsmember Academy", "101 Myrtle Street, Oakland, CA 94607-2507"], ["Oakland International High", "4521 Webster Street, Oakland, CA 94609-2140"], ["Ralph J. Bunche High", "1240 18th Street, Oakland, CA 94607-2223"], ["Gateway to College at Laney College", "900 Fallon Street, Oakland, CA 94607-4808"], ["Castlemont High", "8601 MacArthur Boulevard, Oakland, CA 94605-4037"], ["Fremont High", "4610 Foothill Boulevard, Oakland, CA 94601-4618"], ["Rudsdale Continuation", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Dewey Academy", "1111 2nd Avenue, Oakland, CA 94606-2285"], ["Oakland High", "1023 MacArthur Boulevard, Oakland, CA 94610-3930"], ["Oakland Technical High", "4351 Broadway, Oakland, CA 94611-4612"], ["Skyline High", "12250 Skyline Boulevard, Oakland, CA 94619-2425"], ["Independent Study, Sojourner Truth", "8251 Fontaine Street, Oakland, CA 94605-4109"], ["Piedmont High", "800 Magnolia Avenue, Piedmont, CA 94611-4029"], ["San Leandro High", "2200 Bancroft Avenue, San Leandro, CA 94577-6108"], ["Arroyo High", "15701 Lorenzo Avenue, San Lorenzo, CA 94580-1407"], ["San Lorenzo High", "50 East Lewelling Boulevard, San Lorenzo, CA 94580-1732"], ["Dublin High", "8151 Village Parkway, Dublin, CA 94568-1656"], ["James Dougherty Elementary", "5301 Hibernia Drive, Dublin, CA 94568-3164"], ["Foothill High", "4375 Foothill Road, Pleasanton, CA 94588-9799"], ["Amador Valley High", "1155 Santa Rita Road, Pleasanton, CA 94566-6176"], ["Butte County Special Education", "1859 Bird Street, Oroville, CA 95965-4854"], ["Fair View High (Continuation)", "290 East Avenue, Chico, CA 95926-1122"], ["Chico High", "901 Esplanade, Chico, CA 95926-3908"], ["Pleasant Valley High", "1475 East Avenue, Chico, CA 95926-1699"], ["Las Plumas High", "2380 Las Plumas Avenue, Oroville, CA 95966-7305"], ["Oroville High", "1535 Bridge Street, Oroville, CA 95966-5060"], ["Paradise Senior High", "5911 Maxwell Dr, Paradise, CA 95969-4023"], ["Calaveras High", "350 High School Street, San Andreas, CA 95249-0607"], ["Far East County Programs", "850 Second Street, Brentwood, CA 94513-1132"], ["Clayton Valley Charter High", "1101 Alberta Way, Concord, CA 94521-3799"], ["Acalanes High", "1200 Pleasant Hill Road, Lafayette, CA 94549-2623"], ["Campolindo High", "300 Moraga Road, Moraga, CA 94556-2402"], ["Las Lomas High", "1460 South Main Street, Walnut Creek, CA 94596-5319"], ["Carmen Dragon Elementary", "4721 Vista Grande Drive, Antioch, CA 94531-8619"], ["Bidwell Continuation High", "800 Gary Avenue, Antioch, CA 94509-2763"], ["Prospects High (Alternative)", "820 West Second Street, Antioch, CA 94509-1145"], ["Deer Valley High", "4700 Lone Tree Way, Antioch, CA 94531-8486"], ["Antioch High", "700 West 18th Street, Antioch, CA 94509-1576"], ["Sutter Elementary", "3410 Longview Road, Antioch, CA 94509-6006"], ["Turner Elementary", "4207 Delta Fair Boulevard, Antioch, CA 94509-3944"], ["Heritage High", "101 American Avenue, Brentwood, CA 94513-4604"], ["Freedom High", "1050 Neroly Road, Oakley, CA 94561-3843"], ["Independence High", "929 Second Street, Brentwood, CA 94513-1137"], ["Liberty High", "850 Second Street, Brentwood, CA 94513-1132"], ["La Paloma High (Continuation)", "400 Ghiggeri Way, Brentwood, CA 94513-5314"], ["Alhambra Senior High", "150 E Street, Martinez, CA 94553-3139"], ["Northgate High", "425 Castle Rock Road, Walnut Creek, CA 94598-4599"], ["College Park High", "201 Viking Drive, Pleasant Hill, CA 94523-1809"], ["Concord High", "4200 Concord Boulevard, Concord, CA 94521-1059"], ["Mt. Diablo High", "2455 Grant Street, Concord, CA 94520-2252"], ["Olympic Continuation High", "2730 Salvio Street, Concord, CA 94519-2599"], ["Ygnacio Valley High", "755 Oak Grove Road, Concord, CA 94518-2899"], ["Black Diamond High (Continuation)", "1131 Stoneman Avenue, Pittsburg, CA 94565-5466"], ["Pittsburg Senior High", "1750 Harbor Street, Pittsburg, CA 94565-4615"], ["Vista High (Alternative)", "2625 Barnard Road, San Pablo, CA 94806-2703"], ["De Anza High", "5000 Valley View Road, Richmond, CA 94803-2599"], ["Greenwood Academy", "831 Chanslor Avenue, Richmond, CA 94801-3533"], ["Pinole Valley High", "2900 Pinole Valley Road, Pinole, CA 94564-1499"], ["Richmond High", "1250 23rd Street, Richmond, CA 94804-1091"], ["Dougherty Valley High", "10550 Albion Road, San Ramon, CA 94582-2901"], ["California High", "9870 Broadmoor Drive, San Ramon, CA 94583-2942"], ["Monte Vista High", "3131 Stone Valley Road, Danville, CA 94526-1129"], ["San Ramon Valley High", "501 Danville Boulevard, Danville, CA 94526-2404"], ["Walt Disney Elementary", "3250 Pine Valley Road, San Ramon, CA 94583-3651"], ["Golden View Elementary", "5025 Canyon Crest Drive, San Ramon, CA 94582-4848"], ["Coyote Creek Elementary", "8700 North Gale Ridge Road, San Ramon, CA 94582-5081"], ["Castle Rock", "1260 Glenn Street, Crescent City, CA 95531-2113"], ["Del Norte High", "1301 El Dorado Street, Crescent City, CA 95531-2110"], ["Special Education", "6767 Green Valley Road, Placerville, CA 95667-8984"], ["Oak Ridge High", "1120 Harvard Way, El Dorado Hills, CA 95762-4324"], ["Union Mine High", "6530 Koki Lane, El Dorado, CA 95623-4328"], ["El Dorado High", "561 Canal Street, Placerville, CA 95667-4312"], ["Ponderosa High", "3661 Ponderosa Road, Shingle Springs, CA 95682-9435"], ["Tahoe Valley Elementary", "943 Tahoe Island Drive, South Lake Tahoe, CA 96150-4200"], ["Crescent View West Charter", "1901 East Shields Avenue, Suite 130, Fresno, CA 93726-5309"], ["Fresno County Special Education Local Plan", "1111 Van Ness Avenue, Fresno, CA 93721-2002"], ["Clovis North High", "2770 East International Avenue, Fresno, CA 93730-5400"], ["Clovis West High", "1070 East Teague Avenue, Fresno, CA 93720-1899"], ["Buchanan High", "1560 North Minnewawa Avenue, Clovis, CA 93611-7698"], ["Clovis East High", "2940 Leonard Avenue, Clovis, CA 93611-8474"], ["Gateway High (Continuation)", "1550 Herndon Avenue, Clovis, CA 93611-0598"], ["Clovis High", "1055 Fowler Avenue, Clovis, CA 93611-2062"], ["Coalinga High", "750 Van Ness Avenue, Coalinga, CA 93210-1541"], ["Sierra Charter", "1931 North Fine Avenue, Fresno, CA 93727-1510"], ["Bullard High", "5445 North Palm Avenue, Fresno, CA 93704-1941"], ["J. E. Young Academic Center", "822 North Abby Street, Fresno, CA 93701-1002"], ["Cambridge Continuation High", "1001 South Chestnut, Fresno, CA 93727-3907"], ["School of Unlimited Learning", "2336 Calaveras Street, Fresno, CA 93721-1104"], ["Sunnyside High", "1019 South Peach Avenue, Fresno, CA 93727-4889"], ["Carter G. Woodson Public Charter", "3333 North Bond Avenue, Fresno, CA 93726-5712"], ["Dewolf Continuation High", "2445 W Dakota, Fresno, CA 93703-2124"], ["Edison High", "540 East California Avenue, Fresno, CA 93706-3736"], ["Fresno High", "1839 Echo Avenue, Fresno, CA 93704-6047"], ["Herbert Hoover High", "5550 North First Street, Fresno, CA 93710-6201"], ["McLane High", "2727 North Cedar Avenue, Fresno, CA 93703-2016"], ["Roosevelt High", "4250 East Tulare Street, Fresno, CA 93702-3037"], ["Washington Elementary", "1501 Ellis Street, Kingsburg, CA 93631-1826"], ["Kingsburg High", "1900 18th Avenue, Kingsburg, CA 93631-1629"], ["Mountain View (Alternative)", "877 E. North Avenue, Reedley, CA 93654-2426"], ["Reedley High", "740 West North Avenue, Reedley, CA 93654-2418"], ["Ambassador Phillip V. Sanchez Public Charter", "5659 East Kings Canyon Road, Suite 101, Fresno, CA 93727-4641"], ["Sanger High", "1045 Bethel Avenue, Sanger, CA 93657-2985"], ["Selma High", "3125 Wright Street, Selma, CA 93662-2429"], ["Eric White Elementary", "2001 Mitchell, Selma, CA 93662-9601"], ["West Park Charter Academy", "2695 South Valentine Avenue, Fresno, CA 93706-9042"], ["Crescent View South Charter", "1901 East Shields Avenue, Suite 169, Fresno, CA 93726-5318"], ["Central Unified Alternative/Opportunity", "2698 North Brawley, Fresno, CA 93722-5113"], ["Central High East Campus", "3535 North Cornelia Avenue, Fresno, CA 93722-7020"], ["Kerman High", "205 South First Street, Kerman, CA 93630-1001"], ["Mendota High", "1200 Belmont Avenue, Mendota, CA 93640"], ["Elm High", "5865 South Clara Avenue, Fresno, CA 93706-5805"], ["W. E. B. DuBois Public Charter", "2604 Martin Luther King Boulevard, Fresno, CA 93706"], ["Washington High", "6041 South Elm Avenue, Fresno, CA 93706-6018"], ["Mattole Valley Charter (#159)", "210 Lindley Road, Petrolia, CA 95558-9534"], ["Eureka Senior High", "1915 J Street, Eureka, CA 95501-3052"], ["Imperial County Special Education", "1398 Sperber Road, El Centro, CA 92243-9621"], ["Desert Valley High (Continuation)", "104 West Magnolia Street, Brawley, CA 92227-1583"], ["Brawley High", "480 North Imperial Avenue, Brawley, CA 92227-1625"], ["Aurora High (Continuation)", "641 Rockwood Avenue, Calexico, CA 92231-2700"], ["Calexico High", "1030 Encinas Avenue, Calexico, CA 92231-2560"], ["Southwest High", "2001 Ocotillo Drive, El Centro, CA 92243-9451"], ["Central Union High", "1001 Brighton Avenue, El Centro, CA 92243-3110"], ["Desert Oasis High (Continuation)", "1302 South Third Street, El Centro, CA 92243-6604"], ["Imperial High", "517 West Barioni Boulevard, Imperial, CA 92251-1452"], ["YouthBuild Charter School of California", "155 West Washington Boulevard, Suite 517, Los Angeles, CA 90015-3582"], ["The Education Corps", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["College Bridge Academy", "2824 South Main Street, Los Angeles, CA 90007-3334"], ["Kern County Juvenile Court", "1300 17th Street, Bakersfield, CA 93301-4533"], ["Kern County Community", "1300 17th Street City Centre, Bakersfield, CA 93301"], ["Roy W. Loudon Elementary", "4000 Loudon Street, Bakersfield, CA 93313-3573"], ["Cesar E. Chavez High", "800 Browning Road, Delano, CA 93215-9494"], ["Delano High", "1331 Cecil Avenue, Delano, CA 93215-1410"], ["Raffaello Palla Elementary", "800 Fairview Road, Bakersfield, CA 93307-5524"], ["Golden Valley High", "801 Hosking Avenue, Bakersfield, CA 93307-5818"], ["Frontier High", "6401 Allen Road, Bakersfield, CA 93314-9250"], ["Independence High", "8001 Old River Road, Bakersfield, CA 93311-9752"], ["Mira Monte High", "1800 South Fairfax Road, Bakersfield, CA 93307-8520"], ["Tierra Del Sol Continuation High", "3700 East Belle Terrace, Bakersfield, CA 93307-6832"], ["Vista West Continuation High", "7115 Rosedale Highway, Bakersfield, CA 93308-5845"], ["Arvin High", "900 Varsity Road, Arvin, CA 93203-2421"], ["Stockdale High", "2800 Buena Vista Road, Bakersfield, CA 93311-9791"], ["Centennial High", "8601 Hageman Road, Bakersfield, CA 93312-3957"], ["Ridgeview High", "8501 Stine Road, Bakersfield, CA 93313-9782"], ["Kern Workforce 2000 Academy", "5801 Sundale Avenue, Bakersfield, CA 93309-2924"], ["Liberty High", "925 Jewetta Avenue, Bakersfield, CA 93312-4683"], ["Bakersfield High", "1241 G Street, Bakersfield, CA 93301-5173"], ["East Bakersfield High", "2200 Quincy Street, Bakersfield, CA 93306-4036"], ["Foothill High", "501 Park Drive, Bakersfield, CA 93306-6017"], ["Highland High", "2900 Royal Scots Way, Bakersfield, CA 93306-2819"], ["North High", "300 Galaxy Avenue, Bakersfield, CA 93308-1722"], ["Shafter High", "526 Mannel Avenue, Shafter, CA 93263-1810"], ["South High", "1101 Planz Road, Bakersfield, CA 93304-6150"], ["Vista Continuation High", "200 P Street, Bakersfield, CA 93304-3051"], ["West High", "1200 New Stine Road, Bakersfield, CA 93309-3534"], ["Insight School of California", "50 Moreland Rd, Simi Valley, CA 93065-1800"], ["California City High", "8567 Raven Way, California City, CA 93505-1971"], ["Del Rio Elementary", "600 Hidalgo Drive, Bakersfield, CA 93314-3759"], ["Rosamond High", "2925 Rosamond Boulevard, Rosamond, CA 93560-0640"], ["Parkview Elementary", "520 A Street, Taft, CA 93268-3734"], ["Taft Union High", "701 Wildcat Way, Taft, CA 93268-2319"], ["Monroe High (Continuation)", "126 South Snyder Street, Tehachapi, CA 93561-1513"], ["Tehachapi High", "801 South Dennison Road, Tehachapi, CA 93561-1524"], ["Palm Avenue Elementary", "1017 Palm Avenue, Wasco, CA 93280-2112"], ["Wasco High", "1900 Seventh Street, Wasco, CA 93280-0250"], ["Burroughs High", "500 East French Street, Ridgecrest, CA 93555-3832"], ["Kings County Special Education", "959 Katie Hammond Lane, Hanford, CA 93230-4334"], ["National University Academy, Armona", "2030 University Drive, Vista, CA 92083-7736"], ["R. J. Neutra", "Community Center Drive, N.A.S. Lemoore, CA 93245-0001"], ["Sierra Pacific High", "1259 North 13th Avenue, Hanford, CA 93230-9219"], ["Hanford West High", "1150 West Lacey Boulevard, Hanford, CA 93230-3575"], ["Earl F. Johnson High (Continuation)", "1201 North Douty, Hanford, CA 93230-2156"], ["Hanford High", "120 East Grangeville Boulevard, Hanford, CA 93230-3067"], ["Lemoore High", "101 East Bush Street, Lemoore, CA 93245-3601"], ["Avenal High", "601 Mariposa Street, Avenal, CA 93204-1413"], ["Lower Lake High", "9430 A Lake Street, Lower Lake, CA 95457-0799"], ["Alternative Opportunity Programs", "12830 Columbia Way, Downey, CA 90242-4720"], ["Soledad Enrichment Action Charter High", "222 North Virgil Avenue, Los Angeles, CA 90004-3622"], ["Cerritos High", "12500 East 183rd Street, Cerritos, CA 90703-8450"], ["Artesia High", "12108 East Del Amo Boulevard, Lakewood, CA 90715-1516"], ["Tracy (Wilbur) High (Continuation)", "12222 Cuesta Drive, Cerritos, CA 90703-2801"], ["Gahr (Richard) High", "11111 Artesia Boulevard, Cerritos, CA 90703-2533"], ["ABC Secondary (Alternative)", "16534 South Carmenita Road, Cerritos, CA 90703-2301"], ["William J. (Pete) Knight High", "37423 70th Street East, Palmdale, CA 93552-4800"], ["Eastside High", "3200 East Avenue J-8, Lancaster, CA 93535-5827"], ["Los Angeles County Online High", "2600 Foothill Boulevard, #301, La Crescenta, CA 91214-3588"], ["Antelope Valley High", "44900 North Division Street, Lancaster, CA 93535-2538"], ["Desert Winds Continuation High", "415 East Kettering Street, Lancaster, CA 93535-2503"], ["Palmdale High", "2137 East Avenue R, Palmdale, CA 93550-5415"], ["Quartz Hill High", "6040 West Avenue L, Quartz Hill, CA 93536-4501"], ["Highland High", "39055 25th Street West, Palmdale, CA 93551-4164"], ["Littlerock High", "10833 East Avenue R, Littlerock, CA 93543-4106"], ["Lancaster High", "44701 32nd Street West, Lancaster, CA 93536-7023"], ["Desert Sands Charter", "44130 20th Street West, Lancaster, CA 93534-4045"], ["R. Rex Parris High", "38801 Clock Tower Plaza Drive, Palmdale, CA 93550-3346"], ["Arcadia High", "180 Campus Drive, Arcadia, CA 91007-6958"], ["Azusa High", "240 North Cerritos Avenue, Azusa, CA 91702-3733"], ["None", "3699 North Holly Avenue, Baldwin Park, CA 91706-5397"], ["Opportunities For Learning - Baldwin Park II", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Baldwin Park High", "3900 North Puente Avenue, Baldwin Park, CA 91706-4428"], ["Opportunities for Learning - Baldwin Park", "320 North Halstead Street Suite 220, Pasadena, CA 91107-3147"], ["Bassett Senior High", "755 Ardilla Avenue, La Puente, CA 91746-2163"], ["Bellflower High", "15301 South McNab Avenue, Bellflower, CA 90706-4101"], ["Mayfair High", "6000 North Woodruff Avenue, Lakewood, CA 90713-1124"], ["Somerset Continuation High", "9242 East Laurel Street, Bellflower, CA 90706-7607"], ["Beverly Hills High", "241 Moreno Drive, Beverly Hills, CA 90212-3639"], ["Bonita High", "3102 D Street, La Verne, CA 91750-4023"], ["Burbank High", "902 North Third Street, Burbank, CA 91502-1018"], ["Burroughs High", "1920 Clark Avenue, Burbank, CA 91506-1918"], ["Options for Youth-Burbank Charter", "1610 West Burbank Boulevard, Burbank, CA 91506-1311"], ["Centinela Valley Independent Study", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Family First Charter", "4953 Marine Avenue, Lawndale, CA 90260-1250"], ["New Opportunities Charter", "110 South La Brea Avenue Suite 305A, Inglewood, CA 90301-1768"], ["R. K. Lloyde High", "14901 Inglewood Avenue, Lawndale, CA 90260-1251"], ["Hawthorne High", "4859 West El Segundo Boulevard, Hawthorne, CA 90250-4204"], ["Lawndale High", "14901 South Inglewood Avenue, Lawndale, CA 90260-1251"], ["Leuzinger High", "4118 West Rosecrans Avenue, Lawndale, CA 90260-1601"], ["Charter Oak High", "1430 East Covina Boulevard, Covina, CA 91724-1651"], ["Claremont High", "1601 North Indian Hill Boulevard, Claremont, CA 91711-2643"], ["South Hills High", "645 South Barranca Street, West Covina, CA 91723-0269"], ["Columbus Continuation", "12330 Woodruff Avenue, Downey, CA 90241-5610"], ["Downey High", "11040 Brookshire Avenue, Downey, CA 90241-3816"], ["Warren High", "8141 De Palma Street, Downey, CA 90241-5102"], ["Alameda Elementary", "8613 East Alameda Street, Downey, CA 90242-2620"], ["Opportunities for Learning - Duarte", "1008 Huntington Drive, Duarte, CA 91010-2449"], ["Orchard Dale Elementary", "10625 South Cole Road, Whittier, CA 90604-1539"], ["Arroyo High", "4921 North Cedar Avenue, El Monte, CA 91732-1099"], ["El Monte High", "3048 North Tyler Avenue, El Monte, CA 91731-3365"], ["Mountain View High", "2900 Parkway Drive, El Monte, CA 91732-3695"], ["Rosemead High", "9063 East Mission Drive, Rosemead, CA 91770-4411"], ["Fernando R. Ledesma Continuation High", "12347 Ramona Boulevard, El Monte, CA 91732-2569"], ["Ruben Salazar Continuation", "9115 Balfour Street, Pico Rivera, CA 90660-3225"], ["El Rancho High", "6501 South Passons Boulevard, Pico Rivera, CA 90660-3373"], ["El Segundo High", "640 Main Street, El Segundo, CA 90245-3057"], ["Crescenta Valley High", "2900 Community Avenue, La Crescenta, CA 91214-3471"], ["Daily (Allan F.) High (Continuation)", "220 North Kenwood, Glendale, CA 91206-4209"], ["Glendale High", "1440 East Broadway, Glendale, CA 91205-1503"], ["Columbus Elementary", "425 West Milford Street, Glendale, CA 91203-1708"], ["College View", "440 West Lomita Avenue, Glendale, CA 91204-1512"], ["Glendora High", "1600 East Foothill Boulevard, Glendora, CA 91741-3024"], ["Gorman Learning Center", "1826 Orange Tree Lane, Redlands, CA 92374-2821"], ["Inglewood High", "231 South Grevillea Avenue, Inglewood, CA 90301-2323"], ["Morningside High School", "10500 South Yukon Avenue, Inglewood, CA 90303-2003"], ["La Canada High", "4463 Oak Grove Drive, La Canada, CA 91011-3738"], ["Agoura High", "28545 West Driver Avenue, Agoura, CA 91301-3335"], ["Calabasas High", "22855 West Mulholland Highway, Calabasas, CA 91302-2047"], ["Moffett Elementary", "11050 Larch Avenue, Lennox, CA 90304-1419"], ["Jordan High", "6500 Atlantic Avenue, Long Beach, CA 90805-2304"], ["Lakewood High", "4400 Briercrest Avenue, Lakewood, CA 90713-2512"], ["Millikan High", "2800 Snowden Avenue, Long Beach, CA 90815-1436"], ["Polytechnic High", "1600 Atlantic Avenue, Long Beach, CA 90813-2017"], ["Reid High", "2153 West Hill Street, Long Beach, CA 90810-3400"], ["Wilson High", "4400 East Tenth Street, Long Beach, CA 90804-4310"], ["Educational Partnership High", "1794 Cedar Avenue, Long Beach, CA 90813-1770"], ["Cabrillo High", "2001 Santa Fe Avenue, Long Beach, CA 90810-4068"], ["Bobbie Smith Elementary", "565 East Hill Street, Long Beach, CA 90806-4457"], ["Richard A. Alonzo Community Day", "5755 Fountain Avenue, Los Angeles, CA 90028-8531"], ["Olympic Primary Center", "950 South Albany Street, Los Angeles, CA 90015-1212"], ["Martha Escutia Primary Center", "6401 Bear Avenue, Bell, CA 90201-2301"], ["Danny J. Bakewell, Sr., Primary Center", "8621 South Baring Cross Street, Los Angeles, CA 90044-4801"], ["Hooper Avenue Primary Center", "1280 East 52nd Street, Los Angeles, CA 90011-4704"], ["Pacific Boulevard", "2660 East 57th Street, Huntington Park, CA 90255-2545"], ["Santee Education Complex", "1921 South Maple Avenue, Los Angeles, CA 90011-1036"], ["South East High", "2720 Tweedy Boulevard, South Gate, CA 90280-5539"], ["Maywood Academy High", "6125 Pine Avenue, Maywood, CA 90270-3110"], ["Cal Burke High", "14630 Lanark Street, Panorama City, CA 91402-4917"], ["Frida Kahlo High", "1924 South Los Angeles Street, Los Angeles, CA 90011-1031"], ["Frank del Olmo Elementary", "100 North New Hampshire Avenue, Los Angeles, CA 90004-4707"], ["East Valley Senior High", "5525 Vineland Avenue, North Hollywood, CA 91601-2730"], ["Arleta High", "14200 Van Nuys Boulevard, Arleta, CA 91331-5103"], ["Panorama High", "8015 Van Nuys Boulevard, Panorama City, CA 91402-6009"], ["Bright Star Secondary Charter Academy", "5431 West 98th Street, Los Angeles, CA 90045-5715"], ["West Adams Preparatory High", "1500 West Washington Boulevard, Los Angeles, CA 90007-1257"], ["Edward R. Roybal Learning Center", "1200 West Colton Street, Los Angeles, CA 90026-5816"], ["Helen Bernstein High", "1309 North Wilton Place, Hollywood, CA 90028-8526"], ["APEX Academy", "1309 North Wilton Place, 3rd Floor, Los Angeles, CA 90028-8526"], ["Los Angeles Teacher Preparatory Academy", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["School for the Visual Arts and Humanities", "701 South Catalina Street, Los Angeles, CA 90005-1943"], ["Alain Leroy Locke College Preparatory Academy", "325 East 111th Street, Los Angeles, CA 90061-3003"], ["Sun Valley High", "9171 Telfair Avenue, Sun Valley, CA 91352-1844"], ["UCLA Community K-12", "700 South Mariposa Avenue, Los Angeles, CA 90005-2001"], ["Ramon C. Cortines School of Visual and Performing Arts", "450 North Grand Avenue, Los Angeles, CA 90012-2123"], ["Dorothy V. Johnson Community Day", "10601 South Grandee Avenue, Los Angeles, CA 90002-3676"], ["Valley Academy of Arts and Sciences", "10445 Balboa Boulevard, Granada Hills, CA 91344-7323"], ["Dr. Maya Angelou Community High", "300 East 53rd Street, Los Angeles, CA 90011-4522"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "6361 Cottage Street, Huntington Park, CA 90255-3521"], ["Early College Academy-LA Trade Tech College", "400 West Washington Boulevard, Los Angeles, CA 90015-4108"], ["William Tell Aggeler Opportunity High", "21050 Plummer Street, Chatsworth, CA 91311-4903"], ["Harris Newmark Continuation", "1575 West Second Street, Los Angeles, CA 90026-5701"], ["Central High", "716 East 14th Street, Los Angeles, CA 90021-2114"], ["San Antonio Continuation", "2911 Belgrave Avenue, Huntington Park, CA 90255-5268"], ["Pueblo de Los Angeles Continuation", "2506 Alta Street, Los Angeles, CA 90031-2457"], ["Harold McAlister High (Opportunity)", "611 South Carondelet Street, Los Angeles, CA 90057-3301"], ["Phineas Banning Senior High", "1527 Lakme Avenue, Wilmington, CA 90744-1526"], ["Thomas Riley High", "1524 East 103rd Street, Los Angeles, CA 90002-3307"], ["Mt. Lukens Continuation", "7705 Summitrose Street, Tujunga, CA 91042-1727"], ["Bell Senior High", "4328 Bell Avenue, Bell, CA 90201-2528"], ["Belmont Senior High", "1575 West 2nd Street, Los Angeles, CA 90026-5701"], ["John R. Wooden High", "18741 Elkwood Street, Reseda, CA 91335-1802"], ["Birmingham Community Charter High", "17000 Haynes Street, Van Nuys, CA 91406-5420"], ["Amelia Earhart Continuation", "5355 Colfax Avenue, North Hollywood, CA 91601-3045"], ["Robert H. Lewis Continuation", "12508 Wicks Street, Sun Valley, CA 91352-2953"], ["Jack London Continuation", "12924 Oxnard Street, Van Nuys, CA 91401-4104"], ["Metropolitan Continuation", "727 South Wilson Street, Los Angeles, CA 90021-1625"], ["Canoga Park Senior High", "6850 Topanga Canyon Boulevard, Canoga Park, CA 91303-2354"], ["Mission Continuation", "11015 O'Melveny Avenue, San Fernando, CA 91340-4424"], ["Owensmouth Continuation", "6921 Jordan Avenue, Canoga Park, CA 91303-1997"], ["Carson Senior High", "22328 South Main Street, Carson, CA 90745-4525"], ["Will Rogers Continuation", "14711 Gilmore St, Van Nuys, CA 91411-1595"], ["Stoney Point Continuation", "10010 de Soto Avenue, Chatsworth, CA 91311-3127"], ["Diane S. Leichman Special Education Center", "19034 Gault Street, Reseda, CA 91335-3910"], ["Frank Lanterman", "2328 Saint James Place, Los Angeles, CA 90007-2577"], ["Zane Grey Continuation", "18230 Kittridge Street, Reseda, CA 91335-6115"], ["Independence Continuation", "6501 Balboa Boulevard, Van Nuys, CA 91406-5526"], ["Chatsworth Charter High", "10027 Lurline Avenue, Chatsworth, CA 91311-3153"], ["Whitman Continuation", "7795 Rosewood Avenue, Los Angeles, CA 90036-1764"], ["Grover Cleveland Charter High", "8140 Vanalden Avenue, Reseda, CA 91335-1136"], ["Avalon High", "1425 North Avalon Boulevard, Wilmington, CA 90744-1506"], ["Ellington (Duke) High (Continuation)", "1541 West 110th Street, Los Angeles, CA 90047-4912"], ["Odyssey Continuation", "8693 Dearborn Avenue, South Gate, CA 90280-2904"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet", "5010 11th Avenue, Los Angeles, CA 90043-4816"], ["Henry David Thoreau Continuation", "5429 Quakertown Avenue, Woodland Hills, CA 91364-2528"], ["Eagle Tree Continuation", "22628 South Main Street, Carson, CA 90745-4514"], ["Jane Addams Continuation", "16341 Donmetz Street, Granada Hills, CA 91344-3773"], ["Evergreen Continuation", "13101 Dronfield Avenue, Sylmar, CA 91342-4360"], ["Susan Miller Dorsey Senior High", "3537 Farmdale Avenue, Los Angeles, CA 90016-4707"], ["Eagle Rock High", "1750 Yosemite Drive, Los Angeles, CA 90041-2815"], ["El Camino Real Charter High", "5440 Valley Circle Boulevard, Woodland Hills, CA 91367-5949"], ["Fairfax Senior High", "7850 Melrose Avenue, Los Angeles, CA 90046-7210"], ["John H. Francis Polytechnic", "12431 Roscoe Boulevard, Sun Valley, CA 91352-3723"], ["Benjamin Franklin Senior High", "820 North Avenue 54, Los Angeles, CA 90042-2428"], ["John C. Fremont Senior High", "7676 South San Pedro Street, Los Angeles, CA 90003-2348"], ["Gardena Senior High", "1301 West 182nd Street, Gardena, CA 90248-3322"], ["James A. Garfield Senior High", "5101 East Sixth Street, Los Angeles, CA 90022-3209"], ["Granada Hills Charter High", "10535 Zelzah Avenue, Granada Hills, CA 91344-5902"], ["Ulysses S. Grant Senior High", "13000 Oxnard Street, Van Nuys, CA 91401-4114"], ["Alexander Hamilton Senior High", "2955 Robertson Boulevard, Los Angeles, CA 90034-3116"], ["Hollywood Senior High", "1521 North Highland Avenue, Los Angeles, CA 90028-7001"], ["Huntington Park Senior High", "6020 Miles Avenue, Huntington Park, CA 90255-3109"], ["Thomas Jefferson Senior High", "1319 East 41st Street, Los Angeles, CA 90011-3301"], ["Abraham Lincoln Senior High", "3501 North Broadway, Los Angeles, CA 90031-2856"], ["Los Angeles Senior High", "4650 West Olympic Boulevard, Los Angeles, CA 90019-1831"], ["Manual Arts Senior High", "4131 South Vermont Avenue, Los Angeles, CA 90037-1918"], ["John Marshall Senior High", "3939 Tracy Street, Los Angeles, CA 90027-3207"], ["Joaquin Miller Career and Transition Center", "8218 Vanalden Avenue, Reseda, CA 91335-1138"], ["James Monroe High", "9229 Haskell Avenue, North Hills, CA 91343-3114"], ["Nathaniel Narbonne Senior High", "24300 Western Avenue, Harbor City, CA 90710-1742"], ["North Hollywood Senior High", "5231 Colfax Avenue, North Hollywood, CA 91601-3002"], ["Reseda Senior High", "18230 Kittridge Street, Reseda, CA 91335-6121"], ["Theodore Roosevelt Senior High", "456 South Mathews Street, Los Angeles, CA 90033-4350"], ["San Fernando Senior High", "11133 O'Melveny Avenue, San Fernando, CA 91340-4426"], ["San Pedro Senior High", "1001 West 15th Street, San Pedro, CA 90731-3925"], ["South Gate Senior High", "3351 Firestone Boulevard, South Gate, CA 90280-2937"], ["Sylmar Charter High", "13050 Borden Avenue, Sylmar, CA 91342-4251"], ["Taft Charter High", "5461 Winnetka Avenue, Woodland Hills, CA 91364-2548"], ["University Senior High", "11800 Texas Avenue, Los Angeles, CA 90025-1402"], ["Van Nuys Senior High", "6535 Cedros Avenue, Van Nuys, CA 91411-1506"], ["Venice Senior High", "13000 Venice Boulevard, Los Angeles, CA 90066-3512"], ["Verdugo Hills Senior High", "10625 Plainview Avenue, Tujunga, CA 91042-1723"], ["George Washington Preparatory High", "10860 South Denker Avenue, Los Angeles, CA 90047-4622"], ["WESM Health/Sports Medicine", "7400 West Manchester Avenue, Los Angeles, CA 90045-2322"], ["Joseph Pomeroy Widney High", "2302 South Gramercy Place, Los Angeles, CA 90018-1323"], ["Woodrow Wilson Senior High", "4500 Multnomah Street, Los Angeles, CA 90032-3703"], ["John F. Kennedy High", "11254 Gothic Avenue, Granada Hills, CA 91344-3709"], ["Los Angeles Unified Alternative Education", "333 South Beaudry Avenue, Floor 18, Los Angeles, CA 90017-5108"], ["Youth Opportunities Unlimited", "915 West Manchester Avenue, Los Angeles, CA 90044-4915"], ["Palisades Charter High", "15777 Bowdoin Street, Pacific Palisades, CA 90272-3523"], ["Tri-C Community Day", "716 East 14th Street, Second Floor, Los Angeles, CA 90021-2114"], ["City of Angels", "221 South Eastman Avenue, Los Angeles, CA 90063-2423"], ["Montague Charter Academy", "13000 Montague Street, Pacoima, CA 91331-4146"], ["Valerio Street Elementary", "15035 Valerio Street, Van Nuys, CA 91405-1742"], ["Vaughn Next Century Learning Center", "13330 Vaughn Street, San Fernando, CA 91340-2216"], ["West Athens Elementary", "1110 West 119th Street, Los Angeles, CA 90044-6504"], ["Robert Fulton College Preparatory", "7477 Kester Avenue, Van Nuys, CA 91405-1722"], ["Charles Leroy Lowman Special Education Center", "12827 Saticoy Street, North Hollywood, CA 91605-3506"], ["Benjamin Banneker Career and Transition Center", "14024 South San Pedro Street, Los Angeles, CA 90061-2659"], ["Ernest P. Willenberg Special Education Center", "308 Weymouth Avenue, San Pedro, CA 90732-3426"], ["Alfonso B. Perez Special Education Center", "4540 Michigan Avenue, Los Angeles, CA 90022-1130"], ["Berenece Carlson Home Hospital", "10952 Whipple Street, North Hollywood, CA 91602-3235"], ["Marco Antonio Firebaugh High", "5246 Martin Luther King Boulevard, Lynwood, CA 90262-3903"], ["Pathway Independent Study", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Vista High", "11300 Wright Road, Lynwood, CA 90262-3126"], ["Lynwood High", "4050 East Imperial Highway, Lynwood, CA 90262-2853"], ["Canyon Oaks High", "930 Royal Oaks Drive, Monrovia, CA 91016-3735"], ["Monrovia High", "845 West Colorado Boulevard, Monrovia, CA 91016-2517"], ["Schurr High", "820 North Wilcox Avenue, Montebello, CA 90640-1808"], ["Bell Gardens High", "6119 Agra Street, Bell Gardens, CA 90201-1705"], ["Montebello High", "2100 West Cleveland Avenue, Montebello, CA 90640-4032"], ["Vail High (Continuation)", "1230 South Vail Avenue, Montebello, CA 90640-6312"], ["Montebello Community Day", "123 South Montebello Boulevard, Montebello, CA 90640-4729"], ["John H. Glenn High", "13520 Shoemaker Avenue, Norwalk, CA 90650-4521"], ["La Mirada High", "13520 Adelfa Drive, La Mirada, CA 90638-3103"], ["Norwalk High", "11356 East Leffingwell Road, Norwalk, CA 90650-3646"], ["El Camino High (Continuation)", "14625 Keese Drive, Whittier, CA 90604-3119"], ["Antelope Valley Learning Academy", "1601 Palmdale Boulevard, Suite C, Palmdale, CA 93550-4840"], ["Palos Verdes Peninsula High", "27118 Silver Spur Road, Rolling Hills Estates, CA 90274-2300"], ["Palos Verdes High", "600 Cloyden Road, Palos Verdes Estates, CA 90274-1869"], ["Paramount Alternative Education Center", "3701 Michelson Street, Lakewood, CA 90712-1402"], ["Paramount High", "14429 South Downey Avenue, Paramount, CA 90723-4378"], ["Buena Vista High", "3717 Michelson Street, Lakewood, CA 90712-1402"], ["CIS Academy", "2925 East Siera Madre Boulevard, Pasadena, CA 91107-1846"], ["Learning Works", "90 North Daisy Avenue, Pasadena, CA 91107-3704"], ["John Muir High", "1905 North Lincoln Avenue, Pasadena, CA 91103-1315"], ["Rose City High (Continuation)", "351 South Hudson Avenue, Pasadena, CA 91101-3507"], ["Pasadena High", "2925 East Sierra Madre Boulevard, Pasadena, CA 91107-1846"], ["School of Extended Educational Options", "1460 East Holt Avenue, Suite 100, Pomona, CA 91767-5862"], ["Ganesha High", "1151 Fairplex Drive, Pomona, CA 91768-1299"], ["Garey High", "321 West Lexington Avenue, Pomona, CA 91766-5254"], ["Park West High (Continuation)", "1460 West Holt Avenue, Suite 100, Pomona, CA 91767-2832"], ["Pomona High", "475 Bangor Street, Pomona, CA 91767-2443"], ["Diamond Ranch High", "100 Diamond Ranch Drive, Pomona, CA 91766-4723"], ["Santa Monica High", "601 Pico Boulevard, Santa Monica, CA 90405-1224"], ["McKinley Elementary", "2401 Santa Monica Boulevard, Santa Monica, CA 90404-2044"], ["Will Rogers Elementary", "2401 14th Street, Santa Monica, CA 90405-2615"], ["Charles Helmers Elementary", "27300 North Grandview Drive, Valencia, CA 91354-1800"], ["South Pasadena Senior High", "1401 Fremont Avenue, South Pasadena, CA 91030-3809"], ["Monterey Hills Elementary", "1624 Via del Rey, South Pasadena, CA 91030-4126"], ["Temple City High", "9501 Lemon Avenue, Temple City, CA 91780-1305"], ["North High", "3620 West 182nd Street, Torrance, CA 90504-3935"], ["South High", "4801 Pacific Coast Highway, Torrance, CA 90505-5544"], ["Torrance High", "2200 Carson Street, Torrance, CA 90501-3135"], ["West High", "20401 Victor Street, Torrance, CA 90503-2255"], ["California Virtual Academy @ Los Angeles", "50 Moreland Road, Simi Valley, CA 93065-1659"], ["Coronado High (Continuation)", "1500 East Francisquito Avenue, West Covina, CA 91791-3823"], ["West Covina High", "1609 East Cameron Avenue, West Covina, CA 91791-3108"], ["Frontier High (Continuation)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["California High", "9800 South Mills Avenue, Whittier, CA 90604-1030"], ["La Serna High", "15301 East Youngwood Drive, Whittier, CA 90605-1345"], ["Santa Fe High", "10400 South Orr and Day Road, Santa Fe Springs, CA 90670-4161"], ["Sierra Vista High (Alternative)", "9401 South Painter Avenue, Whittier, CA 90605-2729"], ["Golden Valley High", "27051 Robert C. Lee Parkway, Santa Clarita, CA 91321-0500"], ["West Ranch High", "26255 West Valencia Boulevard, Valencia, CA 91381-0664"], ["Mission View Public", "26334 Citrus Street, Santa Clarita, CA 91355-5323"], ["Canyon High", "19300 West Nadal Street, Canyon Country, CA 91351-1253"], ["Saugus High", "21900 Centurion Way, Saugus, CA 91350-1607"], ["William S. Hart High", "24825 North Newhall Avenue, Newhall, CA 91321-1576"], ["Bowman (Jereann) High (Continuation)", "21508 Centre Pointe Parkway, Santa Clarita, CA 91350-2947"], ["Valencia High", "27801 North Dickason Drive, Valencia, CA 91355-1208"], ["Opportunities for Learning - Santa Clarita", "320 North Halstead Street, Suite 200, Pasadena, CA 91107-3151"], ["Compton High", "601 South Acacia Street, Compton, CA 90220-3702"], ["Dominguez High", "15301 South San Jose Avenue, Compton, CA 90221-3131"], ["Cesar Chavez Continuation High", "12501 North Wilmington, Compton, CA 90222"], ["Puente Hills High", "15430 Shadybend Drive, Hacienda Heights, CA 91746-2829"], ["La Puente High", "15615 East Nelson Avenue, La Puente, CA 91744-3910"], ["Los Altos High", "15325 East Los Robles Avenue, Hacienda Heights, CA 91745-2717"], ["Glen A. Wilson High", "16455 Wedgeworth Drive, Hacienda Heights, CA 91745-3045"], ["William Workman High", "16303 East Temple Avenue, City Of Industry, CA 91744-4162"], ["Santana High (Continuation)", "341 South La Seda Road, La Puente, CA 91744-5980"], ["Nogales High", "401 South Nogales Street, La Puente, CA 91744-6144"], ["John A. Rowland High", "2000 South Otterbein Street, Rowland Heights, CA 91748-3949"], ["Rowland Unified Community Day", "1928 Nogales Street, Rowland Heights, CA 91748-3855"], ["Diamond Bar High", "21400 Pathfinder Road, Diamond Bar, CA 91765-2747"], ["Walnut High", "400 North Pierre Road, Walnut, CA 91789-2535"], ["Gabrielino High", "1327 South San Gabriel Boulevard, San Gabriel, CA 91776-3308"], ["Options for Youth San Gabriel", "405 South San Gabriel Boulevard, Suite A, San Gabriel, CA 91776-1966"], ["Roosevelt Elementary", "401 South Walnut Grove Avenue, San Gabriel, CA 91776-2029"], ["Assurance Learning Academy", "5701 South Western Avenue, Los Angeles, CA 90062-2714"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "17500 Burbank Blvd, Encino, CA 91316-1718"], ["SIATech Academy South", "634 South Spring Street, Los Angeles, CA 90014-3921"], ["Mira Costa High", "1401 Artesia Boulevard, Manhattan Beach, CA 90266-6968"], ["Redondo Union High", "631 Vincent Park, Redondo Beach, CA 90277-3125"], ["Washington Elementary", "1100 Lilienthal Lane, Redondo Beach, CA 90278-4557"], ["Alhambra High", "101 South Second Street, Alhambra, CA 91801-3716"], ["San Gabriel High", "801 Ramona Street, San Gabriel, CA 91776-2342"], ["Madera County Independent Academy", "28123 Avenue 14, Madera, CA 93638-4905"], ["Pioneer Technical Center", "1025 South Madera Avenue, Madera, CA 93637-5625"], ["Gould Educational Center", "117 West Dunham, Madera, CA 93637-5468"], ["Stephens Elementary", "355 North 5th Street, Chowchilla, CA 93610-0907"], ["Chowchilla Union High", "805 Humboldt Avenue, Chowchilla, CA 93610-3117"], ["Madera South High", "755 West Pecan Avenue, Madera, CA 93637"], ["Mountain Vista High", "1901 Clinton Avenue, Madera, CA 93638-1941"], ["Madera High", "200 South L Street, Madera, CA 93637-4650"], ["Marin County Special Education", "1111 Las Gallinas Avenue, San Rafael, CA 94913-1843"], ["Novato High", "625 Arthur Street, Novato, CA 94947-4499"], ["San Rafael High", "185 Mission Ave, San Rafael, CA 94901-5632"], ["Terra Linda High", "320 Nova Albion Way, San Rafael, CA 94903-3523"], ["Redwood High", "395 Doherty Drive, Larkspur, CA 94939-1536"], ["Tamalpais High", "700 Miller Avenue, Mill Valley, CA 94941-2926"], ["South Valley High (Continuation)", "445 South Dora Street, Ukiah, CA 95482-4753"], ["Ukiah High", "1000 Low Gap Road, Ukiah, CA 95482-3737"], ["Valley Merced Community", "1850 Wardrobe Avenue, Merced, CA 95341-6407"], ["Merced County Special Education", "632 West 13th Street, Merced, CA 95341-5908"], ["Elim Elementary", "7677 North Lander Avenue, Hilmar, CA 95324-9338"], ["Pacheco High", "200 North Ward Road, Los Banos, CA 93635-8831"], ["Los Banos High", "1966 11th Street, Los Banos, CA 93635-4812"], ["Golden Valley High", "2121 East Childs Avenue, Merced, CA 95344-0188"], ["Buhach Colony High", "1800 Buhach Road, Atwater, CA 95301-4592"], ["Atwater High", "2201 Fruitland Avenue, Atwater, CA 95301-0835"], ["Livingston High", "1617 Main Street, Livingston, CA 95334-1250"], ["Merced High", "205 West Olive Avenue, Merced, CA 95348-3100"], ["Yosemite High (Continuation)", "1900 G Street, Merced, CA 95340-5043"], ["Pioneer Elementary", "2950 Gerard Avenue, Merced, CA 95341-5433"], ["Monterey County Home Charter", "901 Blanco Circle, Salinas, CA 93901-4401"], ["Salinas Community", "1420 Natividad Road, Salinas, CA 93906-3102"], ["Carmel High", "3600 Ocean Avenue, Carmel, CA 93923"], ["Mary Chapa Academy", "490 El Camino Real, Greenfield, CA 93927-4914"], ["Del Rey Elementary", "502 King Street, King City, CA 93930-3232"], ["Greenfield High", "225 South El Camino Real, Greenfield, CA 93927-6312"], ["Monterey High", "101 Herrmann Drive, Monterey, CA 93940-2538"], ["Seaside High", "2200 Noche Buena Street, Seaside, CA 93955-3145"], ["El Puente", "20 Sherwood Place, Salinas, CA 93906-4010"], ["Alisal High", "777 Williams Road, Salinas, CA 93905-1907"], ["Everett Alvarez High", "1900 Independence Boulevard, Salinas, CA 93906-5300"], ["North Salinas High", "55 Kip Drive, Salinas, CA 93906-2908"], ["Mount Toro High", "10 Sherwood Place, Salinas, CA 93906-4010"], ["Salinas High", "726 South Main Street, Salinas, CA 93901-3243"], ["North Monterey County High", "13990 Castroville Boulevard, Castroville, CA 95012-9749"], ["North Monterey County Center for Independent Study", "17500 Pesante Road, Salinas, CA 93907-1552"], ["Soledad High", "425 Gabilan Drive, Soledad, CA 93960-3207"], ["Rose Ferrero Elementary", "400 Entrada Drive, Soledad, CA 93960-3148"], ["American Canyon High", "3000 Newell Drive, American Canyon, CA 94503-1279"], ["Vintage High", "1375 Trower Avenue, Napa, CA 94558-2420"], ["Napa High", "2475 Jefferson Street, Napa, CA 94558-4931"], ["Salvador Elementary", "1850 Salvador Avenue, Napa, CA 94558-1633"], ["John Muir Charter Schools", "12338 McCourtney Road, Grass Valley, CA 95949-9756"], ["Nevada Union High", "11761 Ridge Road, Grass Valley, CA 95945-5025"], ["Access Juvenile Hall", "1715 East Wilshire Avenue, Suite 702, Santa Ana, CA 92705-4652"], ["OCCS:CHEP/PCHS", "2910 Redhill Avenue, Suite 200, Costa Mesa, CA 92626-5993"], ["Access County Community", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Orange County Special Education", "200 Kalmus Drive, Costa Mesa, CA 92628-9050"], ["Cypress High", "9801 Valley View Street, Cypress, CA 90630-3994"], ["Anaheim High", "811 West Lincoln Avenue, Anaheim, CA 92805-2499"], ["Polaris High (Alternative)", "1800 West Ball Road, Anaheim, CA 92804-5516"], ["Gilbert High (Continuation)", "1800 Ball Road, Anaheim, CA 92804-5516"], ["Katella High", "2200 East Wagner Avenue, Anaheim, CA 92806-4999"], ["John F. Kennedy High", "8281 Walker Street, La Palma, CA 90623-2126"], ["Loara High", "1765 West Cerritos Avenue, Anaheim, CA 92804-6198"], ["Magnolia High", "2450 West Ball Road, Anaheim, CA 92804-5298"], ["Savanna High", "301 North Gilbert Street, Anaheim, CA 92801-5099"], ["Western High", "501 South Western Avenue, Anaheim, CA 92804-1699"], ["Hope", "7901 Knott Avenue, Buena Park, CA 90620-2469"], ["Brea-Olinda High", "789 North Wildcat Way, Brea, CA 92821-7400"], ["Capistrano Connections Academy", "33272 Valle Road, San Juan Capistrano, CA 92675-4842"], ["San Juan Hills High", "29211 Stallion Ridge, San Juan Capistrano, CA 92675-3639"], ["Capistrano Valley High", "26301 Via Escolar, Mission Viejo, CA 92692-3999"], ["Aliso Niguel High", "28000 Wolverine Way, Aliso Viejo, CA 92656-3385"], ["Tesoro High", "1 Tesoro Creek Road, Las Flores, CA 92688-4706"], ["San Clemente High", "700 Avenido Pico, San Clemente, CA 92673-5681"], ["Dana Hills High", "33333 Golden Lantern, Dana Point, CA 92629-1840"], ["Crown Valley Elementary", "29292 Crown Valley Parkway, Laguna Niguel, CA 92677-1899"], ["Raymond Temple Elementary", "7800 Holder Street, Buena Park, CA 90620-2315"], ["Sunset Lane Elementary", "2030 Sunset Lane, Fullerton, CA 92833-1852"], ["La Sierra High (Alternative)", "951 North State College Boulevard, Fullerton, CA 92831"], ["Buena Park High", "8833 Academy Drive, Buena Park, CA 90621-3705"], ["Fullerton Union High", "201 East Chapman Avenue, Fullerton, CA 92832-1925"], ["La Habra High", "801 West Highlander Avenue, La Habra, CA 90631-3720"], ["La Vista High (Continuation)", "909 North State College Boulevard, Fullerton, CA 92831-3013"], ["Sonora High", "401 South Palm Street, La Habra, CA 90631-5735"], ["Sunny Hills High", "1801 Warburton Way, Fullerton, CA 92833-2235"], ["Troy High", "2200 East Dorothy Lane, Fullerton, CA 92831-3036"], ["Marie L. Hare High", "12012 Magnolia Street, Garden Grove, CA 92841-1644"], ["Bolsa Grande High", "9401 Westminster Avenue, Garden Grove, CA 92844-2901"], ["Garden Grove High", "11271 Stanford Avenue, Garden Grove, CA 92840-5317"], ["La Quinta High", "10372 McFadden Street, Westminster, CA 92683-7098"], ["Los Amigos High", "16566 Newhope Street, Fountain Valley, CA 92708-2403"], ["Pacifica High", "6851 Lampson Avenue, Garden Grove, CA 92845-2211"], ["Rancho Alamitos High", "11351 Dale Street, Garden Grove, CA 92841-1598"], ["Santiago High", "12342 Trask Avenue, Garden Grove, CA 92843-2812"], ["Joseph R. Perry Elementary", "19231 Harding Lane, Huntington Beach, CA 92646-2023"], ["Ocean View High", "17071 Gothard Street, Huntington Beach, CA 92647-5417"], ["Edison High", "21400 Magnolia, Huntington Beach, CA 92646-6306"], ["Fountain Valley High", "17816 Bushard, Fountain Valley, CA 92708-4598"], ["Huntington Beach High", "1905 Main Street, Huntington Beach, CA 92648-2705"], ["Marina High", "15871 Springdale Street, Huntington Beach, CA 92649-1727"], ["Westminster High", "14325 Goldenwest Street, Westminster, CA 92683-4905"], ["Valley Vista High (Continuation)", "9600 Dolphin Street, Fountain Valley, CA 92708-4603"], ["Dr. Albert Schweitzer", "229 South Dale Avenue, Anaheim, CA 92804-2006"], ["Corona del Mar High", "2101 Eastbluff Drive, Newport Beach, CA 92660-4530"], ["Costa Mesa High", "2650 Fairview Road, Costa Mesa, CA 92626-5537"], ["Estancia High", "2323 Placentia Avenue, Costa Mesa, CA 92627-3305"], ["Newport Harbor High", "600 Irvine Avenue, Newport Beach, CA 92663-5412"], ["Canyon High", "220 South Imperial Highway, Anaheim, CA 92807-3945"], ["El Modena High", "3920 Spring Street, Orange, CA 92869-3599"], ["Orange High", "525 North Shaffer Street, Orange, CA 92867-6824"], ["Richland Continuation High", "615 North Lemon Street, Orange, CA 92867-6611"], ["Villa Park High", "18042 Taft Avenue, Villa Park, CA 92861-4148"], ["Canyon Hills", "260 South Imperial Highway, Anaheim, CA 92807-3945"], ["Yorba Linda High", "19900 Bastanchury Road, Yorba Linda, CA 92886-8417"], ["Esperanza High", "1830 North Kellogg Drive, Anaheim, CA 92807-1218"], ["El Dorado High", "1651 North Valencia Avenue, Placentia, CA 92870-3030"], ["El Camino Real Continuation High", "1351 East Orangethorpe Avenue, Placentia, CA 92870-5302"], ["Valencia High", "500 North Bradford Avenue, Placentia, CA 92870-4844"], ["Segerstrom High", "2301 West MacArthur Boulevard, Santa Ana, CA 92704-7168"], ["Hector G. Godinez", "3002 Centennial Road, Santa Ana, CA 92704-3904"], ["Cesar E. Chavez High", "2128 South Cypress, Santa Ana, CA 92707-3244"], ["Century High", "1401 South Grand Avenue, Santa Ana, CA 92705-4408"], ["Lorin Griset Academy", "1915 West McFadden, Santa Ana, CA 92704-2902"], ["Saddleback High", "2801 South Flower, Santa Ana, CA 92707-3935"], ["Santa Ana High", "520 West Walnut, Santa Ana, CA 92701-5559"], ["Valley High", "1801 South Greenville Street, Santa Ana, CA 92704-4005"], ["Jessie Hayden Elementary", "14782 Eden Street, Midway City, CA 92655-1108"], ["El Toro High", "25255 Toledo Way, Lake Forest, CA 92630-4203"], ["Silverado High", "25632 Peter A. Hartman Way, Mission Viejo, CA 92691-3118"], ["Laguna Hills High", "25401 Paseo de Valencia, Laguna Hills, CA 92653-5395"], ["Trabuco Hills High", "27501 Cordova Road, Mission Viejo, CA 92691-1027"], ["Mission Viejo High", "25025 Chrisanta Drive, Mission Viejo, CA 92691-5326"], ["Olivewood Elementary", "23391 Dune Mear Road, Lake Forest, CA 92630-3819"], ["Glen Yermo Elementary", "26400 Trabuco Road, Mission Viejo, CA 92691-1999"], ["Esperanza", "25121 Pradera Drive, Mission Viejo, CA 92691-5310"], ["Lomarena Elementary", "25100 Earhart Road, Laguna Hills, CA 92653-5257"], ["Cielo Vista Elementary", "21811 Avenida De Los Fundadores, Rancho Santa Margarita, CA 92688-5444"], ["Foothill Ranch Elementary", "1 Torino Drive, Foothill Ranch, CA 92691-3142"], ["Arnold O. Beckman High", "3588 Bryan Avenue, Irvine, CA 92602-1347"], ["Foothill High", "19251 Dodge Avenue, Santa Ana, CA 92705-2236"], ["Tustin High", "1171 El Camino Real, Tustin, CA 92780-4660"], ["W. R. Nelson Elementary", "14392 Browning Avenue, Tustin, CA 92780-6338"], ["Irvine Adult Transition Programs", "311 West Yale Loop, Irvine, CA 92604-4736"], ["Cypress Village Elementary", "355 Rush Lily, Irvine, CA 92620-4112"], ["Portola Springs Elementary", "12100 Portola Springs, Irvine, CA 92618"], ["Irvine High", "4321 Walnut Avenue, Irvine, CA 92604-2239"], ["Woodbridge High", "2 Meadowbrook, Irvine, CA 92604-4726"], ["Northwood High", "4515 Portola Parkway, Irvine, CA 92620-2200"], ["University High", "4771 Campus Drive, Irvine, CA 92612-3298"], ["Los Alamitos High", "3591 Cerritos Avenue, Los Alamitos, CA 90720-2414"], ["Antelope Meadows Elementary", "8343 Palmerson Drive, Antelope, CA 95843-5195"], ["Del Oro High", "3301 Taylor Road, Loomis, CA 95650-9502"], ["Placer High", "275 Orange Street, Auburn, CA 95603-5115"], ["Antelope High", "7801 Titan Drive, Antelope, CA 95843-6037"], ["Woodcreek High", "2551 Woodcreek Oaks Boulevard, Roseville, CA 95747-6074"], ["Granite Bay High", "1 Grizzly Way, Granite Bay, CA 95746-7194"], ["Oakmont High", "1710 Cirby Way, Roseville, CA 95661-5520"], ["Roseville High", "1 Tiger Way, Roseville, CA 95678-1706"], ["Partnerships for Student-Centered Learning", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Horizon Charter", "2800 Nicolaus Road, Suite 100, Lincoln, CA 95648-1757"], ["Creekside Oaks Elementary", "2030 First Street, Lincoln, CA 95648-2173"], ["Whitney High", "701 Wildcat Boulevard, Rocklin, CA 95765-5469"], ["Rocklin High", "5301 Victory Lane, Rocklin, CA 95765-4988"], ["River Springs Charter", "43466 Business Park Drive, Temecula, CA 92590-5526"], ["Come Back Kids", "3939 13th Street, Riverside, CA 92501, CA 92501-3505"], ["Gateway College and Career Academy", "4800 Magnolia Avenue, Riverside, CA 92506-1201"], ["Riverside County Community", "3939 13th Street, Riverside, CA 92501-3505"], ["Riverside County Special Education", "3939 13th Street, Riverside, CA 92502-0868"], ["California School for the Deaf-Riverside", "3044 Horace Street, Riverside, CA 92506-4498"], ["Alvord Alternative Continuation High", "10368 Campbell Avenue, Riverside, CA 92505-1308"], ["La Sierra High", "4145 La Sierra Avenue, Riverside, CA 92505-2938"], ["Norte Vista High", "6585 Crest Avenue, Riverside, CA 92503-1102"], ["Alvord Continuation High", "3606 Pierce Street, Riverside, CA 92503-4925"], ["Banning High", "100 West Westward, Banning, CA 92220-4922"], ["Hoffer Elementary", "1115 East Hoffer Street, Banning, CA 92220-2723"], ["Beaumont Senior High", "39139 Cherry Valley Blvd, Beaumont, CA 92223-4484"], ["Clara Barton Elementary", "7437 Corona Valley Avenue, Eastvale, CA 92880-8700"], ["Harada Elementary", "12884 Oakdale Street, Eastvale, CA 92880-8547"], ["Eleanor Roosevelt High", "7447 Scholar Way, Eastvale, CA 92880-9750"], ["Eastvale Elementary", "13031 Orange Street, Eastvale, CA 92880-9743"], ["John F. Kennedy High", "1951 Third Street, Norco, CA 92860-2643"], ["Centennial High", "1820 Rimpau Avenue, Corona, CA 92881-3228"], ["Lee V. Pollard High", "185 Magnolia Avenue, Corona, CA 92879-3329"], ["Santiago High", "1395 Foothill Parkway, Corona, CA 92881-0996"], ["Corona High", "1150 West Tenth Street, Corona, CA 92882-3901"], ["Norco High", "2065 Temescal Avenue, Norco, CA 92860-2726"], ["Summit High (Continuation)", "43-330 Palm Royale Drive, La Quinta, CA 92253-8170"], ["Shadow Hills High", "39-225 Jefferson Street, Indio, CA 92201-9482"], ["Palm Desert High", "74-910 Aztec Road, Palm Desert, CA 92260-5639"], ["La Quinta High", "79-255 Westward Ho Drive, La Quinta, CA 92253-4244"], ["Amistad High (Continuation)", "83-501 Dillon Avenue, Indio, CA 92201-3325"], ["Indio High", "81-750 Avenue 46, Indio, CA 92201-3911"], ["Tahquitz High", "4425 Titan Trail, Hemet, CA 92545-6224"], ["Alessandro High", "831 East Devonshire Avenue, Hemet, CA 92543-3052"], ["West Valley High", "3401 Mustang Way, Hemet, CA 92545-9257"], ["Hemet High", "41701 Stetson Avenue, Hemet, CA 92544-7518"], ["Patriot High", "4355 Camino Real, Jurupa Valley, CA 92509-3455"], ["Jurupa Valley High", "10551 Bellegrave Avenue, Jurupa Valley, CA 91752-1800"], ["Nueva Vista Continuation High", "6836 34th Street, Jurupa Valley, CA 92509-1301"], ["Rubidoux High", "4250 Opal Street, Jurupa Valley, CA 92509-7251"], ["Moreno Valley Online Academy", "24521 Cactus Avenue, Moreno Valley, CA 92553"], ["Canyon Springs High", "23100 Cougar Canyon Drive, Moreno Valley, CA 92557-3801"], ["Valley View High", "13135 Nason Street, Moreno Valley, CA 92555-4504"], ["Vista del Lago High", "15150 Lasselle Street, Moreno Valley, CA 92551-1460"], ["March Mountain High", "24551 Dracaea Avenue, Moreno Valley, CA 92553-3745"], ["Moreno Valley High", "23300 Cottonwood Avenue, Moreno Valley, CA 92553-3437"], ["Cathedral City High", "69250 Dinah Shore Drive, Cathedral City, CA 92234-4713"], ["Desert Hot Springs High", "65850 Pierson Boulevard, Desert Hot Springs, CA 92240-3000"], ["Mt. San Jacinto High", "30800 Landau Boulevard, Cathedral City, CA 92234-5159"], ["Palm Springs High", "2401 East Baristo Road, Palm Springs, CA 92262-7217"], ["Palo Verde High", "667 North Lovekin Boulevard, Blythe, CA 92225-1136"], ["Heritage High", "26000 Briggs Road, Romoland, CA 92585-3230"], ["Perris Lake High (Continuation)", "418 West Ellis, Perris, CA 92570-4544"], ["Paloma Valley High", "31375 Bradley Road, Menifee, CA 92584-9368"], ["Perris High", "175 East Nuevo Road, Perris, CA 92571-2910"], ["Arlington High", "2951 Jackson Street, Riverside, CA 92503-5732"], ["Summit View Independent Study", "6401 Lincoln Avenue, Riverside, CA 92506-4413"], ["Martin Luther King Jr. High", "9301 Wood Road, Riverside, CA 92508-9459"], ["John W. North High", "1550 West Third Street, Riverside, CA 92507-3404"], ["Polytechnic High", "5450 Victoria Avenue, Riverside, CA 92506-3362"], ["Ramona High", "7675 Magnolia Avenue, Riverside, CA 92504-3627"], ["Abraham Lincoln Continuation", "4341 Victoria Avenue, Riverside, CA 92507-5009"], ["Clayton A. Record, Jr., Elementary", "1600 Malaga Drive, San Jacinto, CA 92583-2369"], ["Mountain Heights Academy", "1000 Ramona Boulevard, San Jacinto, CA 92582-2552"], ["Mountain View High", "1000 Ramona Boulevard, San Jacinto, CA 92582-2576"], ["San Jacinto High", "500 Idyllwild Drive, San Jacinto, CA 92583-2615"], ["Hyatt Elementary", "400 East Shaver Street, San Jacinto, CA 92583-4724"], ["Coachella Valley High", "83-800 Airport Boulevard, Thermal, CA 92274-9367"], ["Lakeside High", "32593 Riverside Drive, Lake Elsinore, CA 92530-7802"], ["Keith McCarthy Academy", "4305 Education Way, Lake Elsinore, CA 92530-2711"], ["Ortega High", "520 Chaney Street, Building 100, Lake Elsinore, CA 92530-1230"], ["Temescal Canyon High", "28755 El Toro Road, Lake Elsinore, CA 92532-1912"], ["Elsinore High", "21800 Canyon Drive, Wildomar, CA 92595-9181"], ["Great Oak High", "32555 Deer Hollow Way, Temecula, CA 92592-1283"], ["Temecula Valley High", "31555 Rancho Vista Road, Temecula, CA 92592-3516"], ["Chaparral High", "27215 Nicolas Road, Temecula, CA 92591-7348"], ["Vista Murrieta High", "28251 Clinton Keith Road, Murrieta, CA 92563-2465"], ["Murrieta Mesa High", "24801 Monroe Avenue, Murrieta, CA 92562-9018"], ["Murrieta Valley High", "42200 Nighthawk Way, Murrieta, CA 92562-6235"], ["Citrus Hill High", "18150 Wood Road, Perris, CA 92570-9486"], ["May Ranch Elementary", "900 East Morgan, Perris, CA 92571-7815"], ["Rancho Verde High", "17750 Lasselle Street, Moreno Valley, CA 92551-6300"], ["Val Verde High", "972 West Morgan Street, Perris, CA 92571-3103"], ["Sacramento County SH Special Education", "10474 Mather Boulevard, Mather, CA 95655-4116"], ["N.A. Chaderjian High", "7650 South Newcastle Road, Stockton, CA 95213-9014"], ["Mary B. Perry High", "3100 Wright Road, Camarillo, CA 93010"], ["Monterey Trail High", "8661 Power Inn Road, Elk Grove, CA 95624-3467"], ["Pleasant Grove High", "9531 Bond Road, Elk Grove, CA 95624-1440"], ["Cosumnes Oaks High", "8350 Lotz Parkway, Elk Grove, CA 95757"], ["Valley High", "6300 Ehrhardt Avenue, Sacramento, CA 95823-5637"], ["Calvine High", "8333 Vintage Park Drive, Sacramento, CA 95828-6178"], ["Rio Cazadero High (Continuation)", "7825 Grandstaff Drive, Sacramento, CA 95823-4897"], ["Florin High", "7956 Cottonwood Lane, Sacramento, CA 95828-5404"], ["Laguna Creek High", "9050 Vicino Drive, Elk Grove, CA 95758-5859"], ["Sheldon High", "8333 Kingsbridge Drive, Sacramento, CA 95829-6085"], ["Franklin High", "6400 Whitelock Parkway, Elk Grove, CA 95757-5928"], ["Daylor (William) High (Continuation)", "6131 Orange Avenue, Sacramento, CA 95823-3226"], ["Elk Grove High", "9800 Elk Grove-Florin Road, Elk Grove, CA 95624-2549"], ["Jessie Baker", "8850 Southside Avenue, Elk Grove, CA 95624-2231"], ["Vista del Lago High", "1970 Broadstone Parkway, Folsom, CA 95630-8335"], ["Folsom Lake High", "955 Riley Street, Folsom, CA 95630-3002"], ["Cordova High", "2239 Chase Drive, Rancho Cordova, CA 95670-2039"], ["Folsom High", "1655 Iron Point Road, Folsom, CA 95630-3053"], ["Blanche Sprentz Elementary", "249 Flower Drive, Folsom, CA 95630-2746"], ["Estrellita Continuation High", "12935 Marengo Road, Galt, CA 95632-1717"], ["Galt High", "145 North Lincoln Way, Galt, CA 95632-1720"], ["Rosemont High", "9594 Kiefer Boulevard, Sacramento, CA 95827-3817"], ["American Legion High (Continuation)", "3801 Broadway, Sacramento, CA 95817-3399"], ["Capital City Independent Study", "7222 24th Street, Sacramento, CA 95823-4978"], ["Luther Burbank High", "3500 Florin Road, Sacramento, CA 95823-1767"], ["Hiram W. Johnson High", "6879 14th Avenue, Sacramento, CA 95820-3431"], ["John F. Kennedy High", "6715 Gloria Drive, Sacramento, CA 95831-2008"], ["C. K. McClatchy High", "3066 Freeport Boulevard, Sacramento, CA 95818-4349"], ["California Montessori Project-San Juan Campus", "5330A Gibbons Drive, Suite 700, Carmichael, CA 95608-2117"], ["El Sereno Alternative Education", "10700 Fair Oaks Boulevard, Fair Oaks, CA 95628-7213"], ["Bella Vista High", "8301 Madison Avenue, Fair Oaks, CA 95628-3823"], ["Options for Youth-San Juan", "5825 Windmill Way, Carmichael, CA 95608-1300"], ["Visions In Education", "5030 El Camino Avenue, Carmichael, CA 95608-4650"], ["Casa Roble Fundamental High", "9151 Oak Avenue, Orangevale, CA 95662-2730"], ["Del Campo High", "4925 Dewey Drive, Fair Oaks, CA 95628-4402"], ["Encina Preparatory High", "1400 Bell Street, Sacramento, CA 95825-2303"], ["Mira Loma High", "4000 Edison Avenue, Sacramento, CA 95821-2825"], ["Rio Americano High", "4540 American River Drive, Sacramento, CA 95864-6104"], ["San Juan High", "7551 Greenback Lane, Citrus Heights, CA 95610-5614"], ["Laurel Ruff Transition", "5325 Garfield Avenue, Sacramento, CA 95841-3103"], ["Center High", "3111 Center Court Lane, Antelope, CA 95843-9111"], ["Inderkum High", "2500 New Market Drive, Sacramento, CA 95835-2238"], ["Natomas High", "3301 Fong Ranch Road, Sacramento, CA 95834-1719"], ["Discovery High", "3401 Fong Ranch Road, Sacramento, CA 95834-1797"], ["Natomas Charter", "4600 Blackrock Drive, Sacramento, CA 95835-1250"], ["Heritage Peak Charter", "6450 20th Street, Rio Linda, CA 95673-3718"], ["Community Collaborative Charter", "5715 Skvarla Avenue, McClellan, CA 95652-2424"], ["SAVA: Sacramento Academic and Vocational Academy", "5330 Power Inn Road, Suite D, Sacramento, CA 95820-6757"], ["Highlands Community Charter", "1333 Grand Avenue, Sacramento, CA 95838-3654"], ["Elwood J. Keema High", "1281 North Avenue, Sacramento, CA 95838-3661"], ["Grant Union High", "1400 Grand Avenue, Sacramento, CA 95838-3624"], ["Highlands High", "6601 Guthrie Way, North Highlands, CA 95660-3911"], ["Rio Linda High", "6309 Dry Creek Road, Rio Linda, CA 95673-4412"], ["Miles P. Richmond", "4330 Keema Avenue, North Highlands, CA 95660-3948"], ["Sunnyslope Elementary", "1475 Memorial Drive, Hollister, CA 95023-5007"], ["San Benito High", "1220 Monterey Street, Hollister, CA 95023-4708"], ["Community School/Independent Alternative Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["San Bernardino County Special Education", "601 North E Street, San Bernardino, CA 92415-0020"], ["Alta Vista Public", "11988 Hesperia Road, Suite B, Hesperia, CA 92345-1426"], ["Alta Loma Elementary", "7085 Amethyst Street, Alta Loma, CA 91701-5007"], ["Central High (Continuation)", "405 North Second Avenue, Barstow, CA 92311-2226"], ["Barstow High", "430 South First Avenue, Barstow, CA 92311-2860"], ["Crestline Elementary", "2020 Monterey, Barstow, CA 92311-6713"], ["Alta Loma High", "8880 Baseline Road, Alta Loma, CA 91701-5504"], ["Etiwanda High", "13500 Victoria Avenue, Etiwanda, CA 91739-0447"], ["Rancho Cucamonga High", "11801 Lark Drive, Rancho Cucamonga, CA 91701-8715"], ["Los Osos High", "6001 Milliken Avenue, Rancho Cucamonga, CA 91737-7709"], ["Colony High", "3850 East Riverside Drive, Ontario, CA 91761-2603"], ["Chaffey High", "1245 North Euclid Avenue, Ontario, CA 91762-1997"], ["Montclair High", "4725 Benito Street, Montclair, CA 91763-2705"], ["Ontario High", "901 West Francis Street, Ontario, CA 91762-6214"], ["Valley View High (Continuation)", "1801 East Sixth Street, Ontario, CA 91764-1599"], ["Don Antonio Lugo High", "13400 Pipeline Avenue, Chino, CA 91710-4130"], ["Ruben S. Ayala High", "14255 Peyton Avenue, Chino Hills, CA 91709-1607"], ["Chino Hills High", "16150 Pomona Rincon Road, Chino Hills, CA 91709-3101"], ["Buena Vista Continuation High", "13509 Ramona Avenue, Chino, CA 91710-4130"], ["Chino High", "5472 Park Place, Chino, CA 91710-4130"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "21810 Main Street, Grand Terrace, CA 92313-5810"], ["Washington High", "900 East C Street, Colton, CA 92324-2600"], ["Bloomington High", "10750 Laurel Avenue, Bloomington, CA 92316-2520"], ["Colton High", "777 West Valley Boulevard, Colton, CA 92324-2251"], ["Slover Mountain High (Continuation)", "325 Hermosa Street, Colton, CA 92324-1901"], ["Summit High", "15551 Summit Avenue, Fontana, CA 92336-4605"], ["Jurupa Hills High", "10700 Oleander Avenue, Fontana, CA 92337-7435"], ["Birch High (Continuation)", "7930 Locust Avenue, Fontana, CA 92336-2871"], ["Citrus High (Continuation)", "10760 Cypress, Fontana, CA 92337-7422"], ["Fontana A. B. Miller High", "6821 Oleander Avenue, Fontana, CA 92336-1400"], ["Henry J. Kaiser High", "11155 Almond Avenue, Fontana, CA 92337-7113"], ["Fontana High", "9453 Citrus Avenue, Fontana, CA 92335-5510"], ["Alta Vista South Public Charter", "689 West Second Street, San Bernardino, CA 92410-3205"], ["Hope Academy Charter", "12421 Hesperia Road, Suite 5, Victorville, CA 92395-5870"], ["Black Rock Alternative/Continuation", "59273 Sunnyslope, Yucca Valley, CA 92284-5996"], ["Yucca Valley High", "7600 Sage Avenue, Yucca Valley, CA 92284-3624"], ["Mojave River Academy", "16519 Victor Street, Suite 404, Victorville, CA 92395-3968"], ["Citrus Valley High", "800 West Pioneer Avenue, Redlands, CA 92374-1509"], ["Redlands East Valley High", "31000 East Colton Avenue, Redlands, CA 92374-8290"], ["Orangewood High (Continuation)", "515 Texas Street, Redlands, CA 92374-3071"], ["Redlands Senior High", "840 East Citrus Avenue, Redlands, CA 92374-5399"], ["Wilmer Amina Carter High", "2630 North Linden Avenue, Rialto, CA 92377-8446"], ["Milor Continuation High", "266 West Randall, Rialto, CA 92376-6926"], ["Zupanic High", "266 West Randall Avenue, Rialto, CA 92376-6926"], ["Rialto High", "595 South Eucalyptus Avenue, Rialto, CA 92376-7207"], ["Eisenhower Senior High", "1321 North Lilac Avenue, Rialto, CA 92376-3201"], ["Rim of the World Senior High", "27400 Highway 18, Lake Arrowhead, CA 92352-0430"], ["Options for Youth-San Bernardino", "985-A South E Street, San Bernardino, CA 92408"], ["Indian Springs High", "650 North Del Rosa Drive, San Bernardino, CA 92410-4669"], ["San Andreas High", "3232 East Pacific Street, Highland, CA 92346-2499"], ["Provisional Accelerated Learning Academy", "2450 Blake Street, San Bernardino, CA 92407-6104"], ["Arroyo Valley High", "1881 West Baseline Street, San Bernardino, CA 92411-1650"], ["Cajon High", "1200 Hill Drive, San Bernardino, CA 92407-2932"], ["Sierra High", "570 East Ninth Street, San Bernardino, CA 92410-3898"], ["Pacific High", "1020 Pacific Street, San Bernardino, CA 92404-6228"], ["San Bernardino High", "1850 North E Street, San Bernardino, CA 92405"], ["San Gorgonio High", "2299 East Pacific Avenue, San Bernardino, CA 92404-6172"], ["Anderson", "24302 East Fourth Street, San Bernardino, CA 92410-4919"], ["Roosevelt Elementary", "1554 Garner Avenue, San Bernardino, CA 92411-1823"], ["Adelanto High", "15620 Joshua Street, Adelanto, CA 92392-5600"], ["Goodwill High", "16350 Mojave Drive, Victorville, CA 92395-3655"], ["Options for Youth-Victorville Charter", "15048 Bear Valley Road, Victorville, CA 92392-9235"], ["Excelsior Charter", "18422 Bear Valley Road, Building 11, Victorville, CA 92395-5850"], ["Silverado High", "14048 Cobalt Road, Victorville, CA 92392-9316"], ["Victor Valley High", "16500 Mojave Drive, Victorville, CA 92395-3822"], ["Yucaipa High", "33000 Yucaipa Boulevard, Yucaipa, CA 92399-1951"], ["Congressman Jerry Lewis Elementary", "1800 Blackhawk Street, Fort Irwin, CA 92310-1700"], ["Serrano High", "9292 Sheep Creek Road, Phelan, CA 92329-6000"], ["Chaparral High", "9258 Malpaso Road, Phelan, CA 92329-6000"], ["Mirus Secondary", "14073 Main Street, Suite 103, Hesperia, CA 92345-4675"], ["Canyon Ridge High", "12850 Muscatel Avenue, Hesperia, CA 92344-5566"], ["Oak Hills High", "7625 Cataba Road, Oak Hills, CA 92344-8713"], ["Hesperia High", "9898 Maple Avenue, Hesperia, CA 92345-3643"], ["Mojave High", "16633 Lemon, Hesperia, CA 92345-2133"], ["Sultana High", "17311 Sultana Avenue, Hesperia, CA 92345-6567"], ["Shadow Ridge", "12850 Muscatel Street, Hesperia, CA 92345-5566"], ["Sky Mountain Charter", "4535 Missouri Flat Road, Suite 1A, Placerville, CA 95667-5729"], ["Upland High", "565 West 11th Street, Upland, CA 91786-4660"], ["Apple Valley High", "11837 Navajo Road, Apple Valley, CA 92308-7653"], ["Granite Hills High", "22900 Esaws Road, Apple Valley, CA 92307-4305"], ["High Desert Premier Academy", "21950 Nisqually Road, Apple Valley, CA 92308-7256"], ["San Diego County Community", "6401 Linda Vista Road, Room 216, San Diego, CA 92111-7399"], ["San Diego County Court", "2801 Meadow Lark Drive, San Diego, CA 92123"], ["Feaster (Mae L.) Charter", "670 Flower Street, Chula Vista, CA 91910-1327"], ["Coronado High", "650 D Avenue, Coronado, CA 92118-2113"], ["Diego Hills Charter", "4585 College Avenue, San Diego, CA 92115-4011"], ["San Pasqual High", "3300 Bear Valley Parkway, Escondido, CA 92025-7636"], ["Escondido Charter High", "1868 East Valley Parkway, Escondido, CA 92027-2525"], ["Valley High (Continuation)", "410 North Hidden Trails Road, Escondido, CA 92027-5333"], ["Escondido High", "1535 North Broadway, Escondido, CA 92026-2015"], ["Orange Glen High", "2200 Glen Ridge Road, Escondido, CA 92027-4115"], ["Fallbrook High", "2400 South Stage Coach Lane, Fallbrook, CA 92028-4429"], ["Valhalla High", "1725 Hillsdale Road, El Cajon, CA 92019-3742"], ["West Hills High", "8756 Mast Boulevard, Santee, CA 92071-2046"], ["Steele Canyon High", "12440 Campo Road, Spring Valley, CA 91978-2331"], ["El Cajon Valley High", "1035 East Madison Avenue, El Cajon, CA 92021-6226"], ["El Capitan High", "10410 Ashwood Street, Lakeside, CA 92040-2406"], ["Granite Hills High", "1719 East Madison Avenue, El Cajon, CA 92019-1052"], ["Chaparral High", "1600 North Cuyamaca Street, El Cajon, CA 92020-1187"], ["Grossmont High", "1100 Murray Drive, La Mesa, CA 91944-1043"], ["Helix High", "7323 University Avenue, La Mesa, CA 91941-6055"], ["Monte Vista High", "3230 Sweetwater Springs Boulevard, Spring Valley, CA 91977-6934"], ["Mount Miguel High", "8585 Blossom Lane, Spring Valley, CA 91977-3765"], ["Santana High", "9915 North Magnolia Avenue, Santee, CA 92071-1903"], ["Diego Valley Charter", "511 North 2nd Street, El Cajon, CA 92021-6449"], ["Julian Charter", "1704 Cape Horn, Julian, CA 92036"], ["National University Academy", "2030 University Drive, Vista, CA 92083-7736"], ["Eucalyptus Hills Elementary", "11838 Valle Vista Road, Lakeside, CA 92040-1046"], ["San Diego Virtual", "3291 Buckman Springs Road, Pine Valley, CA 91962-5579"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "850 Hampshire Road Suite C, Thousand Oaks, CA 91361-2851"], ["Del Norte High", "16601 Nighthawk Lane, San Diego, CA 92127-4457"], ["Mt. Carmel High", "9550 Carmel Mountain Road, San Diego, CA 92129-2799"], ["Rancho Bernardo High", "13010 Paseo Lucido, San Diego, CA 92128-4499"], ["Westview High", "13500 Camino Del Sur, San Diego, CA 92129-4465"], ["Abraxas Continuation High", "12450 Glenoak Road, Poway, CA 92064-3299"], ["Poway High", "15500 Espola Road, Poway, CA 92064-2299"], ["Montecito High (Continuation)", "720 Ninth Street, Ramona, CA 92065-2348"], ["Ramona High", "1401 Hanson Lane, Ramona, CA 92065-3304"], ["Crawford High", "4191 Colts Way, San Diego, CA 92115-6023"], ["Lincoln High", "4777 Imperial Avenue, San Diego, CA 92113-2071"], ["Laurel Preparatory Academy", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Serra High", "5156 Santo Road, San Diego, CA 92124-2037"], ["Mira Mesa High", "10510 Reagan Road, San Diego, CA 92126-3275"], ["Twain High", "6402 Linda Vista Road, San Diego, CA 92111-7320"], ["Scripps Ranch High", "10410 Treena Street, San Diego, CA 92131-1126"], ["Charter School of San Diego", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["TRACE", "2555 Camino Del Rio South, Suite 150, San Diego, CA 92108-3710"], ["Clairemont High", "4150 Ute Drive, San Diego, CA 92117-5853"], ["Audeo Charter", "10170 Huennekens Street, San Diego, CA 92121-2964"], ["Henry High", "6702 Wandermere Drive, San Diego, CA 92120-3250"], ["Hoover High", "4474 El Cajon Boulevard, San Diego, CA 92115-4312"], ["La Jolla High", "750 Nautilus Street, La Jolla, CA 92037-6103"], ["Madison High", "4833 Doliva Drive, San Diego, CA 92117-3211"], ["Mission Bay High", "2475 Grand Avenue, San Diego, CA 92109-4825"], ["Morse High", "6905 Skyline Drive, San Diego, CA 92114-5928"], ["Point Loma High", "2335 Chatsworth Boulevard, San Diego, CA 92106-1646"], ["Garfield High", "1255 16th Street, San Diego, CA 92101-4759"], ["Doyle Elementary", "3950 Berino Court, San Diego, CA 92122-1601"], ["Canyon Crest Academy", "5951 Village Center Loop Road, San Diego, CA 92130-2499"], ["Torrey Pines High", "3710 Del Mar Heights Road, San Diego, CA 92130-1316"], ["La Costa Canyon High", "1 Maverick Way, Encinitas, CA 92009"], ["Smythe Elementary", "1880 Smythe Avenue, San Ysidro, CA 92173-1599"], ["George Nicoloff Elementary", "1777 Howard Avenue, San Ysidro, CA 92173-1235"], ["California Virtual Academy @ San Diego", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["None", "1130 Fifth Avenue, Chula Vista, CA 91911-2812"], ["Olympian High", "1925 Magdalena Avenue, Chula Vista, CA 91913-3973"], ["Southwest Senior High", "1685 Hollister Street, San Diego, CA 92154-4548"], ["Bonita Vista Senior High", "751 Otay Lakes Road, Chula Vista, CA 91913-2004"], ["Castle Park Senior High", "1395 Hilltop Drive, Chula Vista, CA 91911-4529"], ["Eastlake High", "1120 Eastlake Parkway, Chula Vista, CA 91915-2102"], ["Chula Vista Senior High", "820 Fourth Avenue, Chula Vista, CA 91911-1102"], ["MAAC Community Charter", "1385 Third Avenue, Chula Vista, CA 91911-4302"], ["San Ysidro High", "5353 Airway Road, San Diego, CA 92154-4806"], ["Otay Ranch Senior High", "1250 Olympic Parkway, Chula Vista, CA 91913-1900"], ["Palomar High", "480 Palomar Street, Chula Vista, CA 91911-3098"], ["Hilltop Senior High", "555 Claire Avenue, Chula Vista, CA 91910-6105"], ["Mar Vista Senior High", "505 Elm Avenue, Imperial Beach, CA 91932-2027"], ["Sweetwater High", "2900 Highland Avenue, National City, CA 91950-7415"], ["Montgomery Senior High", "3250 Palm Avenue, San Diego, CA 92154-1507"], ["SIATech", "2611 Temple Heights Drive, Suite A, Oceanside, CA 92056-3582"], ["Major General Raymond Murray High", "215 North Melrose Drive, Vista, CA 92083-5720"], ["Mission Vista High", "1306 Melrose Drive, Oceanside, CA 92057-4649"], ["Vista Adult Transition Center", "325 East Bobier Drive, Vista, CA 92084-3027"], ["Rancho Buena Vista High", "1601 Longhorn Drive, Vista, CA 92081-5423"], ["Alta Vista High (Continuation)", "1575 Bonair Drive, Vista, CA 92084-3572"], ["Vista High", "1 Panther Drive, Vista, CA 92084-3101"], ["Carlsbad High", "3557 Monroe Street, Carlsbad, CA 92008-2729"], ["Pacific View Charter", "3670 Ocean Ranch Boulevard, Oceanside, CA 92056-2669"], ["Oceanside High", "1 Pirates Cove Way, Oceanside, CA 92054-3066"], ["El Camino High", "400 Rancho del Oro Drive, Oceanside, CA 92057-8316"], ["Mission Hills High", "1 Mission Hills Court, San Marcos, CA 92069-1965"], ["San Marcos High", "1615 San Marcos Boulevard, San Marcos, CA 92078-4020"], ["Valley Center High", "31322 Cole Grade Road, Valley Center, CA 92082-3867"], ["Valley Center Primary", "14249 Fruitvale Road, Valley Center, CA 92082-5907"], ["S.F. County Civic Center Secondary", "727 Golden Gate Avenue, San Francisco, CA 94102-3101"], ["None", "555 Franklin Street, San Francisco, CA 94102-5207"], ["Five Keys Charter (SF Sheriff's)", "1 Moreland Drive, San Bruno, CA 94066-1670"], ["Five Keys Adult School (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["Five Keys Independence HS (SF Sheriff's)", "70 Oak Grove, San Francisco, CA 94107-1019"], ["S.F. International High", "1050 York Street, San Francisco, CA 94110-3420"], ["Gateway to College", "50 Phelan Avenue Science Hall, Room 127, San Francisco, CA 94112-1821"], ["Wells (Ida B.) High", "1099 Hayes Street, San Francisco, CA 94117-1621"], ["Downtown High", "693 Vermont Street, San Francisco, CA 94107-2635"], ["Independence High", "1350 7th Avenue, San Francisco, CA 94122-2508"], ["Wallenberg (Raoul) Traditional High", "40 Vega Street, San Francisco, CA 94115-3826"], ["Burton (Phillip and Sala) Academic High", "400 Mansell Street, San Francisco, CA 94134-1829"], ["Balboa High", "1000 Cayuga Avenue, San Francisco, CA 94112-3236"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "555 Portola Drive, San Francisco, CA 94131-1616"], ["Marshall (Thurgood) High", "45 Conkling Street, San Francisco, CA 94124-1931"], ["Galileo High", "1150 Francisco Street, San Francisco, CA 94109-1004"], ["Lincoln (Abraham) High", "2162 24th Avenue, San Francisco, CA 94116-1723"], ["Lowell High", "1101 Eucalyptus Drive, San Francisco, CA 94132-1401"], ["Mission High", "3750 18th Street, San Francisco, CA 94114-2614"], ["Washington (George) High", "600 32nd Avenue, San Francisco, CA 94121-2733"], ["San Joaquin Building Futures Academy", "3100 Monte Diablo Avenue, Stockton, CA 95203-1108"], ["San Joaquin County Community", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Venture Academy", "2829 Transworld Drive, Stockton, CA 95206-3950"], ["San Joaquin County Special Education", "2707 Transworld Drive, Stockton, CA 95206-3948"], ["Lincoln High", "6844 Alexandria Place, Stockton, CA 95207-2401"], ["Ellerth E. Larson Elementary", "2375 Giannoni Way, Lodi, CA 95242-4795"], ["Ronald E. McNair High", "9550 Ronald East McNair Way, Stockton, CA 95210-2800"], ["Podesta Ranch Elementary", "9950 Windmill Park Drive, Stockton, CA 95209-4326"], ["Bear Creek High", "10555 Thornton Road, Stockton, CA 95209-4100"], ["Plaza Robles Continuation High", "9434 Thornton Road, Stockton, CA 95209-1263"], ["Independence", "13451 North Extension Road, Lodi, CA 95242-9249"], ["Tokay High", "1111 West Century Boulevard, Lodi, CA 95240-6605"], ["Liberty High", "660 West Walnut Street, Lodi, CA 95240-3437"], ["Lodi High", "3 South Pacific Avenue, Lodi, CA 95242-3020"], ["Lathrop High", "647 West Lathrop Road, Lathrop, CA 95330-9770"], ["Sierra High", "1700 Thomas Street, Manteca, CA 95336-0032"], ["East Union High", "1700 North Union Road, Manteca, CA 95336-9217"], ["Manteca High", "450 East Yosemite Avenue, Manteca, CA 95336-5718"], ["Calla High", "130 South Austin Road, Manteca, CA 95336-9710"], ["Golden West Elementary", "1031 North Main Street, Manteca, CA 95336-3207"], ["California Virtual Academy @ San Joaquin", "50 Moreland Road, Simi Valley, CA 93065-1800"], ["Renew Virtual Academy K12 #1", "343 E. Main Street Suite 715, Stockton, CA 95202"], ["Delta Charter Online", "31400 S. Koster Road, Tracy, CA 95304-8824"], ["Cesar Chavez High", "2929 Windflower Lane, Stockton, CA 95212-2732"], ["Stockton High", "22 South Van Buren Street, Stockton, CA 95202-3118"], ["Jane Frederick High", "1141 East Weber Avenue, Stockton, CA 95205-4916"], ["Edison High", "100 W Dr Martin Luther King Blv, Stockton, CA 95206-2016"], ["Franklin High", "300 North Gertrude Street, Stockton, CA 95215-4820"], ["Stagg Senior High", "1621 Brookside Road, Stockton, CA 95207-7804"], ["Walton Development Center", "4131 North Crown Avenue, Stockton, CA 95207-6909"], ["George and Evelyn Stein Continuation", "650 West 10th Street, Tracy, CA 95376"], ["John C. Kimball High", "3200 Jaguar Run, Tracy, CA 95377-7216"], ["Merrill F. West High", "1775 West Lowell Avenue, Tracy, CA 95376-2200"], ["Tracy High", "315 East 11th Street, Tracy, CA 95376-4017"], ["South/West Park Elementary", "500 West Mount Diablo Road, Tracy, CA 95376-4625"], ["Grizzly ChalleNGe Charter", "721 Mendocino Avenue Camp San Luis Obispo, San Luis Obispo, CA 93405-7605"], ["Atascadero High", "1 High School Hill, Atascadero, CA 93422-4189"], ["Nipomo High", "525 North Thompson Road, Nipomo, CA 93444-9086"], ["Arroyo Grande High", "495 Valley Road, Arroyo Grande, CA 93420-3928"], ["San Luis Obispo High", "1499 San Luis Drive, San Luis Obispo, CA 93401-3060"], ["Paso Robles High", "801 Niblick Road, Paso Robles, CA 93446-3409"], ["Liberty High (Continuation)", "810 Niblick Road, Paso Robles, CA 93446-4858"], ["San Mateo County Special Education", "101 Twin Dolphin Drive, Redwood City, CA 94065-1064"], ["Nesbit Elementary", "500 Biddulph Way, Belmont, CA 94002-2711"], ["McKinley Elementary", "701 Paloma Avenue, Burlingame, CA 94010-3728"], ["Half Moon Bay High", "Lewis Foster Drive, Half Moon Bay, CA 94019"], ["Jefferson High", "6996 Mission Street, Daly City, CA 94014-2035"], ["Westmoor High", "131 Westmoor Avenue, Daly City, CA 94015-3843"], ["Burlingame High", "1 Mangini Way, Burlingame, CA 94010-2708"], ["Hillsdale High", "3115 Del Monte Street, San Mateo, CA 94403-3800"], ["Carlmont High", "1400 Alameda de Las Pulgas, Belmont, CA 94002-3585"], ["Menlo-Atherton High", "555 Middlefield Road, Atherton, CA 94025-3438"], ["Redwood High", "1968 Old County Road, Redwood City, CA 94063-1073"], ["Sequoia High", "1201 Brewster Avenue, Redwood City, CA 94062-1378"], ["Woodside High", "199 Churchill Avenue, Woodside, CA 94062-2306"], ["South San Francisco High", "400 B Street, South San Francisco, CA 94080-4425"], ["Cabrillo High", "4350 Constellation Road, Lompoc, CA 93436-1003"], ["Maple High", "4010 Jupiter Ave, Lompoc, CA 93436-1819"], ["Lompoc High", "515 West College Avenue, Lompoc, CA 93436-4401"], ["Joe Nightingale Elementary", "255 Winter Road, Santa Maria, CA 93455-2643"], ["Pioneer Valley High", "675 Panther Drive, Santa Maria, CA 93454-9700"], ["Delta High", "4893 Bethany Lane, Santa Maria, CA 93455-4880"], ["Ernest Righetti High", "941 East Foster Road, Santa Maria, CA 93455-3318"], ["Santa Maria High", "901 South Broadway, Santa Maria, CA 93454-6603"], ["Santa Ynez Valley Union High", "2975 East Highway 246, Santa Ynez, CA 93460-0398"], ["Alta Vista Alternative High", "215 East Ortega Street, Santa Barbara, CA 93101-1661"], ["Dos Pueblos Senior High", "7266 Alameda Avenue, Goleta, CA 93117-1351"], ["San Marcos Senior High", "4750 Hollister Avenue, Santa Barbara, CA 93110-1921"], ["Santa Barbara Senior High", "700 East Anapamu Street, Santa Barbara, CA 93103-2384"], ["Rocketship Fuerza Community Prep", "70 South Jackson Avenue, San Jose, CA 95116-2506"], ["Santa Clara County Special Education", "1290 Ridder Park Drive, MC271, San Jose, CA 95131-2304"], ["Vinci Park Elementary", "1311 Vinci Park Way, San Jose, CA 95131-2792"], ["Fammatre Elementary", "2800 New Jersey Avenue, San Jose, CA 95124-1556"], ["Boynton High", "901 Boynton Avenue, San Jose, CA 95117-2006"], ["Del Mar High", "1224 Del Mar Avenue, San Jose, CA 95128-3529"], ["Westmont High", "4805 Westmont Avenue, Campbell, CA 95008-5725"], ["Chester W. Nimitz Elementary", "545 East Cheyenne Drive, Sunnyvale, CA 94087-4421"], ["John Muir Elementary", "6560 Hanover Drive, San Jose, CA 95129-3832"], ["William Regnart Elementary", "1170 Yorkshire Drive, Cupertino, CA 95014-4963"], ["Escuela Popular/Center for Training and Careers, Family Learning", "149 North White Road, San Jose, CA 95127-1612"], ["Calero High", "420 Calero Avenue, San Jose, CA 95123-4240"], ["Yerba Buena High", "1855 Lucretia Avenue, San Jose, CA 95122-3730"], ["Santa Teresa High", "6150 Snell Road, San Jose, CA 95123-4740"], ["Independence High", "1776 Educational Park Drive, San Jose, CA 95133-1703"], ["San Jose Conservation Corps Charter", "1560 Berger Drive, San Jose, CA 95112-2703"], ["Escuela Popular Accelerated Family Learning", "467 North White Road, San Jose, CA 95127-1936"], ["Foothill High", "230 Pala Avenue, San Jose, CA 95127-1862"], ["Andrew P. Hill High", "3200 Senter Road, San Jose, CA 95111-1332"], ["James Lick High", "57 North White Road, San Jose, CA 95127-1933"], ["Mt. Pleasant High", "1750 South White Road, San Jose, CA 95127-4760"], ["Oak Grove High", "285 Blossom Hill Road, San Jose, CA 95123-2048"], ["William C. Overfelt High", "1835 Cunningham Avenue, San Jose, CA 95122-1712"], ["Silver Creek High", "3434 Silver Creek Road, San Jose, CA 95121-1845"], ["Rocketship Spark Academy", "683 Sylvandale Avenue, San Jose, CA 95111-1414"], ["Cupertino High", "10100 Finch Avenue, Cupertino, CA 95014-3411"], ["Fremont High", "1279 Sunnyvale-Saratoga Road, Sunnyvale, CA 94087-2535"], ["Homestead High", "21370 Homestead Road, Cupertino, CA 95014-0203"], ["Lynbrook High", "1280 Johnson Avenue, San Jose, CA 95129-4172"], ["Christopher High", "850 Day Road, Gilroy, CA 95020-9324"], ["Gilroy High", "750 West Tenth Street, Gilroy, CA 95020-6333"], ["Mt. Madonna High", "8750 Hirasaki Court, Gilroy, CA 95020-7531"], ["Eliot Elementary", "475 Old Gilroy Street, Gilroy, CA 95020-6214"], ["Antonio Del Buono Elementary", "9300 Wren Avenue, Gilroy, CA 95020-7636"], ["Los Gatos High", "20 High School Court, Los Gatos, CA 95030-6917"], ["Saratoga High", "20300 Herriman Avenue, Saratoga, CA 95070-4950"], ["Ann Sobrato High", "401 Burnett Avenue, Morgan Hill, CA 95037-2641"], ["Live Oak High", "1505 East Main Avenue, Morgan Hill, CA 95037-3217"], ["Central High (Continuation)", "85 Tilton Avenue, Morgan Hill, CA 95037-2504"], ["El Toro Elementary", "455 East Main Avenue, Morgan Hill, CA 95037-3745"], ["Mariano Castro Elementary", "505 Escuela Avenue, Mountain View, CA 94040-2006"], ["Los Altos High", "201 Almond Avenue, Los Altos, CA 94022-2206"], ["Mountain View High", "3535 Truman Avenue, Mountain View, CA 94040-4559"], ["Henry M. Gunn High", "780 Arastradero Road, Palo Alto, CA 94306-3827"], ["Palo Alto High", "50 Embarcadero Road, Palo Alto, CA 94301-2321"], ["Greendell", "4120 Middlefield Road, Palo Alto, CA 94303-4741"], ["Liberty High (Alternative)", "5845 Allen Avenue, Suite 2, San Jose, CA 95123-2619"], ["Downtown College Preparatory", "1402 Monterey Highway, San Jose, CA 95110-3617"], ["Broadway High", "4825 Speak Lane, San Jose, CA 95118-3769"], ["Leland High", "6677 Camden Avenue, San Jose, CA 95120-2142"], ["Abraham Lincoln High", "555 Dana Avenue, San Jose, CA 95126-2002"], ["Pioneer High", "1290 Blossom Hill Road, San Jose, CA 95118-3126"], ["Willow Glen High", "2001 Cottle Avenue, San Jose, CA 95125-3502"], ["Santa Clara High", "3000 Benton Street, Santa Clara, CA 95051-3736"], ["Wilson Alternative", "1840 Benton Street, Santa Clara, CA 95050-5215"], ["Adrian Wilcox High", "3250 Monroe Street, Santa Clara, CA 95051-1153"], ["Athenour Early Childhood Education Center", "5200 Dent Ave, San Jose, CA 95118-2258"], ["Milpitas High", "1285 Escuela Parkway, Milpitas, CA 95035-3221"], ["Santa Cruz County Community", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Santa Cruz County Special Education", "400 Encinal Street, Santa Cruz, CA 95060-2115"], ["Pajaro Valley High", "500 Harkins Slough Road, Watsonville, CA 95076-9453"], ["Aptos High", "100 Mariner Way, Aptos, CA 95003-9641"], ["Watsonville High", "250 East Beach Street, Watsonville, CA 95076-4831"], ["Ocean Grove Charter", "16900 North Highway Nine, Boulder Creek, CA 95006"], ["Harbor High", "300 La Fonda Avenue, Santa Cruz, CA 95062-1431"], ["Santa Cruz High", "415 Walnut Avenue, Santa Cruz, CA 95060-3633"], ["Foothill High", "9733 Deschutes Road, Palo Cedro, CA 96073-8644"], ["Enterprise High", "3411 Churn Creek Road, Redding, CA 96002-2798"], ["Solano County Special Education", "Golden Hills Education Center 2460 Clay Bank Road, Building 8, Fairfield, CA 94533-1615"], ["Benicia High", "1101 Military West, Benicia, CA 94510-2428"], ["Angelo Rodriguez High", "5000 Red Top Road, Fairfield, CA 94534-9527"], ["Armijo High", "824 Washington Street, Fairfield, CA 94533-5541"], ["Fairfield High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Sem Yeto Continuation High", "205 East Atlantic Avenue, Fairfield, CA 94533-1626"], ["Oakbrook Elementary", "700 Oakbrook Drive, Fairfield, CA 94534-6841"], ["Vanden High", "2951 Markeley Lane, Fairfield, CA 94533-6513"], ["Will C. Wood High", "998 Marshall Road, Vacaville, CA 95687-5735"], ["Country High", "100-B McClellan Street, Vacaville, CA 95688-3937"], ["Vacaville High", "100 Monte Vista Avenue, Vacaville, CA 95688-3829"], ["Eugene Padan Elementary", "200 Padan School Road, Vacaville, CA 95687-5444"], ["Jesse M. Bethel High", "1800 Ascot Parkway, Vallejo, CA 94591-8367"], ["John Finney High (Continuation)", "233 Hobbs Avenue, Vallejo, CA 94589-2325"], ["Vallejo High", "840 Nebraska Street, Vallejo, CA 94590-3368"], ["Vallejo Adult Transition", "425 Corcoran Ave, Vallejo, CA 94589-1768"], ["Sonoma County Special Education", "5340 Skylane Boulevard, Santa Rosa, CA 95403-8246"], ["Gateway to College Academy", "680 Sonoma Mountain Parkway Santa Rosa Junior College, Petaluma, CA 94954-8553"], ["Casa Grande High", "333 Casa Grande Road, Petaluma, CA 94954-5706"], ["Elsie Allen High", "599 Bellevue Avenue, Santa Rosa, CA 95407-7713"], ["Montgomery High", "1250 Hahman Drive, Santa Rosa, CA 95405-6934"], ["Piner High", "1700 Fulton Road, Santa Rosa, CA 95403-1815"], ["Ridgway High (Continuation)", "325 Ridgway Avenue, Santa Rosa, CA 95401-4334"], ["Santa Rosa High", "1235 Mendocino Avenue, Santa Rosa, CA 95401-4312"], ["Sonoma Valley High", "20000 Broadway, Sonoma, CA 95476-7413"], ["Rancho Cotate High", "5450 Snyder Lane, Rohnert Park, CA 94928-2906"], ["Windsor High", "8695 Windsor Road, Windsor, CA 95492-9511"], ["Mattie Washburn Elementary", "75 Pleasant Avenue, Santa Rosa, CA 95403-1130"], ["Stanislaus Alternative Charter", "1120 13th Street, Suite C, Modesto, CA 95354-0908"], ["Stanislaus County Institute of Learning", "3113 Mitchell Road, Ceres, CA 95307-9458"], ["Central Valley High", "4033 Central Avenue, Ceres, CA 95307-7507"], ["Endeavor Alternative", "2555 Lawrence Street, Ceres, CA 95307-3341"], ["Argus High (Continuation)", "2555 Lawrence Street, Ceres, CA 95307-0307"], ["Ceres High", "2320 Central Avenue, Ceres, CA 95307-2502"], ["Denair Charter Academy", "3460 Lester Road, Denair, CA 95316-9502"], ["Sonoma Elementary", "1325 Sonoma Avenue, Modesto, CA 95355-3999"], ["James C. Enochs High", "3201 Sylvan Avenue, Modesto, CA 95355-7893"], ["Joseph A. Gregori High", "3701 Pirrone Road, Modesto, CA 95356-9048"], ["Fred C. Beyer High", "1717 Sylvan Avenue, Modesto, CA 95355-1399"], ["Peter Johansen High", "641 Norseman Drive, Modesto, CA 95357-0405"], ["Grace M. Davis High", "1200 West Rumble Road, Modesto, CA 95350-2198"], ["Thomas Downey High", "1000 Coffee Road, Modesto, CA 95355-4275"], ["Modesto High", "18 H Street, Modesto, CA 95351-3203"], ["Robert Elliott Alternative Education Center", "1440 Sunrise Avenue, Modesto, CA 95350-4643"], ["Patterson High", "200 North Seventh Street, Patterson, CA 95363-2215"], ["Crossroads Elementary", "5800 Saxon Way, Riverbank, CA 95367-9559"], ["Sherwood Elementary", "819 Rumble Road, Modesto, CA 95350-2414"], ["Hunt Elementary", "907 R Street, Newman, CA 95360-1124"], ["Oakdale High", "739 West G Street, Oakdale, CA 95361-3739"], ["Connecting Waters Charter", "12420 Bentley Street, Waterford, CA 95386-9150"], ["John H. Pitman High", "2525 West Christofferson Parkway, Turlock, CA 95382-9509"], ["Turlock High", "1600 East Canal Drive, Turlock, CA 95380-4221"], ["Sutter County Special Education", "970 Klamath Lane, Yuba City, CA 95993-8961"], ["South Sutter Charter", "2452 El Centro Boulevard, East Nicolaus, CA 95659-9748"], ["River Valley High", "801 El Margarita Road, Yuba City, CA 95993-9363"], ["Yuba City High", "850 B Street, Yuba City, CA 95991-4926"], ["Red Bluff High", "1260 Union Street, Red Bluff, CA 96080-3121"], ["Special Education", "6200 South Mooney Boulevard, Visalia, CA 93277"], ["Orosi High", "41815 Road 128, Orosi, CA 93647-2008"], ["Crescent Valley Public Charter", "309 West Main Street, Suite 110, Visalia, CA 93291-6257"], ["Heritage Elementary", "895 West Gail Avenue, Tulare, CA 93274-1236"], ["Mission Oak High", "3442 East Bardsley Avenue, Tulare, CA 93274-6148"], ["Tulare Union High", "755 East Tulare Avenue, Tulare, CA 93274-4353"], ["Tulare Western High", "824 West Maple Avenue, Tulare, CA 93274-2699"], ["Visalia Charter Independent Study", "1821 West Meadow Lane, Visalia, CA 93291-2247"], ["Golden West High", "1717 North McAuliff Road, Visalia, CA 93292-9310"], ["El Diamante High", "5100 West Whitendale Avenue, Visalia, CA 93277-5604"], ["Mt. Whitney High", "900 South Conyer Street, Visalia, CA 93277-2535"], ["Redwood High", "1001 West Main Street, Visalia, CA 93291-5919"], ["Sequoia High", "901 North Mooney Boulevard, Visalia, CA 93291-3228"], ["Farmersville High", "631 East Walnut Avenue, Farmersville, CA 93223-2203"], ["J. E. Hester Elementary", "477 East Ash Street, Farmersville, CA 93223-1209"], ["Butterfield Charter High", "900 West Pioneer Avenue, Porterville, CA 93257-1240"], ["Granite Hills High", "1701 East Putnam Avenue, Porterville, CA 93257-8000"], ["Monache High", "960 North Newcomb Street, Porterville, CA 93257-1302"], ["Porterville High", "465 West Olive Avenue, Porterville, CA 93257-3331"], ["Ronald Reagan Academy", "470 Avenue 406, Dinuba, CA 93618"], ["Dinuba High", "340 East Kern Street, Dinuba, CA 93618-1825"], ["Sonora High", "430 North Washington Street, Sonora, CA 95370-5526"], ["Vista Real Charter High", "401 South A Street, Suite 3, Oxnard, CA 93030-5278"], ["Ventura County Special Education", "5189 Verdugo Way, Camarillo, CA 93012-8603"], ["Fillmore Senior High", "555 Central Avenue, Fillmore, CA 93015-1331"], ["Harrington Elementary", "451 East Olive Street, Oxnard, CA 93033-4699"], ["McKinna Elementary", "1611 South J Street, Oxnard, CA 93033-3110"], ["Christa McAuliffe Elementary", "3300 West Via Marina Avenue, Oxnard, CA 93035-2440"], ["Emilie Ritchen Elementary", "2200 Cabrillo Way, Oxnard, CA 93030-3106"], ["Condor High", "309 South K St, Oxnard, CA 93030-5212"], ["Frontier High", "545 Airport Way, Camarillo, CA 93010-8581"], ["Pacifica High", "600 East Gonzales Road, Oxnard, CA 93036-8266"], ["Adolfo Camarillo High", "4660 Mission Oaks Boulevard, Camarillo, CA 93012-5132"], ["Channel Islands High", "1400 Raiders Way, Oxnard, CA 93033-5699"], ["Hueneme High", "500 West Bard Road, Oxnard, CA 93033-6306"], ["Oxnard High", "3400 West Gonzales Road, Oxnard, CA 93036-7768"], ["Rio Mesa High", "545 Central Avenue, Oxnard, CA 93030-1045"], ["Apollo High", "3150 School Street, Simi Valley, CA 93065-3998"], ["Royal High", "1402 Royal Avenue, Simi Valley, CA 93065-3333"], ["Simi Valley High", "5400 Cochran Street, Simi Valley, CA 93063-3547"], ["Berylwood Elementary", "2300 Heywood Street, Simi Valley, CA 93065-3622"], ["Buena High", "5670 Telegraph Road, Ventura, CA 93003-4204"], ["Ventura High", "2 North Catalina Street, Ventura, CA 93001-3503"], ["Westlake High", "100 North Lakeview Canyon Road, Westlake Village, CA 91362-3895"], ["Newbury Park High", "456 North Reino Road, Newbury Park, CA 91320-3798"], ["Thousand Oaks High", "2323 North Moorpark Road, Thousand Oaks, CA 91360-3198"], ["Oak Park High", "899 Kanan Road, Oak Park, CA 91377-3904"], ["Moorpark High", "4500 Tierra Rejada Road, Moorpark, CA 93021-9772"], ["Santa Paula High", "404 North Sixth Street, Santa Paula, CA 93060-2008"], ["Davis Senior High", "315 West 14th Street, Davis, CA 95616-1914"], ["River City High", "1 Raider Lane, West Sacramento, CA 95691-4619"], ["Southport Elementary", "2747 Linden Road, West Sacramento, CA 95691-4258"], ["Woodland Senior High", "21 North West Street, Woodland, CA 95695-2611"], ["Yuba County Career Preparatory Charter", "1104 E Street, Marysville, CA 95901-4825"], ["Lindhurst High", "4446 Olive Drive, Olivehurst, CA 95961-4738"], ["Lincoln (Abraham) (Alternative)", "1949 B Street, Marysville, CA 95901-3731"]], "spark_error": null, "total_time": 17.24860382080078, "spark_time": 0.2129988670349121, "translation_time": 17.03560495376587, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='97da6d9b-38cf-4abd-ae3f-18ecf60867ed'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='c2f7a37a-0f50-4645-a6b2-29f57f5a3e60'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Quoting identifiers:** Column names with spaces (`Enrollment (K-12)`, `Enrollment (Ages 5-17)`) are correctly quoted using backticks (` `). Other standard column names and aliases do not require quoting.\\n*   **Data types:** The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` assumes these are numeric types, which is appropriate for enrollment figures. The comparison `> 30` is also valid for numeric types.\\n*   **Functions:** `CONCAT` is used correctly with the appropriate number of arguments and string literals are properly enclosed in single quotes.\\n*   **Joins:** The join condition `s.CDSCode = f.CDSCode` uses the correct columns for linking the two tables.\\n*   Other potential issues like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, and explicit casting are not present in this query.\\n\\nHere is the original query, as it is correct:\\n\\n```sql\\nSELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\\n```\" name='query_checker_sql_db' tool_call_id='561afad9-be32-46f7-94be-51aeae6bfaef'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}"], "input_tokens": 4616, "output_tokens": 1926, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools. Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, CONCAT(s.Street, \\', \\', s.City, \\', \\', s.State, \\' \\', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **Quoting identifiers:** Column names with spaces (`Enrollment (K-12)`, `Enrollment (Ages 5-17)`) are correctly quoted using backticks (` `). Other standard column names and aliases do not require quoting.\n*   **Data types:** The arithmetic operation `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`)` assumes these are numeric types, which is appropriate for enrollment figures. The comparison `> 30` is also valid for numeric types.\n*   **Functions:** `CONCAT` is used correctly with the appropriate number of arguments and string literals are properly enclosed in single quotes.\n*   **Joins:** The join condition `s.CDSCode = f.CDSCode` uses the correct columns for linking the two tables.\n*   Other potential issues like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, and explicit casting are not present in this query.\n\nHere is the original query, as it is correct:\n\n```sql\nSELECT s.School, CONCAT(s.Street, ', ', s.City, ', ', s.State, ' ', s.Zip) AS FullStreetAddress FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30\n```", "final_answer": "", "replica": 9, "timestamp": 1768937053.7090733}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["District Office"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["District Office"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["District Office"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["District Office"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["District Office"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["International Studies Learning Center at Legacy High School Complex"], ["Port of Los Angeles High"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["PUC CA Academy for Liberal Studies Early College High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Patti And Peter Neuwirth Leadership Academy"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["School of Business and Tourism at Contreras Learning Complex"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["Contreras Learning Center-Los Angeles School of Global Studies"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Contreras Learning Center-Academic Leadership Community"], ["RFK Community Schools-Los Angeles High School of the Arts"], ["Belmont SH-LA Teacher Preparatory Academy"], ["RFK Community Schools- for the Visual Arts and Humanities"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Ramon C. Cortines School of Visual and Performing Arts"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Cindy and Bill Simon Technology Academy High"], ["Alliance Tennenbaum Family Technology High"], ["Academy of Environmental & Social Policy (ESP) at Roosevelt High"], ["Math, Science, & Technology Magnet Academy at Roosevelt High"], ["East Los Angeles Performing Arts Academy at Esteban E. Torres High No. 1"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Cesar E. Chavez Learning Academies-Arts,Theatre, Entertainment (ArTES)"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy"], ["Los Angeles River at Sonia Sotomayor Learning Academies"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies"], ["Dr. Maya Angelou Community High"], ["Public Service Community at Diego Rivera Learning Complex"], ["Communication and Technology at Diego Rivera Learning Complex"], ["Green Design at Diego Rivera Learning Complex"], ["Performing Arts Community at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["PUC Early College Academy for Leaders and Scholars (ECALS)"], ["STEM Academy at Bernstein High"], ["Augustus F. Hawkins High B Community Health Advocates"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Linda Esperanza Marquez High C School of Social Justice"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex"], ["Visual and Performing Arts at Legacy High School Complex"], ["Academies of Education and Empowerment at Carson High"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["District Office"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["District Office"], ["New Technology High"], ["George Washington Carver School of Arts and Science"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["District Office"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["District Office"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["District Office"], ["Riverside Preparatory"], ["District Office"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["District Office"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Encore Jr./Sr. High School for the Performing and Visual Arts"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["District Office"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["District Office"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["District Office"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School."], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Humphreys College Academy of Business, Law and Education"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["District Office"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["District Office"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["District Office"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["District Office"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["District Office"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 12.462251663208008, "spark_time": 0.290499210357666, "translation_time": 12.171752452850342, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='7379a2d5-78e5-433a-860c-4e2d0ef8ce05'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='5da40010-c29e-4b11-a009-ef633dc35a15'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}", "Observation: content='SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0' name='query_checker_sql_db' tool_call_id='17bd29fd-a2d7-4737-9145-7a8c24ceec70'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}"], "input_tokens": 4451, "output_tokens": 1657, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\"}'}\nTool: SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "final_answer": "", "replica": 0, "timestamp": 1768937067.170901}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["District Office"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["District Office"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["District Office"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["District Office"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["District Office"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["International Studies Learning Center at Legacy High School Complex"], ["Port of Los Angeles High"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["PUC CA Academy for Liberal Studies Early College High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Patti And Peter Neuwirth Leadership Academy"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["School of Business and Tourism at Contreras Learning Complex"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["Contreras Learning Center-Los Angeles School of Global Studies"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Contreras Learning Center-Academic Leadership Community"], ["RFK Community Schools-Los Angeles High School of the Arts"], ["Belmont SH-LA Teacher Preparatory Academy"], ["RFK Community Schools- for the Visual Arts and Humanities"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Ramon C. Cortines School of Visual and Performing Arts"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Cindy and Bill Simon Technology Academy High"], ["Alliance Tennenbaum Family Technology High"], ["Academy of Environmental & Social Policy (ESP) at Roosevelt High"], ["Math, Science, & Technology Magnet Academy at Roosevelt High"], ["East Los Angeles Performing Arts Academy at Esteban E. Torres High No. 1"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Cesar E. Chavez Learning Academies-Arts,Theatre, Entertainment (ArTES)"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy"], ["Los Angeles River at Sonia Sotomayor Learning Academies"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies"], ["Dr. Maya Angelou Community High"], ["Public Service Community at Diego Rivera Learning Complex"], ["Communication and Technology at Diego Rivera Learning Complex"], ["Green Design at Diego Rivera Learning Complex"], ["Performing Arts Community at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["PUC Early College Academy for Leaders and Scholars (ECALS)"], ["STEM Academy at Bernstein High"], ["Augustus F. Hawkins High B Community Health Advocates"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Linda Esperanza Marquez High C School of Social Justice"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex"], ["Visual and Performing Arts at Legacy High School Complex"], ["Academies of Education and Empowerment at Carson High"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["District Office"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["District Office"], ["New Technology High"], ["George Washington Carver School of Arts and Science"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["District Office"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["District Office"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["District Office"], ["Riverside Preparatory"], ["District Office"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["District Office"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Encore Jr./Sr. High School for the Performing and Visual Arts"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["District Office"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["District Office"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["District Office"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School."], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Humphreys College Academy of Business, Law and Education"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["District Office"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["District Office"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["District Office"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["District Office"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["District Office"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 13.557872772216797, "spark_time": 0.2089991569519043, "translation_time": 13.348873615264893, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='bc0759d8-6c81-4139-bc75-c4ec028186d2'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a378579f-b10b-4296-ae27-ba742d56fa40'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}", "Observation: content='SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0' name='query_checker_sql_db' tool_call_id='23d4f971-8b3c-407d-9876-9792c948df51'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}"], "input_tokens": 4451, "output_tokens": 1897, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\"}'}\nTool: SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "final_answer": "", "replica": 1, "timestamp": 1768937081.6137733}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Enrollment (K-12)` > 0 AND (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["District Office"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["District Office"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["District Office"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["District Office"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["District Office"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["International Studies Learning Center at Legacy High School Complex"], ["Port of Los Angeles High"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["PUC CA Academy for Liberal Studies Early College High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Patti And Peter Neuwirth Leadership Academy"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["School of Business and Tourism at Contreras Learning Complex"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["Contreras Learning Center-Los Angeles School of Global Studies"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Contreras Learning Center-Academic Leadership Community"], ["RFK Community Schools-Los Angeles High School of the Arts"], ["Belmont SH-LA Teacher Preparatory Academy"], ["RFK Community Schools- for the Visual Arts and Humanities"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Ramon C. Cortines School of Visual and Performing Arts"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Cindy and Bill Simon Technology Academy High"], ["Alliance Tennenbaum Family Technology High"], ["Academy of Environmental & Social Policy (ESP) at Roosevelt High"], ["Math, Science, & Technology Magnet Academy at Roosevelt High"], ["East Los Angeles Performing Arts Academy at Esteban E. Torres High No. 1"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Cesar E. Chavez Learning Academies-Arts,Theatre, Entertainment (ArTES)"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy"], ["Los Angeles River at Sonia Sotomayor Learning Academies"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies"], ["Dr. Maya Angelou Community High"], ["Public Service Community at Diego Rivera Learning Complex"], ["Communication and Technology at Diego Rivera Learning Complex"], ["Green Design at Diego Rivera Learning Complex"], ["Performing Arts Community at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["PUC Early College Academy for Leaders and Scholars (ECALS)"], ["STEM Academy at Bernstein High"], ["Augustus F. Hawkins High B Community Health Advocates"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Linda Esperanza Marquez High C School of Social Justice"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex"], ["Visual and Performing Arts at Legacy High School Complex"], ["Academies of Education and Empowerment at Carson High"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["District Office"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["District Office"], ["New Technology High"], ["George Washington Carver School of Arts and Science"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["District Office"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["District Office"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["District Office"], ["Riverside Preparatory"], ["District Office"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["District Office"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Encore Jr./Sr. High School for the Performing and Visual Arts"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["District Office"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["District Office"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["District Office"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School."], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Humphreys College Academy of Business, Law and Education"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["District Office"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["District Office"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["District Office"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["District Office"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["District Office"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 13.768717288970947, "spark_time": 0.36693906784057617, "translation_time": 13.401778221130371, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='84527d55-44b8-43d8-ab9b-79b1f42cbedc'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='d6e958aa-6af7-4200-bbe9-d3cd2af04ab8'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}", "Observation: content=\"The query has a potential issue with division by zero if `T1.`Enrollment (K-12)`` is 0. It's good practice to add a check to ensure the denominator is greater than zero before performing the division.\\n\\nHere's the rewritten query:\\n\\n```sql\\nSELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Enrollment (K-12)` > 0 AND (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\\n```\" name='query_checker_sql_db' tool_call_id='e0f7b8c1-dd11-405e-b3a6-e8c2ab3e1eb5'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Enrollment (K-12)` > 0 AND (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}"], "input_tokens": 4536, "output_tokens": 2052, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\"}'}\nTool: The query has a potential issue with division by zero if `T1.`Enrollment (K-12)`` is 0. It's good practice to add a check to ensure the denominator is greater than zero before performing the division.\n\nHere's the rewritten query:\n\n```sql\nSELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Enrollment (K-12)` > 0 AND (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\n```", "final_answer": "", "replica": 2, "timestamp": 1768937096.2475135}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Enrollment (K-12)` > 0 AND (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["District Office"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["District Office"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["District Office"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["District Office"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["District Office"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["International Studies Learning Center at Legacy High School Complex"], ["Port of Los Angeles High"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["PUC CA Academy for Liberal Studies Early College High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Patti And Peter Neuwirth Leadership Academy"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["School of Business and Tourism at Contreras Learning Complex"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["Contreras Learning Center-Los Angeles School of Global Studies"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Contreras Learning Center-Academic Leadership Community"], ["RFK Community Schools-Los Angeles High School of the Arts"], ["Belmont SH-LA Teacher Preparatory Academy"], ["RFK Community Schools- for the Visual Arts and Humanities"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Ramon C. Cortines School of Visual and Performing Arts"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Cindy and Bill Simon Technology Academy High"], ["Alliance Tennenbaum Family Technology High"], ["Academy of Environmental & Social Policy (ESP) at Roosevelt High"], ["Math, Science, & Technology Magnet Academy at Roosevelt High"], ["East Los Angeles Performing Arts Academy at Esteban E. Torres High No. 1"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Cesar E. Chavez Learning Academies-Arts,Theatre, Entertainment (ArTES)"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy"], ["Los Angeles River at Sonia Sotomayor Learning Academies"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies"], ["Dr. Maya Angelou Community High"], ["Public Service Community at Diego Rivera Learning Complex"], ["Communication and Technology at Diego Rivera Learning Complex"], ["Green Design at Diego Rivera Learning Complex"], ["Performing Arts Community at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["PUC Early College Academy for Leaders and Scholars (ECALS)"], ["STEM Academy at Bernstein High"], ["Augustus F. Hawkins High B Community Health Advocates"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Linda Esperanza Marquez High C School of Social Justice"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex"], ["Visual and Performing Arts at Legacy High School Complex"], ["Academies of Education and Empowerment at Carson High"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["District Office"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["District Office"], ["New Technology High"], ["George Washington Carver School of Arts and Science"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["District Office"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["District Office"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["District Office"], ["Riverside Preparatory"], ["District Office"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["District Office"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Encore Jr./Sr. High School for the Performing and Visual Arts"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["District Office"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["District Office"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["District Office"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School."], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Humphreys College Academy of Business, Law and Education"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["District Office"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["District Office"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["District Office"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["District Office"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["District Office"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 21.401332139968872, "spark_time": 0.2989933490753174, "translation_time": 21.102338790893555, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='ed59bbbd-ed6a-4197-b191-94da66bf7d91'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='fd841fba-a1b4-41a0-9842-90e0023404d8'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}", "Observation: content=\"The query has a potential issue with division by zero if `T1.`Enrollment (K-12)`` is 0. It's good practice to add a check to ensure the denominator is greater than zero before performing the division.\\n\\nHere's the rewritten query:\\n\\n```sql\\nSELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Enrollment (K-12)` > 0 AND (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\\n```\" name='query_checker_sql_db' tool_call_id='9659e238-67b0-4f37-88be-1fc211aec945'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Enrollment (K-12)` > 0 AND (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}"], "input_tokens": 4536, "output_tokens": 2157, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\"}'}\nTool: The query has a potential issue with division by zero if `T1.`Enrollment (K-12)`` is 0. It's good practice to add a check to ensure the denominator is greater than zero before performing the division.\n\nHere's the rewritten query:\n\n```sql\nSELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Enrollment (K-12)` > 0 AND (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\n```", "final_answer": "", "replica": 3, "timestamp": 1768937118.8174949}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["District Office"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["District Office"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["District Office"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["District Office"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["District Office"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["International Studies Learning Center at Legacy High School Complex"], ["Port of Los Angeles High"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["PUC CA Academy for Liberal Studies Early College High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Patti And Peter Neuwirth Leadership Academy"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["School of Business and Tourism at Contreras Learning Complex"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["Contreras Learning Center-Los Angeles School of Global Studies"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Contreras Learning Center-Academic Leadership Community"], ["RFK Community Schools-Los Angeles High School of the Arts"], ["Belmont SH-LA Teacher Preparatory Academy"], ["RFK Community Schools- for the Visual Arts and Humanities"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Ramon C. Cortines School of Visual and Performing Arts"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Cindy and Bill Simon Technology Academy High"], ["Alliance Tennenbaum Family Technology High"], ["Academy of Environmental & Social Policy (ESP) at Roosevelt High"], ["Math, Science, & Technology Magnet Academy at Roosevelt High"], ["East Los Angeles Performing Arts Academy at Esteban E. Torres High No. 1"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Cesar E. Chavez Learning Academies-Arts,Theatre, Entertainment (ArTES)"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy"], ["Los Angeles River at Sonia Sotomayor Learning Academies"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies"], ["Dr. Maya Angelou Community High"], ["Public Service Community at Diego Rivera Learning Complex"], ["Communication and Technology at Diego Rivera Learning Complex"], ["Green Design at Diego Rivera Learning Complex"], ["Performing Arts Community at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["PUC Early College Academy for Leaders and Scholars (ECALS)"], ["STEM Academy at Bernstein High"], ["Augustus F. Hawkins High B Community Health Advocates"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Linda Esperanza Marquez High C School of Social Justice"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex"], ["Visual and Performing Arts at Legacy High School Complex"], ["Academies of Education and Empowerment at Carson High"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["District Office"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["District Office"], ["New Technology High"], ["George Washington Carver School of Arts and Science"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["District Office"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["District Office"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["District Office"], ["Riverside Preparatory"], ["District Office"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["District Office"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Encore Jr./Sr. High School for the Performing and Visual Arts"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["District Office"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["District Office"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["District Office"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School."], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Humphreys College Academy of Business, Law and Education"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["District Office"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["District Office"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["District Office"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["District Office"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["District Office"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 18.487502813339233, "spark_time": 0.30516624450683594, "translation_time": 18.182336568832397, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='30b5c593-a2ec-4bec-9104-1f928d42a3f8'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='0a5c04b0-6901-4654-9f79-c8cfd81a11a1'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1'}", "Observation: content=\"The provided Spark SQL query appears to be correct and follows best practices for Spark SQL, especially regarding identifier quoting.\\n\\nHere's a double-check against the common mistakes:\\n\\n1.  **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n2.  **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n3.  **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n4.  **Data type mismatch in predicates**:\\n    *   `T1.CDSCode = T2.cds`: Assuming `CDSCode` and `cds` are compatible types (e.g., both strings or both integers). This is a standard join condition.\\n    *   `(T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1`: In Spark SQL, division of integers typically results in a `DOUBLE`, so comparing it to `0.1` (a `DOUBLE`) is fine. No explicit casting is needed here.\\n    *   `T2.NumGE1500 >= 1`: Assuming `NumGE1500` is a numeric type, this comparison is valid.\\n    *   No apparent data type mismatches.\\n5.  **Properly quoting identifiers**: Identifiers with spaces like ``School Name``, ``Free Meal Count (K-12)``, and ``Enrollment (K-12)`` are correctly quoted using backticks (` `), which is the standard for Spark SQL.\\n6.  **Use `` for the in-query strings**: Not applicable, there are no string literals in the query. (Note: Backticks are for identifiers, single quotes `'` are for string literals in SQL).\\n7.  **Using the correct number of arguments for functions**: Not applicable, no functions are used.\\n8.  **Casting to the correct data type**: As mentioned in point 4, Spark SQL handles the division of integers to produce a double, so explicit casting is not strictly necessary for correctness in this context.\\n9.  **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a common and logical join condition for school-level data, assuming `CDSCode` and `cds` represent the same unique school identifier in both tables.\\n\\nThe query is well-formed.\\n\\n```sql\\nSELECT T1.`School Name` FROM frpm AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1\\n```\" name='query_checker_sql_db' tool_call_id='281ffd03-b49d-407b-b942-5a206ccd0f3f'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1'}"], "input_tokens": 4986, "output_tokens": 2597, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1\"}'}\nTool: The provided Spark SQL query appears to be correct and follows best practices for Spark SQL, especially regarding identifier quoting.\n\nHere's a double-check against the common mistakes:\n\n1.  **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n2.  **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n3.  **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n4.  **Data type mismatch in predicates**:\n    *   `T1.CDSCode = T2.cds`: Assuming `CDSCode` and `cds` are compatible types (e.g., both strings or both integers). This is a standard join condition.\n    *   `(T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1`: In Spark SQL, division of integers typically results in a `DOUBLE`, so comparing it to `0.1` (a `DOUBLE`) is fine. No explicit casting is needed here.\n    *   `T2.NumGE1500 >= 1`: Assuming `NumGE1500` is a numeric type, this comparison is valid.\n    *   No apparent data type mismatches.\n5.  **Properly quoting identifiers**: Identifiers with spaces like ``School Name``, ``Free Meal Count (K-12)``, and ``Enrollment (K-12)`` are correctly quoted using backticks (` `), which is the standard for Spark SQL.\n6.  **Use `` for the in-query strings**: Not applicable, there are no string literals in the query. (Note: Backticks are for identifiers, single quotes `'` are for string literals in SQL).\n7.  **Using the correct number of arguments for functions**: Not applicable, no functions are used.\n8.  **Casting to the correct data type**: As mentioned in point 4, Spark SQL handles the division of integers to produce a double, so explicit casting is not strictly necessary for correctness in this context.\n9.  **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a common and logical join condition for school-level data, assuming `CDSCode` and `cds` represent the same unique school identifier in both tables.\n\nThe query is well-formed.\n\n```sql\nSELECT T1.`School Name` FROM frpm AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1\n```", "final_answer": "", "replica": 4, "timestamp": 1768937138.462016}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 0.9579579579579579, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["Port of Los Angeles High"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Belmont SH-LA Teacher Preparatory Academy"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Tennenbaum Family Technology High"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Dr. Maya Angelou Community High"], ["Green Design at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["STEM Academy at Bernstein High"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["New Technology High"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["Riverside Preparatory"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 16.93717312812805, "spark_time": 0.3212862014770508, "translation_time": 16.615886926651, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0da72dd0-c224-4797-a6ac-7dea6d228689'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='452dd1ee-66ce-4472-83bb-0bf95816493b'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}", "Observation: content='SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0' name='query_checker_sql_db' tool_call_id='bae5d1f1-6b92-4d6f-a6af-c7e16387e7ac'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}"], "input_tokens": 4490, "output_tokens": 2431, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\"}'}\nTool: SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "final_answer": "", "replica": 5, "timestamp": 1768937156.2662373}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 0.9579579579579579, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["Port of Los Angeles High"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Belmont SH-LA Teacher Preparatory Academy"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Tennenbaum Family Technology High"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Dr. Maya Angelou Community High"], ["Green Design at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["STEM Academy at Bernstein High"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["New Technology High"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["Riverside Preparatory"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 14.398590564727783, "spark_time": 0.14601421356201172, "translation_time": 14.252576351165771, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cdeb31e3-8d81-4307-ab94-4f738bf9c0cd'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='56a40832-7bda-41b4-ad52-09acfab0b3a7'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}", "Observation: content='```sql\\nSELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\\n```' name='query_checker_sql_db' tool_call_id='c7a6fe27-0916-4d31-8470-17051bc59f37'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}"], "input_tokens": 4497, "output_tokens": 2150, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\"}'}\nTool: ```sql\nSELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds AND T1.`School Name` = T2.sname WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\n```", "final_answer": "", "replica": 6, "timestamp": 1768937171.488829}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": null, "spider_em": null, "sparksql_query": "\nSELECT\n  T1.\"School Name\"\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  (\n    T1.\"Free Meal Count (K-12)\" / T1.\"Enrollment (K-12)\"\n  ) > 0.1 AND T2.NumGE1500 > 0;\n", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"School Name\"'. SQLSTATE: 42601 (line 3, pos 5)\n\n== SQL ==\n\nSELECT\n  T1.\"School Name\"\n-----^^^\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  (\n    T1.\"Free Meal Count (K-12)\" / T1.\"Enrollment (K-12)\"\n  ) > 0.1 AND T2.NumGE1500 > 0;\n", "total_time": 21.247907876968384, "spark_time": 0.02299022674560547, "translation_time": 21.22491765022278, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0639b650-eff1-478f-83d5-ca482a2ede4a'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='10f2a52d-a715-40a9-94ee-cb6e207dffd1'", "Action: query_checker_sql_db\nAction Input: {'query': '\\nSELECT\\n  T1.\"School Name\"\\nFROM frpm AS T1\\nINNER JOIN satscores AS T2\\n  ON T1.CDSCode = T2.cds\\nWHERE\\n  (\\n    T1.\"Free Meal Count (K-12)\" / T1.\"Enrollment (K-12)\"\\n  ) > 0.1 AND T2.NumGE1500 > 0;\\n'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain the common mistakes listed.\\n\\nHere\\'s a breakdown of the checks:\\n\\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\\n*   **Data type mismatch in predicates**:\\n    *   The division `T1.\"Free Meal Count (K-12)\" / T1.\"Enrollment (K-12)\"` will result in a floating-point number in Spark SQL (even if both operands are integers), which is correctly compared to `0.1` (a decimal).\\n    *   `T2.NumGE1500 > 0` compares a numeric column to an integer, which is fine.\\n    *   The join condition `T1.CDSCode = T2.cds` assumes compatible data types for the `CDSCode` and `cds` columns, which is standard for join keys.\\n    *   **Note on division by zero**: If `T1.\"Enrollment (K-12)\"` is zero, Spark SQL will return `NULL` for the division. A `NULL` value in a `WHERE` clause condition (e.g., `NULL > 0.1`) evaluates to `NULL` (unknown), and thus the row will be excluded, which is generally the desired behavior for such a calculation.\\n*   **Properly quoting identifiers**: Identifiers with spaces (e.g., `\"School Name\"`, `\"Free Meal Count (K-12)\"`, `\"Enrollment (K-12)\"`) are correctly enclosed in double quotes. Other identifiers without spaces or special characters (e.g., `CDSCode`, `cds`, `NumGE1500`) do not require quotes.\\n*   **Use `` ` `` for the in-query strings**: There are no in-query string literals that would require backticks. Backticks are used for identifiers, not string literals (which use single quotes).\\n*   **Using the correct number of arguments for functions**: No user-defined or built-in functions (other than arithmetic operators) are explicitly called in a way that would require checking argument counts.\\n*   **Casting to the correct data type**: Spark SQL\\'s type promotion rules handle the division of integers to produce a floating-point result correctly, so explicit casting (e.g., `CAST(... AS DOUBLE)`) is not strictly necessary here to achieve the desired decimal comparison.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` uses columns that are logically expected to link the `frpm` and `satscores` tables (likely school or district codes).\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT\\n  T1.\"School Name\"\\nFROM frpm AS T1\\nINNER JOIN satscores AS T2\\n  ON T1.CDSCode = T2.cds\\nWHERE\\n  (\\n    T1.\"Free Meal Count (K-12)\" / T1.\"Enrollment (K-12)\"\\n  ) > 0.1 AND T2.NumGE1500 > 0;\\n```' name='query_checker_sql_db' tool_call_id='52618bfb-85d3-4a4e-b7db-199e545c6f3a'", "Action: query_sql_db\nAction Input: {'query': '\\nSELECT\\n  T1.\"School Name\"\\nFROM frpm AS T1\\nINNER JOIN satscores AS T2\\n  ON T1.CDSCode = T2.cds\\nWHERE\\n  (\\n    T1.\"Free Meal Count (K-12)\" / T1.\"Enrollment (K-12)\"\\n  ) > 0.1 AND T2.NumGE1500 > 0;\\n'}"], "input_tokens": 5152, "output_tokens": 3397, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"\\\\nSELECT\\\\n  T1.\\\\\"School Name\\\\\"\\\\nFROM frpm AS T1\\\\nINNER JOIN satscores AS T2\\\\n  ON T1.CDSCode = T2.cds\\\\nWHERE\\\\n  (\\\\n    T1.\\\\\"Free Meal Count (K-12)\\\\\" / T1.\\\\\"Enrollment (K-12)\\\\\"\\\\n  ) > 0.1 AND T2.NumGE1500 > 0;\\\\n\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain the common mistakes listed.\n\nHere's a breakdown of the checks:\n\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\n*   **Data type mismatch in predicates**:\n    *   The division `T1.\"Free Meal Count (K-12)\" / T1.\"Enrollment (K-12)\"` will result in a floating-point number in Spark SQL (even if both operands are integers), which is correctly compared to `0.1` (a decimal).\n    *   `T2.NumGE1500 > 0` compares a numeric column to an integer, which is fine.\n    *   The join condition `T1.CDSCode = T2.cds` assumes compatible data types for the `CDSCode` and `cds` columns, which is standard for join keys.\n    *   **Note on division by zero**: If `T1.\"Enrollment (K-12)\"` is zero, Spark SQL will return `NULL` for the division. A `NULL` value in a `WHERE` clause condition (e.g., `NULL > 0.1`) evaluates to `NULL` (unknown), and thus the row will be excluded, which is generally the desired behavior for such a calculation.\n*   **Properly quoting identifiers**: Identifiers with spaces (e.g., `\"School Name\"`, `\"Free Meal Count (K-12)\"`, `\"Enrollment (K-12)\"`) are correctly enclosed in double quotes. Other identifiers without spaces or special characters (e.g., `CDSCode`, `cds`, `NumGE1500`) do not require quotes.\n*   **Use `` ` `` for the in-query strings**: There are no in-query string literals that would require backticks. Backticks are used for identifiers, not string literals (which use single quotes).\n*   **Using the correct number of arguments for functions**: No user-defined or built-in functions (other than arithmetic operators) are explicitly called in a way that would require checking argument counts.\n*   **Casting to the correct data type**: Spark SQL's type promotion rules handle the division of integers to produce a floating-point result correctly, so explicit casting (e.g., `CAST(... AS DOUBLE)`) is not strictly necessary here to achieve the desired decimal comparison.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` uses columns that are logically expected to link the `frpm` and `satscores` tables (likely school or district codes).\n\nThe query is correct as written.\n\n```sql\nSELECT\n  T1.\"School Name\"\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  (\n    T1.\"Free Meal Count (K-12)\" / T1.\"Enrollment (K-12)\"\n  ) > 0.1 AND T2.NumGE1500 > 0;\n```", "final_answer": "", "replica": 7, "timestamp": 1768937192.914739}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["District Office"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["District Office"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["District Office"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["District Office"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["District Office"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["International Studies Learning Center at Legacy High School Complex"], ["Port of Los Angeles High"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["PUC CA Academy for Liberal Studies Early College High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Patti And Peter Neuwirth Leadership Academy"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["School of Business and Tourism at Contreras Learning Complex"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["Contreras Learning Center-Los Angeles School of Global Studies"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Contreras Learning Center-Academic Leadership Community"], ["RFK Community Schools-Los Angeles High School of the Arts"], ["Belmont SH-LA Teacher Preparatory Academy"], ["RFK Community Schools- for the Visual Arts and Humanities"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Ramon C. Cortines School of Visual and Performing Arts"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Cindy and Bill Simon Technology Academy High"], ["Alliance Tennenbaum Family Technology High"], ["Academy of Environmental & Social Policy (ESP) at Roosevelt High"], ["Math, Science, & Technology Magnet Academy at Roosevelt High"], ["East Los Angeles Performing Arts Academy at Esteban E. Torres High No. 1"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Cesar E. Chavez Learning Academies-Arts,Theatre, Entertainment (ArTES)"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy"], ["Los Angeles River at Sonia Sotomayor Learning Academies"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies"], ["Dr. Maya Angelou Community High"], ["Public Service Community at Diego Rivera Learning Complex"], ["Communication and Technology at Diego Rivera Learning Complex"], ["Green Design at Diego Rivera Learning Complex"], ["Performing Arts Community at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["PUC Early College Academy for Leaders and Scholars (ECALS)"], ["STEM Academy at Bernstein High"], ["Augustus F. Hawkins High B Community Health Advocates"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Linda Esperanza Marquez High C School of Social Justice"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex"], ["Visual and Performing Arts at Legacy High School Complex"], ["Academies of Education and Empowerment at Carson High"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["District Office"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["District Office"], ["New Technology High"], ["George Washington Carver School of Arts and Science"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["District Office"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["District Office"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["District Office"], ["Riverside Preparatory"], ["District Office"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["District Office"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Encore Jr./Sr. High School for the Performing and Visual Arts"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["District Office"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["District Office"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["District Office"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School."], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Humphreys College Academy of Business, Law and Education"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["District Office"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["District Office"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["District Office"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["District Office"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["District Office"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 15.753058195114136, "spark_time": 0.12099623680114746, "translation_time": 15.632061958312988, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d9e6fb6e-9b95-47ff-a466-ff48adfc5aae'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='8431349a-78a4-4df1-9316-a00228ee4d09'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1'}", "Observation: content='The Spark SQL query appears to be correctly written.\\n\\n*   Identifiers with spaces (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`) are properly quoted using backticks.\\n*   The join condition `T1.CDSCode = T2.cds` uses appropriate columns, assuming `CDSCode` and `cds` are the correct keys.\\n*   The division `(T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`)` in Spark SQL typically performs floating-point division, making the comparison with `0.1` accurate without explicit casting.\\n*   No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, or `BETWEEN` for exclusive ranges issues are present.\\n*   No functions with incorrect argument counts are used.\\n*   No literal strings are present that would require backticks.\\n\\n```sql\\nSELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1\\n```' name='query_checker_sql_db' tool_call_id='e70dfc11-8002-44de-aeaa-d29183dfdcae'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1'}"], "input_tokens": 4661, "output_tokens": 2311, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1\"}'}\nTool: The Spark SQL query appears to be correctly written.\n\n*   Identifiers with spaces (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`) are properly quoted using backticks.\n*   The join condition `T1.CDSCode = T2.cds` uses appropriate columns, assuming `CDSCode` and `cds` are the correct keys.\n*   The division `(T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`)` in Spark SQL typically performs floating-point division, making the comparison with `0.1` accurate without explicit casting.\n*   No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, or `BETWEEN` for exclusive ranges issues are present.\n*   No functions with incorrect argument counts are used.\n*   No literal strings are present that would require backticks.\n\n```sql\nSELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 >= 1\n```", "final_answer": "", "replica": 8, "timestamp": 1768937209.436378}
{"query_id": 24, "provider": "google", "db": "california_schools", "nl_query": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)", "gold_sqlite": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "gold_spark": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS FLOAT) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "execution_status": "VALID", "query_result": [["Clovis North High"], ["Clovis West High"], ["Buchanan High"], ["Clovis East High"], ["Clovis High"], ["Coalinga High"], ["Fowler High"], ["Design Science Early College High"], ["Bullard High"], ["Erma Duncan Polytechnical High"], ["Sunnyside High"], ["Edison High"], ["Fresno High"], ["Herbert Hoover High"], ["McLane High"], ["Roosevelt High"], ["Kingsburg High"], ["Orange Cove High"], ["Reedley High"], ["Parlier High"], ["Hallmark Charter"], ["Sanger High"], ["Selma High"], ["Firebaugh High"], ["Central High East Campus"], ["Kerman High"], ["Mendota High"], ["Tranquillity High"], ["Sierra High"], ["Riverdale High"], ["Caruthers High"], ["Washington High"], ["Willows High"], ["Orland High"], ["Hamilton High"], ["Northcoast Preparatory and Performing Arts Academy"], ["Six Rivers Charter High"], ["Arcata High"], ["McKinleyville High"], ["Academy of the Redwoods"], ["Fortuna Union High"], ["Hoopa Valley High"], ["South Fork Junior - Senior High"], ["Ferndale High"], ["District Office"], ["Eureka Senior High"], ["Brawley High"], ["Calexico High"], ["Calipatria High"], ["Southwest High"], ["Central Union High"], ["Holtville High"], ["Imperial High"], ["Bishop Union High"], ["Paramount Academy"], ["Valley Oaks Charter"], ["Cesar E. Chavez High"], ["Robert F. Kennedy High"], ["Delano High"], ["Golden Valley High"], ["Frontier High"], ["Independence High"], ["Mira Monte High"], ["Arvin High"], ["Stockdale High"], ["Centennial High"], ["Ridgeview High"], ["Liberty High"], ["Bakersfield High"], ["East Bakersfield High"], ["Foothill High"], ["Highland High"], ["Kern Valley High"], ["North High"], ["Shafter High"], ["South High"], ["West High"], ["California City High"], ["Rosamond High"], ["Taft Union High"], ["Tehachapi High"], ["Wasco High"], ["Burroughs High"], ["McFarland High"], ["Frazier Mountain High"], ["Corcoran High"], ["Sierra Pacific High"], ["Hanford West High"], ["Hanford High"], ["Lemoore Middle College High"], ["Lemoore High"], ["Avenal High"], ["Kelseyville High"], ["Lower Lake High"], ["Clear Lake High"], ["Middletown High"], ["Lassen High"], ["Los Angeles International Charter High"], ["International Polytechnic High"], ["District Office"], ["Cerritos High"], ["Artesia High"], ["Whitney (Gretchen) High"], ["Gahr (Richard) High"], ["William J. (Pete) Knight High"], ["Eastside High"], ["SOAR High (Students On Academic Rise)"], ["Antelope Valley High"], ["Palmdale High"], ["Quartz Hill High"], ["Highland High"], ["Littlerock High"], ["Lancaster High"], ["Arcadia High"], ["Azusa High"], ["Gladstone High"], ["District Office"], ["Opportunities For Learning - Baldwin Park II"], ["Baldwin Park High"], ["Sierra Vista High"], ["Opportunities for Learning - Baldwin Park"], ["Bassett Senior High"], ["Bellflower High"], ["Mayfair High"], ["Bonita High"], ["San Dimas High"], ["Burbank High"], ["Burroughs High"], ["Options for Youth-Burbank Charter"], ["Hawthorne High"], ["Lawndale High"], ["Leuzinger High"], ["Charter Oak High"], ["Claremont High"], ["Covina High"], ["Northview High"], ["South Hills High"], ["Culver City High"], ["Downey High"], ["Warren High"], ["Duarte High"], ["Arroyo High"], ["El Monte High"], ["Mountain View High"], ["Rosemead High"], ["South El Monte High"], ["District Office"], ["El Rancho High"], ["Crescenta Valley High"], ["Glendale High"], ["Herbert Hoover High"], ["Anderson W. Clark Magnet High"], ["Glendora High"], ["Gorman Learning Center"], ["Hawthorne Math and Science Academy"], ["Inglewood High"], ["Morningside High"], ["City Honors College Preparatory Academy"], ["Animo Inglewood Charter High"], ["Environmental Charter High"], ["Lennox Mathematics, Science and Technology Academy"], ["Animo Leadership High"], ["District Office"], ["Avalon K-12"], ["Jordan High"], ["Lakewood High"], ["Millikan High"], ["Polytechnic High"], ["Wilson High"], ["California Academy of Mathematics and Science"], ["Cabrillo High"], ["Renaissance High School for the Arts"], ["High Tech LA"], ["Wallis Annenberg High"], ["Central City Value"], ["View Park Preparatory Accelerated High"], ["Crenshaw Arts-Technology Charter High"], ["Oscar De La Hoya Animo Charter High"], ["Renaissance Arts Academy"], ["Animo South Los Angeles Charter"], ["New Designs Charter"], ["Middle College High"], ["Harbor Teacher Preparation Academy"], ["Ivy Academia"], ["Camino Nuevo Charter High"], ["Animo Venice Charter High"], ["Animo Pat Brown"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex"], ["Orthopaedic Hospital"], ["Northridge Academy High"], ["International Studies Learning Center at Legacy High School Complex"], ["Port of Los Angeles High"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing"], ["Alliance Judy Ivie Burton Technology Academy High"], ["Alliance Collins Family College-Ready High"], ["Santee Education Complex"], ["South East High"], ["Maywood Academy High"], ["PUC CA Academy for Liberal Studies Early College High"], ["Los Angeles Academy of Arts & Enterprise Charter"], ["Alliance Patti And Peter Neuwirth Leadership Academy"], ["Alliance Dr. Olga Mohan High"], ["Animo Ralph Bunche High"], ["Animo Jackie Robinson High"], ["Animo Watts College Preparatory Academy"], ["Alliance Ouchi-O'Donovan 6-12 Complex"], ["Alliance Marc & Eva Stern Math and Science"], ["School of Business and Tourism at Contreras Learning Complex"], ["East Valley Senior High"], ["Arleta High"], ["Panorama High"], ["Bright Star Secondary Charter Academy"], ["Frederick Douglass Academy High"], ["Student Empowerment Academy"], ["Contreras Learning Center-Los Angeles School of Global Studies"], ["West Adams Preparatory High"], ["Magnolia Science Academy 3"], ["Magnolia Science Academy 2"], ["Discovery Charter Preparatory No. 2"], ["Alliance Media Arts and Entertainment Design High"], ["Edward R. Roybal Learning Center"], ["Helen Bernstein High"], ["APEX Academy"], ["Alliance Health Services Academy High"], ["Alliance Environmental Science and Technology High"], ["Magnolia Science Academy 4"], ["Contreras Learning Center-Academic Leadership Community"], ["RFK Community Schools-Los Angeles High School of the Arts"], ["Belmont SH-LA Teacher Preparatory Academy"], ["RFK Community Schools- for the Visual Arts and Humanities"], ["New Millennium Secondary"], ["Alain Leroy Locke College Prep Academy"], ["Sun Valley High"], ["RFK Community Schools-New Open World Academy K-12"], ["RFK Community Schools-UCLA Community K-12"], ["Ramon C. Cortines School of Visual and Performing Arts"], ["Felicitas and Gonzalo Mendez High"], ["Daniel Pearl Journalism & Communications Magnet"], ["RFK Community Schools-Ambassador-Global Leadership"], ["Alliance Cindy and Bill Simon Technology Academy High"], ["Alliance Tennenbaum Family Technology High"], ["Academy of Environmental & Social Policy (ESP) at Roosevelt High"], ["Math, Science, & Technology Magnet Academy at Roosevelt High"], ["East Los Angeles Performing Arts Academy at Esteban E. Torres High No. 1"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3"], ["PUC Lakeview Charter High"], ["Aspire Pacific Academy"], ["Alliance College-Ready Academy High 16"], ["Valley Academy of Arts and Sciences"], ["Cesar E. Chavez Learning Academies-Arts,Theatre, Entertainment (ArTES)"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy"], ["Los Angeles River at Sonia Sotomayor Learning Academies"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies"], ["Dr. Maya Angelou Community High"], ["Public Service Community at Diego Rivera Learning Complex"], ["Communication and Technology at Diego Rivera Learning Complex"], ["Green Design at Diego Rivera Learning Complex"], ["Performing Arts Community at Diego Rivera Learning Complex"], ["Rancho Dominguez Preparatory"], ["Synergy Quantum Academy"], ["Animo College Preparatory Academy"], ["Alliance Renee and Meyer Luskin Academy High"], ["PUC Early College Academy for Leaders and Scholars (ECALS)"], ["STEM Academy at Bernstein High"], ["Augustus F. Hawkins High B Community Health Advocates"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine"], ["Linda Esperanza Marquez High B LIBRA Academy"], ["Linda Esperanza Marquez High C School of Social Justice"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex"], ["Visual and Performing Arts at Legacy High School Complex"], ["Academies of Education and Empowerment at Carson High"], ["Academy of Medical Arts at Carson High"], ["Humanities and Arts (HARTS) Academy of Los Angeles"], ["Contreras Learning Center-School of Social Justice"], ["Phineas Banning Senior High"], ["Bell Senior High"], ["Belmont Senior High"], ["Birmingham Community Charter High"], ["Canoga Park Senior High"], ["Carson Senior High"], ["Chatsworth Charter High"], ["Valley Alternative Magnet"], ["Grover Cleveland Charter High"], ["Crenshaw Science, Technology, Engineering, Math and Medicine Magnet"], ["Susan Miller Dorsey Senior High"], ["Eagle Rock High"], ["El Camino Real Charter High"], ["Los Angeles Center for Enriched Studies"], ["Downtown Business High"], ["Fairfax Senior High"], ["John H. Francis Polytechnic"], ["King/Drew Medical Magnet High"], ["Benjamin Franklin Senior High"], ["John C. Fremont Senior High"], ["Sherman Oaks Center for Enriched Studies"], ["Gardena Senior High"], ["James A. Garfield Senior High"], ["Granada Hills Charter High"], ["Ulysses S. Grant Senior High"], ["Alexander Hamilton Senior High"], ["Hollywood Senior High"], ["Huntington Park Senior High"], ["Thomas Jefferson Senior High"], ["David Starr Jordan Senior High"], ["Abraham Lincoln Senior High"], ["Los Angeles Senior High"], ["Manual Arts Senior High"], ["John Marshall Senior High"], ["James Monroe High"], ["Nathaniel Narbonne Senior High"], ["North Hollywood Senior High"], ["Reseda Senior High"], ["Theodore Roosevelt Senior High"], ["San Fernando Senior High"], ["San Pedro Senior High"], ["South Gate Senior High"], ["Sylmar Senior High"], ["William Howard Taft Charter High"], ["University Senior High"], ["Van Nuys Senior High"], ["Venice Senior High"], ["Verdugo Hills Senior High"], ["George Washington Preparatory High"], ["WESM Health/Sports Medicine"], ["Woodrow Wilson Senior High"], ["John F. Kennedy High"], ["Francisco Bravo Medical Magnet High"], ["Palisades Charter High"], ["City of Angels"], ["Los Angeles Leadership Academy"], ["Elizabeth Learning Center"], ["Thirty-Second Street USC Performing Arts"], ["Vaughn Next Century Learning Center"], ["Robert Fulton College Preparatory"], ["Foshay Learning Center"], ["Magnolia Science Academy"], ["Marco Antonio Firebaugh High"], ["Lynwood High"], ["Monrovia High"], ["Mountain Park"], ["Applied Technology Center"], ["Schurr High"], ["Bell Gardens High"], ["Montebello High"], ["John H. Glenn High"], ["La Mirada High"], ["Norwalk High"], ["Guidance Charter"], ["Paramount High"], ["Blair High"], ["Marshall Fundamental"], ["John Muir High"], ["Pasadena High"], ["Ganesha High"], ["Garey High"], ["Pomona High"], ["Diamond Ranch High"], ["Village Academy High School at Indian Hill"], ["Fremont Academy of Engineering and Design"], ["Palomares Academy of Health Science"], ["Santa Monica High"], ["South Pasadena Senior High"], ["Temple City High"], ["North High"], ["South High"], ["Torrance High"], ["West High"], ["California Virtual Academy @ Los Angeles"], ["Edgewood High"], ["Insight @ Los Angeles"], ["West Covina High"], ["California High"], ["La Serna High"], ["Pioneer High"], ["Santa Fe High"], ["Whittier High"], ["Golden Valley High"], ["Santa Clarita Valley International"], ["Canyon High"], ["William S. Hart High"], ["Opportunities for Learning - Santa Clarita"], ["Centennial High"], ["Compton High"], ["Dominguez High"], ["La Puente High"], ["Los Altos High"], ["Glen A. Wilson High"], ["William Workman High"], ["Nogales High"], ["John A. Rowland High"], ["Gabrielino High"], ["Options for Youth San Gabriel"], ["Vasquez High"], ["Redondo Union High"], ["School of Arts and Enterprise"], ["Alhambra High"], ["Mark Keppel High"], ["San Gabriel High"], ["Da Vinci Science"], ["Da Vinci Design"], ["Chowchilla Union High"], ["Madera South High"], ["Madera High"], ["Liberty High"], ["Minarets High"], ["Minarets Charter High"], ["Yosemite High"], ["Novato High"], ["San Marin High"], ["San Rafael High"], ["Terra Linda High"], ["Tomales High"], ["Mariposa County High"], ["Anderson Valley Junior-Senior High"], ["Fort Bragg High"], ["Mendocino High"], ["Point Arena High"], ["Redwood Academy of Ukiah"], ["Ukiah High"], ["Willits High"], ["Potter Valley High"], ["Hilmar High"], ["Le Grand High"], ["Pacheco High"], ["Los Banos High"], ["Golden Valley High"], ["Buhach Colony High"], ["Atwater High"], ["Livingston High"], ["Merced High"], ["Gustine High"], ["Dos Palos High"], ["Delhi High"], ["Modoc High"], ["Mammoth High"], ["Greenfield High"], ["King City High"], ["Marina High"], ["Monterey High"], ["Seaside High"], ["Pacific Grove High"], ["Alisal High"], ["Everett Alvarez High"], ["North Salinas High"], ["Salinas High"], ["North Monterey County High"], ["Soledad High"], ["Gonzales High"], ["Calistoga Junior-Senior High"], ["American Canyon High"], ["Vintage High"], ["New Technology High"], ["Napa High"], ["Saint Helena High"], ["Bitney College Preparatory High"], ["Forest Charter"], ["William & Marian Ghidotti High"], ["Bear River High"], ["Nevada Union High"], ["OCCS:CHEP/PCHS"], ["Cypress High"], ["Anaheim High"], ["Oxford Academy"], ["Katella High"], ["John F. Kennedy High"], ["Loara High"], ["Magnolia High"], ["Savanna High"], ["Western High"], ["Brea-Olinda High"], ["Capistrano Connections Academy"], ["San Juan Hills High"], ["Capistrano Valley High"], ["San Clemente High"], ["Dana Hills High"], ["Buena Park High"], ["Fullerton Union High"], ["La Habra High"], ["Sonora High"], ["Sunny Hills High"], ["Troy High"], ["Bolsa Grande High"], ["Garden Grove High"], ["La Quinta High"], ["Los Amigos High"], ["Pacifica High"], ["Rancho Alamitos High"], ["Santiago High"], ["Ocean View High"], ["Fountain Valley High"], ["Huntington Beach High"], ["Marina High"], ["Westminster High"], ["Early College High"], ["Costa Mesa High"], ["Estancia High"], ["Newport Harbor High"], ["El Modena High"], ["Orange High"], ["Villa Park High"], ["Esperanza High"], ["El Dorado High"], ["Valencia High"], ["Nova Academy"], ["Segerstrom High"], ["Hector G. Godinez"], ["Century High"], ["Middle College High"], ["OCSA"], ["Saddleback High"], ["Santa Ana High"], ["Valley High"], ["El Toro High"], ["Laguna Hills High"], ["Mission Viejo High"], ["Arnold O. Beckman High"], ["Foothill High"], ["Tustin High"], ["Irvine High"], ["Woodbridge High"], ["University High"], ["Foresthill High"], ["Colfax High"], ["Placer High"], ["Antelope High"], ["Woodcreek High"], ["Oakmont High"], ["Roseville High"], ["North Tahoe High"], ["Tahoe Truckee High"], ["Horizon Charter"], ["Lincoln High"], ["Whitney High"], ["Chester Junior/Senior High"], ["Portola Junior/Senior High"], ["Quincy Junior/Senior High"], ["River Springs Charter"], ["La Sierra High"], ["Norte Vista High"], ["Banning High"], ["Beaumont Senior High"], ["Eleanor Roosevelt High"], ["John F. Kennedy High"], ["Centennial High"], ["Santiago High"], ["Corona High"], ["Norco High"], ["Shadow Hills High"], ["Palm Desert High"], ["La Quinta High"], ["Indio High"], ["Hamilton High"], ["Tahquitz High"], ["College Prep High"], ["West Valley High"], ["Hemet High"], ["Patriot High"], ["Jurupa Valley High"], ["Rubidoux High"], ["Santa Rosa Academy"], ["Canyon Springs High"], ["Valley View High"], ["Vista del Lago High"], ["Moreno Valley High"], ["Nuview Bridge Early College High"], ["District Office"], ["Cathedral City High"], ["Desert Hot Springs High"], ["Palm Springs High"], ["Palo Verde High"], ["California Military Institute"], ["Heritage High"], ["Paloma Valley High"], ["Perris High"], ["Arlington High"], ["Martin Luther King Jr. High"], ["John W. North High"], ["Polytechnic High"], ["Ramona High"], ["San Jacinto High"], ["San Jacinto Valley Academy"], ["Desert Mirage High"], ["NOVA Academy - Coachella"], ["West Shores High"], ["Coachella Valley High"], ["Lakeside High"], ["Temescal Canyon High"], ["Elsinore High"], ["Temecula Valley High"], ["Chaparral High"], ["Vista Murrieta High"], ["Murrieta Mesa High"], ["Murrieta Valley High"], ["Citrus Hill High"], ["Rancho Verde High"], ["Monterey Trail High"], ["Pleasant Grove High"], ["Cosumnes Oaks High"], ["Valley High"], ["Florin High"], ["Laguna Creek High"], ["Sheldon High"], ["Franklin High"], ["Elk Grove High"], ["Cordova High"], ["Liberty Ranch High"], ["Galt High"], ["Rio Vista High"], ["Delta High"], ["District Office"], ["New Technology High"], ["George Washington Carver School of Arts and Science"], ["The MET"], ["Rosemont High"], ["Sacramento Charter High"], ["Arthur A. Benjamin Health Professions High"], ["School of Engineering & Sciences"], ["West Campus"], ["Luther Burbank High"], ["Hiram W. Johnson High"], ["John F. Kennedy High"], ["C. K. McClatchy High"], ["District Office"], ["Aspire Alexander Twilight Secondary Academy"], ["Mesa Verde High"], ["Bella Vista High"], ["Options for Youth-San Juan"], ["Visions In Education"], ["Casa Roble Fundamental High"], ["Del Campo High"], ["El Camino Fundamental High"], ["Encina Preparatory High"], ["Mira Loma High"], ["Rio Americano High"], ["San Juan High"], ["Center High"], ["Inderkum High"], ["Natomas Pacific Pathways Prep"], ["Natomas High"], ["Natomas Charter"], ["Futures High"], ["Heritage Peak Charter"], ["Foothill High"], ["Grant Union High"], ["Highlands High"], ["Rio Linda High"], ["San Benito High"], ["Anzar High"], ["Barstow High"], ["Big Bear High"], ["Alta Loma High"], ["Etiwanda High"], ["Rancho Cucamonga High"], ["Los Osos High"], ["Colony High"], ["Chaffey High"], ["Montclair High"], ["Ontario High"], ["Don Antonio Lugo High"], ["Ruben S. Ayala High"], ["Chino Hills High"], ["Chino High"], ["District Office"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex"], ["Bloomington High"], ["Colton High"], ["Summit High"], ["Jurupa Hills High"], ["Fontana A. B. Miller High"], ["Henry J. Kaiser High"], ["Fontana High"], ["Academy of Careers and Exploration"], ["Twentynine Palms High"], ["Yucca Valley High"], ["Needles High"], ["District Office"], ["Riverside Preparatory"], ["District Office"], ["Citrus Valley High"], ["Redlands East Valley High"], ["Grove"], ["Redlands Senior High"], ["Wilmer Amina Carter High"], ["Rialto High"], ["Eisenhower Senior High"], ["Rim of the World Senior High"], ["District Office"], ["Options for Youth-San Bernardino"], ["Indian Springs High"], ["Arroyo Valley High"], ["Middle College High"], ["Cajon High"], ["Pacific High"], ["San Bernardino High"], ["San Gorgonio High"], ["University Preparatory"], ["Adelanto High"], ["Options for Youth-Victorville Charter"], ["Excelsior Charter"], ["Silverado High"], ["Victor Valley High"], ["Yucaipa High"], ["Silver Valley High"], ["Serrano High"], ["Encore Jr./Sr. High School for the Performing and Visual Arts"], ["Oak Hills High"], ["Hesperia High"], ["Sultana High"], ["Upland High"], ["Apple Valley High"], ["Granite Hills High"], ["Academy for Academic Excellence"], ["San Pasqual Academy"], ["Borrego Springs High"], ["Dehesa Charter"], ["San Pasqual High"], ["Escondido Charter High"], ["Escondido High"], ["Orange Glen High"], ["Fallbrook High"], ["Valhalla High"], ["West Hills High"], ["Steele Canyon High"], ["Grossmont Middle College High"], ["El Cajon Valley High"], ["El Capitan High"], ["Granite Hills High"], ["Grossmont High"], ["Helix High"], ["Monte Vista High"], ["Mount Miguel High"], ["Santana High"], ["Julian Charter"], ["Mountain Empire High"], ["District Office"], ["Mt. Carmel High"], ["Poway High"], ["Ramona High"], ["High Tech High International"], ["San Diego International Studies"], ["San Diego Business/Leadership"], ["San Diego MVP Arts"], ["Kearny Digital Media & Design"], ["Kearny SCT"], ["Kearny International Business"], ["Kearny Eng, Innov & Design"], ["Crawford High"], ["San Diego Science and Technology"], ["San Diego Metro Career and Tech"], ["High Tech High Media Arts"], ["Lincoln High"], ["Health Sciences High"], ["San Diego Early/Middle College"], ["King-Chavez Community High"], ["Gompers Preparatory Academy"], ["Coleman Tech Charter High"], ["Serra High"], ["Mira Mesa High"], ["University City High"], ["San Diego SCPA"], ["Mt. Everest Academy"], ["Scripps Ranch High"], ["Charter School of San Diego"], ["Preuss School UCSD"], ["Clairemont High"], ["High Tech High"], ["Audeo Charter"], ["Henry High"], ["Hoover High"], ["La Jolla High"], ["Madison High"], ["Mission Bay High"], ["Morse High"], ["Point Loma High"], ["California Virtual Academy @ San Diego"], ["District Office"], ["Olympian High"], ["Southwest Senior High"], ["Bonita Vista Senior High"], ["Castle Park Senior High"], ["Eastlake High"], ["Chula Vista Senior High"], ["San Ysidro High"], ["Otay Ranch Senior High"], ["Hilltop Senior High"], ["Mar Vista Senior High"], ["Sweetwater High"], ["Montgomery Senior High"], ["Mission Vista High"], ["Rancho Buena Vista High"], ["Guajome Park Academy Charter"], ["Vista High"], ["Carlsbad High"], ["Oceanside High"], ["El Camino High"], ["Mission Hills High"], ["San Marcos High"], ["Valley Center High"], ["High Tech High Chula Vista"], ["High Tech High North County"], ["District Office"], ["City Arts and Tech High"], ["S.F. International High"], ["Academy of Arts and Sciences"], ["Independence High"], ["Wallenberg (Raoul) Traditional High"], ["Burton (Phillip and Sala) Academic High"], ["Balboa High"], ["International Studies Academy"], ["Asawa (Ruth) San Francisco School of the Arts, A Public School."], ["Marshall (Thurgood) High"], ["Leadership High"], ["Gateway High"], ["Galileo High"], ["Lincoln (Abraham) High"], ["Lowell High"], ["Mission High"], ["O'Connell (John) High"], ["Washington (George) High"], ["San Francisco Flex Academy"], ["Venture Academy"], ["Escalon High"], ["Lincoln High"], ["Linden High"], ["Aspire Benjamin Holt College Preparatory Academy"], ["Ronald E. McNair High"], ["Bear Creek High"], ["Middle College High"], ["Tokay High"], ["Lodi High"], ["Weston Ranch High"], ["Lathrop High"], ["Sierra High"], ["East Union High"], ["Manteca High"], ["Humphreys College Academy of Business, Law and Education"], ["Delta Charter"], ["California Connections Academy @ Ripon"], ["Ripon High"], ["Cesar Chavez High"], ["Aspire Langston Hughes Academy"], ["Stockton Unified Early College Academy"], ["Stockton Collegiate International Secondary"], ["Health Careers Academy"], ["Weber Institute"], ["Edison High"], ["Franklin High"], ["Stagg Senior High"], ["Millennium Charter"], ["John C. Kimball High"], ["Merrill F. West High"], ["Tracy High"], ["Atascadero High"], ["Nipomo High"], ["Arroyo Grande High"], ["Morro Bay High"], ["San Luis Obispo High"], ["Paso Robles High"], ["Coast Union High"], ["Half Moon Bay High"], ["Jefferson High"], ["Oceana High"], ["Terra Nova High"], ["Westmoor High"], ["Aragon High"], ["Capuchino High"], ["Hillsdale High"], ["Mills High"], ["San Mateo High"], ["Summit Preparatory Charter High"], ["Everest Public High"], ["East Palo Alto Academy"], ["Carlmont High"], ["Menlo-Atherton High"], ["Sequoia High"], ["Woodside High"], ["El Camino High"], ["South San Francisco High"], ["Carpinteria Senior High"], ["Cabrillo High"], ["Lompoc High"], ["Orcutt Academy Charter"], ["Pioneer Valley High"], ["Ernest Righetti High"], ["Santa Maria High"], ["Santa Ynez Valley Union High"], ["Alta Vista Alternative High"], ["Dos Pueblos Senior High"], ["San Marcos Senior High"], ["Santa Barbara Senior High"], ["Leadership Public Schools - San Jose"], ["University Preparatory Academy Charter"], ["Summit Public School: Tahoma"], ["Branham High"], ["Del Mar High"], ["Prospect High"], ["Westmont High"], ["KIPP San Jose Collegiate"], ["Summit Public School: Rainier"], ["Yerba Buena High"], ["Santa Teresa High"], ["Independence High"], ["Evergreen Valley High"], ["Andrew P. Hill High"], ["James Lick High"], ["Mount Pleasant High"], ["Oak Grove High"], ["William C. Overfelt High"], ["Piedmont Hills High"], ["Silver Creek High"], ["Fremont High"], ["Homestead High"], ["Dr. T. J. Owens Gilroy Early College Academy"], ["Christopher High"], ["Gilroy High"], ["Ann Sobrato High"], ["Live Oak High"], ["Los Altos High"], ["Mountain View High"], ["Gunderson High"], ["Abraham Lincoln High"], ["Pioneer High"], ["San Jos High"], ["Willow Glen High"], ["Santa Clara High"], ["Adrian Wilcox High"], ["Milpitas High"], ["District Office"], ["Pajaro Valley High"], ["Aptos High"], ["Watsonville High"], ["Ocean Grove Charter"], ["San Lorenzo Valley High"], ["Harbor High"], ["Santa Cruz High"], ["Soquel High"], ["West Valley High"], ["Anderson High"], ["Fall River Junior-Senior High"], ["University Preparatory"], ["Foothill High"], ["Enterprise High"], ["Shasta High"], ["Central Valley High"], ["Mt. Shasta High"], ["Weed High"], ["Yreka High"], ["Etna Union High"], ["Benicia High"], ["Dixon High"], ["Angelo Rodriguez High"], ["Armijo High"], ["Fairfield High"], ["Vanden High"], ["Will C. Wood High"], ["Elise P. Buckingham Charter Magnet High"], ["Vacaville High"], ["Jesse M. Bethel High"], ["Vallejo High"], ["Analy High"], ["El Molino High"], ["Cloverdale High"], ["Casa Grande High"], ["Petaluma High"], ["Roseland Charter"], ["Elsie Allen High"], ["Maria Carrillo High"], ["Montgomery High"], ["Piner High"], ["Santa Rosa High"], ["Sonoma Valley High"], ["Rancho Cotate High"], ["Windsor High"], ["Healdsburg High"], ["Valley Charter High"], ["Whitmore Charter High"], ["Central Valley High"], ["Ceres High"], ["Denair High"], ["James C. Enochs High"], ["Joseph A. Gregori High"], ["Fred C. Beyer High"], ["Peter Johansen High"], ["Grace M. Davis High"], ["Thomas Downey High"], ["Modesto High"], ["Patterson High"], ["Orestimba High"], ["Hughson High"], ["Riverbank High"], ["Oakdale High"], ["Waterford High"], ["Connecting Waters Charter"], ["John H. Pitman High"], ["Turlock High"], ["East Nicolaus High"], ["Live Oak High"], ["South Sutter Charter"], ["Sutter High"], ["River Valley High"], ["Yuba City High"], ["Corning High"], ["Los Molinos High"], ["Red Bluff High"], ["Trinity High"], ["University Preparatory High"], ["Orosi High"], ["Lindsay Senior High"], ["Mission Oak High"], ["Tulare Union High"], ["Tulare Western High"], ["Visalia Charter Independent Study"], ["Golden West High"], ["El Diamante High"], ["Mt. Whitney High"], ["Redwood High"], ["Farmersville High"], ["Harmony Magnet Academy"], ["Granite Hills High"], ["Monache High"], ["Porterville High"], ["Strathmore High"], ["Dinuba High"], ["Woodlake High"], ["Exeter Union High"], ["District Office"], ["Sonora High"], ["Summerville High"], ["Fillmore Senior High"], ["Nordhoff High"], ["Pacifica High"], ["Adolfo Camarillo High"], ["Channel Islands High"], ["Hueneme High"], ["Oxnard High"], ["Rio Mesa High"], ["Santa Susana High"], ["Royal High"], ["Simi Valley High"], ["El Camino High"], ["Foothill Technology High"], ["Buena High"], ["Ventura High"], ["District Office"], ["Westlake High"], ["Newbury Park High"], ["Thousand Oaks High"], ["The High School at Moorpark College"], ["Moorpark High"], ["District Office"], ["Santa Paula High"], ["Davis Senior High"], ["Esparto High"], ["River City High"], ["Winters High"], ["District Office"], ["Pioneer High"], ["Woodland Senior High"], ["Lindhurst High"], ["Marysville Charter Academy for the Arts"], ["Marysville High"], ["Wheatland Union High"]], "spark_error": null, "total_time": 12.682753086090088, "spark_time": 0.21148180961608887, "translation_time": 12.471271276473999, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='f417389c-3b1c-48bf-9510-658c465016e0'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='98ee845e-22e5-4b9d-a452-0c5462f15555'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}", "Observation: content='SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0' name='query_checker_sql_db' tool_call_id='38da70c9-bd1d-478d-9ed8-0e46f2038f3d'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0'}"], "input_tokens": 4451, "output_tokens": 1897, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500? Percent eligible for free meals = Free Meal Count (K-12) / Total (Enrollment (K-12)\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0\"}'}\nTool: SELECT T1.`School Name` FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.`Free Meal Count (K-12)` / T1.`Enrollment (K-12)`) > 0.1 AND T2.NumGE1500 > 0", "final_answer": "", "replica": 9, "timestamp": 1768937223.0171697}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015625, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS `s` JOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["La Sierra High", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Corona High", "None"], ["Eleanor Roosevelt High", "None"], ["River Springs Charter", "Directly funded"], ["Norco High", "None"], ["Norte Vista High", "None"], ["Temescal Canyon High", "None"], ["College Prep High", "Locally funded"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Shadow Hills High", "None"], ["Temecula Valley High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["Vista del Lago High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Elsinore High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Desert High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Nuview Bridge Early College High", "Locally funded"], ["Heritage High", "None"], ["John W. North High", "None"], ["California Military Institute", "Locally funded"], ["Perris High", "None"], ["Ramona High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Desert Hot Springs High", "None"], ["Coachella Valley High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["Murrieta Mesa High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Citrus Hill High", "None"], ["Temecula Preparatory", "Directly funded"], ["Desert Mirage High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Murrieta Valley High", "None"], ["NOVA Academy - Coachella", "Directly funded"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 18.00984239578247, "spark_time": 0.5439140796661377, "translation_time": 17.465928316116333, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='4f2b65dd-f270-42e7-9dad-9c472da21500'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='5cfb0a96-765e-4502-af06-5611f0ed6e22'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}", "Observation: content='The original query has a minor issue regarding the quoting of identifiers, as per the instruction \"Use ` for the in-query strings\" which typically refers to identifiers in Spark SQL. While the unquoted identifiers in the original query might work if they don\\'t conflict with keywords or contain special characters, it\\'s best practice to quote them with backticks (`) for robustness and clarity.\\n\\nHere\\'s the rewritten query with identifiers properly quoted:\\n\\n```sql\\nSELECT `s`.`School`, `s`.`FundingType`\\nFROM `schools` AS `s`\\nJOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname`\\nWHERE `s`.`County` = \\'Riverside\\'\\nGROUP BY `s`.`School`, `s`.`FundingType`\\nHAVING AVG(`sat`.`AvgScrMath`) > 400\\n```' name='query_checker_sql_db' tool_call_id='8081c6cb-0342-49a2-8f47-8583706ca72f'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS `s` JOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400\"}"], "input_tokens": 4015, "output_tokens": 2625, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}'}\nTool: The original query has a minor issue regarding the quoting of identifiers, as per the instruction \"Use ` for the in-query strings\" which typically refers to identifiers in Spark SQL. While the unquoted identifiers in the original query might work if they don't conflict with keywords or contain special characters, it's best practice to quote them with backticks (`) for robustness and clarity.\n\nHere's the rewritten query with identifiers properly quoted:\n\n```sql\nSELECT `s`.`School`, `s`.`FundingType`\nFROM `schools` AS `s`\nJOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname`\nWHERE `s`.`County` = 'Riverside'\nGROUP BY `s`.`School`, `s`.`FundingType`\nHAVING AVG(`sat`.`AvgScrMath`) > 400\n```", "final_answer": "", "replica": 0, "timestamp": 1768937242.1375356}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015384615384615385, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, `s`.`FundingType` FROM `schools` `s` JOIN `satscores` `sat` ON `s`.`CDSCode` = `sat`.`cds` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Coachella Valley High", "None"], ["Temescal Canyon High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["College Prep High", "Locally funded"], ["Nuview Bridge Early College High", "Locally funded"], ["La Sierra High", "None"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Heritage High", "None"], ["John W. North High", "None"], ["Murrieta Mesa High", "None"], ["None", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Shadow Hills High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Temecula Valley High", "None"], ["Citrus Hill High", "None"], ["California Military Institute", "Locally funded"], ["Temecula Preparatory", "Directly funded"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Vista del Lago High", "None"], ["Perris High", "None"], ["Ramona High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Corona High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Desert Mirage High", "None"], ["Elsinore High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Eleanor Roosevelt High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Murrieta Valley High", "None"], ["River Springs Charter", "Directly funded"], ["NOVA Academy - Coachella", "Directly funded"], ["Norco High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Norte Vista High", "None"], ["Palm Desert High", "None"], ["Desert Hot Springs High", "None"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 18.140944242477417, "spark_time": 0.263960599899292, "translation_time": 17.876983642578125, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b6d0c482-49a8-413d-aa8c-dd597062a1ed'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='36785a41-314e-43a2-b9ef-efe054cb9cfe'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}", "Observation: content='The query has a minor issue regarding the recommended practice of quoting identifiers with backticks (`) in Spark SQL, as mentioned in your checklist (\"Properly quoting identifiers\" and \"Use ` for the in-query strings\"). While the original query might execute successfully if the identifiers do not contain special characters or reserved keywords, it\\'s best practice to quote them for robustness and clarity.\\n\\nHere\\'s the rewritten query with identifiers properly quoted:\\n\\n```sql\\nSELECT `s`.`School`, `s`.`FundingType`\\nFROM `schools` `s`\\nJOIN `satscores` `sat` ON `s`.`CDSCode` = `sat`.`cds`\\nWHERE `s`.`County` = \\'Riverside\\'\\nGROUP BY `s`.`School`, `s`.`FundingType`\\nHAVING AVG(`sat`.`AvgScrMath`) > 400\\n```' name='query_checker_sql_db' tool_call_id='64ff53c3-6514-4874-a5fa-b81f776883bb'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`School`, `s`.`FundingType` FROM `schools` `s` JOIN `satscores` `sat` ON `s`.`CDSCode` = `sat`.`cds` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400\"}"], "input_tokens": 3975, "output_tokens": 1977, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}'}\nTool: The query has a minor issue regarding the recommended practice of quoting identifiers with backticks (`) in Spark SQL, as mentioned in your checklist (\"Properly quoting identifiers\" and \"Use ` for the in-query strings\"). While the original query might execute successfully if the identifiers do not contain special characters or reserved keywords, it's best practice to quote them for robustness and clarity.\n\nHere's the rewritten query with identifiers properly quoted:\n\n```sql\nSELECT `s`.`School`, `s`.`FundingType`\nFROM `schools` `s`\nJOIN `satscores` `sat` ON `s`.`CDSCode` = `sat`.`cds`\nWHERE `s`.`County` = 'Riverside'\nGROUP BY `s`.`School`, `s`.`FundingType`\nHAVING AVG(`sat`.`AvgScrMath`) > 400\n```", "final_answer": "", "replica": 1, "timestamp": 1768937261.267992}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015625, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS `s` JOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["La Sierra High", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Corona High", "None"], ["Eleanor Roosevelt High", "None"], ["River Springs Charter", "Directly funded"], ["Norco High", "None"], ["Norte Vista High", "None"], ["Temescal Canyon High", "None"], ["College Prep High", "Locally funded"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Shadow Hills High", "None"], ["Temecula Valley High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["Vista del Lago High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Elsinore High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Desert High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Nuview Bridge Early College High", "Locally funded"], ["Heritage High", "None"], ["John W. North High", "None"], ["California Military Institute", "Locally funded"], ["Perris High", "None"], ["Ramona High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Desert Hot Springs High", "None"], ["Coachella Valley High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["Murrieta Mesa High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Citrus Hill High", "None"], ["Temecula Preparatory", "Directly funded"], ["Desert Mirage High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Murrieta Valley High", "None"], ["NOVA Academy - Coachella", "Directly funded"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 20.645699739456177, "spark_time": 0.22017741203308105, "translation_time": 20.425522327423096, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='8f47c1c2-c4a2-4d04-a3a5-4a77b8be27b6'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='f08c41fc-4cce-4095-8a08-d065ec9a62f0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}", "Observation: content='The original query is mostly correct and follows standard SQL practices. However, the prompt specifically asks to \"Use ` for the in-query strings\" and \"Properly quoting identifiers\". In Spark SQL, backticks (`` ` ``) are commonly used to quote identifiers (table names, column names, aliases), especially if they might contain special characters, be keywords, or for general consistency.\\n\\nApplying backticks to all identifiers as per the instruction:\\n\\n```sql\\nSELECT `s`.`School`, `s`.`FundingType`\\nFROM `schools` AS `s`\\nJOIN `satscores` AS `sat`\\n  ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname`\\nWHERE `s`.`County` = \\'Riverside\\'\\nGROUP BY `s`.`School`, `s`.`FundingType`\\nHAVING AVG(`sat`.`AvgScrMath`) > 400\\n```' name='query_checker_sql_db' tool_call_id='eb6d10d4-cf07-488f-8bd0-97bda3c07026'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS `s` JOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400\"}"], "input_tokens": 4018, "output_tokens": 2554, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}'}\nTool: The original query is mostly correct and follows standard SQL practices. However, the prompt specifically asks to \"Use ` for the in-query strings\" and \"Properly quoting identifiers\". In Spark SQL, backticks (`` ` ``) are commonly used to quote identifiers (table names, column names, aliases), especially if they might contain special characters, be keywords, or for general consistency.\n\nApplying backticks to all identifiers as per the instruction:\n\n```sql\nSELECT `s`.`School`, `s`.`FundingType`\nFROM `schools` AS `s`\nJOIN `satscores` AS `sat`\n  ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname`\nWHERE `s`.`County` = 'Riverside'\nGROUP BY `s`.`School`, `s`.`FundingType`\nHAVING AVG(`sat`.`AvgScrMath`) > 400\n```", "final_answer": "", "replica": 2, "timestamp": 1768937282.8072503}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015625, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS s JOIN `satscores` AS sa ON `s`.`School` = `sa`.`sname` AND `s`.`County` = `sa`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sa`.`AvgScrMath`) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["La Sierra High", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Corona High", "None"], ["Eleanor Roosevelt High", "None"], ["River Springs Charter", "Directly funded"], ["Norco High", "None"], ["Norte Vista High", "None"], ["Temescal Canyon High", "None"], ["College Prep High", "Locally funded"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Shadow Hills High", "None"], ["Temecula Valley High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["Vista del Lago High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Elsinore High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Desert High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Nuview Bridge Early College High", "Locally funded"], ["Heritage High", "None"], ["John W. North High", "None"], ["California Military Institute", "Locally funded"], ["Perris High", "None"], ["Ramona High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Desert Hot Springs High", "None"], ["Coachella Valley High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["Murrieta Mesa High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Citrus Hill High", "None"], ["Temecula Preparatory", "Directly funded"], ["Desert Mirage High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Murrieta Valley High", "None"], ["NOVA Academy - Coachella", "Directly funded"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 15.793255805969238, "spark_time": 0.30300354957580566, "translation_time": 15.490252256393433, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='95425854-2cb1-4cb7-8a05-6099dda96bc4'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='cfb04df1-9821-4797-9eef-cec20a792cd2'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sa ON s.School = sa.sname AND s.County = sa.cname WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sa.AvgScrMath) > 400\"}", "Observation: content='The original query has a potential mistake regarding the proper quoting of identifiers, as specified in the instructions (\"Use ` for the in-query strings\" in the context of \"Properly quoting identifiers\"). In Spark SQL, it\\'s good practice to quote identifiers (table names, column names) with backticks, especially if they might contain special characters, spaces, or conflict with reserved keywords. While the identifiers in the original query are simple and might not strictly *require* backticks to function, following the instruction strictly means they should be quoted.\\n\\nHere\\'s the rewritten query with identifiers properly quoted using backticks:\\n\\n```sql\\nSELECT `s`.`School`, `s`.`FundingType`\\nFROM `schools` AS s\\nJOIN `satscores` AS sa ON `s`.`School` = `sa`.`sname` AND `s`.`County` = `sa`.`cname`\\nWHERE `s`.`County` = \\'Riverside\\'\\nGROUP BY `s`.`School`, `s`.`FundingType`\\nHAVING AVG(`sa`.`AvgScrMath`) > 400\\n```' name='query_checker_sql_db' tool_call_id='52c4ec76-d3a4-4557-8232-8c51d76e78ef'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS s JOIN `satscores` AS sa ON `s`.`School` = `sa`.`sname` AND `s`.`County` = `sa`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sa`.`AvgScrMath`) > 400\"}"], "input_tokens": 4046, "output_tokens": 2758, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sa ON s.School = sa.sname AND s.County = sa.cname WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sa.AvgScrMath) > 400\"}'}\nTool: The original query has a potential mistake regarding the proper quoting of identifiers, as specified in the instructions (\"Use ` for the in-query strings\" in the context of \"Properly quoting identifiers\"). In Spark SQL, it's good practice to quote identifiers (table names, column names) with backticks, especially if they might contain special characters, spaces, or conflict with reserved keywords. While the identifiers in the original query are simple and might not strictly *require* backticks to function, following the instruction strictly means they should be quoted.\n\nHere's the rewritten query with identifiers properly quoted using backticks:\n\n```sql\nSELECT `s`.`School`, `s`.`FundingType`\nFROM `schools` AS s\nJOIN `satscores` AS sa ON `s`.`School` = `sa`.`sname` AND `s`.`County` = `sa`.`cname`\nWHERE `s`.`County` = 'Riverside'\nGROUP BY `s`.`School`, `s`.`FundingType`\nHAVING AVG(`sa`.`AvgScrMath`) > 400\n```", "final_answer": "", "replica": 3, "timestamp": 1768937299.369501}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015384615384615385, "spider_em": 0, "sparksql_query": "SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Coachella Valley High", "None"], ["Temescal Canyon High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["College Prep High", "Locally funded"], ["Nuview Bridge Early College High", "Locally funded"], ["La Sierra High", "None"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Heritage High", "None"], ["John W. North High", "None"], ["Murrieta Mesa High", "None"], ["None", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Shadow Hills High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Temecula Valley High", "None"], ["Citrus Hill High", "None"], ["California Military Institute", "Locally funded"], ["Temecula Preparatory", "Directly funded"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Vista del Lago High", "None"], ["Perris High", "None"], ["Ramona High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Corona High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Desert Mirage High", "None"], ["Elsinore High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Eleanor Roosevelt High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Murrieta Valley High", "None"], ["River Springs Charter", "Directly funded"], ["NOVA Academy - Coachella", "Directly funded"], ["Norco High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Norte Vista High", "None"], ["Palm Desert High", "None"], ["Desert Hot Springs High", "None"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 14.488038778305054, "spark_time": 0.19408869743347168, "translation_time": 14.293950080871582, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c3b4718d-2eac-4a64-b856-f14af50e1f7d'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='b8fd2b5d-0bce-4df5-9a97-e607b0714619'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `s.County = 'Riverside'` and `AVG(sat.AvgScrMath) > 400` appear to use compatible data types (string comparison and numeric comparison, respectively).\\n*   **Properly quoting identifiers**: The identifiers (`s.School`, `s.FundingType`, `s.CDSCode`, `sat.cds`, `s.County`, `sat.AvgScrMath`) are simple and do not require special quoting (like backticks) in Spark SQL.\\n*   **Use `` ` `` for the in-query strings**: This instruction typically refers to quoting identifiers that might be reserved keywords or contain special characters. The identifiers used in the query are simple and do not strictly require backticks. Using them would be a stylistic choice rather than a correction for a mistake in this case.\\n*   **Using the correct number of arguments for functions**: `AVG(sat.AvgScrMath)` correctly uses one argument.\\n*   **Casting to the correct data type**: No explicit casting is used, and none appears necessary for the operations performed.\\n*   **Using the proper columns for joins**: The join condition `s.CDSCode = sat.cds` is a plausible and common way to link schools to their SAT scores, assuming `CDSCode` and `cds` are the respective unique identifiers.\\n\\nThe query is syntactically correct and follows standard SQL practices for Spark SQL.\\n\\n```sql\\nSELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\\n```\" name='query_checker_sql_db' tool_call_id='698c59e8-ba70-4f64-8619-720246c752fe'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}"], "input_tokens": 4240, "output_tokens": 2410, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `s.County = 'Riverside'` and `AVG(sat.AvgScrMath) > 400` appear to use compatible data types (string comparison and numeric comparison, respectively).\n*   **Properly quoting identifiers**: The identifiers (`s.School`, `s.FundingType`, `s.CDSCode`, `sat.cds`, `s.County`, `sat.AvgScrMath`) are simple and do not require special quoting (like backticks) in Spark SQL.\n*   **Use `` ` `` for the in-query strings**: This instruction typically refers to quoting identifiers that might be reserved keywords or contain special characters. The identifiers used in the query are simple and do not strictly require backticks. Using them would be a stylistic choice rather than a correction for a mistake in this case.\n*   **Using the correct number of arguments for functions**: `AVG(sat.AvgScrMath)` correctly uses one argument.\n*   **Casting to the correct data type**: No explicit casting is used, and none appears necessary for the operations performed.\n*   **Using the proper columns for joins**: The join condition `s.CDSCode = sat.cds` is a plausible and common way to link schools to their SAT scores, assuming `CDSCode` and `cds` are the respective unique identifiers.\n\nThe query is syntactically correct and follows standard SQL practices for Spark SQL.\n\n```sql\nSELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\n```", "final_answer": "", "replica": 4, "timestamp": 1768937314.7306168}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015625, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS s JOIN `satscores` AS sa ON `s`.`School` = `sa`.`sname` AND `s`.`County` = `sa`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sa`.`AvgScrMath`) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["La Sierra High", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Corona High", "None"], ["Eleanor Roosevelt High", "None"], ["River Springs Charter", "Directly funded"], ["Norco High", "None"], ["Norte Vista High", "None"], ["Temescal Canyon High", "None"], ["College Prep High", "Locally funded"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Shadow Hills High", "None"], ["Temecula Valley High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["Vista del Lago High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Elsinore High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Desert High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Nuview Bridge Early College High", "Locally funded"], ["Heritage High", "None"], ["John W. North High", "None"], ["California Military Institute", "Locally funded"], ["Perris High", "None"], ["Ramona High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Desert Hot Springs High", "None"], ["Coachella Valley High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["Murrieta Mesa High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Citrus Hill High", "None"], ["Temecula Preparatory", "Directly funded"], ["Desert Mirage High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Murrieta Valley High", "None"], ["NOVA Academy - Coachella", "Directly funded"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 17.65954327583313, "spark_time": 0.2134711742401123, "translation_time": 17.446072101593018, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='db4cd9d8-ca29-451c-befc-ed16a8080228'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='e4f94f35-c3d6-423c-9a62-0df5530c44bb'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sa ON s.School = sa.sname AND s.County = sa.cname WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sa.AvgScrMath) > 400\"}", "Observation: content='The original query has a potential mistake regarding the proper quoting of identifiers, as specified in the instructions (\"Use ` for the in-query strings\" in the context of \"Properly quoting identifiers\"). In Spark SQL, it\\'s good practice to quote identifiers (table names, column names) with backticks, especially if they might contain special characters, spaces, or conflict with reserved keywords. While the identifiers in the original query are simple and might not strictly *require* backticks to function, following the instruction strictly means they should be quoted.\\n\\nHere\\'s the rewritten query with identifiers properly quoted using backticks:\\n\\n```sql\\nSELECT `s`.`School`, `s`.`FundingType`\\nFROM `schools` AS s\\nJOIN `satscores` AS sa ON `s`.`School` = `sa`.`sname` AND `s`.`County` = `sa`.`cname`\\nWHERE `s`.`County` = \\'Riverside\\'\\nGROUP BY `s`.`School`, `s`.`FundingType`\\nHAVING AVG(`sa`.`AvgScrMath`) > 400\\n```' name='query_checker_sql_db' tool_call_id='2b05afc3-5132-4175-9ab4-c1d335a48c35'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS s JOIN `satscores` AS sa ON `s`.`School` = `sa`.`sname` AND `s`.`County` = `sa`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sa`.`AvgScrMath`) > 400\"}"], "input_tokens": 4046, "output_tokens": 2758, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sa ON s.School = sa.sname AND s.County = sa.cname WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sa.AvgScrMath) > 400\"}'}\nTool: The original query has a potential mistake regarding the proper quoting of identifiers, as specified in the instructions (\"Use ` for the in-query strings\" in the context of \"Properly quoting identifiers\"). In Spark SQL, it's good practice to quote identifiers (table names, column names) with backticks, especially if they might contain special characters, spaces, or conflict with reserved keywords. While the identifiers in the original query are simple and might not strictly *require* backticks to function, following the instruction strictly means they should be quoted.\n\nHere's the rewritten query with identifiers properly quoted using backticks:\n\n```sql\nSELECT `s`.`School`, `s`.`FundingType`\nFROM `schools` AS s\nJOIN `satscores` AS sa ON `s`.`School` = `sa`.`sname` AND `s`.`County` = `sa`.`cname`\nWHERE `s`.`County` = 'Riverside'\nGROUP BY `s`.`School`, `s`.`FundingType`\nHAVING AVG(`sa`.`AvgScrMath`) > 400\n```", "final_answer": "", "replica": 5, "timestamp": 1768937333.2321544}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015625, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS `s` JOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["La Sierra High", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Corona High", "None"], ["Eleanor Roosevelt High", "None"], ["River Springs Charter", "Directly funded"], ["Norco High", "None"], ["Norte Vista High", "None"], ["Temescal Canyon High", "None"], ["College Prep High", "Locally funded"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Shadow Hills High", "None"], ["Temecula Valley High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["Vista del Lago High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Elsinore High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Desert High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Nuview Bridge Early College High", "Locally funded"], ["Heritage High", "None"], ["John W. North High", "None"], ["California Military Institute", "Locally funded"], ["Perris High", "None"], ["Ramona High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Desert Hot Springs High", "None"], ["Coachella Valley High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["Murrieta Mesa High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Citrus Hill High", "None"], ["Temecula Preparatory", "Directly funded"], ["Desert Mirage High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Murrieta Valley High", "None"], ["NOVA Academy - Coachella", "Directly funded"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 23.38235831260681, "spark_time": 0.23652029037475586, "translation_time": 23.145838022232056, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d30ed31b-9123-4ab1-a7cf-2ec7f681f31e'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='d7e481dc-49b2-4e09-a57b-bde1aedd612e'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}", "Observation: content='The original query is mostly correct and follows standard SQL practices. However, the prompt specifically asks to \"Use ` for the in-query strings\" and \"Properly quoting identifiers\". In Spark SQL, backticks (`` ` ``) are commonly used to quote identifiers (table names, column names, aliases), especially if they might contain special characters, be keywords, or for general consistency.\\n\\nApplying backticks to all identifiers as per the instruction:\\n\\n```sql\\nSELECT `s`.`School`, `s`.`FundingType`\\nFROM `schools` AS `s`\\nJOIN `satscores` AS `sat`\\n  ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname`\\nWHERE `s`.`County` = \\'Riverside\\'\\nGROUP BY `s`.`School`, `s`.`FundingType`\\nHAVING AVG(`sat`.`AvgScrMath`) > 400\\n```' name='query_checker_sql_db' tool_call_id='d6af2c99-7e06-490c-993a-e10931531506'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS `s` JOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400\"}"], "input_tokens": 4018, "output_tokens": 2554, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}'}\nTool: The original query is mostly correct and follows standard SQL practices. However, the prompt specifically asks to \"Use ` for the in-query strings\" and \"Properly quoting identifiers\". In Spark SQL, backticks (`` ` ``) are commonly used to quote identifiers (table names, column names, aliases), especially if they might contain special characters, be keywords, or for general consistency.\n\nApplying backticks to all identifiers as per the instruction:\n\n```sql\nSELECT `s`.`School`, `s`.`FundingType`\nFROM `schools` AS `s`\nJOIN `satscores` AS `sat`\n  ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname`\nWHERE `s`.`County` = 'Riverside'\nGROUP BY `s`.`School`, `s`.`FundingType`\nHAVING AVG(`sat`.`AvgScrMath`) > 400\n```", "final_answer": "", "replica": 6, "timestamp": 1768937357.5165074}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015384615384615385, "spider_em": 0, "sparksql_query": "SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Coachella Valley High", "None"], ["Temescal Canyon High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["College Prep High", "Locally funded"], ["Nuview Bridge Early College High", "Locally funded"], ["La Sierra High", "None"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Heritage High", "None"], ["John W. North High", "None"], ["Murrieta Mesa High", "None"], ["None", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Shadow Hills High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Temecula Valley High", "None"], ["Citrus Hill High", "None"], ["California Military Institute", "Locally funded"], ["Temecula Preparatory", "Directly funded"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Vista del Lago High", "None"], ["Perris High", "None"], ["Ramona High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Corona High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Desert Mirage High", "None"], ["Elsinore High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Eleanor Roosevelt High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Murrieta Valley High", "None"], ["River Springs Charter", "Directly funded"], ["NOVA Academy - Coachella", "Directly funded"], ["Norco High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Norte Vista High", "None"], ["Palm Desert High", "None"], ["Desert Hot Springs High", "None"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 18.226216793060303, "spark_time": 0.20212316513061523, "translation_time": 18.024093627929688, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1b44574e-a856-4555-a831-9388b65da6d4'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='b18a134f-b25b-434a-84c8-ee38477ad344'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `s.County = 'Riverside'` and `AVG(sat.AvgScrMath) > 400` appear to use compatible data types (string comparison and numeric comparison, respectively).\\n*   **Properly quoting identifiers**: The identifiers (`s.School`, `s.FundingType`, `s.CDSCode`, `sat.cds`, `s.County`, `sat.AvgScrMath`) are simple and do not require special quoting (like backticks) in Spark SQL.\\n*   **Use `` ` `` for the in-query strings**: This instruction typically refers to quoting identifiers that might be reserved keywords or contain special characters. The identifiers used in the query are simple and do not strictly require backticks. Using them would be a stylistic choice rather than a correction for a mistake in this case.\\n*   **Using the correct number of arguments for functions**: `AVG(sat.AvgScrMath)` correctly uses one argument.\\n*   **Casting to the correct data type**: No explicit casting is used, and none appears necessary for the operations performed.\\n*   **Using the proper columns for joins**: The join condition `s.CDSCode = sat.cds` is a plausible and common way to link schools to their SAT scores, assuming `CDSCode` and `cds` are the respective unique identifiers.\\n\\nThe query is syntactically correct and follows standard SQL practices for Spark SQL.\\n\\n```sql\\nSELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\\n```\" name='query_checker_sql_db' tool_call_id='7d005eae-d492-4d42-abe5-63208f060d6e'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}"], "input_tokens": 4240, "output_tokens": 2458, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `s.County = 'Riverside'` and `AVG(sat.AvgScrMath) > 400` appear to use compatible data types (string comparison and numeric comparison, respectively).\n*   **Properly quoting identifiers**: The identifiers (`s.School`, `s.FundingType`, `s.CDSCode`, `sat.cds`, `s.County`, `sat.AvgScrMath`) are simple and do not require special quoting (like backticks) in Spark SQL.\n*   **Use `` ` `` for the in-query strings**: This instruction typically refers to quoting identifiers that might be reserved keywords or contain special characters. The identifiers used in the query are simple and do not strictly require backticks. Using them would be a stylistic choice rather than a correction for a mistake in this case.\n*   **Using the correct number of arguments for functions**: `AVG(sat.AvgScrMath)` correctly uses one argument.\n*   **Casting to the correct data type**: No explicit casting is used, and none appears necessary for the operations performed.\n*   **Using the proper columns for joins**: The join condition `s.CDSCode = sat.cds` is a plausible and common way to link schools to their SAT scores, assuming `CDSCode` and `cds` are the respective unique identifiers.\n\nThe query is syntactically correct and follows standard SQL practices for Spark SQL.\n\n```sql\nSELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\n```", "final_answer": "", "replica": 7, "timestamp": 1768937376.457727}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015625, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS `s` JOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["La Sierra High", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Corona High", "None"], ["Eleanor Roosevelt High", "None"], ["River Springs Charter", "Directly funded"], ["Norco High", "None"], ["Norte Vista High", "None"], ["Temescal Canyon High", "None"], ["College Prep High", "Locally funded"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Shadow Hills High", "None"], ["Temecula Valley High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["Vista del Lago High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Elsinore High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Desert High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Nuview Bridge Early College High", "Locally funded"], ["Heritage High", "None"], ["John W. North High", "None"], ["California Military Institute", "Locally funded"], ["Perris High", "None"], ["Ramona High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Desert Hot Springs High", "None"], ["Coachella Valley High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["Murrieta Mesa High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Citrus Hill High", "None"], ["Temecula Preparatory", "Directly funded"], ["Desert Mirage High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Murrieta Valley High", "None"], ["NOVA Academy - Coachella", "Directly funded"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 14.614753007888794, "spark_time": 0.22500157356262207, "translation_time": 14.389751434326172, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b6c338cf-54e3-4a58-92b9-e5d03285bece'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='863c9a92-33fd-4206-b73f-cade1473ac22'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}", "Observation: content='The original query is mostly correct and follows standard SQL practices. However, the prompt specifically asks to \"Use ` for the in-query strings\" and \"Properly quoting identifiers\". In Spark SQL, backticks (`` ` ``) are commonly used to quote identifiers (table names, column names, aliases), especially if they might contain special characters, be keywords, or for general consistency.\\n\\nApplying backticks to all identifiers as per the instruction:\\n\\n```sql\\nSELECT `s`.`School`, `s`.`FundingType`\\nFROM `schools` AS `s`\\nJOIN `satscores` AS `sat`\\n  ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname`\\nWHERE `s`.`County` = \\'Riverside\\'\\nGROUP BY `s`.`School`, `s`.`FundingType`\\nHAVING AVG(`sat`.`AvgScrMath`) > 400\\n```' name='query_checker_sql_db' tool_call_id='098b76b3-3e40-451c-8f60-482323b299c6'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `s`.`School`, `s`.`FundingType` FROM `schools` AS `s` JOIN `satscores` AS `sat` ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname` WHERE `s`.`County` = 'Riverside' GROUP BY `s`.`School`, `s`.`FundingType` HAVING AVG(`sat`.`AvgScrMath`) > 400\"}"], "input_tokens": 4018, "output_tokens": 2554, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}'}\nTool: The original query is mostly correct and follows standard SQL practices. However, the prompt specifically asks to \"Use ` for the in-query strings\" and \"Properly quoting identifiers\". In Spark SQL, backticks (`` ` ``) are commonly used to quote identifiers (table names, column names, aliases), especially if they might contain special characters, be keywords, or for general consistency.\n\nApplying backticks to all identifiers as per the instruction:\n\n```sql\nSELECT `s`.`School`, `s`.`FundingType`\nFROM `schools` AS `s`\nJOIN `satscores` AS `sat`\n  ON `s`.`School` = `sat`.`sname` AND `s`.`County` = `sat`.`cname`\nWHERE `s`.`County` = 'Riverside'\nGROUP BY `s`.`School`, `s`.`FundingType`\nHAVING AVG(`sat`.`AvgScrMath`) > 400\n```", "final_answer": "", "replica": 8, "timestamp": 1768937391.9905164}
{"query_id": 25, "provider": "google", "db": "california_schools", "nl_query": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).", "gold_sqlite": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400", "gold_spark": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS FLOAT) / COUNT(T1.cds) > 400", "jaccard": 0.015384615384615385, "spider_em": 0, "sparksql_query": "SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400", "execution_status": "VALID", "query_result": [["John F. Kennedy High", "None"], ["Palo Verde High", "None"], ["Martin Luther King Jr. High", "None"], ["Coachella Valley High", "None"], ["Temescal Canyon High", "None"], ["Chaparral High", "None"], ["Rancho Verde High", "None"], ["College Prep High", "Locally funded"], ["Nuview Bridge Early College High", "Locally funded"], ["La Sierra High", "None"], ["Hemet High", "None"], ["Moreno Valley High", "None"], ["Heritage High", "None"], ["John W. North High", "None"], ["Murrieta Mesa High", "None"], ["None", "None"], ["Banning High", "None"], ["Santiago High", "None"], ["Shadow Hills High", "None"], ["Hamilton High", "None"], ["Patriot High", "None"], ["San Jacinto High", "None"], ["Lakeside High", "None"], ["Temecula Valley High", "None"], ["Citrus Hill High", "None"], ["California Military Institute", "Locally funded"], ["Temecula Preparatory", "Directly funded"], ["Beaumont Senior High", "None"], ["Centennial High", "None"], ["Vista del Lago High", "None"], ["Perris High", "None"], ["Ramona High", "None"], ["Santa Rosa Academy", "Directly funded"], ["Corona High", "None"], ["West Valley High", "None"], ["Jurupa Valley High", "None"], ["Desert Mirage High", "None"], ["Elsinore High", "None"], ["San Jacinto Valley Academy", "Directly funded"], ["Eleanor Roosevelt High", "None"], ["Tahquitz High", "None"], ["Rubidoux High", "None"], ["Valley View High", "None"], ["Cathedral City High", "None"], ["Paloma Valley High", "None"], ["Polytechnic High", "None"], ["Murrieta Valley High", "None"], ["River Springs Charter", "Directly funded"], ["NOVA Academy - Coachella", "Directly funded"], ["Norco High", "None"], ["La Quinta High", "None"], ["Indio High", "None"], ["Canyon Springs High", "None"], ["Palm Springs High", "None"], ["Arlington High", "None"], ["Norte Vista High", "None"], ["Palm Desert High", "None"], ["Desert Hot Springs High", "None"], ["Great Oak High", "None"], ["Vista Murrieta High", "None"]], "spark_error": null, "total_time": 23.739769220352173, "spark_time": 0.18000030517578125, "translation_time": 23.55976891517639, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='23d6ec5c-2c75-4fb8-8f3a-94ff78636130'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='c30ddfd0-e835-4538-8735-87657969a31b'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `s.County = 'Riverside'` and `AVG(sat.AvgScrMath) > 400` appear to use compatible data types (string comparison and numeric comparison, respectively).\\n*   **Properly quoting identifiers**: The identifiers (`s.School`, `s.FundingType`, `s.CDSCode`, `sat.cds`, `s.County`, `sat.AvgScrMath`) are simple and do not require special quoting (like backticks) in Spark SQL.\\n*   **Use `` ` `` for the in-query strings**: This instruction typically refers to quoting identifiers that might be reserved keywords or contain special characters. The identifiers used in the query are simple and do not strictly require backticks. Using them would be a stylistic choice rather than a correction for a mistake in this case.\\n*   **Using the correct number of arguments for functions**: `AVG(sat.AvgScrMath)` correctly uses one argument.\\n*   **Casting to the correct data type**: No explicit casting is used, and none appears necessary for the operations performed.\\n*   **Using the proper columns for joins**: The join condition `s.CDSCode = sat.cds` is a plausible and common way to link schools to their SAT scores, assuming `CDSCode` and `cds` are the respective unique identifiers.\\n\\nThe query is syntactically correct and follows standard SQL practices for Spark SQL.\\n\\n```sql\\nSELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\\n```\" name='query_checker_sql_db' tool_call_id='4ef650b9-0924-4684-aa32-98c5d3289f95'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}"], "input_tokens": 4240, "output_tokens": 2410, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools? Average of average math = sum(average math scores) / count(schools).\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = \\'Riverside\\' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `s.County = 'Riverside'` and `AVG(sat.AvgScrMath) > 400` appear to use compatible data types (string comparison and numeric comparison, respectively).\n*   **Properly quoting identifiers**: The identifiers (`s.School`, `s.FundingType`, `s.CDSCode`, `sat.cds`, `s.County`, `sat.AvgScrMath`) are simple and do not require special quoting (like backticks) in Spark SQL.\n*   **Use `` ` `` for the in-query strings**: This instruction typically refers to quoting identifiers that might be reserved keywords or contain special characters. The identifiers used in the query are simple and do not strictly require backticks. Using them would be a stylistic choice rather than a correction for a mistake in this case.\n*   **Using the correct number of arguments for functions**: `AVG(sat.AvgScrMath)` correctly uses one argument.\n*   **Casting to the correct data type**: No explicit casting is used, and none appears necessary for the operations performed.\n*   **Using the proper columns for joins**: The join condition `s.CDSCode = sat.cds` is a plausible and common way to link schools to their SAT scores, assuming `CDSCode` and `cds` are the respective unique identifiers.\n\nThe query is syntactically correct and follows standard SQL practices for Spark SQL.\n\n```sql\nSELECT s.School, s.FundingType FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.County = 'Riverside' GROUP BY s.School, s.FundingType HAVING AVG(sat.AvgScrMath) > 400\n```", "final_answer": "", "replica": 9, "timestamp": 1768937416.5552835}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'Adult' of the type \"STRING\" cannot be cast to \"BIGINT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 182) ==\n... WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)`...\n                                   ^^^^^^^^^^^^^^^^^^^^\n", "total_time": 21.536449193954468, "spark_time": 0.18180489540100098, "translation_time": 21.354644298553467, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='883a840a-219b-475f-a3db-c4903331e31e'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a9594345-9d03-483a-a433-f7aa5fe4092f'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content=\"The query has one potential data type mismatch in a predicate.\\n\\n*   **Data type mismatch in predicates**: The condition `T2.`High Grade` = '12'` compares the `High Grade` column to a string literal `'12'`. While Spark SQL might implicitly cast, it's generally safer and clearer to match data types. If `High Grade` is an integer column (which is common for grade levels), it should be compared to an integer literal `12`.\\n\\nAssuming `T2.`High Grade`` is an integer column, the corrected query is:\\n\\n```sql\\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\\n```\" name='query_checker_sql_db' tool_call_id='571710a5-253b-43aa-a6b7-752a4c173a87'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4461, "output_tokens": 2788, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = \\'Monterey\\' AND T2.`High Grade` = \\'12\\' AND T2.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: The query has one potential data type mismatch in a predicate.\n\n*   **Data type mismatch in predicates**: The condition `T2.`High Grade` = '12'` compares the `High Grade` column to a string literal `'12'`. While Spark SQL might implicitly cast, it's generally safer and clearer to match data types. If `High Grade` is an integer column (which is common for grade levels), it should be compared to an integer literal `12`.\n\nAssuming `T2.`High Grade`` is an integer column, the corrected query is:\n\n```sql\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\n```", "final_answer": "", "replica": 0, "timestamp": 1768937438.2527316}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'Adult' of the type \"STRING\" cannot be cast to \"BIGINT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 182) ==\n... WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)`...\n                                   ^^^^^^^^^^^^^^^^^^^^\n", "total_time": 21.872135877609253, "spark_time": 0.11797285079956055, "translation_time": 21.754163026809692, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='6ca366d0-e84e-4b26-92a7-59d4a6c6c6d2'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='76781c5d-9aef-4d02-8ee0-8401c10a96de'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content=\"The query has one potential data type mismatch in a predicate.\\n\\n*   **Data type mismatch in predicates**: The condition `T2.`High Grade` = '12'` compares the `High Grade` column to a string literal `'12'`. While Spark SQL might implicitly cast, it's generally safer and clearer to match data types. If `High Grade` is an integer column (which is common for grade levels), it should be compared to an integer literal `12`.\\n\\nAssuming `T2.`High Grade`` is an integer column, the corrected query is:\\n\\n```sql\\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\\n```\" name='query_checker_sql_db' tool_call_id='89a8f1cf-15fb-4258-bed3-f1f199101984'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4461, "output_tokens": 2788, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = \\'Monterey\\' AND T2.`High Grade` = \\'12\\' AND T2.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: The query has one potential data type mismatch in a predicate.\n\n*   **Data type mismatch in predicates**: The condition `T2.`High Grade` = '12'` compares the `High Grade` column to a string literal `'12'`. While Spark SQL might implicitly cast, it's generally safer and clearer to match data types. If `High Grade` is an integer column (which is common for grade levels), it should be compared to an integer literal `12`.\n\nAssuming `T2.`High Grade`` is an integer column, the corrected query is:\n\n```sql\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\n```", "final_answer": "", "replica": 1, "timestamp": 1768937460.349866}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.Street, s.City, s.State, s.Zip FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.City = 'Monterey' AND f.`School Type` = 'High School' AND f.`FRPM Count (Ages 5-17)` > 800", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 20.93594002723694, "spark_time": 0.11418342590332031, "translation_time": 20.821756601333618, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1d7b721e-cb7e-4a23-8fde-0d37388b2111'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='0695a9d7-a828-4b53-940f-ff7e245dbc7b'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.Street, s.City, s.State, s.Zip FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.City = 'Monterey' AND f.`School Type` = 'High School' AND f.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content=\"SELECT s.School, s.Street, s.City, s.State, s.Zip FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.City = 'Monterey' AND f.`School Type` = 'High School' AND f.`FRPM Count (Ages 5-17)` > 800\" name='query_checker_sql_db' tool_call_id='850ccc5c-3c01-4c11-b1b3-a3ad7a2b38ab'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, s.Street, s.City, s.State, s.Zip FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.City = 'Monterey' AND f.`School Type` = 'High School' AND f.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4254, "output_tokens": 1791, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Street, s.City, s.State, s.Zip FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.City = \\'Monterey\\' AND f.`School Type` = \\'High School\\' AND f.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: SELECT s.School, s.Street, s.City, s.State, s.Zip FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.City = 'Monterey' AND f.`School Type` = 'High School' AND f.`FRPM Count (Ages 5-17)` > 800", "final_answer": "", "replica": 2, "timestamp": 1768937482.155322}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Monterey' AND T2.`FRPM Count (Ages 5-17)` > 800 AND T2.`School Type` = 'High School'", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 15.16956615447998, "spark_time": 0.0748896598815918, "translation_time": 15.094676494598389, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='27b4478a-d039-402f-aefe-4035a8fa790c'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='1ccd5f7f-bcb9-46ca-925e-64c3f8cd9149'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Monterey' AND T2.`FRPM Count (Ages 5-17)` > 800 AND T2.`School Type` = 'High School'\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION` or `UNION ALL`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (`T1.City = 'Monterey'`, `T2.`FRPM Count (Ages 5-17)` > 800`, `T2.`School Type` = 'High School'`) are consistent (string with string, numeric with numeric).\\n*   Identifiers are properly quoted: `FRPM Count (Ages 5-17)` and `School Type` use backticks (` `) as required for names with spaces, while simple column names and table aliases do not need them.\\n*   String literals (`'Monterey'`, `'High School'`) correctly use single quotes.\\n*   It does not use any functions, so argument count is not an issue.\\n*   No explicit casting is used or seems necessary.\\n*   The join condition `T1.CDSCode = T2.CDSCode` uses appropriate columns, assuming `CDSCode` is the common key between the `schools` and `frpm` tables.\\n\\n```sql\\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Monterey' AND T2.`FRPM Count (Ages 5-17)` > 800 AND T2.`School Type` = 'High School'\\n```\" name='query_checker_sql_db' tool_call_id='e64686b6-ecf9-4857-9c9b-abb8fdc789c3'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Monterey' AND T2.`FRPM Count (Ages 5-17)` > 800 AND T2.`School Type` = 'High School'\"}"], "input_tokens": 4576, "output_tokens": 2602, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = \\'Monterey\\' AND T2.`FRPM Count (Ages 5-17)` > 800 AND T2.`School Type` = \\'High School\\'\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION` or `UNION ALL`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (`T1.City = 'Monterey'`, `T2.`FRPM Count (Ages 5-17)` > 800`, `T2.`School Type` = 'High School'`) are consistent (string with string, numeric with numeric).\n*   Identifiers are properly quoted: `FRPM Count (Ages 5-17)` and `School Type` use backticks (` `) as required for names with spaces, while simple column names and table aliases do not need them.\n*   String literals (`'Monterey'`, `'High School'`) correctly use single quotes.\n*   It does not use any functions, so argument count is not an issue.\n*   No explicit casting is used or seems necessary.\n*   The join condition `T1.CDSCode = T2.CDSCode` uses appropriate columns, assuming `CDSCode` is the common key between the `schools` and `frpm` tables.\n\n```sql\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.City = 'Monterey' AND T2.`FRPM Count (Ages 5-17)` > 800 AND T2.`School Type` = 'High School'\n```", "final_answer": "", "replica": 3, "timestamp": 1768937498.0994005}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 17.58802032470703, "spark_time": 0.2259972095489502, "translation_time": 17.36202311515808, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b89e8a18-f9aa-4401-9e32-dae4d6960fde'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='5ad98258-b4d9-4891-9b9a-fcd347ed2b7a'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values:** Not used.\\n*   **UNION vs. UNION ALL:** Not used.\\n*   **BETWEEN for exclusive ranges:** Not used.\\n*   **Data type mismatch in predicates:**\\n    *   `T2.City = 'Monterey'`: String comparison, correct.\\n    *   `T1.`High Grade` = '12'`: String comparison, assuming `High Grade` is stored as a string (e.g., 'K', '1', '12'), which is common. If it were an integer, it would be `12` without quotes, but this is a plausible string comparison.\\n    *   `T1.`FRPM Count (Ages 5-17)` > 800`: Numeric comparison, correct.\\n*   **Properly quoting identifiers:** Backticks (`) are correctly used for identifiers containing spaces or special characters (`School Name`, `High Grade`, `FRPM Count (Ages 5-17)`). Other identifiers without spaces are not quoted, which is also correct.\\n*   **Use ` for the in-query strings:** Single quotes (`'`) are correctly used for string literals (`'Monterey'`, `'12'`). (Assuming the prompt meant single quotes for strings, as backticks are for identifiers).\\n*   **Correct number of arguments for functions:** No functions are used.\\n*   **Casting to the correct data type:** No explicit casting is used, and implicit casting (if any) seems appropriate for the comparisons.\\n*   **Proper columns for joins:** `T1.CDSCode = T2.CDSCode` is a logical and common join condition between a `frpm` table and a `schools` table, using a unique school identifier.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\\n```\" name='query_checker_sql_db' tool_call_id='a4380be6-a15b-4719-9cd3-cae75488a1db'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4723, "output_tokens": 2764, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Monterey\\' AND T1.`High Grade` = \\'12\\' AND T1.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values:** Not used.\n*   **UNION vs. UNION ALL:** Not used.\n*   **BETWEEN for exclusive ranges:** Not used.\n*   **Data type mismatch in predicates:**\n    *   `T2.City = 'Monterey'`: String comparison, correct.\n    *   `T1.`High Grade` = '12'`: String comparison, assuming `High Grade` is stored as a string (e.g., 'K', '1', '12'), which is common. If it were an integer, it would be `12` without quotes, but this is a plausible string comparison.\n    *   `T1.`FRPM Count (Ages 5-17)` > 800`: Numeric comparison, correct.\n*   **Properly quoting identifiers:** Backticks (`) are correctly used for identifiers containing spaces or special characters (`School Name`, `High Grade`, `FRPM Count (Ages 5-17)`). Other identifiers without spaces are not quoted, which is also correct.\n*   **Use ` for the in-query strings:** Single quotes (`'`) are correctly used for string literals (`'Monterey'`, `'12'`). (Assuming the prompt meant single quotes for strings, as backticks are for identifiers).\n*   **Correct number of arguments for functions:** No functions are used.\n*   **Casting to the correct data type:** No explicit casting is used, and implicit casting (if any) seems appropriate for the comparisons.\n*   **Proper columns for joins:** `T1.CDSCode = T2.CDSCode` is a logical and common join condition between a `frpm` table and a `schools` table, using a unique school identifier.\n\nThe query is correct as written.\n\n```sql\nSELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\n```", "final_answer": "", "replica": 4, "timestamp": 1768937516.522938}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 14.216375350952148, "spark_time": 0.17810320854187012, "translation_time": 14.038272142410278, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='5c5d04e1-a046-48dd-b05a-32bcc2805c07'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f5d8a69a-0afa-4d5d-8f98-022ec35a30ad'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content=\"The Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` or `UNION`.\\n*   It does not use `BETWEEN`.\\n*   Data type comparisons in predicates (`'Monterey'`, `'12'`, `800`) are consistent with common data types for such columns (string for city and grade, numeric for count).\\n*   Identifiers with spaces or special characters (`School Name`, `High Grade`, `FRPM Count (Ages 5-17)`) are correctly quoted using backticks.\\n*   String literals (`'Monterey'`, `'12'`) are correctly enclosed in single quotes.\\n*   No functions are used, so argument count is not an issue.\\n*   No explicit casting is performed, and implicit casting (if any) is likely handled correctly by Spark SQL for the given predicates.\\n*   The join conditions (`T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name``) are logical and appropriate for linking school data.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800\\n```\" name='query_checker_sql_db' tool_call_id='a3a73dbd-bd79-4073-89ef-69394821c858'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4587, "output_tokens": 2405, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = \\'Monterey\\' AND T2.`High Grade` = \\'12\\' AND T2.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: The Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` or `UNION`.\n*   It does not use `BETWEEN`.\n*   Data type comparisons in predicates (`'Monterey'`, `'12'`, `800`) are consistent with common data types for such columns (string for city and grade, numeric for count).\n*   Identifiers with spaces or special characters (`School Name`, `High Grade`, `FRPM Count (Ages 5-17)`) are correctly quoted using backticks.\n*   String literals (`'Monterey'`, `'12'`) are correctly enclosed in single quotes.\n*   No functions are used, so argument count is not an issue.\n*   No explicit casting is performed, and implicit casting (if any) is likely handled correctly by Spark SQL for the given predicates.\n*   The join conditions (`T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name``) are logical and appropriate for linking school data.\n\nThe query is correct as written.\n\n```sql\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800\n```", "final_answer": "", "replica": 5, "timestamp": 1768937531.4883113}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'Adult' of the type \"STRING\" cannot be cast to \"BIGINT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 182) ==\n... WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)`...\n                                   ^^^^^^^^^^^^^^^^^^^^\n", "total_time": 17.258506059646606, "spark_time": 0.11103129386901855, "translation_time": 17.147474765777588, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='e868a9d5-e750-439e-80ce-9b1e4a3267c3'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='c73a16af-c2b2-4bd0-ade4-68e7076b6ce8'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content=\"The query has one potential data type mismatch in a predicate.\\n\\n*   **Data type mismatch in predicates**: The condition `T2.`High Grade` = '12'` compares the `High Grade` column to a string literal `'12'`. While Spark SQL might implicitly cast, it's generally safer and clearer to match data types. If `High Grade` is an integer column (which is common for grade levels), it should be compared to an integer literal `12`.\\n\\nAssuming `T2.`High Grade`` is an integer column, the corrected query is:\\n\\n```sql\\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\\n```\" name='query_checker_sql_db' tool_call_id='08534e68-2910-4990-9024-25885ed3c503'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4461, "output_tokens": 2788, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = \\'Monterey\\' AND T2.`High Grade` = \\'12\\' AND T2.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: The query has one potential data type mismatch in a predicate.\n\n*   **Data type mismatch in predicates**: The condition `T2.`High Grade` = '12'` compares the `High Grade` column to a string literal `'12'`. While Spark SQL might implicitly cast, it's generally safer and clearer to match data types. If `High Grade` is an integer column (which is common for grade levels), it should be compared to an integer literal `12`.\n\nAssuming `T2.`High Grade`` is an integer column, the corrected query is:\n\n```sql\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\n```", "final_answer": "", "replica": 6, "timestamp": 1768937548.8798168}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'Adult' of the type \"STRING\" cannot be cast to \"BIGINT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 182) ==\n... WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)`...\n                                   ^^^^^^^^^^^^^^^^^^^^\n", "total_time": 16.38759469985962, "spark_time": 0.09691524505615234, "translation_time": 16.290679454803467, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b727f49b-507e-4ab4-ad03-c8bc651f3036'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='e6327401-6f82-424b-8114-6eb1794f78e7'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content=\"The query has one potential data type mismatch in a predicate.\\n\\n*   **Data type mismatch in predicates**: The condition `T2.`High Grade` = '12'` compares the `High Grade` column to a string literal `'12'`. While Spark SQL might implicitly cast, it's generally safer and clearer to match data types. If `High Grade` is an integer column (which is common for grade levels), it should be compared to an integer literal `12`.\\n\\nAssuming `T2.`High Grade`` is an integer column, the corrected query is:\\n\\n```sql\\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\\n```\" name='query_checker_sql_db' tool_call_id='da11b18f-f6d9-4dd1-a74c-f28e16f37022'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4461, "output_tokens": 2788, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = \\'Monterey\\' AND T2.`High Grade` = \\'12\\' AND T2.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: The query has one potential data type mismatch in a predicate.\n\n*   **Data type mismatch in predicates**: The condition `T2.`High Grade` = '12'` compares the `High Grade` column to a string literal `'12'`. While Spark SQL might implicitly cast, it's generally safer and clearer to match data types. If `High Grade` is an integer column (which is common for grade levels), it should be compared to an integer literal `12`.\n\nAssuming `T2.`High Grade`` is an integer column, the corrected query is:\n\n```sql\nSELECT T1.School, T1.Street, T1.City, T1.State, T1.Zip FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode AND T1.School = T2.`School Name` WHERE T1.City = 'Monterey' AND T2.`High Grade` = 12 AND T2.`FRPM Count (Ages 5-17)` > 800\n```", "final_answer": "", "replica": 7, "timestamp": 1768937565.5009496}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 20.408047676086426, "spark_time": 0.145798921585083, "translation_time": 20.262248754501343, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d448ad3a-16fe-4fb2-bbe7-262d69ff969f'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='966af282-0a9e-4617-bf87-533c0ec46a37'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content='The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values:** Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used:** Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges:** Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates:** The predicates `T2.City = \\'Monterey\\'`, `T1.`High Grade` = \\'12\\'`, and `T1.`FRPM Count (Ages 5-17)` > 800` seem to use appropriate data types (string vs. string, numeric vs. numeric, or implicitly castable types).\\n*   **Properly quoting identifiers:** Identifiers with spaces or special characters (`School Name`, `High Grade`, `FRPM Count (Ages 5-17)`) are correctly quoted using backticks (` `), which is standard for Spark SQL. Other identifiers are unquoted, which is also correct.\\n*   **Use ` for the in-query strings:** String literals (`\\'Monterey\\'`, `\\'12\\'`) are correctly quoted with single quotes (`\\'`), which is the standard for SQL strings. Backticks are for identifiers, not string literals. Assuming the prompt meant \"properly quote string literals with single quotes\", this is correct.\\n*   **Using the correct number of arguments for functions:** Not applicable, no functions are used.\\n*   **Casting to the correct data type:** No explicit casting is used, and implicit casting where it might occur (e.g., comparing a string \\'12\\' to a numeric `High Grade` if it were numeric) is generally handled gracefully by Spark SQL, or `High Grade` is indeed a string type.\\n*   **Using the proper columns for joins:** The join condition `T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common and appropriate key for joining school-related datasets.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Monterey\\' AND T1.`High Grade` = \\'12\\' AND T1.`FRPM Count (Ages 5-17)` > 800\\n```' name='query_checker_sql_db' tool_call_id='a9a3f335-8260-42c2-a732-358e91959440'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4760, "output_tokens": 2777, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Monterey\\' AND T1.`High Grade` = \\'12\\' AND T1.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values:** Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used:** Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges:** Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates:** The predicates `T2.City = 'Monterey'`, `T1.`High Grade` = '12'`, and `T1.`FRPM Count (Ages 5-17)` > 800` seem to use appropriate data types (string vs. string, numeric vs. numeric, or implicitly castable types).\n*   **Properly quoting identifiers:** Identifiers with spaces or special characters (`School Name`, `High Grade`, `FRPM Count (Ages 5-17)`) are correctly quoted using backticks (` `), which is standard for Spark SQL. Other identifiers are unquoted, which is also correct.\n*   **Use ` for the in-query strings:** String literals (`'Monterey'`, `'12'`) are correctly quoted with single quotes (`'`), which is the standard for SQL strings. Backticks are for identifiers, not string literals. Assuming the prompt meant \"properly quote string literals with single quotes\", this is correct.\n*   **Using the correct number of arguments for functions:** Not applicable, no functions are used.\n*   **Casting to the correct data type:** No explicit casting is used, and implicit casting where it might occur (e.g., comparing a string '12' to a numeric `High Grade` if it were numeric) is generally handled gracefully by Spark SQL, or `High Grade` is indeed a string type.\n*   **Using the proper columns for joins:** The join condition `T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common and appropriate key for joining school-related datasets.\n\nThe query is correct as written.\n\n```sql\nSELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\n```", "final_answer": "", "replica": 8, "timestamp": 1768937586.6800938}
{"query_id": 26, "provider": "google", "db": "california_schools", "nl_query": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.", "gold_sqlite": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "gold_spark": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 22.10757279396057, "spark_time": 0.1270158290863037, "translation_time": 21.980556964874268, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='22c6e7ee-6c35-4973-9444-99cf684a1b39'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='52ee6cac-f84e-4cc1-982f-adea78cf6df5'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\"}", "Observation: content='The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values:** Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used:** Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges:** Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates:** The predicates `T2.City = \\'Monterey\\'`, `T1.`High Grade` = \\'12\\'`, and `T1.`FRPM Count (Ages 5-17)` > 800` seem to use appropriate data types (string vs. string, numeric vs. numeric, or implicitly castable types).\\n*   **Properly quoting identifiers:** Identifiers with spaces or special characters (`School Name`, `High Grade`, `FRPM Count (Ages 5-17)`) are correctly quoted using backticks (` `), which is standard for Spark SQL. Other identifiers are unquoted, which is also correct.\\n*   **Use ` for the in-query strings:** String literals (`\\'Monterey\\'`, `\\'12\\'`) are correctly quoted with single quotes (`\\'`), which is the standard for SQL strings. Backticks are for identifiers, not string literals. Assuming the prompt meant \"properly quote string literals with single quotes\", this is correct.\\n*   **Using the correct number of arguments for functions:** Not applicable, no functions are used.\\n*   **Casting to the correct data type:** No explicit casting is used, and implicit casting where it might occur (e.g., comparing a string \\'12\\' to a numeric `High Grade` if it were numeric) is generally handled gracefully by Spark SQL, or `High Grade` is indeed a string type.\\n*   **Using the proper columns for joins:** The join condition `T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common and appropriate key for joining school-related datasets.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Monterey\\' AND T1.`High Grade` = \\'12\\' AND T1.`FRPM Count (Ages 5-17)` > 800\\n```' name='query_checker_sql_db' tool_call_id='944e5d50-a6ac-45a6-918d-f52fd68855e8'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\"}"], "input_tokens": 4760, "output_tokens": 2777, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17? Full communication address should include Street, City, State and zip code if any.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = \\'Monterey\\' AND T1.`High Grade` = \\'12\\' AND T1.`FRPM Count (Ages 5-17)` > 800\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values:** Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used:** Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges:** Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates:** The predicates `T2.City = 'Monterey'`, `T1.`High Grade` = '12'`, and `T1.`FRPM Count (Ages 5-17)` > 800` seem to use appropriate data types (string vs. string, numeric vs. numeric, or implicitly castable types).\n*   **Properly quoting identifiers:** Identifiers with spaces or special characters (`School Name`, `High Grade`, `FRPM Count (Ages 5-17)`) are correctly quoted using backticks (` `), which is standard for Spark SQL. Other identifiers are unquoted, which is also correct.\n*   **Use ` for the in-query strings:** String literals (`'Monterey'`, `'12'`) are correctly quoted with single quotes (`'`), which is the standard for SQL strings. Backticks are for identifiers, not string literals. Assuming the prompt meant \"properly quote string literals with single quotes\", this is correct.\n*   **Using the correct number of arguments for functions:** Not applicable, no functions are used.\n*   **Casting to the correct data type:** No explicit casting is used, and implicit casting where it might occur (e.g., comparing a string '12' to a numeric `High Grade` if it were numeric) is generally handled gracefully by Spark SQL, or `High Grade` is indeed a string type.\n*   **Using the proper columns for joins:** The join condition `T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common and appropriate key for joining school-related datasets.\n\nThe query is correct as written.\n\n```sql\nSELECT T1.`School Name`, T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Monterey' AND T1.`High Grade` = '12' AND T1.`FRPM Count (Ages 5-17)` > 800\n```", "final_answer": "", "replica": 9, "timestamp": 1768937609.4826646}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": 0.0521004459047172, "spider_em": 0, "sparksql_query": "SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000", "execution_status": "VALID", "query_result": [["Crescent View West Charter", "None", "(559) 222-8439"], ["Hume Lake Charter", "None", "(559) 305-7565"], ["Big Picture Educational Academy", "None", "(559) 420-1234"], ["Clovis North High", "519.0", "(559) 327-5000"], ["Clovis Online Charter", "None", "(559) 327-4400"], ["Buchanan High", "507.0", "(559) 327-3000"], ["Clovis East High", "455.0", "(559) 327-4000"], ["Design Science Early College High", "468.0", "(559) 248-7353"], ["Sierra Charter", "None", "(559) 490-4290"], ["University High", "593.0", "(559) 278-8263"], ["Fresno Academy for Civic and Entrepreneurial Leadership", "None", "None"], ["School of Unlimited Learning", "None", "(559) 498-8543"], ["Sunnyside High", "399.0", "(559) 253-6700"], ["Carter G. Woodson Public Charter", "None", "(559) 229-3529"], ["Kingsburg Independent Study High", "None", "(559) 897-3880"], ["Orange Cove High", "405.0", "(559) 626-5900"], ["Dunlap Leadership Academy", "None", "(559) 305-7320"], ["National University Academy - Orange Center", "None", "None"], ["Academy of Arts and Sciences: Fresno", "None", "(855) 937-4227"], ["Ambassador Phillip V. Sanchez Public Charter", "None", "(559) 255-9017"], ["Hallmark Charter", "460.0", "(559) 524-7170"], ["Selma Independent", "None", "(559) 898-6670"], ["West Park Charter Academy", "None", "(559) 233-6501"], ["Crescent View South Charter", "None", "(559) 222-8439"], ["Opportunities For Learning - Fresno", "None", "(626) 921-8200"], ["Central High East Campus", "449.0", "(559) 276-0280"], ["Mendota High", "378.0", "(559) 655-1993"], ["Elm High", "None", "(559) 485-8805"], ["W. E. B. DuBois Public Charter", "None", "(559) 486-1166"], ["Success One!", "None", "(530) 934-6320"], ["Conservation Corps of Long Beach Gateway Cities Charter", "None", "(562) 216-1790"], ["Northcoast Preparatory and Performing Arts Academy", "579.0", "None"], ["Six Rivers Charter High", "472.0", "(707) 825-2428"], ["Laurel Tree Charter", "None", "(707) 822-5626"], ["Academy of the Redwoods", "524.0", "(707) 476-4203"], ["Pacific View Charter", "None", "(707) 269-9490"], ["Alder Grove Charter", "None", "(707) 268-0854"], ["Mattole Triple Junction High", "None", "(707) 629-3250"], ["Mattole Valley Charter (#159)", "None", "(707) 629-3634"], ["Southwest High", "468.0", "(760) 336-4100"], ["YouthBuild Charter School of California", "None", "(213) 741-2600"], ["YouthBuild Charter School of California Central", "None", "None"], ["The Education Corps", "None", "(323) 249-7845"], ["College Bridge Academy", "None", "(323) 249-7845"], ["Bishop Independent Study", "None", "(760) 938-2001"], ["Wonderful College Prep Academy", "377.0", "(661) 454-3000"], ["Valley Oaks Charter", "502.0", "(661) 852-6700"], ["Cesar E. Chavez High", "439.0", "(661) 720-4501"], ["Robert F. Kennedy High", "449.0", "(661) 720-5117"], ["Golden Valley High", "424.0", "(661) 827-0800"], ["Frontier High", "475.0", "(661) 829-1107"], ["Independence High", "463.0", "(661) 834-8001"], ["Mira Monte High", "403.0", "(661) 366-1800"], ["Centennial High", "489.0", "(661) 588-8601"], ["Ridgeview High", "421.0", "(661) 398-3100"], ["Kern Workforce 2000 Academy", "None", "(661) 827-3158"], ["Liberty High", "501.0", "(661) 587-0925"], ["Insight School of California", "None", "(805) 581-0202"], ["California City High", "424.0", "(760) 373-5263"], ["Abraham Lincoln Alternative", "None", "(661) 256-5090"], ["Frazier Mountain High", "443.0", "(661) 248-0310"], ["Crossroads Charter", "None", "(559) 583-5060"], ["California Virtual Academy @ Kings", "None", "(805) 581-0202"], ["National University Academy, Armona", "None", "None"], ["Sierra Pacific High", "464.0", "(559) 583-5912"], ["Hanford West High", "450.0", "(559) 583-5903"], ["Lemoore Middle College High", "464.0", "(559) 925-3552"], ["New Day Academy", "None", "(530) 233-3861"], ["Westwood Charter", "None", "(530) 256-2994"], ["Mt. Lassen Charter", "None", "(530) 827-2129"], ["Los Angeles International Charter High", "428.0", "(323) 257-1499"], ["Optimist Charter", "None", "(323) 443-3100"], ["International Polytechnic High", "495.0", "(909) 839-2320"], ["Soledad Enrichment Action Charter High", "335.0", "(213) 480-4200"], ["William J. (Pete) Knight High", "442.0", "(661) 533-9000"], ["Eastside High", "409.0", "(661) 946-3800"], ["SOAR High (Students On Academic Rise)", "496.0", "(661) 722-6300"], ["Los Angeles County Online High", "None", "(800) 985-0770"], ["Academies of the Antelope Valley", "None", "(661) 948-7655"], ["Lancaster High", "449.0", "(661) 726-7649"], ["Desert Sands Charter", "None", "(661) 942-3357"], ["Opportunities For Learning - Baldwin Park II", "426.0", "(626) 962-3311"], ["Opportunities for Learning - Baldwin Park", "447.0", "(626) 814-0161"], ["Options for Youth-Burbank Charter", "464.0", "(818) 566-7525"], ["Centinela Valley Independent Study", "None", "(310) 263-4469"], ["Family First Charter", "None", "(310) 355-0001"], ["New Opportunities Charter", "None", "(310) 355-0001"], ["Lawndale High", "423.0", "(310) 263-3102"], ["Opportunities for Learning - Duarte", "None", "(626) 921-8200"], ["South El Monte High", "427.0", "(626) 442-0218"], ["Anderson W. Clark Magnet High", "539.0", "(818) 248-8324"], ["Gorman Learning Center", "473.0", "(909) 307-6312"], ["Hawthorne Math and Science Academy", "492.0", "(310) 973-8184"], ["City Honors College Preparatory Academy", "442.0", "(310) 680-4880"], ["Animo Inglewood Charter High", "448.0", "(310) 673-0956"], ["Environmental Charter High", "446.0", "(310) 214-3400"], ["Lennox Mathematics, Science and Technology Academy", "418.0", "(310) 680-5600"], ["Animo Leadership High", "416.0", "(310) 216-3277"], ["Beach High-Intensive Learning Program", "None", "(562) 595-8893"], ["Cabrillo High", "388.0", "(562) 951-7700"], ["Renaissance High School for the Arts", "483.0", "(562) 901-0168"], ["High Tech LA", "508.0", "(818) 609-2640"], ["Wallis Annenberg High", "416.0", "(323) 235-6343"], ["North Valley Military Institute College Preparatory Academy", "None", "(818) 368-1557"], ["Central City Value", "404.0", "(213) 471-4686"], ["View Park Preparatory Accelerated High", "382.0", "(323) 290-6975"], ["Crenshaw Arts-Technology Charter High", "381.0", "(323) 293-3917"], ["Oscar De La Hoya Animo Charter High", "398.0", "(323) 780-1259"], ["Renaissance Arts Academy", "506.0", "(323) 259-5700"], ["Animo South Los Angeles Charter", "376.0", "(323) 779-0544"], ["New Designs Charter", "411.0", "(213) 765-9084"], ["Middle College High", "435.0", "(323) 418-4700"], ["Harbor Teacher Preparation Academy", "509.0", "(310) 834-3932"], ["Ivy Academia", "431.0", "(818) 716-0771"], ["Camino Nuevo Charter High", "413.0", "(213) 240-8700"], ["Animo Venice Charter High", "414.0", "(310) 392-8751"], ["Animo Pat Brown", "377.0", "(323) 585-3312"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex", "436.0", "(213) 745-8141"], ["Orthopaedic Hospital", "444.0", "(213) 765-2088"], ["Northridge Academy High", "464.0", "(818) 700-2222"], ["International Studies Learning Center at Legacy High School Complex", "457.0", "(323) 357-7521"], ["Port of Los Angeles High", "487.0", "(310) 832-9201"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing", "497.0", "(818) 994-7614"], ["Alliance Judy Ivie Burton Technology Academy High", "408.0", "(323) 920-6125"], ["Alliance Collins Family College-Ready High", "390.0", "(323) 923-1588"], ["Pacific Boulevard", "None", "(323) 586-8640"], ["Santee Education Complex", "382.0", "(213) 763-1000"], ["South East High", "439.0", "(323) 568-3400"], ["Maywood Academy High", "420.0", "(323) 838-6000"], ["PUC CA Academy for Liberal Studies Early College High", "437.0", "None"], ["Los Angeles Academy of Arts & Enterprise Charter", "388.0", "(213) 487-0600"], ["Frida Kahlo High", "None", "(213) 763-1090"], ["New Village Girls Academy", "374.0", "(213) 385-4015"], ["Alliance Patti And Peter Neuwirth Leadership Academy", "386.0", "(213) 342-2874"], ["Alliance Dr. Olga Mohan High", "407.0", "(213) 342-2870"], ["Animo Ralph Bunche Charter High", "387.0", "(323) 232-9436"], ["Animo Jackie Robinson High", "377.0", "(323) 846-5800"], ["Animo Watts College Preparatory Academy", "362.0", "(323) 756-3930"], ["Alliance Ouchi-O'Donovan 6-12 Complex", "397.0", "(323) 596-2290"], ["Alliance Marc & Eva Stern Math and Science", "439.0", "(323) 987-2144"], ["School of Business and Tourism at Contreras Learning Complex", "403.0", "(213) 240-3800"], ["East Valley Senior High", "415.0", "(818) 753-4400"], ["Arleta High", "397.0", "(818) 686-4100"], ["Panorama High", "411.0", "(818) 909-4500"], ["Bright Star Secondary Charter Academy", "435.0", "(424) 789-8337"], ["Frederick Douglass Academy High", "378.0", "None"], ["Student Empowerment Academy", "372.0", "None"], ["Contreras Learning Center-Los Angeles School of Global Studies", "378.0", "(213) 240-3850"], ["West Adams Preparatory High", "385.0", "(323) 373-2500"], ["Magnolia Science Academy 3", "418.0", "(310) 637-3806"], ["Magnolia Science Academy 2", "427.0", "(818) 758-0300"], ["Discovery Charter Preparatory School #2", "373.0", "(818) 897-1187"], ["Alliance Morgan McKinzie High", "375.0", "(323) 859-0750"], ["Edward R. Roybal Learning Center", "408.0", "(213) 580-6400"], ["Helen Bernstein High", "391.0", "(323) 817-6460"], ["APEX Academy", "368.0", "(323) 817-6550"], ["Alliance Piera Barabaglia Shaheen Health Services Academy", "393.0", "(323) 972-9010"], ["Alliance Leichtman-Levine Family Foundation Environmental Science High", "444.0", "(323) 739-0560"], ["Magnolia Science Academy 4", "405.0", "(310) 473-2464"], ["Contreras Learning Center-Academic Leadership Community", "390.0", "(213) 240-3815"], ["Los Angeles High School of the Arts", "409.0", "(213) 480-4600"], ["Los Angeles Teacher Preparatory Academy", "339.0", "None"], ["School for the Visual Arts and Humanities", "394.0", "(213) 480-4700"], ["New Millennium Secondary", "388.0", "(310) 999-6162"], ["Alain Leroy Locke College Preparatory Academy", "364.0", "(323) 420-2100"], ["Sun Valley High", "385.0", "(818) 394-4600"], ["New Open World Academy K-12", "402.0", "(213) 480-3700"], ["UCLA Community K-12", "392.0", "(213) 480-3750"], ["Ramon C. Cortines School of Visual and Performing Arts", "446.0", "(213) 217-8600"], ["Felicitas and Gonzalo Mendez High", "382.0", "(323) 981-6100"], ["New Designs Charter School-Watts", "371.0", "(323) 418-0600"], ["Daniel Pearl Journalism & Communications Magnet", "470.0", "(818) 654-3775"], ["Ambassador-Global Leadership", "412.0", "(213) 480-4540"], ["Alliance Cindy and Bill Simon Technology Academy High", "364.0", "(323) 744-2122"], ["Alliance Tennenbaum Family Technology High", "385.0", "(323) 276-5545"], ["Environmental and Social Policy Magnet", "390.0", "(323) 441-4577"], ["Math, Science, & Technology Magnet Academy at Roosevelt High", "447.0", "(323) 780-6500"], ["Esteban Torres East LA Performing Arts Magnet", "378.0", "(323) 265-6725"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4", "386.0", "(323) 265-6830"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5", "371.0", "(323) 265-6865"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2", "388.0", "(323) 265-6760"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3", "395.0", "(323) 285-6795"], ["PUC Triumph Charter High", "None", "None"], ["PUC Lakeview Charter High", "390.0", "(818) 356-2591"], ["Aspire Pacific Academy", "394.0", "(323) 589-2800"], ["Los Angeles Big Picture High", "None", "None"], ["Alliance Ted K. Tajima High", "378.0", "(213) 241-8533"], ["Valley Academy of Arts and Sciences", "440.0", "(818) 832-7750"], ["Cesar E. Chavez Learning Academy - Arts/Theatre/Entertain Mag", "369.0", "(818) 837-6428"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy", "401.0", "(818) 838-3915"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)", "413.0", "(818) 838-3926"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy", "401.0", "(818) 838-3946"], ["Los Angeles River at Sonia Sotomayor Learning Academies", "383.0", "(323) 276-5535"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies", "430.0", "(323) 276-5500"], ["Dr. Maya Angelou Community High", "363.0", "(323) 846-4700"], ["Public Service Community at Diego Rivera Learning Complex", "406.0", "(323) 846-2128"], ["Communication and Technology at Diego Rivera Learning Complex", "373.0", "(323) 846-2118"], ["Green Design at Diego Rivera Learning Complex", "375.0", "(323) 846-2108"], ["Performing Arts Community at Diego Rivera Learning Complex", "372.0", "(323) 846-2136"], ["Rancho Dominguez Preparatory", "420.0", "(310) 354-3400"], ["Synergy Quantum Academy", "419.0", "(323) 846-4716"], ["Animo College Preparatory Academy", "359.0", "(323) 568-4136"], ["Alliance Renee and Meyer Luskin Academy High", "364.0", "(323) 905-1210"], ["PUC Early College Academy for Leaders and Scholars (ECALS)", "401.0", "(323) 276-5525"], ["Alliance Margaret M. Bloomfield Technology Academy High", "None", "(323) 537-2060"], ["Leadership in Entertainment and Media Arts (LEMA)", "354.0", "None"], ["STEM Academy at Bernstein High", "399.0", "(323) 817-6461"], ["Academy of Science and Engineering", "None", "(323) 545-1100"], ["Augustus F. Hawkins High A Critical Design and Gaming", "354.0", "(323) 789-1282"], ["Augustus F. Hawkins High B Community Health Advocates", "366.0", "(323) 789-1282"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship", "346.0", "(323) 789-1282"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "431.0", "(323) 568-3800"], ["Linda Esperanza Marquez High B LIBRA Academy", "410.0", "(323) 584-3800"], ["Linda Esperanza Marquez High C School of Social Justice", "423.0", "(323) 584-3800"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex", "383.0", "(323) 357-7545"], ["Visual and Performing Arts at Legacy High School Complex", "386.0", "(323) 357-7500"], ["Academy for Multilingual Arts and Science at Mervyn M. Dymally High", "377.0", "(323) 565-4600"], ["Academies of Education and Empowerment at Carson High", "403.0", "(310) 847-1455"], ["Academy of Medical Arts at Carson High", "417.0", "(310) 847-1465"], ["Humanities and Arts (HARTS) Academy of Los Angeles", "425.0", "(310) 257-7100"], ["Contreras Learning Center-School of Social Justice", "383.0", "(213) 240-3800"], ["Early College Academy-LA Trade Tech College", "None", "(323) 763-3685"], ["Camino Nuevo High #2", "None", "(213) 736-5566"], ["Youth Opportunities Unlimited", "None", "(323) 789-4731"], ["Palisades Charter High", "525.0", "(310) 230-6623"], ["City of Angels", "501.0", "(323) 415-8350"], ["Los Angeles Leadership Academy", "425.0", "(323) 227-7719"], ["PUC Community Charter Middle and PUC Community Charter Early College High", "None", "(818) 485-0933"], ["Magnolia Science Academy", "470.0", "(818) 609-0507"], ["Marco Antonio Firebaugh High", "412.0", "(310) 886-5200"], ["Pathway Independent Study", "None", "(310) 603-1516"], ["Mountain Park", "468.0", "(626) 471-3014"], ["Applied Technology Center", "420.0", "(323) 248-2500"], ["Antelope Valley Learning Academy", "None", "(661) 952-6028"], ["Palmdale Aerospace Academy", "None", "(661) 273-3680"], ["Guidance Charter", "407.0", "(661) 285-1600"], ["Palos Verdes High", "564.0", "(310) 378-8471"], ["Paramount Alternative Education Center", "None", "None"], ["Aveson Global Leadership Academy", "None", "(626) 797-1438"], ["CIS Academy", "None", "(626) 396-5883"], ["Learning Works", "None", "(626) 564-2871"], ["School of Extended Educational Options", "None", "(909) 397-4900"], ["Diamond Ranch High", "472.0", "(909) 397-4715"], ["Village Academy High School at Indian Hill", "442.0", "(909) 397-4900"], ["Malibu High", "553.0", "(310) 457-6801"], ["California Virtual Academy @ Los Angeles", "521.0", "(805) 581-0202"], ["Edgewood High", "493.0", "(626) 939-0600"], ["Insight @ Los Angeles", "425.0", "None"], ["Golden Valley High", "500.0", "(661) 298-8140"], ["West Ranch High", "539.0", "(661) 222-1220"], ["Mission View Public", "None", "(661) 200-5595"], ["Santa Clarita Valley International", "443.0", "(661) 705-4820"], ["Albert Einstein Academy for Letters, Arts and Sciences", "None", "(661) 702-0755"], ["Valencia High", "528.0", "(661) 294-1188"], ["Opportunities for Learning - Santa Clarita", "489.0", "(661) 424-1337"], ["Academy of the Canyons", "596.0", "(661) 362-3056"], ["Thurgood Marshall", "None", "(310) 898-6340"], ["iQ Academy California-Los Angeles", "None", "(888) 997-4722"], ["Gabrielino High", "518.0", "(626) 573-2415"], ["Options for Youth San Gabriel", "455.0", "(626) 921-8200"], ["Del Mar High", "None", "(626) 291-5723"], ["Assurance Learning Academy", "None", "(661) 272-1225"], ["Inspire Charter School", "None", "(661) 269-2214"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "None", "(855) 937-4227"], ["SIATech Academy South", "None", "(760) 945-1227"], ["Vasquez High", "500.0", "(661) 269-0451"], ["Redondo Shores High (Continuation)", "None", "(310) 798-8690"], ["School of Arts and Enterprise", "473.0", "(909) 622-0699"], ["Lifeline Education Charter", "359.0", "(310) 605-2510"], ["Da Vinci Science", "467.0", "(310) 725-5800"], ["Da Vinci Design", "459.0", "(310) 725-5800"], ["Anahuacalmecac International University Preparatory of North America", "None", "None"], ["Madera County Independent Academy", "None", "(559) 662-4636"], ["Pioneer Technical Center", "None", "(559) 662-6294"], ["Madera South High", "414.0", "(559) 675-4450"], ["Sherman Thomas Charter High", "None", "(559) 675-6626"], ["Liberty High", "472.0", "(559) 645-3500"], ["Minarets High", "472.0", "(559) 868-8689"], ["Minarets Charter High", "463.0", "(559) 868-8659"], ["Chawanakee Academy", "None", "None"], ["Glacier High School Charter", "None", "(559) 642-1422"], ["San Andreas High (Continuation)", "None", "(415) 945-3751"], ["Ukiah Independent Study Academy", "None", "(707) 472-5062"], ["Redwood Academy of Ukiah", "540.0", "(707) 467-0500"], ["Accelerated Achievement Academy", "None", "(707) 463-7080"], ["New Horizons", "None", "(707) 459-4801"], ["Willits Charter", "None", "(707) 459-5506"], ["Merced Scholars Charter", "None", "(209) 381-5165"], ["Crossroads Alternative Education Center", "None", "(209) 826-4013"], ["Pacheco High", "441.0", "(209) 826-3801"], ["Golden Valley High", "436.0", "(209) 325-1800"], ["Buhach Colony High", "438.0", "(209) 325-1400"], ["Shattuck Independent Study", "None", "(209) 656-2012"], ["Delhi High", "419.0", "(209) 656-2050"], ["Urban Corps of San Diego County Charter", "None", "(619) 235-6884"], ["Orange County Conservation Corps Charter", "None", "(714) 956-6222"], ["Monterey County Home Charter", "None", "(831) 755-0331"], ["Greenfield High", "427.0", "(831) 674-2751"], ["Marina High", "454.0", "(831) 583-2060"], ["Learning for Life Charter", "None", "(831) 582-9820"], ["El Puente", "None", "(831) 796-7700"], ["Everett Alvarez High", "446.0", "(831) 796-7800"], ["Soledad High", "428.0", "(831) 678-6400"], ["Gonzales High", "425.0", "(831) 675-2495"], ["Napa Valley Independent Studies", "None", "(707) 259-8577"], ["American Canyon High", "470.0", "(707) 265-2710"], ["New Technology High", "500.0", "(707) 259-8557"], ["Bitney College Preparatory High", "482.0", "(530) 477-1235"], ["Forest Charter", "508.0", "(530) 265-4823"], ["EPIC de Cesar Chavez", "None", "(661) 822-4381"], ["John Muir Charter Schools", "None", "(530) 272-4008"], ["William & Marian Ghidotti High", "576.0", "(530) 274-5270"], ["Vantage Point Charter", "None", "(530) 432-5312"], ["OCCS:CHEP/PCHS", "528.0", "(714) 327-1000"], ["Oxford Academy", "634.0", "(714) 220-3055"], ["Capistrano Connections Academy", "512.0", "(949) 461-1667"], ["San Juan Hills High", "534.0", "(949) 234-5900"], ["California Preparatory Academy", "None", "(949) 234-5317"], ["Aliso Niguel High", "548.0", "(949) 831-5590"], ["Tesoro High", "545.0", "(949) 234-5310"], ["Opportunities for Learning - Capistrano", "None", "(949) 248-1282"], ["Early College High", "478.0", "(714) 241-6108"], ["OUSD Home Sch", "None", "(714) 628-5479"], ["Yorba Linda High", "543.0", "(714) 986-7500"], ["Parkview", "None", "(714) 986-7050"], ["Nova Academy", "448.0", "(714) 569-0948"], ["Segerstrom High", "463.0", "(714) 241-5000"], ["Hector G. Godinez", "433.0", "(714) 433-6790"], ["Cesar E. Chavez High", "None", "(714) 430-5700"], ["Middle College High", "483.0", "(714) 953-3900"], ["OCSA", "582.0", "(714) 560-9000"], ["Arnold O. Beckman High", "572.0", "(714) 734-2900"], ["Northwood High", "621.0", "(949) 936-7200"], ["CORE Placer Charter", "None", "(530) 346-8340"], ["John Adams Academy", "576.0", "(916) 780-6800"], ["Foresthill High", "490.0", "(530) 367-5244"], ["Antelope High", "469.0", "(916) 726-1400"], ["Woodcreek High", "501.0", "(916) 771-6565"], ["Granite Bay High", "551.0", "(916) 786-8676"], ["Cold Stream Alternative", "None", "(530) 582-2640"], ["Partnerships for Student-Centered Learning", "None", "(916) 408-5200"], ["Horizon Charter", "456.0", "(916) 408-5200"], ["Whitney High", "502.0", "(916) 632-6500"], ["Western Sierra Collegiate Academy", "547.0", "(916) 778-4544"], ["Rocklin Independent Charter Academy", "None", "(916) 632-3195"], ["Rocklin High", "527.0", "(916) 632-1600"], ["Victory High", "None", "(916) 632-3195"], ["Plumas Charter", "None", "(530) 283-3851"], ["River Springs Charter", "478.0", "(951) 252-8800"], ["Riverside County Education Academy", "None", "(951) 826-6602"], ["Come Back Kids", "None", "(951) 826-6461"], ["Gateway College and Career Academy", "None", "(951) 222-8931"], ["Alvord Alternative Continuation High", "None", "(951) 509-6021"], ["Banning Independent Study", "None", "(951) 922-0268"], ["21st Century Learning Institute", "None", "(951) 769-8424"], ["Eleanor Roosevelt High", "486.0", "(951) 738-2100"], ["John F. Kennedy High", "497.0", "(951) 738-2200"], ["Corona-Norco Alternative", "None", "(951) 736-3367"], ["Lee V. Pollard High", "None", "(951) 736-3367"], ["Santiago High", "499.0", "(951) 739-5600"], ["Shadow Hills High", "434.0", "(760) 393-5400"], ["La Quinta High", "462.0", "(760) 772-4150"], ["Horizon", "None", "(760) 238-9720"], ["Hamilton High", "481.0", "(951) 763-1865"], ["Tahquitz High", "445.0", "(951) 765-6300"], ["College Prep High", "463.0", "(951) 925-5155"], ["Patriot High", "463.0", "(951) 361-6500"], ["Rivercrest Preparatory", "None", "(951) 360-2660"], ["Santa Rosa Academy", "503.0", "(951) 672-2400"], ["Moreno Valley Online Academy", "None", "(951) 571-4800"], ["Vista del Lago High", "424.0", "(951) 571-4880"], ["Nuview Bridge Early College High", "471.0", "(951) 928-8498"], ["Desert Hot Springs High", "429.0", "(760) 288-7000"], ["California Military Institute", "423.0", "(951) 443-2731"], ["Heritage High", "444.0", "(951) 940-5447"], ["Paloma Valley High", "450.0", "(951) 672-6030"], ["Riverside Virtual", "None", "(951) 276-2006"], ["Martin Luther King Jr. High", "494.0", "(951) 789-5690"], ["Mountain Heights Academy", "None", "(951) 487-7710"], ["San Jacinto Valley Academy", "466.0", "(951) 654-6113"], ["Desert Mirage High", "414.0", "(760) 397-2255"], ["NOVA Academy - Coachella", "403.0", "(714) 569-0948"], ["Lakeside High", "454.0", "(951) 253-7300"], ["Keith McCarthy Academy", "None", "(951) 253-7777"], ["Southern California Online Academy", "None", "None"], ["Great Oak High", "505.0", "(951) 294-6450"], ["Susan H. Nelson", "None", "(951) 695-7360"], ["Chaparral High", "491.0", "(951) 695-4200"], ["Temecula Preparatory", "539.0", "(951) 926-6776"], ["Vista Murrieta High", "491.0", "(951) 894-5750"], ["Murrieta Canyon Academy", "None", "(951) 696-1661"], ["Murrieta Mesa High", "478.0", "(951) 677-0568"], ["Citrus Hill High", "405.0", "(951) 490-0400"], ["Val Verde Academy", "None", "(951) 443-2450"], ["Monterey Trail High", "444.0", "(916) 688-0050"], ["Pleasant Grove High", "513.0", "(916) 686-0230"], ["Cosumnes Oaks High", "491.0", "(916) 683-7670"], ["Laguna Creek High", "483.0", "(916) 683-1339"], ["Sheldon High", "472.0", "(916) 681-7500"], ["Franklin High", "512.0", "(916) 714-8150"], ["Elk Grove Charter", "None", "(916) 714-1653"], ["Vista del Lago High", "552.0", "(916) 294-2410"], ["Liberty Ranch High", "496.0", "(209) 744-4250"], ["New Technology High", "432.0", "(916) 395-5254"], ["George Washington Carver School of Arts and Science", "526.0", "(916) 395-5266"], ["The MET", "468.0", "(916) 395-5417"], ["Rosemont High", "452.0", "(916) 395-5130"], ["Sacramento Charter High", "403.0", "(916) 277-6200"], ["Arthur A. Benjamin Health Professions High", "449.0", "(916) 395-5010"], ["School of Engineering & Sciences", "420.0", "(916) 395-5040"], ["Capital City Independent Study", "None", "(916) 433-5187"], ["West Campus", "500.0", "(916) 277-6400"], ["Aspire Alexander Twilight Secondary Academy", "403.0", "(916) 979-1788"], ["Options for Youth-San Juan", "431.0", "(916) 485-5155"], ["Visions In Education", "533.0", "(916) 971-7037"], ["San Juan Choices Charter", "None", "(916) 979-8378"], ["Global Youth Charter", "None", "(916) 339-4680"], ["Antelope View Charter", "None", "None"], ["Inderkum High", "449.0", "(916) 567-5640"], ["Natomas Pacific Pathways Prep", "477.0", "(916) 567-5740"], ["Natomas High", "454.0", "(916) 641-4960"], ["Natomas Charter", "524.0", "(916) 928-5353"], ["Futures High", "489.0", "(916) 286-1902"], ["Heritage Peak Charter", "458.0", "(866) 992-9033"], ["Creative Connections Arts Academy", "None", "(916) 566-1870"], ["Community Collaborative Charter", "None", "(916) 286-5161"], ["SAVA: Sacramento Academic and Vocational Academy", "None", "(916) 387-8063"], ["Highlands Community Charter", "None", "(916) 844-2283"], ["Elwood J. Keema High", "None", "(916) 566-3410"], ["Vista Nueva Career and Technology High", "None", "(916) 566-2750"], ["Anzar High", "479.0", "(831) 623-7660"], ["Alta Vista Public", "None", "(760) 947-0006"], ["Chaffey District Online High", "None", "(909) 985-0966"], ["Rancho Cucamonga High", "489.0", "(909) 989-1600"], ["Los Osos High", "511.0", "(909) 477-6900"], ["Colony High", "450.0", "(909) 930-2929"], ["Chino Hills High", "508.0", "(909) 606-7540"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "441.0", "(909) 580-5006"], ["Summit High", "425.0", "(909) 357-5950"], ["Jurupa Hills High", "424.0", "(909) 357-6300"], ["Henry J. Kaiser High", "417.0", "(909) 357-5900"], ["Academy of Careers and Exploration", "462.0", "(760) 952-1266"], ["Empire Springs Charter", "None", "(951) 252-8800"], ["Independence Charter Academy", "None", "(760) 952-1760"], ["Alta Vista South Public Charter", "None", "(661) 272-1225"], ["Hope Academy Charter", "None", "None"], ["Mojave River Academy", "None", "(760) 245-3222"], ["Riverside Preparatory", "447.0", "(760) 243-5884"], ["Citrus Valley High", "473.0", "(909) 799-2300"], ["Redlands eAcademy", "None", "(909) 748-6941"], ["Redlands East Valley High", "498.0", "(909) 389-2500"], ["Grove", "535.0", "(909) 798-7831"], ["Wilmer Amina Carter High", "436.0", "(909) 854-4100"], ["Rialto High", "421.0", "(909) 421-7500"], ["ASA Charter", "None", "(909) 475-3322"], ["Public Safety Academy", "None", "(909) 382-2211"], ["Options for Youth-San Bernardino", "457.0", "(626) 685-9300"], ["Indian Springs High", "400.0", "(909) 383-1360"], ["Provisional Accelerated Learning Academy", "None", "(909) 887-7002"], ["Arroyo Valley High", "406.0", "(909) 381-4295"], ["Middle College High", "469.0", "(909) 888-4041"], ["University Preparatory", "500.0", "(760) 243-5940"], ["Adelanto High", "421.0", "(760) 246-3909"], ["Options for Youth-Victorville Charter", "419.0", "(626) 685-9300"], ["Excelsior Charter", "473.0", "(760) 245-4262"], ["Silverado High", "422.0", "(760) 955-3353"], ["Silver Valley Academy", "None", "(760) 254-2715"], ["Summit Leadership Academy-High Desert", "370.0", "(760) 949-9202"], ["Mirus Secondary", "None", "(760) 244-3764"], ["Encore Jr./Sr. High School for the Performing and Visual Arts", "486.0", "(760) 956-2632"], ["Oak Hills High", "450.0", "(760) 244-2283"], ["Sultana High", "448.0", "(760) 947-6777"], ["Shadow Ridge", "None", "(760) 949-8267"], ["Sky Mountain Charter", "None", "(530) 295-3566"], ["Granite Hills High", "479.0", "(760) 961-2290"], ["High Desert Premier Academy", "None", "(760) 240-4252"], ["Academy for Academic Excellence", "505.0", "(760) 946-5414"], ["San Pasqual Academy", "363.0", "(760) 233-6003"], ["Monarch", "None", "(619) 652-4100"], ["Literacy First Charter", "None", "(619) 579-7232"], ["Juan Bautista de Anza", "None", "(760) 767-5850"], ["Diego Springs Academy", "None", "(661) 272-1225"], ["Coronado Pathways Charter", "None", "None"], ["Diego Hills Charter", "None", "(619) 286-0312"], ["Dehesa Charter", "529.0", "(760) 743-7880"], ["Classical Academy High", "548.0", "(760) 480-9845"], ["Escondido Charter High", "513.0", "(760) 737-3154"], ["Oasis High (Alternative)", "None", "(760) 723-6395"], ["Steele Canyon High", "492.0", "(619) 660-3550"], ["Grossmont Middle College High", "525.0", "(619) 644-7524"], ["Helix High", "464.0", "(619) 466-4194"], ["Greater San Diego Academy", "None", "(619) 669-3050"], ["Diego Valley Charter", "None", "(619) 286-0312"], ["Julian Charter", "517.0", "(760) 765-3847"], ["National University Academy", "None", "(760) 631-5842"], ["River Valley Charter", "555.0", "(619) 390-2579"], ["San Diego Virtual", "None", "(619) 713-7271"], ["Pivot Charter School - San Diego", "None", "(760) 591-0217"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "None", "None"], ["Academy of Arts and Sciences", "None", "(855) 937-4227"], ["Del Norte High", "565.0", "(858) 487-0877"], ["Westview High", "581.0", "(858) 780-2000"], ["Future Bound Independent Study Secondary", "None", "(760) 787-2068"], ["Mountain Valley Academy", "None", "(760) 787-3600"], ["High Tech High International", "477.0", "(619) 243-5014"], ["Learning Choice Academy", "None", "(619) 463-6849"], ["San Diego International Studies", "523.0", "(619) 525-7464"], ["San Diego Business/Leadership", "402.0", "(619) 525-7461"], ["San Diego MVP Arts", "405.0", "None"], ["Kearny Digital Media & Design", "482.0", "(858) 496-8370"], ["Kearny SCT", "452.0", "(858) 496-8370"], ["Kearny College Connections", "450.0", "(858) 496-8370"], ["Kearny Eng, Innov & Design", "426.0", "(858) 496-8370"], ["Crawford High", "380.0", "(619) 362-3700"], ["San Diego Science and Technology", "423.0", "(619) 525-7459"], ["San Diego Metro Career and Tech", "489.0", "(619) 388-2299"], ["High Tech High Media Arts", "457.0", "(619) 398-8632"], ["Lincoln High", "389.0", "(619) 266-6500"], ["Health Sciences High", "422.0", "(619) 528-9070"], ["Arroyo Paseo Charter High", "None", "(619) 677-3017"], ["East Village High", "483.0", "(619) 525-2000"], ["King-Chavez Community High", "369.0", "(619) 704-1020"], ["Gompers Preparatory Academy", "363.0", "(619) 263-2171"], ["iHigh Virtual Academy", "None", "(619) 764-5440"], ["School for Entrepreneurship and Technology", "453.0", "(858) 874-4338"], ["Home & Hosp/Transition Support", "None", "(619) 344-6435"], ["Laurel Preparatory Academy", "None", "(858) 678-4812"], ["Scripps Ranch High", "564.0", "(858) 621-9020"], ["Charter School of San Diego", "479.0", "(858) 678-2020"], ["Preuss School UCSD", "520.0", "(858) 822-3000"], ["High Tech High", "477.0", "(619) 243-5014"], ["Audeo Charter", "483.0", "(858) 678-2050"], ["Canyon Crest Academy", "611.0", "(858) 350-0253"], ["La Costa Canyon High", "542.0", "(760) 436-6136"], ["Insight @ San Diego", "None", "(805) 581-0202"], ["California Virtual Academy @ San Diego", "517.0", "(805) 581-0202"], ["Olympian High", "476.0", "(619) 656-2400"], ["Eastlake High", "498.0", "(619) 397-3800"], ["Options Secondary", "None", "(619) 796-7320"], ["MAAC Community Charter", "None", "(619) 476-0749"], ["Alta Vista Academy", "None", "(619) 216-5160"], ["San Ysidro High", "431.0", "(619) 710-2300"], ["Otay Ranch Senior High", "474.0", "(619) 591-5000"], ["RAI Online Charter", "None", "None"], ["Taylion San Diego Academy", "None", "(760) 295-5564"], ["SIATech", "None", "(760) 945-1227"], ["North County Trade Tech High", "None", "(760) 598-0782"], ["Mission Vista High", "501.0", "(760) 758-6800"], ["Guajome Learning Center", "None", "(760) 631-8500"], ["Vista Visions Academy", "None", "(760) 724-4785"], ["Guajome Park Academy Charter", "531.0", "(760) 631-8500"], ["Carlsbad Seaside Academy", "None", "(760) 331-5299"], ["Pacific View Charter", "None", "(760) 757-0161"], ["Mission Hills High", "495.0", "(760) 290-2700"], ["Bayshore Preparatory Charter", "None", "(760) 471-0847"], ["Warner Junior/Senior High", "None", "(760) 782-3517"], ["Valley Center High", "474.0", "(760) 751-5502"], ["Valley Center Prep", "None", "(760) 751-0455"], ["High Tech High Chula Vista", "471.0", "(619) 243-5014"], ["High Tech High North County", "511.0", "(619) 243-5014"], ["Five Keys Charter (SF Sheriff's)", "None", "(415) 734-3310"], ["Jordan (June) School for Equity", "None", "(415) 452-4922"], ["City Arts and Tech High", "395.0", "(415) 841-2200"], ["Five Keys Adult School (SF Sheriff's)", "None", "(415) 734-3310"], ["Five Keys Independence HS (SF Sheriff's)", "None", "(415) 734-3310"], ["S.F. International High", "318.0", "(415) 695-5781"], ["Academy (The)- SF @McAteer", "456.0", "(415) 695-5700"], ["Gateway to College", "None", "(415) 452-5768"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "553.0", "(415) 695-5700"], ["Marshall (Thurgood) High", "364.0", "(415) 695-5612"], ["Leadership High", "408.0", "(415) 841-8910"], ["Gateway High", "483.0", "(415) 749-3600"], ["San Francisco Flex Academy", "502.0", "None"], ["one.Charter", "None", "(209) 468-9079"], ["San Joaquin Building Futures Academy", "None", "(209) 468-8140"], ["Venture Academy", "458.0", "(209) 468-5940"], ["Aspire Benjamin Holt College Preparatory Academy", "503.0", "(209) 955-1477"], ["Ronald E. McNair High", "436.0", "(209) 953-9245"], ["Rio Valley Charter", "None", "(209) 368-4934"], ["Independence", "None", "(209) 331-8275"], ["Middle College High", "565.0", "(209) 954-5790"], ["Weston Ranch High", "454.0", "(209) 938-6245"], ["New Vision High", "None", "(209) 938-6225"], ["Lathrop High", "432.0", "(209) 938-6350"], ["be.tech", "None", "(209) 858-7460"], ["Sierra High", "463.0", "(209) 858-7410"], ["Humphreys College Academy of Business, Law and Education", "424.0", "(209) 478-1600"], ["California Virtual Academy @ San Joaquin", "None", "(805) 581-0202"], ["Renew Virtual Academy K12 #1", "None", "None"], ["Delta Home Charter", "None", "(209) 830-6363"], ["Valley View Charter Prep", "None", "(916) 866-9033"], ["Delta Charter Online", "None", "(209) 830-6363"], ["Delta Charter", "468.0", "(209) 830-6363"], ["California Connections Academy @ Ripon", "535.0", "(209) 253-1208"], ["Cesar Chavez High", "417.0", "(209) 933-7480"], ["Edward C. Merlo Institute of Environmental Studies", "370.0", "(209) 933-7190"], ["Aspire Langston Hughes Academy", "408.0", "(209) 943-2389"], ["Stockton Unified Early College Academy", "519.0", "(209) 933-7370"], ["Stockton High", "None", "(209) 933-7365"], ["Stockton Collegiate International Secondary", "475.0", "(209) 390-9861"], ["Health Careers Academy", "418.0", "(209) 933-7360"], ["Pacific Law Academy", "None", "(209) 933-7475"], ["Weber Institute", "420.0", "(209) 933-7330"], ["Millennium Charter", "480.0", "(209) 831-5240"], ["John C. Kimball High", "500.0", "(209) 832-6600"], ["Merrill F. West High", "479.0", "(209) 830-3370"], ["Grizzly ChalleNGe Charter", "None", "(805) 782-6882"], ["Nipomo High", "490.0", "(805) 474-3300"], ["Templeton Independent Study High", "None", "(805) 434-5805"], ["Independence High", "None", "(805) 769-1620"], ["California Virtual Academy @ San Mateo", "None", "(805) 581-0202"], ["Aspire East Palo Alto Charter", "None", "None"], ["Peninsula High", "None", "(650) 558-2499"], ["Summit Preparatory Charter High", "522.0", "(650) 556-1110"], ["Everest Public High", "538.0", "(650) 366-1050"], ["East Palo Alto Academy", "403.0", "(650) 893-8900"], ["Family Partnership Home Study Charter", "None", "(805) 348-3333"], ["Los Olivos Charter School", "None", "None"], ["Orcutt Academy Charter", "492.0", "(805) 938-8900"], ["Pioneer Valley High", "451.0", "(805) 922-1305"], ["Alta Vista Alternative High", "558.0", "(805) 965-1916"], ["Leadership Public Schools - San Jose", "381.0", "None"], ["University Preparatory Academy Charter", "537.0", "(408) 723-1839"], ["Magnolia Science Academy Santa Clara", "None", "None"], ["Silicon Valley Flex Academy", "None", "None"], ["Summit Public School: Tahoma", "483.0", "(408) 729-1981"], ["Branham High", "540.0", "(408) 626-3407"], ["Escuela Popular/Center for Training and Careers, Family Learning", "None", "(408) 275-7191"], ["KIPP San Jose Collegiate", "482.0", "(408) 937-3752"], ["Summit Public School: Rainier", "493.0", "(408) 831-3104"], ["Calero High", "None", "(408) 347-7600"], ["Apollo High", "None", "(408) 928-5400"], ["Latino College Preparatory Academy", "380.0", "(408) 729-2281"], ["San Jose Conservation Corps Charter", "None", "(408) 459-6404"], ["Evergreen Valley High", "565.0", "(408) 347-7000"], ["Escuela Popular Accelerated Family Learning", "None", "(408) 275-7190"], ["Dr. TJ Owens Gilroy Early College Academy", "552.0", "(408) 846-4909"], ["Christopher High", "484.0", "(408) 848-7171"], ["Ann Sobrato High", "515.0", "(408) 201-6200"], ["Liberty High (Alternative)", "None", "(408) 535-6327"], ["Downtown College Preparatory", "None", "(408) 271-8120"], ["Middle College High", "None", "(408) 298-2181"], ["Pacific Collegiate Charter", "630.0", "(831) 479-7785"], ["Cypress Charter High", "506.0", "(831) 477-0302"], ["Pajaro Valley High", "430.0", "(831) 728-8102"], ["Ceiba College Preparatory Academy", "None", "(831) 728-6208"], ["Pacific Coast Charter", "None", "(831) 761-6021"], ["Ocean Grove Charter", "554.0", "(530) 295-3566"], ["SLVUSD Charter", "None", "(831) 335-0932"], ["Delta Charter", "None", "(831) 477-5212"], ["Alternative Family Education", "None", "(831) 429-3898"], ["Scotts Valley High", "547.0", "(831) 439-9555"], ["Anderson New Technology High", "None", "(530) 365-3100"], ["Stellar Secondary Charter High", "None", "(530) 245-7730"], ["University Preparatory", "551.0", "(530) 245-2790"], ["Shasta Charter Academy", "None", "(530) 245-2600"], ["North State Independence High", "None", "(530) 245-2760"], ["Northern Summit Academy", "None", "(530) 949-0154"], ["Academy of Personalized Learning", "None", "(530) 222-9280"], ["Gateway Educational Options", "None", "(530) 245-7960"], ["Golden Eagle Charter", "None", "(530) 926-5800"], ["Matt Garcia Career and College Academy", "None", "(707) 424-9400"], ["Angelo Rodriguez High", "489.0", "(707) 863-7950"], ["Elise P. Buckingham Charter Magnet High", "533.0", "(707) 453-7300"], ["Jesse M. Bethel High", "447.0", "(707) 556-5700"], ["MIT Academy", "None", "(707) 552-6482"], ["Geyserville New Tech Academy", "None", "(707) 857-3592"], ["Pathways Charter", "None", "(707) 585-6510"], ["California Virtual Academy @ Sonoma", "None", "(805) 581-0202"], ["Pivot Online Charter - North Bay", "None", "(707) 843-4676"], ["Gateway to College Academy", "None", "(707) 778-4621"], ["Valley Oaks High (Alternative)", "None", "(707) 778-4794"], ["Northwest Prep Charter", "None", "(707) 522-3320"], ["Roseland Charter", "410.0", "(707) 545-0102"], ["Abraxis Charter", "None", "(707) 539-2897"], ["Elsie Allen High", "457.0", "(707) 528-5020"], ["Maria Carrillo High", "563.0", "(707) 528-5790"], ["Orchard View", "None", "(707) 823-4709"], ["Credo High", "None", "(707) 664-0600"], ["Academy of Arts and Sciences: Sonoma", "None", "(855) 937-4227"], ["Technology High", "567.0", "(707) 792-4825"], ["Windsor High", "516.0", "(707) 837-7767"], ["Stanislaus Alternative Charter", "None", "(209) 238-6801"], ["Valley Charter High", "489.0", "(209) 238-6800"], ["Whitmore Charter High", "542.0", "(209) 556-1617"], ["Central Valley High", "433.0", "(209) 556-1900"], ["Endeavor Alternative", "None", "(209) 556-1805"], ["Denair Charter Academy", "None", "(209) 634-0917"], ["Hart-Ransom Academic Charter", "None", "(209) 523-0401"], ["Keyes to Learning Charter", "None", "(209) 634-6467"], ["James C. Enochs High", "487.0", "(209) 550-3400"], ["Aspire Vanguard College Preparatory Academy", "None", "(209) 521-3010"], ["Joseph A. Gregori High", "465.0", "(209) 550-3421"], ["Peter Johansen High", "435.0", "(209) 576-4702"], ["Oakdale Charter", "None", "(209) 848-4361"], ["Valley Oak Junior and Senior High", "None", "(209) 847-3097"], ["Waterford High", "465.0", "(209) 874-9060"], ["Connecting Waters Charter", "504.0", "(209) 874-9463"], ["eCademy Charter at Crane", "None", "(209) 669-3410"], ["Fusion Charter", "None", "(209) 667-0327"], ["John H. Pitman High", "480.0", "(209) 656-1592"], ["South Sutter Charter", "465.0", "(530) 295-3566"], ["California Virtual Academy @ Sutter", "None", "(805) 581-0202"], ["River Valley High", "479.0", "(530) 822-2500"], ["Yuba City Charter", "None", "(530) 822-9667"], ["Tehama eLearning Academy", "None", "(530) 527-0188"], ["University Preparatory High", "498.0", "(559) 730-2529"], ["La Sierra High", "None", "(559) 733-6963"], ["Eleanor Roosevelt Community Learning Center", "None", "(559) 592-9160"], ["California Connections Academy@Central", "None", "(559) 713-1324"], ["Summit Charter Academy", "None", "(559) 782-5902"], ["Burton Horizon Academy", "None", "(559) 782-4748"], ["Loma Vista Charter", "None", "(559) 562-5111"], ["Crescent Valley Public Charter", "None", "(559) 970-5894"], ["Mission Oak High", "435.0", "(559) 688-2021"], ["Sierra Vista Charter High", "None", "(559) 687-7384"], ["Visalia Charter Independent Study", "442.0", "(559) 735-8055"], ["Visalia Technical Early College", "None", "(559) 622-3212"], ["El Diamante High", "475.0", "(559) 735-3501"], ["Farmersville High", "400.0", "(559) 594-4567"], ["Butterfield Charter High", "None", "(559) 782-7057"], ["Harmony Magnet Academy", "464.0", "(559) 568-0347"], ["Granite Hills High", "433.0", "(559) 782-7075"], ["Prospect Education Center", "None", "(559) 782-7095"], ["Ronald Reagan Academy", "None", "(559) 595-0563"], ["California Virtual Academy @ Jamestown", "None", "(805) 581-0202"], ["Gold Rush Charter", "None", "(209) 532-9781"], ["Connections Visual and Performing Arts Academy", "None", "(209) 928-4228"], ["Vista Real Charter High", "None", "(805) 486-5449"], ["River Oaks Academy", "None", "(805) 777-7999"], ["Golden Valley Charter", "None", "(805) 642-3435"], ["Academy of Arts and Sciences: Thousand Oaks & Simi Valley", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: Oxnard & Ventura", "None", "None"], ["Architecture, Construction & Engineering Charter High (ACE)", "None", "(805) 437-1410"], ["Condor High", "None", "(805) 385-2552"], ["Pacifica High", "454.0", "(805) 278-5000"], ["Santa Susana High", "556.0", "(805) 520-6800"], ["El Camino High", "537.0", "(805) 289-7955"], ["Foothill Technology High", "530.0", "(805) 289-0023"], ["Century Academy", "None", "(805) 496-0286"], ["Oak Park Independent", "488.0", "(818) 735-3260"], ["IvyTech Charter", "None", "(805) 222-5188"], ["The High School at Moorpark College", "519.0", "(805) 378-1444"], ["Da Vinci Charter Academy", "558.0", "(530) 757-7154"], ["West Sacramento Early College Prep Charter", "None", "(916) 375-7680"], ["Pioneer High", "455.0", "(530) 406-1148"], ["Yuba County Career Preparatory Charter", "None", "(530) 749-4000"], ["Camptonville Academy", "None", "(530) 742-2786"], ["Marysville Charter Academy for the Arts", "484.0", "(530) 749-6156"]], "spark_error": null, "total_time": 20.482201099395752, "spark_time": 0.35775303840637207, "translation_time": 20.12444806098938, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='656803af-b3ab-4723-819a-1453ba82f1a7'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='6e71d4a6-0a53-4592-aead-89e14369ad3a'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION vs. UNION ALL**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The `CAST(SUBSTRING(..., 1, 4) AS INT)` correctly converts the year string to an integer for comparison with integer literals (1991, 2000). The join condition `s.CDSCode = sa.cds` assumes compatible types, which is standard for such identifiers.\\n*   **Properly quoting identifiers**: All identifiers (`s.School`, `sa.AvgScrWrite`, `s.Phone`, `schools`, `s`, `satscores`, `sa`, `s.CDSCode`, `sa.cds`, `s.OpenDate`, `s.ClosedDate`) are standard SQL identifiers and do not require special quoting (like backticks).\\n*   **Use `` ` `` for the in-query strings**: This point typically refers to quoting identifiers that are keywords or contain special characters. The query uses single quotes for string literals ('1', '4') and integer literals (1991, 2000), which is correct. No identifiers requiring backticks are present.\\n*   **Using the correct number of arguments for functions**: `SUBSTRING(string, start, length)` and `CAST(expression AS type)` are used with the correct number of arguments.\\n*   **Casting to the correct data type**: `CAST(... AS INT)` is appropriate for converting the year string to an integer for numeric comparison.\\n*   **Using the proper columns for joins**: `s.CDSCode = sa.cds` is a standard way to join a schools table with a related scores table using a common identifier.\\n\\nThe query is well-formed and follows standard SQL practices.\\n\\n```sql\\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\\n```\" name='query_checker_sql_db' tool_call_id='44e15f51-5adf-4250-8bc6-44bdfdc594e3'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}"], "input_tokens": 4378, "output_tokens": 3170, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION vs. UNION ALL**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The `CAST(SUBSTRING(..., 1, 4) AS INT)` correctly converts the year string to an integer for comparison with integer literals (1991, 2000). The join condition `s.CDSCode = sa.cds` assumes compatible types, which is standard for such identifiers.\n*   **Properly quoting identifiers**: All identifiers (`s.School`, `sa.AvgScrWrite`, `s.Phone`, `schools`, `s`, `satscores`, `sa`, `s.CDSCode`, `sa.cds`, `s.OpenDate`, `s.ClosedDate`) are standard SQL identifiers and do not require special quoting (like backticks).\n*   **Use `` ` `` for the in-query strings**: This point typically refers to quoting identifiers that are keywords or contain special characters. The query uses single quotes for string literals ('1', '4') and integer literals (1991, 2000), which is correct. No identifiers requiring backticks are present.\n*   **Using the correct number of arguments for functions**: `SUBSTRING(string, start, length)` and `CAST(expression AS type)` are used with the correct number of arguments.\n*   **Casting to the correct data type**: `CAST(... AS INT)` is appropriate for converting the year string to an integer for numeric comparison.\n*   **Using the proper columns for joins**: `s.CDSCode = sa.cds` is a standard way to join a schools table with a related scores table using a common identifier.\n\nThe query is well-formed and follows standard SQL practices.\n\n```sql\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\n```", "final_answer": "", "replica": 0, "timestamp": 1768937631.6438854}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": 0.0521004459047172, "spider_em": 0, "sparksql_query": "SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 ORDER BY s.School", "execution_status": "VALID", "query_result": [["21st Century Learning Institute", "None", "(951) 769-8424"], ["APEX Academy", "368.0", "(323) 817-6550"], ["ASA Charter", "None", "(909) 475-3322"], ["Abraham Lincoln Alternative", "None", "(661) 256-5090"], ["Abraxis Charter", "None", "(707) 539-2897"], ["Academies of Education and Empowerment at Carson High", "403.0", "(310) 847-1455"], ["Academies of the Antelope Valley", "None", "(661) 948-7655"], ["Academy (The)- SF @McAteer", "456.0", "(415) 695-5700"], ["Academy for Academic Excellence", "505.0", "(760) 946-5414"], ["Academy for Multilingual Arts and Science at Mervyn M. Dymally High", "377.0", "(323) 565-4600"], ["Academy of Arts and Sciences", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "None", "None"], ["Academy of Arts and Sciences: Fresno", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: Oxnard & Ventura", "None", "None"], ["Academy of Arts and Sciences: Sonoma", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: Thousand Oaks & Simi Valley", "None", "(855) 937-4227"], ["Academy of Careers and Exploration", "462.0", "(760) 952-1266"], ["Academy of Medical Arts at Carson High", "417.0", "(310) 847-1465"], ["Academy of Personalized Learning", "None", "(530) 222-9280"], ["Academy of Science and Engineering", "None", "(323) 545-1100"], ["Academy of the Canyons", "596.0", "(661) 362-3056"], ["Academy of the Redwoods", "524.0", "(707) 476-4203"], ["Accelerated Achievement Academy", "None", "(707) 463-7080"], ["Adelanto High", "421.0", "(760) 246-3909"], ["Alain Leroy Locke College Preparatory Academy", "364.0", "(323) 420-2100"], ["Albert Einstein Academy for Letters, Arts and Sciences", "None", "(661) 702-0755"], ["Alder Grove Charter", "None", "(707) 268-0854"], ["Aliso Niguel High", "548.0", "(949) 831-5590"], ["Alliance Cindy and Bill Simon Technology Academy High", "364.0", "(323) 744-2122"], ["Alliance Collins Family College-Ready High", "390.0", "(323) 923-1588"], ["Alliance Dr. Olga Mohan High", "407.0", "(213) 342-2870"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex", "436.0", "(213) 745-8141"], ["Alliance Judy Ivie Burton Technology Academy High", "408.0", "(323) 920-6125"], ["Alliance Leichtman-Levine Family Foundation Environmental Science High", "444.0", "(323) 739-0560"], ["Alliance Marc & Eva Stern Math and Science", "439.0", "(323) 987-2144"], ["Alliance Margaret M. Bloomfield Technology Academy High", "None", "(323) 537-2060"], ["Alliance Morgan McKinzie High", "375.0", "(323) 859-0750"], ["Alliance Ouchi-O'Donovan 6-12 Complex", "397.0", "(323) 596-2290"], ["Alliance Patti And Peter Neuwirth Leadership Academy", "386.0", "(213) 342-2874"], ["Alliance Piera Barabaglia Shaheen Health Services Academy", "393.0", "(323) 972-9010"], ["Alliance Renee and Meyer Luskin Academy High", "364.0", "(323) 905-1210"], ["Alliance Ted K. Tajima High", "378.0", "(213) 241-8533"], ["Alliance Tennenbaum Family Technology High", "385.0", "(323) 276-5545"], ["Alta Vista Academy", "None", "(619) 216-5160"], ["Alta Vista Alternative High", "558.0", "(805) 965-1916"], ["Alta Vista Public", "None", "(760) 947-0006"], ["Alta Vista South Public Charter", "None", "(661) 272-1225"], ["Alternative Family Education", "None", "(831) 429-3898"], ["Alvord Alternative Continuation High", "None", "(951) 509-6021"], ["Ambassador Phillip V. Sanchez Public Charter", "None", "(559) 255-9017"], ["Ambassador-Global Leadership", "412.0", "(213) 480-4540"], ["American Canyon High", "470.0", "(707) 265-2710"], ["Anahuacalmecac International University Preparatory of North America", "None", "None"], ["Anderson New Technology High", "None", "(530) 365-3100"], ["Anderson W. Clark Magnet High", "539.0", "(818) 248-8324"], ["Angelo Rodriguez High", "489.0", "(707) 863-7950"], ["Animo College Preparatory Academy", "359.0", "(323) 568-4136"], ["Animo Inglewood Charter High", "448.0", "(310) 673-0956"], ["Animo Jackie Robinson High", "377.0", "(323) 846-5800"], ["Animo Leadership High", "416.0", "(310) 216-3277"], ["Animo Pat Brown", "377.0", "(323) 585-3312"], ["Animo Ralph Bunche Charter High", "387.0", "(323) 232-9436"], ["Animo South Los Angeles Charter", "376.0", "(323) 779-0544"], ["Animo Venice Charter High", "414.0", "(310) 392-8751"], ["Animo Watts College Preparatory Academy", "362.0", "(323) 756-3930"], ["Ann Sobrato High", "515.0", "(408) 201-6200"], ["Antelope High", "469.0", "(916) 726-1400"], ["Antelope Valley Learning Academy", "None", "(661) 952-6028"], ["Antelope View Charter", "None", "None"], ["Anzar High", "479.0", "(831) 623-7660"], ["Apollo High", "None", "(408) 928-5400"], ["Applied Technology Center", "420.0", "(323) 248-2500"], ["Architecture, Construction & Engineering Charter High (ACE)", "None", "(805) 437-1410"], ["Arleta High", "397.0", "(818) 686-4100"], ["Arnold O. Beckman High", "572.0", "(714) 734-2900"], ["Arroyo Paseo Charter High", "None", "(619) 677-3017"], ["Arroyo Valley High", "406.0", "(909) 381-4295"], ["Arthur A. Benjamin Health Professions High", "449.0", "(916) 395-5010"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "553.0", "(415) 695-5700"], ["Aspire Alexander Twilight Secondary Academy", "403.0", "(916) 979-1788"], ["Aspire Benjamin Holt College Preparatory Academy", "503.0", "(209) 955-1477"], ["Aspire East Palo Alto Charter", "None", "None"], ["Aspire Langston Hughes Academy", "408.0", "(209) 943-2389"], ["Aspire Pacific Academy", "394.0", "(323) 589-2800"], ["Aspire Vanguard College Preparatory Academy", "None", "(209) 521-3010"], ["Assurance Learning Academy", "None", "(661) 272-1225"], ["Audeo Charter", "483.0", "(858) 678-2050"], ["Augustus F. Hawkins High A Critical Design and Gaming", "354.0", "(323) 789-1282"], ["Augustus F. Hawkins High B Community Health Advocates", "366.0", "(323) 789-1282"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship", "346.0", "(323) 789-1282"], ["Aveson Global Leadership Academy", "None", "(626) 797-1438"], ["Banning Independent Study", "None", "(951) 922-0268"], ["Bayshore Preparatory Charter", "None", "(760) 471-0847"], ["Beach High-Intensive Learning Program", "None", "(562) 595-8893"], ["Big Picture Educational Academy", "None", "(559) 420-1234"], ["Bishop Independent Study", "None", "(760) 938-2001"], ["Bitney College Preparatory High", "482.0", "(530) 477-1235"], ["Branham High", "540.0", "(408) 626-3407"], ["Bright Star Secondary Charter Academy", "435.0", "(424) 789-8337"], ["Buchanan High", "507.0", "(559) 327-3000"], ["Buhach Colony High", "438.0", "(209) 325-1400"], ["Burton Horizon Academy", "None", "(559) 782-4748"], ["Butterfield Charter High", "None", "(559) 782-7057"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing", "497.0", "(818) 994-7614"], ["CIS Academy", "None", "(626) 396-5883"], ["CORE Placer Charter", "None", "(530) 346-8340"], ["Cabrillo High", "388.0", "(562) 951-7700"], ["Calero High", "None", "(408) 347-7600"], ["California City High", "424.0", "(760) 373-5263"], ["California Connections Academy @ Ripon", "535.0", "(209) 253-1208"], ["California Connections Academy@Central", "None", "(559) 713-1324"], ["California Military Institute", "423.0", "(951) 443-2731"], ["California Preparatory Academy", "None", "(949) 234-5317"], ["California Virtual Academy @ Jamestown", "None", "(805) 581-0202"], ["California Virtual Academy @ Kings", "None", "(805) 581-0202"], ["California Virtual Academy @ Los Angeles", "521.0", "(805) 581-0202"], ["California Virtual Academy @ San Diego", "517.0", "(805) 581-0202"], ["California Virtual Academy @ San Joaquin", "None", "(805) 581-0202"], ["California Virtual Academy @ San Mateo", "None", "(805) 581-0202"], ["California Virtual Academy @ Sonoma", "None", "(805) 581-0202"], ["California Virtual Academy @ Sutter", "None", "(805) 581-0202"], ["Camino Nuevo Charter High", "413.0", "(213) 240-8700"], ["Camino Nuevo High #2", "None", "(213) 736-5566"], ["Camptonville Academy", "None", "(530) 742-2786"], ["Canyon Crest Academy", "611.0", "(858) 350-0253"], ["Capistrano Connections Academy", "512.0", "(949) 461-1667"], ["Capital City Independent Study", "None", "(916) 433-5187"], ["Carlsbad Seaside Academy", "None", "(760) 331-5299"], ["Carter G. Woodson Public Charter", "None", "(559) 229-3529"], ["Ceiba College Preparatory Academy", "None", "(831) 728-6208"], ["Centennial High", "489.0", "(661) 588-8601"], ["Centinela Valley Independent Study", "None", "(310) 263-4469"], ["Central City Value", "404.0", "(213) 471-4686"], ["Central High East Campus", "449.0", "(559) 276-0280"], ["Central Valley High", "433.0", "(209) 556-1900"], ["Century Academy", "None", "(805) 496-0286"], ["Cesar Chavez High", "417.0", "(209) 933-7480"], ["Cesar E. Chavez High", "439.0", "(661) 720-4501"], ["Cesar E. Chavez High", "None", "(714) 430-5700"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)", "413.0", "(818) 838-3926"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy", "401.0", "(818) 838-3915"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy", "401.0", "(818) 838-3946"], ["Cesar E. Chavez Learning Academy - Arts/Theatre/Entertain Mag", "369.0", "(818) 837-6428"], ["Chaffey District Online High", "None", "(909) 985-0966"], ["Chaparral High", "491.0", "(951) 695-4200"], ["Charter School of San Diego", "479.0", "(858) 678-2020"], ["Chawanakee Academy", "None", "None"], ["Chino Hills High", "508.0", "(909) 606-7540"], ["Christopher High", "484.0", "(408) 848-7171"], ["Citrus Hill High", "405.0", "(951) 490-0400"], ["Citrus Valley High", "473.0", "(909) 799-2300"], ["City Arts and Tech High", "395.0", "(415) 841-2200"], ["City Honors College Preparatory Academy", "442.0", "(310) 680-4880"], ["City of Angels", "501.0", "(323) 415-8350"], ["Classical Academy High", "548.0", "(760) 480-9845"], ["Clovis East High", "455.0", "(559) 327-4000"], ["Clovis North High", "519.0", "(559) 327-5000"], ["Clovis Online Charter", "None", "(559) 327-4400"], ["Cold Stream Alternative", "None", "(530) 582-2640"], ["College Bridge Academy", "None", "(323) 249-7845"], ["College Prep High", "463.0", "(951) 925-5155"], ["Colony High", "450.0", "(909) 930-2929"], ["Come Back Kids", "None", "(951) 826-6461"], ["Communication and Technology at Diego Rivera Learning Complex", "373.0", "(323) 846-2118"], ["Community Collaborative Charter", "None", "(916) 286-5161"], ["Condor High", "None", "(805) 385-2552"], ["Connecting Waters Charter", "504.0", "(209) 874-9463"], ["Connections Visual and Performing Arts Academy", "None", "(209) 928-4228"], ["Conservation Corps of Long Beach Gateway Cities Charter", "None", "(562) 216-1790"], ["Contreras Learning Center-Academic Leadership Community", "390.0", "(213) 240-3815"], ["Contreras Learning Center-Los Angeles School of Global Studies", "378.0", "(213) 240-3850"], ["Contreras Learning Center-School of Social Justice", "383.0", "(213) 240-3800"], ["Corona-Norco Alternative", "None", "(951) 736-3367"], ["Coronado Pathways Charter", "None", "None"], ["Cosumnes Oaks High", "491.0", "(916) 683-7670"], ["Crawford High", "380.0", "(619) 362-3700"], ["Creative Connections Arts Academy", "None", "(916) 566-1870"], ["Credo High", "None", "(707) 664-0600"], ["Crenshaw Arts-Technology Charter High", "381.0", "(323) 293-3917"], ["Crescent Valley Public Charter", "None", "(559) 970-5894"], ["Crescent View South Charter", "None", "(559) 222-8439"], ["Crescent View West Charter", "None", "(559) 222-8439"], ["Crossroads Alternative Education Center", "None", "(209) 826-4013"], ["Crossroads Charter", "None", "(559) 583-5060"], ["Cypress Charter High", "506.0", "(831) 477-0302"], ["Da Vinci Charter Academy", "558.0", "(530) 757-7154"], ["Da Vinci Design", "459.0", "(310) 725-5800"], ["Da Vinci Science", "467.0", "(310) 725-5800"], ["Daniel Pearl Journalism & Communications Magnet", "470.0", "(818) 654-3775"], ["Dehesa Charter", "529.0", "(760) 743-7880"], ["Del Mar High", "None", "(626) 291-5723"], ["Del Norte High", "565.0", "(858) 487-0877"], ["Delhi High", "419.0", "(209) 656-2050"], ["Delta Charter", "468.0", "(209) 830-6363"], ["Delta Charter", "None", "(831) 477-5212"], ["Delta Charter Online", "None", "(209) 830-6363"], ["Delta Home Charter", "None", "(209) 830-6363"], ["Denair Charter Academy", "None", "(209) 634-0917"], ["Desert Hot Springs High", "429.0", "(760) 288-7000"], ["Desert Mirage High", "414.0", "(760) 397-2255"], ["Desert Sands Charter", "None", "(661) 942-3357"], ["Design Science Early College High", "468.0", "(559) 248-7353"], ["Diamond Ranch High", "472.0", "(909) 397-4715"], ["Diego Hills Charter", "None", "(619) 286-0312"], ["Diego Springs Academy", "None", "(661) 272-1225"], ["Diego Valley Charter", "None", "(619) 286-0312"], ["Discovery Charter Preparatory School #2", "373.0", "(818) 897-1187"], ["Downtown College Preparatory", "None", "(408) 271-8120"], ["Dr. Maya Angelou Community High", "363.0", "(323) 846-4700"], ["Dr. TJ Owens Gilroy Early College Academy", "552.0", "(408) 846-4909"], ["Dunlap Leadership Academy", "None", "(559) 305-7320"], ["EPIC de Cesar Chavez", "None", "(661) 822-4381"], ["Early College Academy-LA Trade Tech College", "None", "(323) 763-3685"], ["Early College High", "478.0", "(714) 241-6108"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2", "388.0", "(323) 265-6760"], ["East Palo Alto Academy", "403.0", "(650) 893-8900"], ["East Valley Senior High", "415.0", "(818) 753-4400"], ["East Village High", "483.0", "(619) 525-2000"], ["Eastlake High", "498.0", "(619) 397-3800"], ["Eastside High", "409.0", "(661) 946-3800"], ["Edgewood High", "493.0", "(626) 939-0600"], ["Edward C. Merlo Institute of Environmental Studies", "370.0", "(209) 933-7190"], ["Edward R. Roybal Learning Center", "408.0", "(213) 580-6400"], ["El Camino High", "537.0", "(805) 289-7955"], ["El Diamante High", "475.0", "(559) 735-3501"], ["El Puente", "None", "(831) 796-7700"], ["Eleanor Roosevelt Community Learning Center", "None", "(559) 592-9160"], ["Eleanor Roosevelt High", "486.0", "(951) 738-2100"], ["Elise P. Buckingham Charter Magnet High", "533.0", "(707) 453-7300"], ["Elk Grove Charter", "None", "(916) 714-1653"], ["Elm High", "None", "(559) 485-8805"], ["Elsie Allen High", "457.0", "(707) 528-5020"], ["Elwood J. Keema High", "None", "(916) 566-3410"], ["Empire Springs Charter", "None", "(951) 252-8800"], ["Encore Jr./Sr. High School for the Performing and Visual Arts", "486.0", "(760) 956-2632"], ["Endeavor Alternative", "None", "(209) 556-1805"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3", "395.0", "(323) 285-6795"], ["Environmental Charter High", "446.0", "(310) 214-3400"], ["Environmental and Social Policy Magnet", "390.0", "(323) 441-4577"], ["Escondido Charter High", "513.0", "(760) 737-3154"], ["Escuela Popular Accelerated Family Learning", "None", "(408) 275-7190"], ["Escuela Popular/Center for Training and Careers, Family Learning", "None", "(408) 275-7191"], ["Esteban Torres East LA Performing Arts Magnet", "378.0", "(323) 265-6725"], ["Everest Public High", "538.0", "(650) 366-1050"], ["Everett Alvarez High", "446.0", "(831) 796-7800"], ["Evergreen Valley High", "565.0", "(408) 347-7000"], ["Excelsior Charter", "473.0", "(760) 245-4262"], ["Family First Charter", "None", "(310) 355-0001"], ["Family Partnership Home Study Charter", "None", "(805) 348-3333"], ["Farmersville High", "400.0", "(559) 594-4567"], ["Felicitas and Gonzalo Mendez High", "382.0", "(323) 981-6100"], ["Five Keys Adult School (SF Sheriff's)", "None", "(415) 734-3310"], ["Five Keys Charter (SF Sheriff's)", "None", "(415) 734-3310"], ["Five Keys Independence HS (SF Sheriff's)", "None", "(415) 734-3310"], ["Foothill Technology High", "530.0", "(805) 289-0023"], ["Forest Charter", "508.0", "(530) 265-4823"], ["Foresthill High", "490.0", "(530) 367-5244"], ["Franklin High", "512.0", "(916) 714-8150"], ["Frazier Mountain High", "443.0", "(661) 248-0310"], ["Frederick Douglass Academy High", "378.0", "None"], ["Fresno Academy for Civic and Entrepreneurial Leadership", "None", "None"], ["Frida Kahlo High", "None", "(213) 763-1090"], ["Frontier High", "475.0", "(661) 829-1107"], ["Fusion Charter", "None", "(209) 667-0327"], ["Future Bound Independent Study Secondary", "None", "(760) 787-2068"], ["Futures High", "489.0", "(916) 286-1902"], ["Gabrielino High", "518.0", "(626) 573-2415"], ["Gateway College and Career Academy", "None", "(951) 222-8931"], ["Gateway Educational Options", "None", "(530) 245-7960"], ["Gateway High", "483.0", "(415) 749-3600"], ["Gateway to College", "None", "(415) 452-5768"], ["Gateway to College Academy", "None", "(707) 778-4621"], ["George Washington Carver School of Arts and Science", "526.0", "(916) 395-5266"], ["Geyserville New Tech Academy", "None", "(707) 857-3592"], ["Glacier High School Charter", "None", "(559) 642-1422"], ["Global Youth Charter", "None", "(916) 339-4680"], ["Gold Rush Charter", "None", "(209) 532-9781"], ["Golden Eagle Charter", "None", "(530) 926-5800"], ["Golden Valley Charter", "None", "(805) 642-3435"], ["Golden Valley High", "424.0", "(661) 827-0800"], ["Golden Valley High", "500.0", "(661) 298-8140"], ["Golden Valley High", "436.0", "(209) 325-1800"], ["Gompers Preparatory Academy", "363.0", "(619) 263-2171"], ["Gonzales High", "425.0", "(831) 675-2495"], ["Gorman Learning Center", "473.0", "(909) 307-6312"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "441.0", "(909) 580-5006"], ["Granite Bay High", "551.0", "(916) 786-8676"], ["Granite Hills High", "479.0", "(760) 961-2290"], ["Granite Hills High", "433.0", "(559) 782-7075"], ["Great Oak High", "505.0", "(951) 294-6450"], ["Greater San Diego Academy", "None", "(619) 669-3050"], ["Green Design at Diego Rivera Learning Complex", "375.0", "(323) 846-2108"], ["Greenfield High", "427.0", "(831) 674-2751"], ["Grizzly ChalleNGe Charter", "None", "(805) 782-6882"], ["Grossmont Middle College High", "525.0", "(619) 644-7524"], ["Grove", "535.0", "(909) 798-7831"], ["Guajome Learning Center", "None", "(760) 631-8500"], ["Guajome Park Academy Charter", "531.0", "(760) 631-8500"], ["Guidance Charter", "407.0", "(661) 285-1600"], ["Hallmark Charter", "460.0", "(559) 524-7170"], ["Hamilton High", "481.0", "(951) 763-1865"], ["Hanford West High", "450.0", "(559) 583-5903"], ["Harbor Teacher Preparation Academy", "509.0", "(310) 834-3932"], ["Harmony Magnet Academy", "464.0", "(559) 568-0347"], ["Hart-Ransom Academic Charter", "None", "(209) 523-0401"], ["Hawthorne Math and Science Academy", "492.0", "(310) 973-8184"], ["Health Careers Academy", "418.0", "(209) 933-7360"], ["Health Sciences High", "422.0", "(619) 528-9070"], ["Hector G. Godinez", "433.0", "(714) 433-6790"], ["Helen Bernstein High", "391.0", "(323) 817-6460"], ["Helix High", "464.0", "(619) 466-4194"], ["Henry J. Kaiser High", "417.0", "(909) 357-5900"], ["Heritage High", "444.0", "(951) 940-5447"], ["Heritage Peak Charter", "458.0", "(866) 992-9033"], ["High Desert Premier Academy", "None", "(760) 240-4252"], ["High Tech High", "477.0", "(619) 243-5014"], ["High Tech High Chula Vista", "471.0", "(619) 243-5014"], ["High Tech High International", "477.0", "(619) 243-5014"], ["High Tech High Media Arts", "457.0", "(619) 398-8632"], ["High Tech High North County", "511.0", "(619) 243-5014"], ["High Tech LA", "508.0", "(818) 609-2640"], ["Highlands Community Charter", "None", "(916) 844-2283"], ["Home & Hosp/Transition Support", "None", "(619) 344-6435"], ["Hope Academy Charter", "None", "None"], ["Horizon", "None", "(760) 238-9720"], ["Horizon Charter", "456.0", "(916) 408-5200"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4", "386.0", "(323) 265-6830"], ["Humanities and Arts (HARTS) Academy of Los Angeles", "425.0", "(310) 257-7100"], ["Hume Lake Charter", "None", "(559) 305-7565"], ["Humphreys College Academy of Business, Law and Education", "424.0", "(209) 478-1600"], ["Independence", "None", "(209) 331-8275"], ["Independence Charter Academy", "None", "(760) 952-1760"], ["Independence High", "463.0", "(661) 834-8001"], ["Independence High", "None", "(805) 769-1620"], ["Inderkum High", "449.0", "(916) 567-5640"], ["Indian Springs High", "400.0", "(909) 383-1360"], ["Insight @ Los Angeles", "425.0", "None"], ["Insight @ San Diego", "None", "(805) 581-0202"], ["Insight School of California", "None", "(805) 581-0202"], ["Inspire Charter School", "None", "(661) 269-2214"], ["International Polytechnic High", "495.0", "(909) 839-2320"], ["International Studies Learning Center at Legacy High School Complex", "457.0", "(323) 357-7521"], ["Ivy Academia", "431.0", "(818) 716-0771"], ["IvyTech Charter", "None", "(805) 222-5188"], ["James C. Enochs High", "487.0", "(209) 550-3400"], ["Jesse M. Bethel High", "447.0", "(707) 556-5700"], ["John Adams Academy", "576.0", "(916) 780-6800"], ["John C. Kimball High", "500.0", "(209) 832-6600"], ["John F. Kennedy High", "497.0", "(951) 738-2200"], ["John H. Pitman High", "480.0", "(209) 656-1592"], ["John Muir Charter Schools", "None", "(530) 272-4008"], ["Jordan (June) School for Equity", "None", "(415) 452-4922"], ["Joseph A. Gregori High", "465.0", "(209) 550-3421"], ["Juan Bautista de Anza", "None", "(760) 767-5850"], ["Julian Charter", "517.0", "(760) 765-3847"], ["Jurupa Hills High", "424.0", "(909) 357-6300"], ["KIPP San Jose Collegiate", "482.0", "(408) 937-3752"], ["Kearny College Connections", "450.0", "(858) 496-8370"], ["Kearny Digital Media & Design", "482.0", "(858) 496-8370"], ["Kearny Eng, Innov & Design", "426.0", "(858) 496-8370"], ["Kearny SCT", "452.0", "(858) 496-8370"], ["Keith McCarthy Academy", "None", "(951) 253-7777"], ["Kern Workforce 2000 Academy", "None", "(661) 827-3158"], ["Keyes to Learning Charter", "None", "(209) 634-6467"], ["King-Chavez Community High", "369.0", "(619) 704-1020"], ["Kingsburg Independent Study High", "None", "(559) 897-3880"], ["La Costa Canyon High", "542.0", "(760) 436-6136"], ["La Quinta High", "462.0", "(760) 772-4150"], ["La Sierra High", "None", "(559) 733-6963"], ["Laguna Creek High", "483.0", "(916) 683-1339"], ["Lakeside High", "454.0", "(951) 253-7300"], ["Lancaster High", "449.0", "(661) 726-7649"], ["Lathrop High", "432.0", "(209) 938-6350"], ["Latino College Preparatory Academy", "380.0", "(408) 729-2281"], ["Laurel Preparatory Academy", "None", "(858) 678-4812"], ["Laurel Tree Charter", "None", "(707) 822-5626"], ["Lawndale High", "423.0", "(310) 263-3102"], ["Leadership High", "408.0", "(415) 841-8910"], ["Leadership Public Schools - San Jose", "381.0", "None"], ["Leadership in Entertainment and Media Arts (LEMA)", "354.0", "None"], ["Learning Choice Academy", "None", "(619) 463-6849"], ["Learning Works", "None", "(626) 564-2871"], ["Learning for Life Charter", "None", "(831) 582-9820"], ["Lee V. Pollard High", "None", "(951) 736-3367"], ["Lemoore Middle College High", "464.0", "(559) 925-3552"], ["Lennox Mathematics, Science and Technology Academy", "418.0", "(310) 680-5600"], ["Liberty High", "501.0", "(661) 587-0925"], ["Liberty High", "472.0", "(559) 645-3500"], ["Liberty High (Alternative)", "None", "(408) 535-6327"], ["Liberty Ranch High", "496.0", "(209) 744-4250"], ["Lifeline Education Charter", "359.0", "(310) 605-2510"], ["Lincoln High", "389.0", "(619) 266-6500"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "431.0", "(323) 568-3800"], ["Linda Esperanza Marquez High B LIBRA Academy", "410.0", "(323) 584-3800"], ["Linda Esperanza Marquez High C School of Social Justice", "423.0", "(323) 584-3800"], ["Literacy First Charter", "None", "(619) 579-7232"], ["Loma Vista Charter", "None", "(559) 562-5111"], ["Los Angeles Academy of Arts & Enterprise Charter", "388.0", "(213) 487-0600"], ["Los Angeles Big Picture High", "None", "None"], ["Los Angeles County Online High", "None", "(800) 985-0770"], ["Los Angeles High School of the Arts", "409.0", "(213) 480-4600"], ["Los Angeles International Charter High", "428.0", "(323) 257-1499"], ["Los Angeles Leadership Academy", "425.0", "(323) 227-7719"], ["Los Angeles River at Sonia Sotomayor Learning Academies", "383.0", "(323) 276-5535"], ["Los Angeles Teacher Preparatory Academy", "339.0", "None"], ["Los Olivos Charter School", "None", "None"], ["Los Osos High", "511.0", "(909) 477-6900"], ["MAAC Community Charter", "None", "(619) 476-0749"], ["MIT Academy", "None", "(707) 552-6482"], ["Madera County Independent Academy", "None", "(559) 662-4636"], ["Madera South High", "414.0", "(559) 675-4450"], ["Magnolia Science Academy", "470.0", "(818) 609-0507"], ["Magnolia Science Academy 2", "427.0", "(818) 758-0300"], ["Magnolia Science Academy 3", "418.0", "(310) 637-3806"], ["Magnolia Science Academy 4", "405.0", "(310) 473-2464"], ["Magnolia Science Academy Santa Clara", "None", "None"], ["Malibu High", "553.0", "(310) 457-6801"], ["Marco Antonio Firebaugh High", "412.0", "(310) 886-5200"], ["Maria Carrillo High", "563.0", "(707) 528-5790"], ["Marina High", "454.0", "(831) 583-2060"], ["Marshall (Thurgood) High", "364.0", "(415) 695-5612"], ["Martin Luther King Jr. High", "494.0", "(951) 789-5690"], ["Marysville Charter Academy for the Arts", "484.0", "(530) 749-6156"], ["Math, Science, & Technology Magnet Academy at Roosevelt High", "447.0", "(323) 780-6500"], ["Matt Garcia Career and College Academy", "None", "(707) 424-9400"], ["Mattole Triple Junction High", "None", "(707) 629-3250"], ["Mattole Valley Charter (#159)", "None", "(707) 629-3634"], ["Maywood Academy High", "420.0", "(323) 838-6000"], ["Mendota High", "378.0", "(559) 655-1993"], ["Merced Scholars Charter", "None", "(209) 381-5165"], ["Merrill F. West High", "479.0", "(209) 830-3370"], ["Middle College High", "435.0", "(323) 418-4700"], ["Middle College High", "483.0", "(714) 953-3900"], ["Middle College High", "469.0", "(909) 888-4041"], ["Middle College High", "565.0", "(209) 954-5790"], ["Middle College High", "None", "(408) 298-2181"], ["Millennium Charter", "480.0", "(209) 831-5240"], ["Minarets Charter High", "463.0", "(559) 868-8659"], ["Minarets High", "472.0", "(559) 868-8689"], ["Mira Monte High", "403.0", "(661) 366-1800"], ["Mirus Secondary", "None", "(760) 244-3764"], ["Mission Hills High", "495.0", "(760) 290-2700"], ["Mission Oak High", "435.0", "(559) 688-2021"], ["Mission View Public", "None", "(661) 200-5595"], ["Mission Vista High", "501.0", "(760) 758-6800"], ["Mojave River Academy", "None", "(760) 245-3222"], ["Monarch", "None", "(619) 652-4100"], ["Monterey County Home Charter", "None", "(831) 755-0331"], ["Monterey Trail High", "444.0", "(916) 688-0050"], ["Moreno Valley Online Academy", "None", "(951) 571-4800"], ["Mountain Heights Academy", "None", "(951) 487-7710"], ["Mountain Park", "468.0", "(626) 471-3014"], ["Mountain Valley Academy", "None", "(760) 787-3600"], ["Mt. Lassen Charter", "None", "(530) 827-2129"], ["Murrieta Canyon Academy", "None", "(951) 696-1661"], ["Murrieta Mesa High", "478.0", "(951) 677-0568"], ["NOVA Academy - Coachella", "403.0", "(714) 569-0948"], ["Napa Valley Independent Studies", "None", "(707) 259-8577"], ["National University Academy", "None", "(760) 631-5842"], ["National University Academy - Orange Center", "None", "None"], ["National University Academy, Armona", "None", "None"], ["Natomas Charter", "524.0", "(916) 928-5353"], ["Natomas High", "454.0", "(916) 641-4960"], ["Natomas Pacific Pathways Prep", "477.0", "(916) 567-5740"], ["New Day Academy", "None", "(530) 233-3861"], ["New Designs Charter", "411.0", "(213) 765-9084"], ["New Designs Charter School-Watts", "371.0", "(323) 418-0600"], ["New Horizons", "None", "(707) 459-4801"], ["New Millennium Secondary", "388.0", "(310) 999-6162"], ["New Open World Academy K-12", "402.0", "(213) 480-3700"], ["New Opportunities Charter", "None", "(310) 355-0001"], ["New Technology High", "500.0", "(707) 259-8557"], ["New Technology High", "432.0", "(916) 395-5254"], ["New Village Girls Academy", "374.0", "(213) 385-4015"], ["New Vision High", "None", "(209) 938-6225"], ["Nipomo High", "490.0", "(805) 474-3300"], ["North County Trade Tech High", "None", "(760) 598-0782"], ["North State Independence High", "None", "(530) 245-2760"], ["North Valley Military Institute College Preparatory Academy", "None", "(818) 368-1557"], ["Northcoast Preparatory and Performing Arts Academy", "579.0", "None"], ["Northern Summit Academy", "None", "(530) 949-0154"], ["Northridge Academy High", "464.0", "(818) 700-2222"], ["Northwest Prep Charter", "None", "(707) 522-3320"], ["Northwood High", "621.0", "(949) 936-7200"], ["Nova Academy", "448.0", "(714) 569-0948"], ["Nuview Bridge Early College High", "471.0", "(951) 928-8498"], ["OCCS:CHEP/PCHS", "528.0", "(714) 327-1000"], ["OCSA", "582.0", "(714) 560-9000"], ["OUSD Home Sch", "None", "(714) 628-5479"], ["Oak Hills High", "450.0", "(760) 244-2283"], ["Oak Park Independent", "488.0", "(818) 735-3260"], ["Oakdale Charter", "None", "(209) 848-4361"], ["Oasis High (Alternative)", "None", "(760) 723-6395"], ["Ocean Grove Charter", "554.0", "(530) 295-3566"], ["Olympian High", "476.0", "(619) 656-2400"], ["Opportunities For Learning - Baldwin Park II", "426.0", "(626) 962-3311"], ["Opportunities For Learning - Fresno", "None", "(626) 921-8200"], ["Opportunities for Learning - Baldwin Park", "447.0", "(626) 814-0161"], ["Opportunities for Learning - Capistrano", "None", "(949) 248-1282"], ["Opportunities for Learning - Duarte", "None", "(626) 921-8200"], ["Opportunities for Learning - Santa Clarita", "489.0", "(661) 424-1337"], ["Optimist Charter", "None", "(323) 443-3100"], ["Options Secondary", "None", "(619) 796-7320"], ["Options for Youth San Gabriel", "455.0", "(626) 921-8200"], ["Options for Youth-Burbank Charter", "464.0", "(818) 566-7525"], ["Options for Youth-San Bernardino", "457.0", "(626) 685-9300"], ["Options for Youth-San Juan", "431.0", "(916) 485-5155"], ["Options for Youth-Victorville Charter", "419.0", "(626) 685-9300"], ["Orange County Conservation Corps Charter", "None", "(714) 956-6222"], ["Orange Cove High", "405.0", "(559) 626-5900"], ["Orchard View", "None", "(707) 823-4709"], ["Orcutt Academy Charter", "492.0", "(805) 938-8900"], ["Orthopaedic Hospital", "444.0", "(213) 765-2088"], ["Oscar De La Hoya Animo Charter High", "398.0", "(323) 780-1259"], ["Otay Ranch Senior High", "474.0", "(619) 591-5000"], ["Oxford Academy", "634.0", "(714) 220-3055"], ["PUC CA Academy for Liberal Studies Early College High", "437.0", "None"], ["PUC Community Charter Middle and PUC Community Charter Early College High", "None", "(818) 485-0933"], ["PUC Early College Academy for Leaders and Scholars (ECALS)", "401.0", "(323) 276-5525"], ["PUC Lakeview Charter High", "390.0", "(818) 356-2591"], ["PUC Triumph Charter High", "None", "None"], ["Pacheco High", "441.0", "(209) 826-3801"], ["Pacific Boulevard", "None", "(323) 586-8640"], ["Pacific Coast Charter", "None", "(831) 761-6021"], ["Pacific Collegiate Charter", "630.0", "(831) 479-7785"], ["Pacific Law Academy", "None", "(209) 933-7475"], ["Pacific View Charter", "None", "(707) 269-9490"], ["Pacific View Charter", "None", "(760) 757-0161"], ["Pacifica High", "454.0", "(805) 278-5000"], ["Pajaro Valley High", "430.0", "(831) 728-8102"], ["Palisades Charter High", "525.0", "(310) 230-6623"], ["Palmdale Aerospace Academy", "None", "(661) 273-3680"], ["Paloma Valley High", "450.0", "(951) 672-6030"], ["Palos Verdes High", "564.0", "(310) 378-8471"], ["Panorama High", "411.0", "(818) 909-4500"], ["Paramount Alternative Education Center", "None", "None"], ["Parkview", "None", "(714) 986-7050"], ["Partnerships for Student-Centered Learning", "None", "(916) 408-5200"], ["Pathway Independent Study", "None", "(310) 603-1516"], ["Pathways Charter", "None", "(707) 585-6510"], ["Patriot High", "463.0", "(951) 361-6500"], ["Peninsula High", "None", "(650) 558-2499"], ["Performing Arts Community at Diego Rivera Learning Complex", "372.0", "(323) 846-2136"], ["Peter Johansen High", "435.0", "(209) 576-4702"], ["Pioneer High", "455.0", "(530) 406-1148"], ["Pioneer Technical Center", "None", "(559) 662-6294"], ["Pioneer Valley High", "451.0", "(805) 922-1305"], ["Pivot Charter School - San Diego", "None", "(760) 591-0217"], ["Pivot Online Charter - North Bay", "None", "(707) 843-4676"], ["Pleasant Grove High", "513.0", "(916) 686-0230"], ["Plumas Charter", "None", "(530) 283-3851"], ["Port of Los Angeles High", "487.0", "(310) 832-9201"], ["Preuss School UCSD", "520.0", "(858) 822-3000"], ["Prospect Education Center", "None", "(559) 782-7095"], ["Provisional Accelerated Learning Academy", "None", "(909) 887-7002"], ["Public Safety Academy", "None", "(909) 382-2211"], ["Public Service Community at Diego Rivera Learning Complex", "406.0", "(323) 846-2128"], ["RAI Online Charter", "None", "None"], ["Ramon C. Cortines School of Visual and Performing Arts", "446.0", "(213) 217-8600"], ["Rancho Cucamonga High", "489.0", "(909) 989-1600"], ["Rancho Dominguez Preparatory", "420.0", "(310) 354-3400"], ["Redlands East Valley High", "498.0", "(909) 389-2500"], ["Redlands eAcademy", "None", "(909) 748-6941"], ["Redondo Shores High (Continuation)", "None", "(310) 798-8690"], ["Redwood Academy of Ukiah", "540.0", "(707) 467-0500"], ["Renaissance Arts Academy", "506.0", "(323) 259-5700"], ["Renaissance High School for the Arts", "483.0", "(562) 901-0168"], ["Renew Virtual Academy K12 #1", "None", "None"], ["Rialto High", "421.0", "(909) 421-7500"], ["Ridgeview High", "421.0", "(661) 398-3100"], ["Rio Valley Charter", "None", "(209) 368-4934"], ["River Oaks Academy", "None", "(805) 777-7999"], ["River Springs Charter", "478.0", "(951) 252-8800"], ["River Valley Charter", "555.0", "(619) 390-2579"], ["River Valley High", "479.0", "(530) 822-2500"], ["Rivercrest Preparatory", "None", "(951) 360-2660"], ["Riverside County Education Academy", "None", "(951) 826-6602"], ["Riverside Preparatory", "447.0", "(760) 243-5884"], ["Riverside Virtual", "None", "(951) 276-2006"], ["Robert F. Kennedy High", "449.0", "(661) 720-5117"], ["Rocklin High", "527.0", "(916) 632-1600"], ["Rocklin Independent Charter Academy", "None", "(916) 632-3195"], ["Ronald E. McNair High", "436.0", "(209) 953-9245"], ["Ronald Reagan Academy", "None", "(559) 595-0563"], ["Roseland Charter", "410.0", "(707) 545-0102"], ["Rosemont High", "452.0", "(916) 395-5130"], ["S.F. International High", "318.0", "(415) 695-5781"], ["SAVA: Sacramento Academic and Vocational Academy", "None", "(916) 387-8063"], ["SIATech", "None", "(760) 945-1227"], ["SIATech Academy South", "None", "(760) 945-1227"], ["SLVUSD Charter", "None", "(831) 335-0932"], ["SOAR High (Students On Academic Rise)", "496.0", "(661) 722-6300"], ["STEM Academy at Bernstein High", "399.0", "(323) 817-6461"], ["Sacramento Charter High", "403.0", "(916) 277-6200"], ["San Andreas High (Continuation)", "None", "(415) 945-3751"], ["San Diego Business/Leadership", "402.0", "(619) 525-7461"], ["San Diego International Studies", "523.0", "(619) 525-7464"], ["San Diego MVP Arts", "405.0", "None"], ["San Diego Metro Career and Tech", "489.0", "(619) 388-2299"], ["San Diego Science and Technology", "423.0", "(619) 525-7459"], ["San Diego Virtual", "None", "(619) 713-7271"], ["San Francisco Flex Academy", "502.0", "None"], ["San Jacinto Valley Academy", "466.0", "(951) 654-6113"], ["San Joaquin Building Futures Academy", "None", "(209) 468-8140"], ["San Jose Conservation Corps Charter", "None", "(408) 459-6404"], ["San Juan Choices Charter", "None", "(916) 979-8378"], ["San Juan Hills High", "534.0", "(949) 234-5900"], ["San Pasqual Academy", "363.0", "(760) 233-6003"], ["San Ysidro High", "431.0", "(619) 710-2300"], ["Santa Clarita Valley International", "443.0", "(661) 705-4820"], ["Santa Rosa Academy", "503.0", "(951) 672-2400"], ["Santa Susana High", "556.0", "(805) 520-6800"], ["Santee Education Complex", "382.0", "(213) 763-1000"], ["Santiago High", "499.0", "(951) 739-5600"], ["School for Entrepreneurship and Technology", "453.0", "(858) 874-4338"], ["School for the Visual Arts and Humanities", "394.0", "(213) 480-4700"], ["School of Arts and Enterprise", "473.0", "(909) 622-0699"], ["School of Business and Tourism at Contreras Learning Complex", "403.0", "(213) 240-3800"], ["School of Engineering & Sciences", "420.0", "(916) 395-5040"], ["School of Extended Educational Options", "None", "(909) 397-4900"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies", "430.0", "(323) 276-5500"], ["School of Unlimited Learning", "None", "(559) 498-8543"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex", "383.0", "(323) 357-7545"], ["Scotts Valley High", "547.0", "(831) 439-9555"], ["Scripps Ranch High", "564.0", "(858) 621-9020"], ["Segerstrom High", "463.0", "(714) 241-5000"], ["Selma Independent", "None", "(559) 898-6670"], ["Shadow Hills High", "434.0", "(760) 393-5400"], ["Shadow Ridge", "None", "(760) 949-8267"], ["Shasta Charter Academy", "None", "(530) 245-2600"], ["Shattuck Independent Study", "None", "(209) 656-2012"], ["Sheldon High", "472.0", "(916) 681-7500"], ["Sherman Thomas Charter High", "None", "(559) 675-6626"], ["Sierra Charter", "None", "(559) 490-4290"], ["Sierra High", "463.0", "(209) 858-7410"], ["Sierra Pacific High", "464.0", "(559) 583-5912"], ["Sierra Vista Charter High", "None", "(559) 687-7384"], ["Silicon Valley Flex Academy", "None", "None"], ["Silver Valley Academy", "None", "(760) 254-2715"], ["Silverado High", "422.0", "(760) 955-3353"], ["Six Rivers Charter High", "472.0", "(707) 825-2428"], ["Sky Mountain Charter", "None", "(530) 295-3566"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5", "371.0", "(323) 265-6865"], ["Soledad Enrichment Action Charter High", "335.0", "(213) 480-4200"], ["Soledad High", "428.0", "(831) 678-6400"], ["South East High", "439.0", "(323) 568-3400"], ["South El Monte High", "427.0", "(626) 442-0218"], ["South Sutter Charter", "465.0", "(530) 295-3566"], ["Southern California Online Academy", "None", "None"], ["Southwest High", "468.0", "(760) 336-4100"], ["Stanislaus Alternative Charter", "None", "(209) 238-6801"], ["Steele Canyon High", "492.0", "(619) 660-3550"], ["Stellar Secondary Charter High", "None", "(530) 245-7730"], ["Stockton Collegiate International Secondary", "475.0", "(209) 390-9861"], ["Stockton High", "None", "(209) 933-7365"], ["Stockton Unified Early College Academy", "519.0", "(209) 933-7370"], ["Student Empowerment Academy", "372.0", "None"], ["Success One!", "None", "(530) 934-6320"], ["Sultana High", "448.0", "(760) 947-6777"], ["Summit Charter Academy", "None", "(559) 782-5902"], ["Summit High", "425.0", "(909) 357-5950"], ["Summit Leadership Academy-High Desert", "370.0", "(760) 949-9202"], ["Summit Preparatory Charter High", "522.0", "(650) 556-1110"], ["Summit Public School: Rainier", "493.0", "(408) 831-3104"], ["Summit Public School: Tahoma", "483.0", "(408) 729-1981"], ["Sun Valley High", "385.0", "(818) 394-4600"], ["Sunnyside High", "399.0", "(559) 253-6700"], ["Susan H. Nelson", "None", "(951) 695-7360"], ["Synergy Quantum Academy", "419.0", "(323) 846-4716"], ["Tahquitz High", "445.0", "(951) 765-6300"], ["Taylion San Diego Academy", "None", "(760) 295-5564"], ["Technology High", "567.0", "(707) 792-4825"], ["Tehama eLearning Academy", "None", "(530) 527-0188"], ["Temecula Preparatory", "539.0", "(951) 926-6776"], ["Templeton Independent Study High", "None", "(805) 434-5805"], ["Tesoro High", "545.0", "(949) 234-5310"], ["The Education Corps", "None", "(323) 249-7845"], ["The High School at Moorpark College", "519.0", "(805) 378-1444"], ["The MET", "468.0", "(916) 395-5417"], ["Thurgood Marshall", "None", "(310) 898-6340"], ["UCLA Community K-12", "392.0", "(213) 480-3750"], ["Ukiah Independent Study Academy", "None", "(707) 472-5062"], ["University High", "593.0", "(559) 278-8263"], ["University Preparatory", "500.0", "(760) 243-5940"], ["University Preparatory", "551.0", "(530) 245-2790"], ["University Preparatory Academy Charter", "537.0", "(408) 723-1839"], ["University Preparatory High", "498.0", "(559) 730-2529"], ["Urban Corps of San Diego County Charter", "None", "(619) 235-6884"], ["Val Verde Academy", "None", "(951) 443-2450"], ["Valencia High", "528.0", "(661) 294-1188"], ["Valley Academy of Arts and Sciences", "440.0", "(818) 832-7750"], ["Valley Center High", "474.0", "(760) 751-5502"], ["Valley Center Prep", "None", "(760) 751-0455"], ["Valley Charter High", "489.0", "(209) 238-6800"], ["Valley Oak Junior and Senior High", "None", "(209) 847-3097"], ["Valley Oaks Charter", "502.0", "(661) 852-6700"], ["Valley Oaks High (Alternative)", "None", "(707) 778-4794"], ["Valley View Charter Prep", "None", "(916) 866-9033"], ["Vantage Point Charter", "None", "(530) 432-5312"], ["Vasquez High", "500.0", "(661) 269-0451"], ["Venture Academy", "458.0", "(209) 468-5940"], ["Victory High", "None", "(916) 632-3195"], ["View Park Preparatory Accelerated High", "382.0", "(323) 290-6975"], ["Village Academy High School at Indian Hill", "442.0", "(909) 397-4900"], ["Visalia Charter Independent Study", "442.0", "(559) 735-8055"], ["Visalia Technical Early College", "None", "(559) 622-3212"], ["Visions In Education", "533.0", "(916) 971-7037"], ["Vista Murrieta High", "491.0", "(951) 894-5750"], ["Vista Nueva Career and Technology High", "None", "(916) 566-2750"], ["Vista Real Charter High", "None", "(805) 486-5449"], ["Vista Visions Academy", "None", "(760) 724-4785"], ["Vista del Lago High", "424.0", "(951) 571-4880"], ["Vista del Lago High", "552.0", "(916) 294-2410"], ["Visual and Performing Arts at Legacy High School Complex", "386.0", "(323) 357-7500"], ["W. E. B. DuBois Public Charter", "None", "(559) 486-1166"], ["Wallis Annenberg High", "416.0", "(323) 235-6343"], ["Warner Junior/Senior High", "None", "(760) 782-3517"], ["Waterford High", "465.0", "(209) 874-9060"], ["Weber Institute", "420.0", "(209) 933-7330"], ["West Adams Preparatory High", "385.0", "(323) 373-2500"], ["West Campus", "500.0", "(916) 277-6400"], ["West Park Charter Academy", "None", "(559) 233-6501"], ["West Ranch High", "539.0", "(661) 222-1220"], ["West Sacramento Early College Prep Charter", "None", "(916) 375-7680"], ["Western Sierra Collegiate Academy", "547.0", "(916) 778-4544"], ["Weston Ranch High", "454.0", "(209) 938-6245"], ["Westview High", "581.0", "(858) 780-2000"], ["Westwood Charter", "None", "(530) 256-2994"], ["Whitmore Charter High", "542.0", "(209) 556-1617"], ["Whitney High", "502.0", "(916) 632-6500"], ["William & Marian Ghidotti High", "576.0", "(530) 274-5270"], ["William J. (Pete) Knight High", "442.0", "(661) 533-9000"], ["Willits Charter", "None", "(707) 459-5506"], ["Wilmer Amina Carter High", "436.0", "(909) 854-4100"], ["Windsor High", "516.0", "(707) 837-7767"], ["Wonderful College Prep Academy", "377.0", "(661) 454-3000"], ["Woodcreek High", "501.0", "(916) 771-6565"], ["Yorba Linda High", "543.0", "(714) 986-7500"], ["Youth Opportunities Unlimited", "None", "(323) 789-4731"], ["YouthBuild Charter School of California", "None", "(213) 741-2600"], ["YouthBuild Charter School of California Central", "None", "None"], ["Yuba City Charter", "None", "(530) 822-9667"], ["Yuba County Career Preparatory Charter", "None", "(530) 749-4000"], ["be.tech", "None", "(209) 858-7460"], ["eCademy Charter at Crane", "None", "(209) 669-3410"], ["iHigh Virtual Academy", "None", "(619) 764-5440"], ["iQ Academy California-Los Angeles", "None", "(888) 997-4722"], ["one.Charter", "None", "(209) 468-9079"]], "spark_error": null, "total_time": 29.90698528289795, "spark_time": 0.6131572723388672, "translation_time": 29.293828010559082, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='34ba9bd0-0444-4e0e-9170-6563c89196ee'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='05661fe2-aff5-4cb4-bcd2-47627b3c693e'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 ORDER BY s.School'}", "Observation: content='The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   Data types are correctly handled in predicates by casting the substring to `INT` before comparison.\\n*   Identifiers are simple and do not require quoting with backticks.\\n*   There are no string literals that need backticks.\\n*   Functions (`SUBSTRING`, `CAST`) are used with the correct number of arguments.\\n*   Casting is done to the appropriate `INT` type for numerical comparison.\\n*   The join columns (`s.CDSCode = sa.cds`) are assumed to be the correct keys for linking schools and SAT scores.\\n\\n```sql\\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 ORDER BY s.School\\n```' name='query_checker_sql_db' tool_call_id='89c7b3ee-fcd5-45ad-96dd-2d97ceee24f8'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 ORDER BY s.School'}"], "input_tokens": 4154, "output_tokens": 2646, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 ORDER BY s.School\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   Data types are correctly handled in predicates by casting the substring to `INT` before comparison.\n*   Identifiers are simple and do not require quoting with backticks.\n*   There are no string literals that need backticks.\n*   Functions (`SUBSTRING`, `CAST`) are used with the correct number of arguments.\n*   Casting is done to the appropriate `INT` type for numerical comparison.\n*   The join columns (`s.CDSCode = sa.cds`) are assumed to be the correct keys for linking schools and SAT scores.\n\n```sql\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 ORDER BY s.School\n```", "final_answer": "", "replica": 1, "timestamp": 1768937662.5438676}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": 0.0521004459047172, "spider_em": 0, "sparksql_query": "SELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000", "execution_status": "VALID", "query_result": [["Crescent View West Charter", "None", "(559) 222-8439"], ["Hume Lake Charter", "None", "(559) 305-7565"], ["Big Picture Educational Academy", "None", "(559) 420-1234"], ["Clovis North High", "519.0", "(559) 327-5000"], ["Clovis Online Charter", "None", "(559) 327-4400"], ["Buchanan High", "507.0", "(559) 327-3000"], ["Clovis East High", "455.0", "(559) 327-4000"], ["Design Science Early College High", "468.0", "(559) 248-7353"], ["Sierra Charter", "None", "(559) 490-4290"], ["University High", "593.0", "(559) 278-8263"], ["Fresno Academy for Civic and Entrepreneurial Leadership", "None", "None"], ["School of Unlimited Learning", "None", "(559) 498-8543"], ["Sunnyside High", "399.0", "(559) 253-6700"], ["Carter G. Woodson Public Charter", "None", "(559) 229-3529"], ["Kingsburg Independent Study High", "None", "(559) 897-3880"], ["Orange Cove High", "405.0", "(559) 626-5900"], ["Dunlap Leadership Academy", "None", "(559) 305-7320"], ["National University Academy - Orange Center", "None", "None"], ["Academy of Arts and Sciences: Fresno", "None", "(855) 937-4227"], ["Ambassador Phillip V. Sanchez Public Charter", "None", "(559) 255-9017"], ["Hallmark Charter", "460.0", "(559) 524-7170"], ["Selma Independent", "None", "(559) 898-6670"], ["West Park Charter Academy", "None", "(559) 233-6501"], ["Crescent View South Charter", "None", "(559) 222-8439"], ["Opportunities For Learning - Fresno", "None", "(626) 921-8200"], ["Central High East Campus", "449.0", "(559) 276-0280"], ["Mendota High", "378.0", "(559) 655-1993"], ["Elm High", "None", "(559) 485-8805"], ["W. E. B. DuBois Public Charter", "None", "(559) 486-1166"], ["Success One!", "None", "(530) 934-6320"], ["Conservation Corps of Long Beach Gateway Cities Charter", "None", "(562) 216-1790"], ["Northcoast Preparatory and Performing Arts Academy", "579.0", "None"], ["Six Rivers Charter High", "472.0", "(707) 825-2428"], ["Laurel Tree Charter", "None", "(707) 822-5626"], ["Academy of the Redwoods", "524.0", "(707) 476-4203"], ["Pacific View Charter", "None", "(707) 269-9490"], ["Alder Grove Charter", "None", "(707) 268-0854"], ["Mattole Triple Junction High", "None", "(707) 629-3250"], ["Mattole Valley Charter (#159)", "None", "(707) 629-3634"], ["Southwest High", "468.0", "(760) 336-4100"], ["YouthBuild Charter School of California", "None", "(213) 741-2600"], ["YouthBuild Charter School of California Central", "None", "None"], ["The Education Corps", "None", "(323) 249-7845"], ["College Bridge Academy", "None", "(323) 249-7845"], ["Bishop Independent Study", "None", "(760) 938-2001"], ["Wonderful College Prep Academy", "377.0", "(661) 454-3000"], ["Valley Oaks Charter", "502.0", "(661) 852-6700"], ["Cesar E. Chavez High", "439.0", "(661) 720-4501"], ["Robert F. Kennedy High", "449.0", "(661) 720-5117"], ["Golden Valley High", "424.0", "(661) 827-0800"], ["Frontier High", "475.0", "(661) 829-1107"], ["Independence High", "463.0", "(661) 834-8001"], ["Mira Monte High", "403.0", "(661) 366-1800"], ["Centennial High", "489.0", "(661) 588-8601"], ["Ridgeview High", "421.0", "(661) 398-3100"], ["Kern Workforce 2000 Academy", "None", "(661) 827-3158"], ["Liberty High", "501.0", "(661) 587-0925"], ["Insight School of California", "None", "(805) 581-0202"], ["California City High", "424.0", "(760) 373-5263"], ["Abraham Lincoln Alternative", "None", "(661) 256-5090"], ["Frazier Mountain High", "443.0", "(661) 248-0310"], ["Crossroads Charter", "None", "(559) 583-5060"], ["California Virtual Academy @ Kings", "None", "(805) 581-0202"], ["National University Academy, Armona", "None", "None"], ["Sierra Pacific High", "464.0", "(559) 583-5912"], ["Hanford West High", "450.0", "(559) 583-5903"], ["Lemoore Middle College High", "464.0", "(559) 925-3552"], ["New Day Academy", "None", "(530) 233-3861"], ["Westwood Charter", "None", "(530) 256-2994"], ["Mt. Lassen Charter", "None", "(530) 827-2129"], ["Los Angeles International Charter High", "428.0", "(323) 257-1499"], ["Optimist Charter", "None", "(323) 443-3100"], ["International Polytechnic High", "495.0", "(909) 839-2320"], ["Soledad Enrichment Action Charter High", "335.0", "(213) 480-4200"], ["William J. (Pete) Knight High", "442.0", "(661) 533-9000"], ["Eastside High", "409.0", "(661) 946-3800"], ["SOAR High (Students On Academic Rise)", "496.0", "(661) 722-6300"], ["Los Angeles County Online High", "None", "(800) 985-0770"], ["Academies of the Antelope Valley", "None", "(661) 948-7655"], ["Lancaster High", "449.0", "(661) 726-7649"], ["Desert Sands Charter", "None", "(661) 942-3357"], ["Opportunities For Learning - Baldwin Park II", "426.0", "(626) 962-3311"], ["Opportunities for Learning - Baldwin Park", "447.0", "(626) 814-0161"], ["Options for Youth-Burbank Charter", "464.0", "(818) 566-7525"], ["Centinela Valley Independent Study", "None", "(310) 263-4469"], ["Family First Charter", "None", "(310) 355-0001"], ["New Opportunities Charter", "None", "(310) 355-0001"], ["Lawndale High", "423.0", "(310) 263-3102"], ["Opportunities for Learning - Duarte", "None", "(626) 921-8200"], ["South El Monte High", "427.0", "(626) 442-0218"], ["Anderson W. Clark Magnet High", "539.0", "(818) 248-8324"], ["Gorman Learning Center", "473.0", "(909) 307-6312"], ["Hawthorne Math and Science Academy", "492.0", "(310) 973-8184"], ["City Honors College Preparatory Academy", "442.0", "(310) 680-4880"], ["Animo Inglewood Charter High", "448.0", "(310) 673-0956"], ["Environmental Charter High", "446.0", "(310) 214-3400"], ["Lennox Mathematics, Science and Technology Academy", "418.0", "(310) 680-5600"], ["Animo Leadership High", "416.0", "(310) 216-3277"], ["Beach High-Intensive Learning Program", "None", "(562) 595-8893"], ["Cabrillo High", "388.0", "(562) 951-7700"], ["Renaissance High School for the Arts", "483.0", "(562) 901-0168"], ["High Tech LA", "508.0", "(818) 609-2640"], ["Wallis Annenberg High", "416.0", "(323) 235-6343"], ["North Valley Military Institute College Preparatory Academy", "None", "(818) 368-1557"], ["Central City Value", "404.0", "(213) 471-4686"], ["View Park Preparatory Accelerated High", "382.0", "(323) 290-6975"], ["Crenshaw Arts-Technology Charter High", "381.0", "(323) 293-3917"], ["Oscar De La Hoya Animo Charter High", "398.0", "(323) 780-1259"], ["Renaissance Arts Academy", "506.0", "(323) 259-5700"], ["Animo South Los Angeles Charter", "376.0", "(323) 779-0544"], ["New Designs Charter", "411.0", "(213) 765-9084"], ["Middle College High", "435.0", "(323) 418-4700"], ["Harbor Teacher Preparation Academy", "509.0", "(310) 834-3932"], ["Ivy Academia", "431.0", "(818) 716-0771"], ["Camino Nuevo Charter High", "413.0", "(213) 240-8700"], ["Animo Venice Charter High", "414.0", "(310) 392-8751"], ["Animo Pat Brown", "377.0", "(323) 585-3312"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex", "436.0", "(213) 745-8141"], ["Orthopaedic Hospital", "444.0", "(213) 765-2088"], ["Northridge Academy High", "464.0", "(818) 700-2222"], ["International Studies Learning Center at Legacy High School Complex", "457.0", "(323) 357-7521"], ["Port of Los Angeles High", "487.0", "(310) 832-9201"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing", "497.0", "(818) 994-7614"], ["Alliance Judy Ivie Burton Technology Academy High", "408.0", "(323) 920-6125"], ["Alliance Collins Family College-Ready High", "390.0", "(323) 923-1588"], ["Pacific Boulevard", "None", "(323) 586-8640"], ["Santee Education Complex", "382.0", "(213) 763-1000"], ["South East High", "439.0", "(323) 568-3400"], ["Maywood Academy High", "420.0", "(323) 838-6000"], ["PUC CA Academy for Liberal Studies Early College High", "437.0", "None"], ["Los Angeles Academy of Arts & Enterprise Charter", "388.0", "(213) 487-0600"], ["Frida Kahlo High", "None", "(213) 763-1090"], ["New Village Girls Academy", "374.0", "(213) 385-4015"], ["Alliance Patti And Peter Neuwirth Leadership Academy", "386.0", "(213) 342-2874"], ["Alliance Dr. Olga Mohan High", "407.0", "(213) 342-2870"], ["Animo Ralph Bunche Charter High", "387.0", "(323) 232-9436"], ["Animo Jackie Robinson High", "377.0", "(323) 846-5800"], ["Animo Watts College Preparatory Academy", "362.0", "(323) 756-3930"], ["Alliance Ouchi-O'Donovan 6-12 Complex", "397.0", "(323) 596-2290"], ["Alliance Marc & Eva Stern Math and Science", "439.0", "(323) 987-2144"], ["School of Business and Tourism at Contreras Learning Complex", "403.0", "(213) 240-3800"], ["East Valley Senior High", "415.0", "(818) 753-4400"], ["Arleta High", "397.0", "(818) 686-4100"], ["Panorama High", "411.0", "(818) 909-4500"], ["Bright Star Secondary Charter Academy", "435.0", "(424) 789-8337"], ["Frederick Douglass Academy High", "378.0", "None"], ["Student Empowerment Academy", "372.0", "None"], ["Contreras Learning Center-Los Angeles School of Global Studies", "378.0", "(213) 240-3850"], ["West Adams Preparatory High", "385.0", "(323) 373-2500"], ["Magnolia Science Academy 3", "418.0", "(310) 637-3806"], ["Magnolia Science Academy 2", "427.0", "(818) 758-0300"], ["Discovery Charter Preparatory School #2", "373.0", "(818) 897-1187"], ["Alliance Morgan McKinzie High", "375.0", "(323) 859-0750"], ["Edward R. Roybal Learning Center", "408.0", "(213) 580-6400"], ["Helen Bernstein High", "391.0", "(323) 817-6460"], ["APEX Academy", "368.0", "(323) 817-6550"], ["Alliance Piera Barabaglia Shaheen Health Services Academy", "393.0", "(323) 972-9010"], ["Alliance Leichtman-Levine Family Foundation Environmental Science High", "444.0", "(323) 739-0560"], ["Magnolia Science Academy 4", "405.0", "(310) 473-2464"], ["Contreras Learning Center-Academic Leadership Community", "390.0", "(213) 240-3815"], ["Los Angeles High School of the Arts", "409.0", "(213) 480-4600"], ["Los Angeles Teacher Preparatory Academy", "339.0", "None"], ["School for the Visual Arts and Humanities", "394.0", "(213) 480-4700"], ["New Millennium Secondary", "388.0", "(310) 999-6162"], ["Alain Leroy Locke College Preparatory Academy", "364.0", "(323) 420-2100"], ["Sun Valley High", "385.0", "(818) 394-4600"], ["New Open World Academy K-12", "402.0", "(213) 480-3700"], ["UCLA Community K-12", "392.0", "(213) 480-3750"], ["Ramon C. Cortines School of Visual and Performing Arts", "446.0", "(213) 217-8600"], ["Felicitas and Gonzalo Mendez High", "382.0", "(323) 981-6100"], ["New Designs Charter School-Watts", "371.0", "(323) 418-0600"], ["Daniel Pearl Journalism & Communications Magnet", "470.0", "(818) 654-3775"], ["Ambassador-Global Leadership", "412.0", "(213) 480-4540"], ["Alliance Cindy and Bill Simon Technology Academy High", "364.0", "(323) 744-2122"], ["Alliance Tennenbaum Family Technology High", "385.0", "(323) 276-5545"], ["Environmental and Social Policy Magnet", "390.0", "(323) 441-4577"], ["Math, Science, & Technology Magnet Academy at Roosevelt High", "447.0", "(323) 780-6500"], ["Esteban Torres East LA Performing Arts Magnet", "378.0", "(323) 265-6725"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4", "386.0", "(323) 265-6830"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5", "371.0", "(323) 265-6865"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2", "388.0", "(323) 265-6760"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3", "395.0", "(323) 285-6795"], ["PUC Triumph Charter High", "None", "None"], ["PUC Lakeview Charter High", "390.0", "(818) 356-2591"], ["Aspire Pacific Academy", "394.0", "(323) 589-2800"], ["Los Angeles Big Picture High", "None", "None"], ["Alliance Ted K. Tajima High", "378.0", "(213) 241-8533"], ["Valley Academy of Arts and Sciences", "440.0", "(818) 832-7750"], ["Cesar E. Chavez Learning Academy - Arts/Theatre/Entertain Mag", "369.0", "(818) 837-6428"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy", "401.0", "(818) 838-3915"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)", "413.0", "(818) 838-3926"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy", "401.0", "(818) 838-3946"], ["Los Angeles River at Sonia Sotomayor Learning Academies", "383.0", "(323) 276-5535"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies", "430.0", "(323) 276-5500"], ["Dr. Maya Angelou Community High", "363.0", "(323) 846-4700"], ["Public Service Community at Diego Rivera Learning Complex", "406.0", "(323) 846-2128"], ["Communication and Technology at Diego Rivera Learning Complex", "373.0", "(323) 846-2118"], ["Green Design at Diego Rivera Learning Complex", "375.0", "(323) 846-2108"], ["Performing Arts Community at Diego Rivera Learning Complex", "372.0", "(323) 846-2136"], ["Rancho Dominguez Preparatory", "420.0", "(310) 354-3400"], ["Synergy Quantum Academy", "419.0", "(323) 846-4716"], ["Animo College Preparatory Academy", "359.0", "(323) 568-4136"], ["Alliance Renee and Meyer Luskin Academy High", "364.0", "(323) 905-1210"], ["PUC Early College Academy for Leaders and Scholars (ECALS)", "401.0", "(323) 276-5525"], ["Alliance Margaret M. Bloomfield Technology Academy High", "None", "(323) 537-2060"], ["Leadership in Entertainment and Media Arts (LEMA)", "354.0", "None"], ["STEM Academy at Bernstein High", "399.0", "(323) 817-6461"], ["Academy of Science and Engineering", "None", "(323) 545-1100"], ["Augustus F. Hawkins High A Critical Design and Gaming", "354.0", "(323) 789-1282"], ["Augustus F. Hawkins High B Community Health Advocates", "366.0", "(323) 789-1282"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship", "346.0", "(323) 789-1282"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "431.0", "(323) 568-3800"], ["Linda Esperanza Marquez High B LIBRA Academy", "410.0", "(323) 584-3800"], ["Linda Esperanza Marquez High C School of Social Justice", "423.0", "(323) 584-3800"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex", "383.0", "(323) 357-7545"], ["Visual and Performing Arts at Legacy High School Complex", "386.0", "(323) 357-7500"], ["Academy for Multilingual Arts and Science at Mervyn M. Dymally High", "377.0", "(323) 565-4600"], ["Academies of Education and Empowerment at Carson High", "403.0", "(310) 847-1455"], ["Academy of Medical Arts at Carson High", "417.0", "(310) 847-1465"], ["Humanities and Arts (HARTS) Academy of Los Angeles", "425.0", "(310) 257-7100"], ["Contreras Learning Center-School of Social Justice", "383.0", "(213) 240-3800"], ["Early College Academy-LA Trade Tech College", "None", "(323) 763-3685"], ["Camino Nuevo High #2", "None", "(213) 736-5566"], ["Youth Opportunities Unlimited", "None", "(323) 789-4731"], ["Palisades Charter High", "525.0", "(310) 230-6623"], ["City of Angels", "501.0", "(323) 415-8350"], ["Los Angeles Leadership Academy", "425.0", "(323) 227-7719"], ["PUC Community Charter Middle and PUC Community Charter Early College High", "None", "(818) 485-0933"], ["Magnolia Science Academy", "470.0", "(818) 609-0507"], ["Marco Antonio Firebaugh High", "412.0", "(310) 886-5200"], ["Pathway Independent Study", "None", "(310) 603-1516"], ["Mountain Park", "468.0", "(626) 471-3014"], ["Applied Technology Center", "420.0", "(323) 248-2500"], ["Antelope Valley Learning Academy", "None", "(661) 952-6028"], ["Palmdale Aerospace Academy", "None", "(661) 273-3680"], ["Guidance Charter", "407.0", "(661) 285-1600"], ["Palos Verdes High", "564.0", "(310) 378-8471"], ["Paramount Alternative Education Center", "None", "None"], ["Aveson Global Leadership Academy", "None", "(626) 797-1438"], ["CIS Academy", "None", "(626) 396-5883"], ["Learning Works", "None", "(626) 564-2871"], ["School of Extended Educational Options", "None", "(909) 397-4900"], ["Diamond Ranch High", "472.0", "(909) 397-4715"], ["Village Academy High School at Indian Hill", "442.0", "(909) 397-4900"], ["Malibu High", "553.0", "(310) 457-6801"], ["California Virtual Academy @ Los Angeles", "521.0", "(805) 581-0202"], ["Edgewood High", "493.0", "(626) 939-0600"], ["Insight @ Los Angeles", "425.0", "None"], ["Golden Valley High", "500.0", "(661) 298-8140"], ["West Ranch High", "539.0", "(661) 222-1220"], ["Mission View Public", "None", "(661) 200-5595"], ["Santa Clarita Valley International", "443.0", "(661) 705-4820"], ["Albert Einstein Academy for Letters, Arts and Sciences", "None", "(661) 702-0755"], ["Valencia High", "528.0", "(661) 294-1188"], ["Opportunities for Learning - Santa Clarita", "489.0", "(661) 424-1337"], ["Academy of the Canyons", "596.0", "(661) 362-3056"], ["Thurgood Marshall", "None", "(310) 898-6340"], ["iQ Academy California-Los Angeles", "None", "(888) 997-4722"], ["Gabrielino High", "518.0", "(626) 573-2415"], ["Options for Youth San Gabriel", "455.0", "(626) 921-8200"], ["Del Mar High", "None", "(626) 291-5723"], ["Assurance Learning Academy", "None", "(661) 272-1225"], ["Inspire Charter School", "None", "(661) 269-2214"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "None", "(855) 937-4227"], ["SIATech Academy South", "None", "(760) 945-1227"], ["Vasquez High", "500.0", "(661) 269-0451"], ["Redondo Shores High (Continuation)", "None", "(310) 798-8690"], ["School of Arts and Enterprise", "473.0", "(909) 622-0699"], ["Lifeline Education Charter", "359.0", "(310) 605-2510"], ["Da Vinci Science", "467.0", "(310) 725-5800"], ["Da Vinci Design", "459.0", "(310) 725-5800"], ["Anahuacalmecac International University Preparatory of North America", "None", "None"], ["Madera County Independent Academy", "None", "(559) 662-4636"], ["Pioneer Technical Center", "None", "(559) 662-6294"], ["Madera South High", "414.0", "(559) 675-4450"], ["Sherman Thomas Charter High", "None", "(559) 675-6626"], ["Liberty High", "472.0", "(559) 645-3500"], ["Minarets High", "472.0", "(559) 868-8689"], ["Minarets Charter High", "463.0", "(559) 868-8659"], ["Chawanakee Academy", "None", "None"], ["Glacier High School Charter", "None", "(559) 642-1422"], ["San Andreas High (Continuation)", "None", "(415) 945-3751"], ["Ukiah Independent Study Academy", "None", "(707) 472-5062"], ["Redwood Academy of Ukiah", "540.0", "(707) 467-0500"], ["Accelerated Achievement Academy", "None", "(707) 463-7080"], ["New Horizons", "None", "(707) 459-4801"], ["Willits Charter", "None", "(707) 459-5506"], ["Merced Scholars Charter", "None", "(209) 381-5165"], ["Crossroads Alternative Education Center", "None", "(209) 826-4013"], ["Pacheco High", "441.0", "(209) 826-3801"], ["Golden Valley High", "436.0", "(209) 325-1800"], ["Buhach Colony High", "438.0", "(209) 325-1400"], ["Shattuck Independent Study", "None", "(209) 656-2012"], ["Delhi High", "419.0", "(209) 656-2050"], ["Urban Corps of San Diego County Charter", "None", "(619) 235-6884"], ["Orange County Conservation Corps Charter", "None", "(714) 956-6222"], ["Monterey County Home Charter", "None", "(831) 755-0331"], ["Greenfield High", "427.0", "(831) 674-2751"], ["Marina High", "454.0", "(831) 583-2060"], ["Learning for Life Charter", "None", "(831) 582-9820"], ["El Puente", "None", "(831) 796-7700"], ["Everett Alvarez High", "446.0", "(831) 796-7800"], ["Soledad High", "428.0", "(831) 678-6400"], ["Gonzales High", "425.0", "(831) 675-2495"], ["Napa Valley Independent Studies", "None", "(707) 259-8577"], ["American Canyon High", "470.0", "(707) 265-2710"], ["New Technology High", "500.0", "(707) 259-8557"], ["Bitney College Preparatory High", "482.0", "(530) 477-1235"], ["Forest Charter", "508.0", "(530) 265-4823"], ["EPIC de Cesar Chavez", "None", "(661) 822-4381"], ["John Muir Charter Schools", "None", "(530) 272-4008"], ["William & Marian Ghidotti High", "576.0", "(530) 274-5270"], ["Vantage Point Charter", "None", "(530) 432-5312"], ["OCCS:CHEP/PCHS", "528.0", "(714) 327-1000"], ["Oxford Academy", "634.0", "(714) 220-3055"], ["Capistrano Connections Academy", "512.0", "(949) 461-1667"], ["San Juan Hills High", "534.0", "(949) 234-5900"], ["California Preparatory Academy", "None", "(949) 234-5317"], ["Aliso Niguel High", "548.0", "(949) 831-5590"], ["Tesoro High", "545.0", "(949) 234-5310"], ["Opportunities for Learning - Capistrano", "None", "(949) 248-1282"], ["Early College High", "478.0", "(714) 241-6108"], ["OUSD Home Sch", "None", "(714) 628-5479"], ["Yorba Linda High", "543.0", "(714) 986-7500"], ["Parkview", "None", "(714) 986-7050"], ["Nova Academy", "448.0", "(714) 569-0948"], ["Segerstrom High", "463.0", "(714) 241-5000"], ["Hector G. Godinez", "433.0", "(714) 433-6790"], ["Cesar E. Chavez High", "None", "(714) 430-5700"], ["Middle College High", "483.0", "(714) 953-3900"], ["OCSA", "582.0", "(714) 560-9000"], ["Arnold O. Beckman High", "572.0", "(714) 734-2900"], ["Northwood High", "621.0", "(949) 936-7200"], ["CORE Placer Charter", "None", "(530) 346-8340"], ["John Adams Academy", "576.0", "(916) 780-6800"], ["Foresthill High", "490.0", "(530) 367-5244"], ["Antelope High", "469.0", "(916) 726-1400"], ["Woodcreek High", "501.0", "(916) 771-6565"], ["Granite Bay High", "551.0", "(916) 786-8676"], ["Cold Stream Alternative", "None", "(530) 582-2640"], ["Partnerships for Student-Centered Learning", "None", "(916) 408-5200"], ["Horizon Charter", "456.0", "(916) 408-5200"], ["Whitney High", "502.0", "(916) 632-6500"], ["Western Sierra Collegiate Academy", "547.0", "(916) 778-4544"], ["Rocklin Independent Charter Academy", "None", "(916) 632-3195"], ["Rocklin High", "527.0", "(916) 632-1600"], ["Victory High", "None", "(916) 632-3195"], ["Plumas Charter", "None", "(530) 283-3851"], ["River Springs Charter", "478.0", "(951) 252-8800"], ["Riverside County Education Academy", "None", "(951) 826-6602"], ["Come Back Kids", "None", "(951) 826-6461"], ["Gateway College and Career Academy", "None", "(951) 222-8931"], ["Alvord Alternative Continuation High", "None", "(951) 509-6021"], ["Banning Independent Study", "None", "(951) 922-0268"], ["21st Century Learning Institute", "None", "(951) 769-8424"], ["Eleanor Roosevelt High", "486.0", "(951) 738-2100"], ["John F. Kennedy High", "497.0", "(951) 738-2200"], ["Corona-Norco Alternative", "None", "(951) 736-3367"], ["Lee V. Pollard High", "None", "(951) 736-3367"], ["Santiago High", "499.0", "(951) 739-5600"], ["Shadow Hills High", "434.0", "(760) 393-5400"], ["La Quinta High", "462.0", "(760) 772-4150"], ["Horizon", "None", "(760) 238-9720"], ["Hamilton High", "481.0", "(951) 763-1865"], ["Tahquitz High", "445.0", "(951) 765-6300"], ["College Prep High", "463.0", "(951) 925-5155"], ["Patriot High", "463.0", "(951) 361-6500"], ["Rivercrest Preparatory", "None", "(951) 360-2660"], ["Santa Rosa Academy", "503.0", "(951) 672-2400"], ["Moreno Valley Online Academy", "None", "(951) 571-4800"], ["Vista del Lago High", "424.0", "(951) 571-4880"], ["Nuview Bridge Early College High", "471.0", "(951) 928-8498"], ["Desert Hot Springs High", "429.0", "(760) 288-7000"], ["California Military Institute", "423.0", "(951) 443-2731"], ["Heritage High", "444.0", "(951) 940-5447"], ["Paloma Valley High", "450.0", "(951) 672-6030"], ["Riverside Virtual", "None", "(951) 276-2006"], ["Martin Luther King Jr. High", "494.0", "(951) 789-5690"], ["Mountain Heights Academy", "None", "(951) 487-7710"], ["San Jacinto Valley Academy", "466.0", "(951) 654-6113"], ["Desert Mirage High", "414.0", "(760) 397-2255"], ["NOVA Academy - Coachella", "403.0", "(714) 569-0948"], ["Lakeside High", "454.0", "(951) 253-7300"], ["Keith McCarthy Academy", "None", "(951) 253-7777"], ["Southern California Online Academy", "None", "None"], ["Great Oak High", "505.0", "(951) 294-6450"], ["Susan H. Nelson", "None", "(951) 695-7360"], ["Chaparral High", "491.0", "(951) 695-4200"], ["Temecula Preparatory", "539.0", "(951) 926-6776"], ["Vista Murrieta High", "491.0", "(951) 894-5750"], ["Murrieta Canyon Academy", "None", "(951) 696-1661"], ["Murrieta Mesa High", "478.0", "(951) 677-0568"], ["Citrus Hill High", "405.0", "(951) 490-0400"], ["Val Verde Academy", "None", "(951) 443-2450"], ["Monterey Trail High", "444.0", "(916) 688-0050"], ["Pleasant Grove High", "513.0", "(916) 686-0230"], ["Cosumnes Oaks High", "491.0", "(916) 683-7670"], ["Laguna Creek High", "483.0", "(916) 683-1339"], ["Sheldon High", "472.0", "(916) 681-7500"], ["Franklin High", "512.0", "(916) 714-8150"], ["Elk Grove Charter", "None", "(916) 714-1653"], ["Vista del Lago High", "552.0", "(916) 294-2410"], ["Liberty Ranch High", "496.0", "(209) 744-4250"], ["New Technology High", "432.0", "(916) 395-5254"], ["George Washington Carver School of Arts and Science", "526.0", "(916) 395-5266"], ["The MET", "468.0", "(916) 395-5417"], ["Rosemont High", "452.0", "(916) 395-5130"], ["Sacramento Charter High", "403.0", "(916) 277-6200"], ["Arthur A. Benjamin Health Professions High", "449.0", "(916) 395-5010"], ["School of Engineering & Sciences", "420.0", "(916) 395-5040"], ["Capital City Independent Study", "None", "(916) 433-5187"], ["West Campus", "500.0", "(916) 277-6400"], ["Aspire Alexander Twilight Secondary Academy", "403.0", "(916) 979-1788"], ["Options for Youth-San Juan", "431.0", "(916) 485-5155"], ["Visions In Education", "533.0", "(916) 971-7037"], ["San Juan Choices Charter", "None", "(916) 979-8378"], ["Global Youth Charter", "None", "(916) 339-4680"], ["Antelope View Charter", "None", "None"], ["Inderkum High", "449.0", "(916) 567-5640"], ["Natomas Pacific Pathways Prep", "477.0", "(916) 567-5740"], ["Natomas High", "454.0", "(916) 641-4960"], ["Natomas Charter", "524.0", "(916) 928-5353"], ["Futures High", "489.0", "(916) 286-1902"], ["Heritage Peak Charter", "458.0", "(866) 992-9033"], ["Creative Connections Arts Academy", "None", "(916) 566-1870"], ["Community Collaborative Charter", "None", "(916) 286-5161"], ["SAVA: Sacramento Academic and Vocational Academy", "None", "(916) 387-8063"], ["Highlands Community Charter", "None", "(916) 844-2283"], ["Elwood J. Keema High", "None", "(916) 566-3410"], ["Vista Nueva Career and Technology High", "None", "(916) 566-2750"], ["Anzar High", "479.0", "(831) 623-7660"], ["Alta Vista Public", "None", "(760) 947-0006"], ["Chaffey District Online High", "None", "(909) 985-0966"], ["Rancho Cucamonga High", "489.0", "(909) 989-1600"], ["Los Osos High", "511.0", "(909) 477-6900"], ["Colony High", "450.0", "(909) 930-2929"], ["Chino Hills High", "508.0", "(909) 606-7540"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "441.0", "(909) 580-5006"], ["Summit High", "425.0", "(909) 357-5950"], ["Jurupa Hills High", "424.0", "(909) 357-6300"], ["Henry J. Kaiser High", "417.0", "(909) 357-5900"], ["Academy of Careers and Exploration", "462.0", "(760) 952-1266"], ["Empire Springs Charter", "None", "(951) 252-8800"], ["Independence Charter Academy", "None", "(760) 952-1760"], ["Alta Vista South Public Charter", "None", "(661) 272-1225"], ["Hope Academy Charter", "None", "None"], ["Mojave River Academy", "None", "(760) 245-3222"], ["Riverside Preparatory", "447.0", "(760) 243-5884"], ["Citrus Valley High", "473.0", "(909) 799-2300"], ["Redlands eAcademy", "None", "(909) 748-6941"], ["Redlands East Valley High", "498.0", "(909) 389-2500"], ["Grove", "535.0", "(909) 798-7831"], ["Wilmer Amina Carter High", "436.0", "(909) 854-4100"], ["Rialto High", "421.0", "(909) 421-7500"], ["ASA Charter", "None", "(909) 475-3322"], ["Public Safety Academy", "None", "(909) 382-2211"], ["Options for Youth-San Bernardino", "457.0", "(626) 685-9300"], ["Indian Springs High", "400.0", "(909) 383-1360"], ["Provisional Accelerated Learning Academy", "None", "(909) 887-7002"], ["Arroyo Valley High", "406.0", "(909) 381-4295"], ["Middle College High", "469.0", "(909) 888-4041"], ["University Preparatory", "500.0", "(760) 243-5940"], ["Adelanto High", "421.0", "(760) 246-3909"], ["Options for Youth-Victorville Charter", "419.0", "(626) 685-9300"], ["Excelsior Charter", "473.0", "(760) 245-4262"], ["Silverado High", "422.0", "(760) 955-3353"], ["Silver Valley Academy", "None", "(760) 254-2715"], ["Summit Leadership Academy-High Desert", "370.0", "(760) 949-9202"], ["Mirus Secondary", "None", "(760) 244-3764"], ["Encore Jr./Sr. High School for the Performing and Visual Arts", "486.0", "(760) 956-2632"], ["Oak Hills High", "450.0", "(760) 244-2283"], ["Sultana High", "448.0", "(760) 947-6777"], ["Shadow Ridge", "None", "(760) 949-8267"], ["Sky Mountain Charter", "None", "(530) 295-3566"], ["Granite Hills High", "479.0", "(760) 961-2290"], ["High Desert Premier Academy", "None", "(760) 240-4252"], ["Academy for Academic Excellence", "505.0", "(760) 946-5414"], ["San Pasqual Academy", "363.0", "(760) 233-6003"], ["Monarch", "None", "(619) 652-4100"], ["Literacy First Charter", "None", "(619) 579-7232"], ["Juan Bautista de Anza", "None", "(760) 767-5850"], ["Diego Springs Academy", "None", "(661) 272-1225"], ["Coronado Pathways Charter", "None", "None"], ["Diego Hills Charter", "None", "(619) 286-0312"], ["Dehesa Charter", "529.0", "(760) 743-7880"], ["Classical Academy High", "548.0", "(760) 480-9845"], ["Escondido Charter High", "513.0", "(760) 737-3154"], ["Oasis High (Alternative)", "None", "(760) 723-6395"], ["Steele Canyon High", "492.0", "(619) 660-3550"], ["Grossmont Middle College High", "525.0", "(619) 644-7524"], ["Helix High", "464.0", "(619) 466-4194"], ["Greater San Diego Academy", "None", "(619) 669-3050"], ["Diego Valley Charter", "None", "(619) 286-0312"], ["Julian Charter", "517.0", "(760) 765-3847"], ["National University Academy", "None", "(760) 631-5842"], ["River Valley Charter", "555.0", "(619) 390-2579"], ["San Diego Virtual", "None", "(619) 713-7271"], ["Pivot Charter School - San Diego", "None", "(760) 591-0217"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "None", "None"], ["Academy of Arts and Sciences", "None", "(855) 937-4227"], ["Del Norte High", "565.0", "(858) 487-0877"], ["Westview High", "581.0", "(858) 780-2000"], ["Future Bound Independent Study Secondary", "None", "(760) 787-2068"], ["Mountain Valley Academy", "None", "(760) 787-3600"], ["High Tech High International", "477.0", "(619) 243-5014"], ["Learning Choice Academy", "None", "(619) 463-6849"], ["San Diego International Studies", "523.0", "(619) 525-7464"], ["San Diego Business/Leadership", "402.0", "(619) 525-7461"], ["San Diego MVP Arts", "405.0", "None"], ["Kearny Digital Media & Design", "482.0", "(858) 496-8370"], ["Kearny SCT", "452.0", "(858) 496-8370"], ["Kearny College Connections", "450.0", "(858) 496-8370"], ["Kearny Eng, Innov & Design", "426.0", "(858) 496-8370"], ["Crawford High", "380.0", "(619) 362-3700"], ["San Diego Science and Technology", "423.0", "(619) 525-7459"], ["San Diego Metro Career and Tech", "489.0", "(619) 388-2299"], ["High Tech High Media Arts", "457.0", "(619) 398-8632"], ["Lincoln High", "389.0", "(619) 266-6500"], ["Health Sciences High", "422.0", "(619) 528-9070"], ["Arroyo Paseo Charter High", "None", "(619) 677-3017"], ["East Village High", "483.0", "(619) 525-2000"], ["King-Chavez Community High", "369.0", "(619) 704-1020"], ["Gompers Preparatory Academy", "363.0", "(619) 263-2171"], ["iHigh Virtual Academy", "None", "(619) 764-5440"], ["School for Entrepreneurship and Technology", "453.0", "(858) 874-4338"], ["Home & Hosp/Transition Support", "None", "(619) 344-6435"], ["Laurel Preparatory Academy", "None", "(858) 678-4812"], ["Scripps Ranch High", "564.0", "(858) 621-9020"], ["Charter School of San Diego", "479.0", "(858) 678-2020"], ["Preuss School UCSD", "520.0", "(858) 822-3000"], ["High Tech High", "477.0", "(619) 243-5014"], ["Audeo Charter", "483.0", "(858) 678-2050"], ["Canyon Crest Academy", "611.0", "(858) 350-0253"], ["La Costa Canyon High", "542.0", "(760) 436-6136"], ["Insight @ San Diego", "None", "(805) 581-0202"], ["California Virtual Academy @ San Diego", "517.0", "(805) 581-0202"], ["Olympian High", "476.0", "(619) 656-2400"], ["Eastlake High", "498.0", "(619) 397-3800"], ["Options Secondary", "None", "(619) 796-7320"], ["MAAC Community Charter", "None", "(619) 476-0749"], ["Alta Vista Academy", "None", "(619) 216-5160"], ["San Ysidro High", "431.0", "(619) 710-2300"], ["Otay Ranch Senior High", "474.0", "(619) 591-5000"], ["RAI Online Charter", "None", "None"], ["Taylion San Diego Academy", "None", "(760) 295-5564"], ["SIATech", "None", "(760) 945-1227"], ["North County Trade Tech High", "None", "(760) 598-0782"], ["Mission Vista High", "501.0", "(760) 758-6800"], ["Guajome Learning Center", "None", "(760) 631-8500"], ["Vista Visions Academy", "None", "(760) 724-4785"], ["Guajome Park Academy Charter", "531.0", "(760) 631-8500"], ["Carlsbad Seaside Academy", "None", "(760) 331-5299"], ["Pacific View Charter", "None", "(760) 757-0161"], ["Mission Hills High", "495.0", "(760) 290-2700"], ["Bayshore Preparatory Charter", "None", "(760) 471-0847"], ["Warner Junior/Senior High", "None", "(760) 782-3517"], ["Valley Center High", "474.0", "(760) 751-5502"], ["Valley Center Prep", "None", "(760) 751-0455"], ["High Tech High Chula Vista", "471.0", "(619) 243-5014"], ["High Tech High North County", "511.0", "(619) 243-5014"], ["Five Keys Charter (SF Sheriff's)", "None", "(415) 734-3310"], ["Jordan (June) School for Equity", "None", "(415) 452-4922"], ["City Arts and Tech High", "395.0", "(415) 841-2200"], ["Five Keys Adult School (SF Sheriff's)", "None", "(415) 734-3310"], ["Five Keys Independence HS (SF Sheriff's)", "None", "(415) 734-3310"], ["S.F. International High", "318.0", "(415) 695-5781"], ["Academy (The)- SF @McAteer", "456.0", "(415) 695-5700"], ["Gateway to College", "None", "(415) 452-5768"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "553.0", "(415) 695-5700"], ["Marshall (Thurgood) High", "364.0", "(415) 695-5612"], ["Leadership High", "408.0", "(415) 841-8910"], ["Gateway High", "483.0", "(415) 749-3600"], ["San Francisco Flex Academy", "502.0", "None"], ["one.Charter", "None", "(209) 468-9079"], ["San Joaquin Building Futures Academy", "None", "(209) 468-8140"], ["Venture Academy", "458.0", "(209) 468-5940"], ["Aspire Benjamin Holt College Preparatory Academy", "503.0", "(209) 955-1477"], ["Ronald E. McNair High", "436.0", "(209) 953-9245"], ["Rio Valley Charter", "None", "(209) 368-4934"], ["Independence", "None", "(209) 331-8275"], ["Middle College High", "565.0", "(209) 954-5790"], ["Weston Ranch High", "454.0", "(209) 938-6245"], ["New Vision High", "None", "(209) 938-6225"], ["Lathrop High", "432.0", "(209) 938-6350"], ["be.tech", "None", "(209) 858-7460"], ["Sierra High", "463.0", "(209) 858-7410"], ["Humphreys College Academy of Business, Law and Education", "424.0", "(209) 478-1600"], ["California Virtual Academy @ San Joaquin", "None", "(805) 581-0202"], ["Renew Virtual Academy K12 #1", "None", "None"], ["Delta Home Charter", "None", "(209) 830-6363"], ["Valley View Charter Prep", "None", "(916) 866-9033"], ["Delta Charter Online", "None", "(209) 830-6363"], ["Delta Charter", "468.0", "(209) 830-6363"], ["California Connections Academy @ Ripon", "535.0", "(209) 253-1208"], ["Cesar Chavez High", "417.0", "(209) 933-7480"], ["Edward C. Merlo Institute of Environmental Studies", "370.0", "(209) 933-7190"], ["Aspire Langston Hughes Academy", "408.0", "(209) 943-2389"], ["Stockton Unified Early College Academy", "519.0", "(209) 933-7370"], ["Stockton High", "None", "(209) 933-7365"], ["Stockton Collegiate International Secondary", "475.0", "(209) 390-9861"], ["Health Careers Academy", "418.0", "(209) 933-7360"], ["Pacific Law Academy", "None", "(209) 933-7475"], ["Weber Institute", "420.0", "(209) 933-7330"], ["Millennium Charter", "480.0", "(209) 831-5240"], ["John C. Kimball High", "500.0", "(209) 832-6600"], ["Merrill F. West High", "479.0", "(209) 830-3370"], ["Grizzly ChalleNGe Charter", "None", "(805) 782-6882"], ["Nipomo High", "490.0", "(805) 474-3300"], ["Templeton Independent Study High", "None", "(805) 434-5805"], ["Independence High", "None", "(805) 769-1620"], ["California Virtual Academy @ San Mateo", "None", "(805) 581-0202"], ["Aspire East Palo Alto Charter", "None", "None"], ["Peninsula High", "None", "(650) 558-2499"], ["Summit Preparatory Charter High", "522.0", "(650) 556-1110"], ["Everest Public High", "538.0", "(650) 366-1050"], ["East Palo Alto Academy", "403.0", "(650) 893-8900"], ["Family Partnership Home Study Charter", "None", "(805) 348-3333"], ["Los Olivos Charter School", "None", "None"], ["Orcutt Academy Charter", "492.0", "(805) 938-8900"], ["Pioneer Valley High", "451.0", "(805) 922-1305"], ["Alta Vista Alternative High", "558.0", "(805) 965-1916"], ["Leadership Public Schools - San Jose", "381.0", "None"], ["University Preparatory Academy Charter", "537.0", "(408) 723-1839"], ["Magnolia Science Academy Santa Clara", "None", "None"], ["Silicon Valley Flex Academy", "None", "None"], ["Summit Public School: Tahoma", "483.0", "(408) 729-1981"], ["Branham High", "540.0", "(408) 626-3407"], ["Escuela Popular/Center for Training and Careers, Family Learning", "None", "(408) 275-7191"], ["KIPP San Jose Collegiate", "482.0", "(408) 937-3752"], ["Summit Public School: Rainier", "493.0", "(408) 831-3104"], ["Calero High", "None", "(408) 347-7600"], ["Apollo High", "None", "(408) 928-5400"], ["Latino College Preparatory Academy", "380.0", "(408) 729-2281"], ["San Jose Conservation Corps Charter", "None", "(408) 459-6404"], ["Evergreen Valley High", "565.0", "(408) 347-7000"], ["Escuela Popular Accelerated Family Learning", "None", "(408) 275-7190"], ["Dr. TJ Owens Gilroy Early College Academy", "552.0", "(408) 846-4909"], ["Christopher High", "484.0", "(408) 848-7171"], ["Ann Sobrato High", "515.0", "(408) 201-6200"], ["Liberty High (Alternative)", "None", "(408) 535-6327"], ["Downtown College Preparatory", "None", "(408) 271-8120"], ["Middle College High", "None", "(408) 298-2181"], ["Pacific Collegiate Charter", "630.0", "(831) 479-7785"], ["Cypress Charter High", "506.0", "(831) 477-0302"], ["Pajaro Valley High", "430.0", "(831) 728-8102"], ["Ceiba College Preparatory Academy", "None", "(831) 728-6208"], ["Pacific Coast Charter", "None", "(831) 761-6021"], ["Ocean Grove Charter", "554.0", "(530) 295-3566"], ["SLVUSD Charter", "None", "(831) 335-0932"], ["Delta Charter", "None", "(831) 477-5212"], ["Alternative Family Education", "None", "(831) 429-3898"], ["Scotts Valley High", "547.0", "(831) 439-9555"], ["Anderson New Technology High", "None", "(530) 365-3100"], ["Stellar Secondary Charter High", "None", "(530) 245-7730"], ["University Preparatory", "551.0", "(530) 245-2790"], ["Shasta Charter Academy", "None", "(530) 245-2600"], ["North State Independence High", "None", "(530) 245-2760"], ["Northern Summit Academy", "None", "(530) 949-0154"], ["Academy of Personalized Learning", "None", "(530) 222-9280"], ["Gateway Educational Options", "None", "(530) 245-7960"], ["Golden Eagle Charter", "None", "(530) 926-5800"], ["Matt Garcia Career and College Academy", "None", "(707) 424-9400"], ["Angelo Rodriguez High", "489.0", "(707) 863-7950"], ["Elise P. Buckingham Charter Magnet High", "533.0", "(707) 453-7300"], ["Jesse M. Bethel High", "447.0", "(707) 556-5700"], ["MIT Academy", "None", "(707) 552-6482"], ["Geyserville New Tech Academy", "None", "(707) 857-3592"], ["Pathways Charter", "None", "(707) 585-6510"], ["California Virtual Academy @ Sonoma", "None", "(805) 581-0202"], ["Pivot Online Charter - North Bay", "None", "(707) 843-4676"], ["Gateway to College Academy", "None", "(707) 778-4621"], ["Valley Oaks High (Alternative)", "None", "(707) 778-4794"], ["Northwest Prep Charter", "None", "(707) 522-3320"], ["Roseland Charter", "410.0", "(707) 545-0102"], ["Abraxis Charter", "None", "(707) 539-2897"], ["Elsie Allen High", "457.0", "(707) 528-5020"], ["Maria Carrillo High", "563.0", "(707) 528-5790"], ["Orchard View", "None", "(707) 823-4709"], ["Credo High", "None", "(707) 664-0600"], ["Academy of Arts and Sciences: Sonoma", "None", "(855) 937-4227"], ["Technology High", "567.0", "(707) 792-4825"], ["Windsor High", "516.0", "(707) 837-7767"], ["Stanislaus Alternative Charter", "None", "(209) 238-6801"], ["Valley Charter High", "489.0", "(209) 238-6800"], ["Whitmore Charter High", "542.0", "(209) 556-1617"], ["Central Valley High", "433.0", "(209) 556-1900"], ["Endeavor Alternative", "None", "(209) 556-1805"], ["Denair Charter Academy", "None", "(209) 634-0917"], ["Hart-Ransom Academic Charter", "None", "(209) 523-0401"], ["Keyes to Learning Charter", "None", "(209) 634-6467"], ["James C. Enochs High", "487.0", "(209) 550-3400"], ["Aspire Vanguard College Preparatory Academy", "None", "(209) 521-3010"], ["Joseph A. Gregori High", "465.0", "(209) 550-3421"], ["Peter Johansen High", "435.0", "(209) 576-4702"], ["Oakdale Charter", "None", "(209) 848-4361"], ["Valley Oak Junior and Senior High", "None", "(209) 847-3097"], ["Waterford High", "465.0", "(209) 874-9060"], ["Connecting Waters Charter", "504.0", "(209) 874-9463"], ["eCademy Charter at Crane", "None", "(209) 669-3410"], ["Fusion Charter", "None", "(209) 667-0327"], ["John H. Pitman High", "480.0", "(209) 656-1592"], ["South Sutter Charter", "465.0", "(530) 295-3566"], ["California Virtual Academy @ Sutter", "None", "(805) 581-0202"], ["River Valley High", "479.0", "(530) 822-2500"], ["Yuba City Charter", "None", "(530) 822-9667"], ["Tehama eLearning Academy", "None", "(530) 527-0188"], ["University Preparatory High", "498.0", "(559) 730-2529"], ["La Sierra High", "None", "(559) 733-6963"], ["Eleanor Roosevelt Community Learning Center", "None", "(559) 592-9160"], ["California Connections Academy@Central", "None", "(559) 713-1324"], ["Summit Charter Academy", "None", "(559) 782-5902"], ["Burton Horizon Academy", "None", "(559) 782-4748"], ["Loma Vista Charter", "None", "(559) 562-5111"], ["Crescent Valley Public Charter", "None", "(559) 970-5894"], ["Mission Oak High", "435.0", "(559) 688-2021"], ["Sierra Vista Charter High", "None", "(559) 687-7384"], ["Visalia Charter Independent Study", "442.0", "(559) 735-8055"], ["Visalia Technical Early College", "None", "(559) 622-3212"], ["El Diamante High", "475.0", "(559) 735-3501"], ["Farmersville High", "400.0", "(559) 594-4567"], ["Butterfield Charter High", "None", "(559) 782-7057"], ["Harmony Magnet Academy", "464.0", "(559) 568-0347"], ["Granite Hills High", "433.0", "(559) 782-7075"], ["Prospect Education Center", "None", "(559) 782-7095"], ["Ronald Reagan Academy", "None", "(559) 595-0563"], ["California Virtual Academy @ Jamestown", "None", "(805) 581-0202"], ["Gold Rush Charter", "None", "(209) 532-9781"], ["Connections Visual and Performing Arts Academy", "None", "(209) 928-4228"], ["Vista Real Charter High", "None", "(805) 486-5449"], ["River Oaks Academy", "None", "(805) 777-7999"], ["Golden Valley Charter", "None", "(805) 642-3435"], ["Academy of Arts and Sciences: Thousand Oaks & Simi Valley", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: Oxnard & Ventura", "None", "None"], ["Architecture, Construction & Engineering Charter High (ACE)", "None", "(805) 437-1410"], ["Condor High", "None", "(805) 385-2552"], ["Pacifica High", "454.0", "(805) 278-5000"], ["Santa Susana High", "556.0", "(805) 520-6800"], ["El Camino High", "537.0", "(805) 289-7955"], ["Foothill Technology High", "530.0", "(805) 289-0023"], ["Century Academy", "None", "(805) 496-0286"], ["Oak Park Independent", "488.0", "(818) 735-3260"], ["IvyTech Charter", "None", "(805) 222-5188"], ["The High School at Moorpark College", "519.0", "(805) 378-1444"], ["Da Vinci Charter Academy", "558.0", "(530) 757-7154"], ["West Sacramento Early College Prep Charter", "None", "(916) 375-7680"], ["Pioneer High", "455.0", "(530) 406-1148"], ["Yuba County Career Preparatory Charter", "None", "(530) 749-4000"], ["Camptonville Academy", "None", "(530) 742-2786"], ["Marysville Charter Academy for the Arts", "484.0", "(530) 749-6156"]], "spark_error": null, "total_time": 16.556926727294922, "spark_time": 0.18197107315063477, "translation_time": 16.374955654144287, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='fdfb9172-2c86-412e-bda3-6c6607a559a9'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='e6be0e89-68cb-41ce-af0e-a1c68488ae41'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}", "Observation: content='The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n```sql\\nSELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\\n```' name='query_checker_sql_db' tool_call_id='00571255-68a7-498b-86d4-680b3152d90a'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}"], "input_tokens": 3987, "output_tokens": 2564, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n```sql\nSELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\n```", "final_answer": "", "replica": 2, "timestamp": 1768937679.9849637}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": 0.0521004459047172, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, AVG(`ss`.`AvgScrWrite`) AS `AverageWritingScore`, `s`.`Phone` FROM `schools` AS `s` JOIN `satscores` AS `ss` ON `s`.`CDSCode` = `ss`.`cds` WHERE CAST(SUBSTRING(`s`.`OpenDate`, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(`s`.`ClosedDate`, 1, 4) AS INT) < 2000 GROUP BY `s`.`School`, `s`.`Phone` ORDER BY `AverageWritingScore` DESC", "execution_status": "VALID", "query_result": [["Oxford Academy", "634.0", "(714) 220-3055"], ["Pacific Collegiate Charter", "630.0", "(831) 479-7785"], ["Northwood High", "621.0", "(949) 936-7200"], ["Canyon Crest Academy", "611.0", "(858) 350-0253"], ["Academy of the Canyons", "596.0", "(661) 362-3056"], ["University High", "593.0", "(559) 278-8263"], ["OCSA", "582.0", "(714) 560-9000"], ["Westview High", "581.0", "(858) 780-2000"], ["Northcoast Preparatory and Performing Arts Academy", "579.0", "None"], ["William & Marian Ghidotti High", "576.0", "(530) 274-5270"], ["John Adams Academy", "576.0", "(916) 780-6800"], ["Arnold O. Beckman High", "572.0", "(714) 734-2900"], ["Technology High", "567.0", "(707) 792-4825"], ["Del Norte High", "565.0", "(858) 487-0877"], ["Middle College High", "565.0", "(209) 954-5790"], ["Evergreen Valley High", "565.0", "(408) 347-7000"], ["Palos Verdes High", "564.0", "(310) 378-8471"], ["Scripps Ranch High", "564.0", "(858) 621-9020"], ["Maria Carrillo High", "563.0", "(707) 528-5790"], ["Alta Vista Alternative High", "558.0", "(805) 965-1916"], ["Da Vinci Charter Academy", "558.0", "(530) 757-7154"], ["Santa Susana High", "556.0", "(805) 520-6800"], ["River Valley Charter", "555.0", "(619) 390-2579"], ["Ocean Grove Charter", "554.0", "(530) 295-3566"], ["Malibu High", "553.0", "(310) 457-6801"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "553.0", "(415) 695-5700"], ["Vista del Lago High", "552.0", "(916) 294-2410"], ["Dr. TJ Owens Gilroy Early College Academy", "552.0", "(408) 846-4909"], ["Granite Bay High", "551.0", "(916) 786-8676"], ["University Preparatory", "551.0", "(530) 245-2790"], ["Aliso Niguel High", "548.0", "(949) 831-5590"], ["Classical Academy High", "548.0", "(760) 480-9845"], ["Western Sierra Collegiate Academy", "547.0", "(916) 778-4544"], ["Scotts Valley High", "547.0", "(831) 439-9555"], ["Tesoro High", "545.0", "(949) 234-5310"], ["Yorba Linda High", "543.0", "(714) 986-7500"], ["La Costa Canyon High", "542.0", "(760) 436-6136"], ["Whitmore Charter High", "542.0", "(209) 556-1617"], ["Redwood Academy of Ukiah", "540.0", "(707) 467-0500"], ["Branham High", "540.0", "(408) 626-3407"], ["Anderson W. Clark Magnet High", "539.0", "(818) 248-8324"], ["West Ranch High", "539.0", "(661) 222-1220"], ["Temecula Preparatory", "539.0", "(951) 926-6776"], ["Everest Public High", "538.0", "(650) 366-1050"], ["El Camino High", "537.0", "(805) 289-7955"], ["University Preparatory Academy Charter", "537.0", "(408) 723-1839"], ["Grove", "535.0", "(909) 798-7831"], ["California Connections Academy @ Ripon", "535.0", "(209) 253-1208"], ["San Juan Hills High", "534.0", "(949) 234-5900"], ["Visions In Education", "533.0", "(916) 971-7037"], ["Elise P. Buckingham Charter Magnet High", "533.0", "(707) 453-7300"], ["Guajome Park Academy Charter", "531.0", "(760) 631-8500"], ["Foothill Technology High", "530.0", "(805) 289-0023"], ["Dehesa Charter", "529.0", "(760) 743-7880"], ["OCCS:CHEP/PCHS", "528.0", "(714) 327-1000"], ["Valencia High", "528.0", "(661) 294-1188"], ["Rocklin High", "527.0", "(916) 632-1600"], ["George Washington Carver School of Arts and Science", "526.0", "(916) 395-5266"], ["Palisades Charter High", "525.0", "(310) 230-6623"], ["Grossmont Middle College High", "525.0", "(619) 644-7524"], ["Academy of the Redwoods", "524.0", "(707) 476-4203"], ["Natomas Charter", "524.0", "(916) 928-5353"], ["San Diego International Studies", "523.0", "(619) 525-7464"], ["Summit Preparatory Charter High", "522.0", "(650) 556-1110"], ["California Virtual Academy @ Los Angeles", "521.0", "(805) 581-0202"], ["Preuss School UCSD", "520.0", "(858) 822-3000"], ["Clovis North High", "519.0", "(559) 327-5000"], ["The High School at Moorpark College", "519.0", "(805) 378-1444"], ["Stockton Unified Early College Academy", "519.0", "(209) 933-7370"], ["Gabrielino High", "518.0", "(626) 573-2415"], ["California Virtual Academy @ San Diego", "517.0", "(805) 581-0202"], ["Julian Charter", "517.0", "(760) 765-3847"], ["Windsor High", "516.0", "(707) 837-7767"], ["Ann Sobrato High", "515.0", "(408) 201-6200"], ["Pleasant Grove High", "513.0", "(916) 686-0230"], ["Escondido Charter High", "513.0", "(760) 737-3154"], ["Capistrano Connections Academy", "512.0", "(949) 461-1667"], ["Franklin High", "512.0", "(916) 714-8150"], ["High Tech High North County", "511.0", "(619) 243-5014"], ["Los Osos High", "511.0", "(909) 477-6900"], ["Harbor Teacher Preparation Academy", "509.0", "(310) 834-3932"], ["Forest Charter", "508.0", "(530) 265-4823"], ["High Tech LA", "508.0", "(818) 609-2640"], ["Chino Hills High", "508.0", "(909) 606-7540"], ["Buchanan High", "507.0", "(559) 327-3000"], ["Renaissance Arts Academy", "506.0", "(323) 259-5700"], ["Cypress Charter High", "506.0", "(831) 477-0302"], ["Academy for Academic Excellence", "505.0", "(760) 946-5414"], ["Great Oak High", "505.0", "(951) 294-6450"], ["Connecting Waters Charter", "504.0", "(209) 874-9463"], ["Santa Rosa Academy", "503.0", "(951) 672-2400"], ["Aspire Benjamin Holt College Preparatory Academy", "503.0", "(209) 955-1477"], ["Valley Oaks Charter", "502.0", "(661) 852-6700"], ["Whitney High", "502.0", "(916) 632-6500"], ["San Francisco Flex Academy", "502.0", "None"], ["Liberty High", "501.0", "(661) 587-0925"], ["City of Angels", "501.0", "(323) 415-8350"], ["Mission Vista High", "501.0", "(760) 758-6800"], ["Woodcreek High", "501.0", "(916) 771-6565"], ["Golden Valley High", "500.0", "(661) 298-8140"], ["Vasquez High", "500.0", "(661) 269-0451"], ["New Technology High", "500.0", "(707) 259-8557"], ["West Campus", "500.0", "(916) 277-6400"], ["University Preparatory", "500.0", "(760) 243-5940"], ["John C. Kimball High", "500.0", "(209) 832-6600"], ["Santiago High", "499.0", "(951) 739-5600"], ["Redlands East Valley High", "498.0", "(909) 389-2500"], ["Eastlake High", "498.0", "(619) 397-3800"], ["University Preparatory High", "498.0", "(559) 730-2529"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing", "497.0", "(818) 994-7614"], ["John F. Kennedy High", "497.0", "(951) 738-2200"], ["SOAR High (Students On Academic Rise)", "496.0", "(661) 722-6300"], ["Liberty Ranch High", "496.0", "(209) 744-4250"], ["International Polytechnic High", "495.0", "(909) 839-2320"], ["Mission Hills High", "495.0", "(760) 290-2700"], ["Martin Luther King Jr. High", "494.0", "(951) 789-5690"], ["Edgewood High", "493.0", "(626) 939-0600"], ["Summit Public School: Rainier", "493.0", "(408) 831-3104"], ["Hawthorne Math and Science Academy", "492.0", "(310) 973-8184"], ["Steele Canyon High", "492.0", "(619) 660-3550"], ["Orcutt Academy Charter", "492.0", "(805) 938-8900"], ["Vista Murrieta High", "491.0", "(951) 894-5750"], ["Cosumnes Oaks High", "491.0", "(916) 683-7670"], ["Chaparral High", "491.0", "(951) 695-4200"], ["Foresthill High", "490.0", "(530) 367-5244"], ["Nipomo High", "490.0", "(805) 474-3300"], ["Centennial High", "489.0", "(661) 588-8601"], ["Opportunities for Learning - Santa Clarita", "489.0", "(661) 424-1337"], ["Futures High", "489.0", "(916) 286-1902"], ["Rancho Cucamonga High", "489.0", "(909) 989-1600"], ["San Diego Metro Career and Tech", "489.0", "(619) 388-2299"], ["Valley Charter High", "489.0", "(209) 238-6800"], ["Angelo Rodriguez High", "489.0", "(707) 863-7950"], ["Oak Park Independent", "488.0", "(818) 735-3260"], ["Port of Los Angeles High", "487.0", "(310) 832-9201"], ["James C. Enochs High", "487.0", "(209) 550-3400"], ["Eleanor Roosevelt High", "486.0", "(951) 738-2100"], ["Encore Jr./Sr. High School for the Performing and Visual Arts", "486.0", "(760) 956-2632"], ["Christopher High", "484.0", "(408) 848-7171"], ["Marysville Charter Academy for the Arts", "484.0", "(530) 749-6156"], ["Renaissance High School for the Arts", "483.0", "(562) 901-0168"], ["East Village High", "483.0", "(619) 525-2000"], ["Audeo Charter", "483.0", "(858) 678-2050"], ["Gateway High", "483.0", "(415) 749-3600"], ["Middle College High", "483.0", "(714) 953-3900"], ["Laguna Creek High", "483.0", "(916) 683-1339"], ["Summit Public School: Tahoma", "483.0", "(408) 729-1981"], ["Bitney College Preparatory High", "482.0", "(530) 477-1235"], ["Kearny Digital Media & Design", "482.0", "(858) 496-8370"], ["KIPP San Jose Collegiate", "482.0", "(408) 937-3752"], ["Hamilton High", "481.0", "(951) 763-1865"], ["Millennium Charter", "480.0", "(209) 831-5240"], ["John H. Pitman High", "480.0", "(209) 656-1592"], ["Granite Hills High", "479.0", "(760) 961-2290"], ["Anzar High", "479.0", "(831) 623-7660"], ["Charter School of San Diego", "479.0", "(858) 678-2020"], ["River Valley High", "479.0", "(530) 822-2500"], ["Merrill F. West High", "479.0", "(209) 830-3370"], ["Early College High", "478.0", "(714) 241-6108"], ["River Springs Charter", "478.0", "(951) 252-8800"], ["Murrieta Mesa High", "478.0", "(951) 677-0568"], ["High Tech High International", "477.0", "(619) 243-5014"], ["Natomas Pacific Pathways Prep", "477.0", "(916) 567-5740"], ["High Tech High", "477.0", "(619) 243-5014"], ["Olympian High", "476.0", "(619) 656-2400"], ["Frontier High", "475.0", "(661) 829-1107"], ["El Diamante High", "475.0", "(559) 735-3501"], ["Stockton Collegiate International Secondary", "475.0", "(209) 390-9861"], ["Otay Ranch Senior High", "474.0", "(619) 591-5000"], ["Valley Center High", "474.0", "(760) 751-5502"], ["School of Arts and Enterprise", "473.0", "(909) 622-0699"], ["Gorman Learning Center", "473.0", "(909) 307-6312"], ["Citrus Valley High", "473.0", "(909) 799-2300"], ["Excelsior Charter", "473.0", "(760) 245-4262"], ["Six Rivers Charter High", "472.0", "(707) 825-2428"], ["Liberty High", "472.0", "(559) 645-3500"], ["Minarets High", "472.0", "(559) 868-8689"], ["Diamond Ranch High", "472.0", "(909) 397-4715"], ["Sheldon High", "472.0", "(916) 681-7500"], ["High Tech High Chula Vista", "471.0", "(619) 243-5014"], ["Nuview Bridge Early College High", "471.0", "(951) 928-8498"], ["Magnolia Science Academy", "470.0", "(818) 609-0507"], ["Daniel Pearl Journalism & Communications Magnet", "470.0", "(818) 654-3775"], ["American Canyon High", "470.0", "(707) 265-2710"], ["Middle College High", "469.0", "(909) 888-4041"], ["Antelope High", "469.0", "(916) 726-1400"], ["Southwest High", "468.0", "(760) 336-4100"], ["Design Science Early College High", "468.0", "(559) 248-7353"], ["Mountain Park", "468.0", "(626) 471-3014"], ["The MET", "468.0", "(916) 395-5417"], ["Delta Charter", "468.0", "(209) 830-6363"], ["Da Vinci Science", "467.0", "(310) 725-5800"], ["San Jacinto Valley Academy", "466.0", "(951) 654-6113"], ["South Sutter Charter", "465.0", "(530) 295-3566"], ["Joseph A. Gregori High", "465.0", "(209) 550-3421"], ["Waterford High", "465.0", "(209) 874-9060"], ["Lemoore Middle College High", "464.0", "(559) 925-3552"], ["Options for Youth-Burbank Charter", "464.0", "(818) 566-7525"], ["Sierra Pacific High", "464.0", "(559) 583-5912"], ["Northridge Academy High", "464.0", "(818) 700-2222"], ["Helix High", "464.0", "(619) 466-4194"], ["Harmony Magnet Academy", "464.0", "(559) 568-0347"], ["Independence High", "463.0", "(661) 834-8001"], ["Minarets Charter High", "463.0", "(559) 868-8659"], ["Patriot High", "463.0", "(951) 361-6500"], ["Segerstrom High", "463.0", "(714) 241-5000"], ["College Prep High", "463.0", "(951) 925-5155"], ["Sierra High", "463.0", "(209) 858-7410"], ["La Quinta High", "462.0", "(760) 772-4150"], ["Academy of Careers and Exploration", "462.0", "(760) 952-1266"], ["Hallmark Charter", "460.0", "(559) 524-7170"], ["Da Vinci Design", "459.0", "(310) 725-5800"], ["Heritage Peak Charter", "458.0", "(866) 992-9033"], ["Venture Academy", "458.0", "(209) 468-5940"], ["International Studies Learning Center at Legacy High School Complex", "457.0", "(323) 357-7521"], ["Options for Youth-San Bernardino", "457.0", "(626) 685-9300"], ["High Tech High Media Arts", "457.0", "(619) 398-8632"], ["Elsie Allen High", "457.0", "(707) 528-5020"], ["Horizon Charter", "456.0", "(916) 408-5200"], ["Academy (The)- SF @McAteer", "456.0", "(415) 695-5700"], ["Clovis East High", "455.0", "(559) 327-4000"], ["Options for Youth San Gabriel", "455.0", "(626) 921-8200"], ["Pioneer High", "455.0", "(530) 406-1148"], ["Marina High", "454.0", "(831) 583-2060"], ["Lakeside High", "454.0", "(951) 253-7300"], ["Natomas High", "454.0", "(916) 641-4960"], ["Pacifica High", "454.0", "(805) 278-5000"], ["Weston Ranch High", "454.0", "(209) 938-6245"], ["School for Entrepreneurship and Technology", "453.0", "(858) 874-4338"], ["Rosemont High", "452.0", "(916) 395-5130"], ["Kearny SCT", "452.0", "(858) 496-8370"], ["Pioneer Valley High", "451.0", "(805) 922-1305"], ["Hanford West High", "450.0", "(559) 583-5903"], ["Paloma Valley High", "450.0", "(951) 672-6030"], ["Oak Hills High", "450.0", "(760) 244-2283"], ["Colony High", "450.0", "(909) 930-2929"], ["Kearny College Connections", "450.0", "(858) 496-8370"], ["Central High East Campus", "449.0", "(559) 276-0280"], ["Lancaster High", "449.0", "(661) 726-7649"], ["Robert F. Kennedy High", "449.0", "(661) 720-5117"], ["Inderkum High", "449.0", "(916) 567-5640"], ["Arthur A. Benjamin Health Professions High", "449.0", "(916) 395-5010"], ["Animo Inglewood Charter High", "448.0", "(310) 673-0956"], ["Sultana High", "448.0", "(760) 947-6777"], ["Nova Academy", "448.0", "(714) 569-0948"], ["Opportunities for Learning - Baldwin Park", "447.0", "(626) 814-0161"], ["Math, Science, & Technology Magnet Academy at Roosevelt High", "447.0", "(323) 780-6500"], ["Riverside Preparatory", "447.0", "(760) 243-5884"], ["Jesse M. Bethel High", "447.0", "(707) 556-5700"], ["Environmental Charter High", "446.0", "(310) 214-3400"], ["Ramon C. Cortines School of Visual and Performing Arts", "446.0", "(213) 217-8600"], ["Everett Alvarez High", "446.0", "(831) 796-7800"], ["Tahquitz High", "445.0", "(951) 765-6300"], ["Orthopaedic Hospital", "444.0", "(213) 765-2088"], ["Alliance Leichtman-Levine Family Foundation Environmental Science High", "444.0", "(323) 739-0560"], ["Monterey Trail High", "444.0", "(916) 688-0050"], ["Heritage High", "444.0", "(951) 940-5447"], ["Frazier Mountain High", "443.0", "(661) 248-0310"], ["Santa Clarita Valley International", "443.0", "(661) 705-4820"], ["William J. (Pete) Knight High", "442.0", "(661) 533-9000"], ["Village Academy High School at Indian Hill", "442.0", "(909) 397-4900"], ["City Honors College Preparatory Academy", "442.0", "(310) 680-4880"], ["Visalia Charter Independent Study", "442.0", "(559) 735-8055"], ["Pacheco High", "441.0", "(209) 826-3801"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "441.0", "(909) 580-5006"], ["Valley Academy of Arts and Sciences", "440.0", "(818) 832-7750"], ["Cesar E. Chavez High", "439.0", "(661) 720-4501"], ["South East High", "439.0", "(323) 568-3400"], ["Alliance Marc & Eva Stern Math and Science", "439.0", "(323) 987-2144"], ["Buhach Colony High", "438.0", "(209) 325-1400"], ["PUC CA Academy for Liberal Studies Early College High", "437.0", "None"], ["Golden Valley High", "436.0", "(209) 325-1800"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex", "436.0", "(213) 745-8141"], ["Wilmer Amina Carter High", "436.0", "(909) 854-4100"], ["Ronald E. McNair High", "436.0", "(209) 953-9245"], ["Bright Star Secondary Charter Academy", "435.0", "(424) 789-8337"], ["Middle College High", "435.0", "(323) 418-4700"], ["Peter Johansen High", "435.0", "(209) 576-4702"], ["Mission Oak High", "435.0", "(559) 688-2021"], ["Shadow Hills High", "434.0", "(760) 393-5400"], ["Hector G. Godinez", "433.0", "(714) 433-6790"], ["Central Valley High", "433.0", "(209) 556-1900"], ["Granite Hills High", "433.0", "(559) 782-7075"], ["New Technology High", "432.0", "(916) 395-5254"], ["Lathrop High", "432.0", "(209) 938-6350"], ["Ivy Academia", "431.0", "(818) 716-0771"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "431.0", "(323) 568-3800"], ["San Ysidro High", "431.0", "(619) 710-2300"], ["Options for Youth-San Juan", "431.0", "(916) 485-5155"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies", "430.0", "(323) 276-5500"], ["Pajaro Valley High", "430.0", "(831) 728-8102"], ["Desert Hot Springs High", "429.0", "(760) 288-7000"], ["Soledad High", "428.0", "(831) 678-6400"], ["Los Angeles International Charter High", "428.0", "(323) 257-1499"], ["South El Monte High", "427.0", "(626) 442-0218"], ["Greenfield High", "427.0", "(831) 674-2751"], ["Magnolia Science Academy 2", "427.0", "(818) 758-0300"], ["Kearny Eng, Innov & Design", "426.0", "(858) 496-8370"], ["Opportunities For Learning - Baldwin Park II", "426.0", "(626) 962-3311"], ["Gonzales High", "425.0", "(831) 675-2495"], ["Insight @ Los Angeles", "425.0", "None"], ["Los Angeles Leadership Academy", "425.0", "(323) 227-7719"], ["Humanities and Arts (HARTS) Academy of Los Angeles", "425.0", "(310) 257-7100"], ["Summit High", "425.0", "(909) 357-5950"], ["Jurupa Hills High", "424.0", "(909) 357-6300"], ["Vista del Lago High", "424.0", "(951) 571-4880"], ["Humphreys College Academy of Business, Law and Education", "424.0", "(209) 478-1600"], ["Golden Valley High", "424.0", "(661) 827-0800"], ["California City High", "424.0", "(760) 373-5263"], ["Linda Esperanza Marquez High C School of Social Justice", "423.0", "(323) 584-3800"], ["Lawndale High", "423.0", "(310) 263-3102"], ["San Diego Science and Technology", "423.0", "(619) 525-7459"], ["California Military Institute", "423.0", "(951) 443-2731"], ["Silverado High", "422.0", "(760) 955-3353"], ["Health Sciences High", "422.0", "(619) 528-9070"], ["Rialto High", "421.0", "(909) 421-7500"], ["Adelanto High", "421.0", "(760) 246-3909"], ["Ridgeview High", "421.0", "(661) 398-3100"], ["Applied Technology Center", "420.0", "(323) 248-2500"], ["Maywood Academy High", "420.0", "(323) 838-6000"], ["Rancho Dominguez Preparatory", "420.0", "(310) 354-3400"], ["School of Engineering & Sciences", "420.0", "(916) 395-5040"], ["Weber Institute", "420.0", "(209) 933-7330"], ["Delhi High", "419.0", "(209) 656-2050"], ["Synergy Quantum Academy", "419.0", "(323) 846-4716"], ["Options for Youth-Victorville Charter", "419.0", "(626) 685-9300"], ["Magnolia Science Academy 3", "418.0", "(310) 637-3806"], ["Lennox Mathematics, Science and Technology Academy", "418.0", "(310) 680-5600"], ["Health Careers Academy", "418.0", "(209) 933-7360"], ["Academy of Medical Arts at Carson High", "417.0", "(310) 847-1465"], ["Henry J. Kaiser High", "417.0", "(909) 357-5900"], ["Cesar Chavez High", "417.0", "(209) 933-7480"], ["Wallis Annenberg High", "416.0", "(323) 235-6343"], ["Animo Leadership High", "416.0", "(310) 216-3277"], ["East Valley Senior High", "415.0", "(818) 753-4400"], ["Animo Venice Charter High", "414.0", "(310) 392-8751"], ["Madera South High", "414.0", "(559) 675-4450"], ["Desert Mirage High", "414.0", "(760) 397-2255"], ["Camino Nuevo Charter High", "413.0", "(213) 240-8700"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)", "413.0", "(818) 838-3926"], ["Ambassador-Global Leadership", "412.0", "(213) 480-4540"], ["Marco Antonio Firebaugh High", "412.0", "(310) 886-5200"], ["New Designs Charter", "411.0", "(213) 765-9084"], ["Panorama High", "411.0", "(818) 909-4500"], ["Linda Esperanza Marquez High B LIBRA Academy", "410.0", "(323) 584-3800"], ["Roseland Charter", "410.0", "(707) 545-0102"], ["Los Angeles High School of the Arts", "409.0", "(213) 480-4600"], ["Eastside High", "409.0", "(661) 946-3800"], ["Edward R. Roybal Learning Center", "408.0", "(213) 580-6400"], ["Alliance Judy Ivie Burton Technology Academy High", "408.0", "(323) 920-6125"], ["Leadership High", "408.0", "(415) 841-8910"], ["Aspire Langston Hughes Academy", "408.0", "(209) 943-2389"], ["Guidance Charter", "407.0", "(661) 285-1600"], ["Alliance Dr. Olga Mohan High", "407.0", "(213) 342-2870"], ["Public Service Community at Diego Rivera Learning Complex", "406.0", "(323) 846-2128"], ["Arroyo Valley High", "406.0", "(909) 381-4295"], ["Magnolia Science Academy 4", "405.0", "(310) 473-2464"], ["San Diego MVP Arts", "405.0", "None"], ["Citrus Hill High", "405.0", "(951) 490-0400"], ["Orange Cove High", "405.0", "(559) 626-5900"], ["Central City Value", "404.0", "(213) 471-4686"], ["Academies of Education and Empowerment at Carson High", "403.0", "(310) 847-1455"], ["School of Business and Tourism at Contreras Learning Complex", "403.0", "(213) 240-3800"], ["NOVA Academy - Coachella", "403.0", "(714) 569-0948"], ["Aspire Alexander Twilight Secondary Academy", "403.0", "(916) 979-1788"], ["Sacramento Charter High", "403.0", "(916) 277-6200"], ["East Palo Alto Academy", "403.0", "(650) 893-8900"], ["Mira Monte High", "403.0", "(661) 366-1800"], ["San Diego Business/Leadership", "402.0", "(619) 525-7461"], ["New Open World Academy K-12", "402.0", "(213) 480-3700"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy", "401.0", "(818) 838-3946"], ["PUC Early College Academy for Leaders and Scholars (ECALS)", "401.0", "(323) 276-5525"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy", "401.0", "(818) 838-3915"], ["Indian Springs High", "400.0", "(909) 383-1360"], ["Farmersville High", "400.0", "(559) 594-4567"], ["Sunnyside High", "399.0", "(559) 253-6700"], ["STEM Academy at Bernstein High", "399.0", "(323) 817-6461"], ["Oscar De La Hoya Animo Charter High", "398.0", "(323) 780-1259"], ["Alliance Ouchi-O'Donovan 6-12 Complex", "397.0", "(323) 596-2290"], ["Arleta High", "397.0", "(818) 686-4100"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3", "395.0", "(323) 285-6795"], ["City Arts and Tech High", "395.0", "(415) 841-2200"], ["School for the Visual Arts and Humanities", "394.0", "(213) 480-4700"], ["Aspire Pacific Academy", "394.0", "(323) 589-2800"], ["Alliance Piera Barabaglia Shaheen Health Services Academy", "393.0", "(323) 972-9010"], ["UCLA Community K-12", "392.0", "(213) 480-3750"], ["Helen Bernstein High", "391.0", "(323) 817-6460"], ["PUC Lakeview Charter High", "390.0", "(818) 356-2591"], ["Alliance Collins Family College-Ready High", "390.0", "(323) 923-1588"], ["Environmental and Social Policy Magnet", "390.0", "(323) 441-4577"], ["Contreras Learning Center-Academic Leadership Community", "390.0", "(213) 240-3815"], ["Lincoln High", "389.0", "(619) 266-6500"], ["Cabrillo High", "388.0", "(562) 951-7700"], ["New Millennium Secondary", "388.0", "(310) 999-6162"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2", "388.0", "(323) 265-6760"], ["Los Angeles Academy of Arts & Enterprise Charter", "388.0", "(213) 487-0600"], ["Animo Ralph Bunche Charter High", "387.0", "(323) 232-9436"], ["Visual and Performing Arts at Legacy High School Complex", "386.0", "(323) 357-7500"], ["Alliance Patti And Peter Neuwirth Leadership Academy", "386.0", "(213) 342-2874"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4", "386.0", "(323) 265-6830"], ["Sun Valley High", "385.0", "(818) 394-4600"], ["West Adams Preparatory High", "385.0", "(323) 373-2500"], ["Alliance Tennenbaum Family Technology High", "385.0", "(323) 276-5545"], ["Contreras Learning Center-School of Social Justice", "383.0", "(213) 240-3800"], ["Los Angeles River at Sonia Sotomayor Learning Academies", "383.0", "(323) 276-5535"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex", "383.0", "(323) 357-7545"], ["Santee Education Complex", "382.0", "(213) 763-1000"], ["Felicitas and Gonzalo Mendez High", "382.0", "(323) 981-6100"], ["View Park Preparatory Accelerated High", "382.0", "(323) 290-6975"], ["Crenshaw Arts-Technology Charter High", "381.0", "(323) 293-3917"], ["Leadership Public Schools - San Jose", "381.0", "None"], ["Crawford High", "380.0", "(619) 362-3700"], ["Latino College Preparatory Academy", "380.0", "(408) 729-2281"], ["Mendota High", "378.0", "(559) 655-1993"], ["Esteban Torres East LA Performing Arts Magnet", "378.0", "(323) 265-6725"], ["Frederick Douglass Academy High", "378.0", "None"], ["Alliance Ted K. Tajima High", "378.0", "(213) 241-8533"], ["Contreras Learning Center-Los Angeles School of Global Studies", "378.0", "(213) 240-3850"], ["Wonderful College Prep Academy", "377.0", "(661) 454-3000"], ["Animo Pat Brown", "377.0", "(323) 585-3312"], ["Animo Jackie Robinson High", "377.0", "(323) 846-5800"], ["Academy for Multilingual Arts and Science at Mervyn M. Dymally High", "377.0", "(323) 565-4600"], ["Animo South Los Angeles Charter", "376.0", "(323) 779-0544"], ["Alliance Morgan McKinzie High", "375.0", "(323) 859-0750"], ["Green Design at Diego Rivera Learning Complex", "375.0", "(323) 846-2108"], ["New Village Girls Academy", "374.0", "(213) 385-4015"], ["Discovery Charter Preparatory School #2", "373.0", "(818) 897-1187"], ["Communication and Technology at Diego Rivera Learning Complex", "373.0", "(323) 846-2118"], ["Performing Arts Community at Diego Rivera Learning Complex", "372.0", "(323) 846-2136"], ["Student Empowerment Academy", "372.0", "None"], ["New Designs Charter School-Watts", "371.0", "(323) 418-0600"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5", "371.0", "(323) 265-6865"], ["Summit Leadership Academy-High Desert", "370.0", "(760) 949-9202"], ["Edward C. Merlo Institute of Environmental Studies", "370.0", "(209) 933-7190"], ["Cesar E. Chavez Learning Academy - Arts/Theatre/Entertain Mag", "369.0", "(818) 837-6428"], ["King-Chavez Community High", "369.0", "(619) 704-1020"], ["APEX Academy", "368.0", "(323) 817-6550"], ["Augustus F. Hawkins High B Community Health Advocates", "366.0", "(323) 789-1282"], ["Alliance Cindy and Bill Simon Technology Academy High", "364.0", "(323) 744-2122"], ["Alain Leroy Locke College Preparatory Academy", "364.0", "(323) 420-2100"], ["Alliance Renee and Meyer Luskin Academy High", "364.0", "(323) 905-1210"], ["Marshall (Thurgood) High", "364.0", "(415) 695-5612"], ["Dr. Maya Angelou Community High", "363.0", "(323) 846-4700"], ["San Pasqual Academy", "363.0", "(760) 233-6003"], ["Gompers Preparatory Academy", "363.0", "(619) 263-2171"], ["Animo Watts College Preparatory Academy", "362.0", "(323) 756-3930"], ["Lifeline Education Charter", "359.0", "(310) 605-2510"], ["Animo College Preparatory Academy", "359.0", "(323) 568-4136"], ["Augustus F. Hawkins High A Critical Design and Gaming", "354.0", "(323) 789-1282"], ["Leadership in Entertainment and Media Arts (LEMA)", "354.0", "None"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship", "346.0", "(323) 789-1282"], ["Los Angeles Teacher Preparatory Academy", "339.0", "None"], ["Soledad Enrichment Action Charter High", "335.0", "(213) 480-4200"], ["S.F. International High", "318.0", "(415) 695-5781"], ["Sierra Charter", "None", "(559) 490-4290"], ["W. E. B. DuBois Public Charter", "None", "(559) 486-1166"], ["Success One!", "None", "(530) 934-6320"], ["College Bridge Academy", "None", "(323) 249-7845"], ["Los Angeles County Online High", "None", "(800) 985-0770"], ["Hume Lake Charter", "None", "(559) 305-7565"], ["Desert Sands Charter", "None", "(661) 942-3357"], ["School of Unlimited Learning", "None", "(559) 498-8543"], ["Opportunities For Learning - Fresno", "None", "(626) 921-8200"], ["Alder Grove Charter", "None", "(707) 268-0854"], ["Mattole Valley Charter (#159)", "None", "(707) 629-3634"], ["YouthBuild Charter School of California", "None", "(213) 741-2600"], ["Crescent View West Charter", "None", "(559) 222-8439"], ["Clovis Online Charter", "None", "(559) 327-4400"], ["Carter G. Woodson Public Charter", "None", "(559) 229-3529"], ["Elm High", "None", "(559) 485-8805"], ["Laurel Tree Charter", "None", "(707) 822-5626"], ["Mattole Triple Junction High", "None", "(707) 629-3250"], ["Crossroads Charter", "None", "(559) 583-5060"], ["California Virtual Academy @ Kings", "None", "(805) 581-0202"], ["Kingsburg Independent Study High", "None", "(559) 897-3880"], ["Ambassador Phillip V. Sanchez Public Charter", "None", "(559) 255-9017"], ["New Day Academy", "None", "(530) 233-3861"], ["Academies of the Antelope Valley", "None", "(661) 948-7655"], ["West Park Charter Academy", "None", "(559) 233-6501"], ["Crescent View South Charter", "None", "(559) 222-8439"], ["Conservation Corps of Long Beach Gateway Cities Charter", "None", "(562) 216-1790"], ["National University Academy - Orange Center", "None", "None"], ["Big Picture Educational Academy", "None", "(559) 420-1234"], ["Academy of Arts and Sciences: Fresno", "None", "(855) 937-4227"], ["Selma Independent", "None", "(559) 898-6670"], ["Abraham Lincoln Alternative", "None", "(661) 256-5090"], ["Mt. Lassen Charter", "None", "(530) 827-2129"], ["Optimist Charter", "None", "(323) 443-3100"], ["Fresno Academy for Civic and Entrepreneurial Leadership", "None", "None"], ["YouthBuild Charter School of California Central", "None", "None"], ["Dunlap Leadership Academy", "None", "(559) 305-7320"], ["Pacific View Charter", "None", "(707) 269-9490"], ["The Education Corps", "None", "(323) 249-7845"], ["Bishop Independent Study", "None", "(760) 938-2001"], ["Kern Workforce 2000 Academy", "None", "(661) 827-3158"], ["Insight School of California", "None", "(805) 581-0202"], ["Westwood Charter", "None", "(530) 256-2994"], ["National University Academy, Armona", "None", "None"], ["Centinela Valley Independent Study", "None", "(310) 263-4469"], ["PUC Community Charter Middle and PUC Community Charter Early College High", "None", "(818) 485-0933"], ["Merced Scholars Charter", "None", "(209) 381-5165"], ["Anahuacalmecac International University Preparatory of North America", "None", "None"], ["Academy of Science and Engineering", "None", "(323) 545-1100"], ["Aveson Global Leadership Academy", "None", "(626) 797-1438"], ["Learning Works", "None", "(626) 564-2871"], ["iQ Academy California-Los Angeles", "None", "(888) 997-4722"], ["Crossroads Alternative Education Center", "None", "(209) 826-4013"], ["Opportunities for Learning - Capistrano", "None", "(949) 248-1282"], ["PUC Triumph Charter High", "None", "None"], ["Family First Charter", "None", "(310) 355-0001"], ["School of Extended Educational Options", "None", "(909) 397-4900"], ["Mission View Public", "None", "(661) 200-5595"], ["Inspire Charter School", "None", "(661) 269-2214"], ["SIATech Academy South", "None", "(760) 945-1227"], ["Madera County Independent Academy", "None", "(559) 662-4636"], ["San Andreas High (Continuation)", "None", "(415) 945-3751"], ["Ukiah Independent Study Academy", "None", "(707) 472-5062"], ["Monterey County Home Charter", "None", "(831) 755-0331"], ["Learning for Life Charter", "None", "(831) 582-9820"], ["New Opportunities Charter", "None", "(310) 355-0001"], ["Beach High-Intensive Learning Program", "None", "(562) 595-8893"], ["Pacific Boulevard", "None", "(323) 586-8640"], ["Frida Kahlo High", "None", "(213) 763-1090"], ["Antelope Valley Learning Academy", "None", "(661) 952-6028"], ["Palmdale Aerospace Academy", "None", "(661) 273-3680"], ["Del Mar High", "None", "(626) 291-5723"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "None", "(855) 937-4227"], ["Pioneer Technical Center", "None", "(559) 662-6294"], ["New Horizons", "None", "(707) 459-4801"], ["Willits Charter", "None", "(707) 459-5506"], ["California Preparatory Academy", "None", "(949) 234-5317"], ["Opportunities for Learning - Duarte", "None", "(626) 921-8200"], ["Alliance Margaret M. Bloomfield Technology Academy High", "None", "(323) 537-2060"], ["Youth Opportunities Unlimited", "None", "(323) 789-4731"], ["Albert Einstein Academy for Letters, Arts and Sciences", "None", "(661) 702-0755"], ["Redondo Shores High (Continuation)", "None", "(310) 798-8690"], ["Sherman Thomas Charter High", "None", "(559) 675-6626"], ["Accelerated Achievement Academy", "None", "(707) 463-7080"], ["Shattuck Independent Study", "None", "(209) 656-2012"], ["Urban Corps of San Diego County Charter", "None", "(619) 235-6884"], ["Camino Nuevo High #2", "None", "(213) 736-5566"], ["Thurgood Marshall", "None", "(310) 898-6340"], ["Glacier High School Charter", "None", "(559) 642-1422"], ["Napa Valley Independent Studies", "None", "(707) 259-8577"], ["EPIC de Cesar Chavez", "None", "(661) 822-4381"], ["Vantage Point Charter", "None", "(530) 432-5312"], ["Los Angeles Big Picture High", "None", "None"], ["Paramount Alternative Education Center", "None", "None"], ["North Valley Military Institute College Preparatory Academy", "None", "(818) 368-1557"], ["Pathway Independent Study", "None", "(310) 603-1516"], ["Orange County Conservation Corps Charter", "None", "(714) 956-6222"], ["El Puente", "None", "(831) 796-7700"], ["Chawanakee Academy", "None", "None"], ["Early College Academy-LA Trade Tech College", "None", "(323) 763-3685"], ["CIS Academy", "None", "(626) 396-5883"], ["Assurance Learning Academy", "None", "(661) 272-1225"], ["John Muir Charter Schools", "None", "(530) 272-4008"], ["Partnerships for Student-Centered Learning", "None", "(916) 408-5200"], ["Rocklin Independent Charter Academy", "None", "(916) 632-3195"], ["Gateway College and Career Academy", "None", "(951) 222-8931"], ["Moreno Valley Online Academy", "None", "(951) 571-4800"], ["Mountain Heights Academy", "None", "(951) 487-7710"], ["Murrieta Canyon Academy", "None", "(951) 696-1661"], ["Creative Connections Arts Academy", "None", "(916) 566-1870"], ["Alta Vista South Public Charter", "None", "(661) 272-1225"], ["Redlands eAcademy", "None", "(909) 748-6941"], ["Public Safety Academy", "None", "(909) 382-2211"], ["Silver Valley Academy", "None", "(760) 254-2715"], ["Juan Bautista de Anza", "None", "(760) 767-5850"], ["Diego Hills Charter", "None", "(619) 286-0312"], ["Diego Valley Charter", "None", "(619) 286-0312"], ["Future Bound Independent Study Secondary", "None", "(760) 787-2068"], ["SIATech", "None", "(760) 945-1227"], ["Carlsbad Seaside Academy", "None", "(760) 331-5299"], ["Five Keys Charter (SF Sheriff's)", "None", "(415) 734-3310"], ["Coronado Pathways Charter", "None", "None"], ["Riverside County Education Academy", "None", "(951) 826-6602"], ["Come Back Kids", "None", "(951) 826-6461"], ["Capital City Independent Study", "None", "(916) 433-5187"], ["Vista Nueva Career and Technology High", "None", "(916) 566-2750"], ["Alta Vista Public", "None", "(760) 947-0006"], ["Chaffey District Online High", "None", "(909) 985-0966"], ["ASA Charter", "None", "(909) 475-3322"], ["Shadow Ridge", "None", "(760) 949-8267"], ["Oasis High (Alternative)", "None", "(760) 723-6395"], ["San Diego Virtual", "None", "(619) 713-7271"], ["Academy of Arts and Sciences", "None", "(855) 937-4227"], ["Arroyo Paseo Charter High", "None", "(619) 677-3017"], ["Laurel Preparatory Academy", "None", "(858) 678-4812"], ["Insight @ San Diego", "None", "(805) 581-0202"], ["Southern California Online Academy", "None", "None"], ["Antelope View Charter", "None", "None"], ["21st Century Learning Institute", "None", "(951) 769-8424"], ["Lee V. Pollard High", "None", "(951) 736-3367"], ["Keith McCarthy Academy", "None", "(951) 253-7777"], ["Val Verde Academy", "None", "(951) 443-2450"], ["Elwood J. Keema High", "None", "(916) 566-3410"], ["Provisional Accelerated Learning Academy", "None", "(909) 887-7002"], ["Sky Mountain Charter", "None", "(530) 295-3566"], ["High Desert Premier Academy", "None", "(760) 240-4252"], ["Diego Springs Academy", "None", "(661) 272-1225"], ["Greater San Diego Academy", "None", "(619) 669-3050"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "None", "None"], ["RAI Online Charter", "None", "None"], ["CORE Placer Charter", "None", "(530) 346-8340"], ["Cold Stream Alternative", "None", "(530) 582-2640"], ["Plumas Charter", "None", "(530) 283-3851"], ["Alvord Alternative Continuation High", "None", "(951) 509-6021"], ["Rivercrest Preparatory", "None", "(951) 360-2660"], ["Riverside Virtual", "None", "(951) 276-2006"], ["Mountain Valley Academy", "None", "(760) 787-3600"], ["Home & Hosp/Transition Support", "None", "(619) 344-6435"], ["MAAC Community Charter", "None", "(619) 476-0749"], ["North County Trade Tech High", "None", "(760) 598-0782"], ["Five Keys Adult School (SF Sheriff's)", "None", "(415) 734-3310"], ["OUSD Home Sch", "None", "(714) 628-5479"], ["Susan H. Nelson", "None", "(951) 695-7360"], ["Community Collaborative Charter", "None", "(916) 286-5161"], ["Literacy First Charter", "None", "(619) 579-7232"], ["Pivot Charter School - San Diego", "None", "(760) 591-0217"], ["Bayshore Preparatory Charter", "None", "(760) 471-0847"], ["Five Keys Independence HS (SF Sheriff's)", "None", "(415) 734-3310"], ["Hope Academy Charter", "None", "None"], ["Parkview", "None", "(714) 986-7050"], ["Cesar E. Chavez High", "None", "(714) 430-5700"], ["Victory High", "None", "(916) 632-3195"], ["Banning Independent Study", "None", "(951) 922-0268"], ["Highlands Community Charter", "None", "(916) 844-2283"], ["Learning Choice Academy", "None", "(619) 463-6849"], ["iHigh Virtual Academy", "None", "(619) 764-5440"], ["Taylion San Diego Academy", "None", "(760) 295-5564"], ["Valley Center Prep", "None", "(760) 751-0455"], ["Gateway to College", "None", "(415) 452-5768"], ["Horizon", "None", "(760) 238-9720"], ["San Juan Choices Charter", "None", "(916) 979-8378"], ["Independence Charter Academy", "None", "(760) 952-1760"], ["Mirus Secondary", "None", "(760) 244-3764"], ["Options Secondary", "None", "(619) 796-7320"], ["Pacific View Charter", "None", "(760) 757-0161"], ["Warner Junior/Senior High", "None", "(760) 782-3517"], ["Jordan (June) School for Equity", "None", "(415) 452-4922"], ["Corona-Norco Alternative", "None", "(951) 736-3367"], ["Elk Grove Charter", "None", "(916) 714-1653"], ["Global Youth Charter", "None", "(916) 339-4680"], ["SAVA: Sacramento Academic and Vocational Academy", "None", "(916) 387-8063"], ["Empire Springs Charter", "None", "(951) 252-8800"], ["Mojave River Academy", "None", "(760) 245-3222"], ["Monarch", "None", "(619) 652-4100"], ["National University Academy", "None", "(760) 631-5842"], ["Alta Vista Academy", "None", "(619) 216-5160"], ["Guajome Learning Center", "None", "(760) 631-8500"], ["Vista Visions Academy", "None", "(760) 724-4785"], ["Valley View Charter Prep", "None", "(916) 866-9033"], ["Escuela Popular/Center for Training and Careers, Family Learning", "None", "(408) 275-7191"], ["Middle College High", "None", "(408) 298-2181"], ["Northern Summit Academy", "None", "(530) 949-0154"], ["Matt Garcia Career and College Academy", "None", "(707) 424-9400"], ["Endeavor Alternative", "None", "(209) 556-1805"], ["Aspire Vanguard College Preparatory Academy", "None", "(209) 521-3010"], ["Prospect Education Center", "None", "(559) 782-7095"], ["California Virtual Academy @ Jamestown", "None", "(805) 581-0202"], ["Golden Valley Charter", "None", "(805) 642-3435"], ["Academy of Arts and Sciences: Thousand Oaks & Simi Valley", "None", "(855) 937-4227"], ["Independence", "None", "(209) 331-8275"], ["New Vision High", "None", "(209) 938-6225"], ["Delta Charter Online", "None", "(209) 830-6363"], ["Family Partnership Home Study Charter", "None", "(805) 348-3333"], ["Stellar Secondary Charter High", "None", "(530) 245-7730"], ["Valley Oaks High (Alternative)", "None", "(707) 778-4794"], ["Keyes to Learning Charter", "None", "(209) 634-6467"], ["Tehama eLearning Academy", "None", "(530) 527-0188"], ["Visalia Technical Early College", "None", "(559) 622-3212"], ["Renew Virtual Academy K12 #1", "None", "None"], ["Stockton High", "None", "(209) 933-7365"], ["Calero High", "None", "(408) 347-7600"], ["Academy of Personalized Learning", "None", "(530) 222-9280"], ["Gateway Educational Options", "None", "(530) 245-7960"], ["Golden Eagle Charter", "None", "(530) 926-5800"], ["Credo High", "None", "(707) 664-0600"], ["Valley Oak Junior and Senior High", "None", "(209) 847-3097"], ["Gold Rush Charter", "None", "(209) 532-9781"], ["Camptonville Academy", "None", "(530) 742-2786"], ["Aspire East Palo Alto Charter", "None", "None"], ["one.Charter", "None", "(209) 468-9079"], ["San Joaquin Building Futures Academy", "None", "(209) 468-8140"], ["California Virtual Academy @ San Joaquin", "None", "(805) 581-0202"], ["Peninsula High", "None", "(650) 558-2499"], ["Liberty High (Alternative)", "None", "(408) 535-6327"], ["North State Independence High", "None", "(530) 245-2760"], ["MIT Academy", "None", "(707) 552-6482"], ["Pathways Charter", "None", "(707) 585-6510"], ["Ronald Reagan Academy", "None", "(559) 595-0563"], ["Vista Real Charter High", "None", "(805) 486-5449"], ["Architecture, Construction & Engineering Charter High (ACE)", "None", "(805) 437-1410"], ["Condor High", "None", "(805) 385-2552"], ["Yuba County Career Preparatory Charter", "None", "(530) 749-4000"], ["Academy of Arts and Sciences: Oxnard & Ventura", "None", "None"], ["be.tech", "None", "(209) 858-7460"], ["Delta Home Charter", "None", "(209) 830-6363"], ["Pacific Law Academy", "None", "(209) 933-7475"], ["Grizzly ChalleNGe Charter", "None", "(805) 782-6882"], ["California Virtual Academy @ San Mateo", "None", "(805) 581-0202"], ["Downtown College Preparatory", "None", "(408) 271-8120"], ["Alternative Family Education", "None", "(831) 429-3898"], ["California Virtual Academy @ Sonoma", "None", "(805) 581-0202"], ["Oakdale Charter", "None", "(209) 848-4361"], ["La Sierra High", "None", "(559) 733-6963"], ["California Connections Academy@Central", "None", "(559) 713-1324"], ["Summit Charter Academy", "None", "(559) 782-5902"], ["Sierra Vista Charter High", "None", "(559) 687-7384"], ["IvyTech Charter", "None", "(805) 222-5188"], ["Los Olivos Charter School", "None", "None"], ["Magnolia Science Academy Santa Clara", "None", "None"], ["Independence High", "None", "(805) 769-1620"], ["San Jose Conservation Corps Charter", "None", "(408) 459-6404"], ["Escuela Popular Accelerated Family Learning", "None", "(408) 275-7190"], ["Pacific Coast Charter", "None", "(831) 761-6021"], ["Geyserville New Tech Academy", "None", "(707) 857-3592"], ["Orchard View", "None", "(707) 823-4709"], ["Hart-Ransom Academic Charter", "None", "(209) 523-0401"], ["eCademy Charter at Crane", "None", "(209) 669-3410"], ["Silicon Valley Flex Academy", "None", "None"], ["Rio Valley Charter", "None", "(209) 368-4934"], ["Ceiba College Preparatory Academy", "None", "(831) 728-6208"], ["SLVUSD Charter", "None", "(831) 335-0932"], ["Delta Charter", "None", "(831) 477-5212"], ["Gateway to College Academy", "None", "(707) 778-4621"], ["Northwest Prep Charter", "None", "(707) 522-3320"], ["California Virtual Academy @ Sutter", "None", "(805) 581-0202"], ["Eleanor Roosevelt Community Learning Center", "None", "(559) 592-9160"], ["Burton Horizon Academy", "None", "(559) 782-4748"], ["Loma Vista Charter", "None", "(559) 562-5111"], ["Connections Visual and Performing Arts Academy", "None", "(209) 928-4228"], ["Century Academy", "None", "(805) 496-0286"], ["Templeton Independent Study High", "None", "(805) 434-5805"], ["Apollo High", "None", "(408) 928-5400"], ["Anderson New Technology High", "None", "(530) 365-3100"], ["Shasta Charter Academy", "None", "(530) 245-2600"], ["Pivot Online Charter - North Bay", "None", "(707) 843-4676"], ["Abraxis Charter", "None", "(707) 539-2897"], ["Academy of Arts and Sciences: Sonoma", "None", "(855) 937-4227"], ["Stanislaus Alternative Charter", "None", "(209) 238-6801"], ["Denair Charter Academy", "None", "(209) 634-0917"], ["Fusion Charter", "None", "(209) 667-0327"], ["Yuba City Charter", "None", "(530) 822-9667"], ["Crescent Valley Public Charter", "None", "(559) 970-5894"], ["Butterfield Charter High", "None", "(559) 782-7057"], ["River Oaks Academy", "None", "(805) 777-7999"], ["West Sacramento Early College Prep Charter", "None", "(916) 375-7680"]], "spark_error": null, "total_time": 30.636115550994873, "spark_time": 0.628411054611206, "translation_time": 30.007704496383667, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a78ccedf-5129-4526-bcb0-a215bafbe4e2'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='b6b71b31-cbee-4908-b594-b4d85988cf79'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, AVG(ss.AvgScrWrite) AS AverageWritingScore, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 GROUP BY s.School, s.Phone ORDER BY AverageWritingScore DESC'}", "Observation: content='The original query has one potential area for improvement based on the provided instructions, specifically regarding \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While Spark SQL often allows simple alphanumeric identifiers without quoting, using backticks (`) for all identifiers (table names, column names, and aliases) is a robust practice that prevents issues with special characters, reserved keywords, or case sensitivity, and aligns with the instruction \"Use ` for the in-query strings\" if interpreted as a directive for identifiers.\\n\\nLet\\'s review the other points:\\n-   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n-   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n-   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used. The `>` and `<` operators correctly define exclusive ranges.\\n-   **Data type mismatch in predicates**:\\n    -   `CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991`: `SUBSTRING` extracts a string, which is then `CAST` to `INT` for comparison with an integer literal. This is correct.\\n    -   `CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000`: Same logic, correct.\\n    -   `s.CDSCode = ss.cds`: Assumed to be compatible types for the join. If they were different string/numeric types, Spark SQL might handle implicit casting, but explicit casting would be needed if an error occurred. Without schema, this is generally considered correct.\\n-   **Using the correct number of arguments for functions**: All functions (`AVG`, `SUBSTRING`, `CAST`) are used with the correct number of arguments.\\n-   **Casting to the correct data type**: Casting the extracted year to `INT` is appropriate for numerical comparison.\\n-   **Using the proper columns for joins**: `s.CDSCode = ss.cds` is a logical join condition between schools and their SAT scores.\\n\\nThe only change needed is to apply backticks to all identifiers for robustness and to strictly adhere to the \"Use ` for the in-query strings\" instruction when interpreted as applying to identifiers.\\n\\n```sql\\nSELECT\\n    `s`.`School`,\\n    AVG(`ss`.`AvgScrWrite`) AS `AverageWritingScore`,\\n    `s`.`Phone`\\nFROM\\n    `schools` AS `s`\\nJOIN\\n    `satscores` AS `ss` ON `s`.`CDSCode` = `ss`.`cds`\\nWHERE\\n    CAST(SUBSTRING(`s`.`OpenDate`, 1, 4) AS INT) > 1991\\n    OR CAST(SUBSTRING(`s`.`ClosedDate`, 1, 4) AS INT) < 2000\\nGROUP BY\\n    `s`.`School`,\\n    `s`.`Phone`\\nORDER BY\\n    `AverageWritingScore` DESC\\n```' name='query_checker_sql_db' tool_call_id='cf9d2529-eb93-4b43-b0d5-95066ea1b1fe'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `s`.`School`, AVG(`ss`.`AvgScrWrite`) AS `AverageWritingScore`, `s`.`Phone` FROM `schools` AS `s` JOIN `satscores` AS `ss` ON `s`.`CDSCode` = `ss`.`cds` WHERE CAST(SUBSTRING(`s`.`OpenDate`, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(`s`.`ClosedDate`, 1, 4) AS INT) < 2000 GROUP BY `s`.`School`, `s`.`Phone` ORDER BY `AverageWritingScore` DESC'}"], "input_tokens": 4597, "output_tokens": 5613, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, AVG(ss.AvgScrWrite) AS AverageWritingScore, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 GROUP BY s.School, s.Phone ORDER BY AverageWritingScore DESC\"}'}\nTool: The original query has one potential area for improvement based on the provided instructions, specifically regarding \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While Spark SQL often allows simple alphanumeric identifiers without quoting, using backticks (`) for all identifiers (table names, column names, and aliases) is a robust practice that prevents issues with special characters, reserved keywords, or case sensitivity, and aligns with the instruction \"Use ` for the in-query strings\" if interpreted as a directive for identifiers.\n\nLet's review the other points:\n-   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n-   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n-   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used. The `>` and `<` operators correctly define exclusive ranges.\n-   **Data type mismatch in predicates**:\n    -   `CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991`: `SUBSTRING` extracts a string, which is then `CAST` to `INT` for comparison with an integer literal. This is correct.\n    -   `CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000`: Same logic, correct.\n    -   `s.CDSCode = ss.cds`: Assumed to be compatible types for the join. If they were different string/numeric types, Spark SQL might handle implicit casting, but explicit casting would be needed if an error occurred. Without schema, this is generally considered correct.\n-   **Using the correct number of arguments for functions**: All functions (`AVG`, `SUBSTRING`, `CAST`) are used with the correct number of arguments.\n-   **Casting to the correct data type**: Casting the extracted year to `INT` is appropriate for numerical comparison.\n-   **Using the proper columns for joins**: `s.CDSCode = ss.cds` is a logical join condition between schools and their SAT scores.\n\nThe only change needed is to apply backticks to all identifiers for robustness and to strictly adhere to the \"Use ` for the in-query strings\" instruction when interpreted as applying to identifiers.\n\n```sql\nSELECT\n    `s`.`School`,\n    AVG(`ss`.`AvgScrWrite`) AS `AverageWritingScore`,\n    `s`.`Phone`\nFROM\n    `schools` AS `s`\nJOIN\n    `satscores` AS `ss` ON `s`.`CDSCode` = `ss`.`cds`\nWHERE\n    CAST(SUBSTRING(`s`.`OpenDate`, 1, 4) AS INT) > 1991\n    OR CAST(SUBSTRING(`s`.`ClosedDate`, 1, 4) AS INT) < 2000\nGROUP BY\n    `s`.`School`,\n    `s`.`Phone`\nORDER BY\n    `AverageWritingScore` DESC\n```", "final_answer": "", "replica": 3, "timestamp": 1768937711.534592}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value '8-29' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 109) ==\n... sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT ...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 16.45123553276062, "spark_time": 0.12599468231201172, "translation_time": 16.32524085044861, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='aaef4eec-bcf4-4f37-87a4-83b1f7ce0196'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='80cd9361-eea1-4384-b1fb-7008c7ee63dc'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School'}", "Observation: content='```sql\\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School\\n```' name='query_checker_sql_db' tool_call_id='8c315778-adca-4e89-bd9a-81d8c41ca58f'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School'}"], "input_tokens": 4009, "output_tokens": 2798, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School\"}'}\nTool: ```sql\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School\n```", "final_answer": "", "replica": 4, "timestamp": 1768937728.1538296}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value '8-29' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 109) ==\n... sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT ...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 19.987072706222534, "spark_time": 0.09099078178405762, "translation_time": 19.896081924438477, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d3b18e41-6b51-453f-8765-ab735e187718'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='f21c9ced-8230-4041-80e1-3883b926d0cb'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School'}", "Observation: content='The Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` with `NULL` values: Not used.\\n*   `UNION` vs. `UNION ALL`: Not used.\\n*   `BETWEEN` for exclusive ranges: Not used.\\n*   Data type mismatch in predicates: `SUBSTRING` extracts a string, which is then `CAST` to `INT` for comparison with integer literals (`1991`, `2000`). This is correct. Join condition `s.CDSCode = sa.cds` assumes compatible types, which is standard for join keys.\\n*   Properly quoting identifiers: Identifiers like `s.School`, `s.OpenDate`, etc., are standard and do not require special quoting (like backticks) in Spark SQL unless they are reserved keywords or contain special characters, which is not the case here.\\n*   Use `` ` `` for the in-query strings: This typically refers to quoting identifiers, not string literals. There are no string literals used as identifiers here.\\n*   Correct number of arguments for functions: `SUBSTRING(s.OpenDate, 7, 4)` and `CAST(... AS INT)` use the correct number of arguments. `SUBSTRING` with `(string, start_position, length)` is standard.\\n*   Casting to the correct data type: Casting the extracted year to `INT` is appropriate for numerical comparison.\\n*   Proper columns for joins: `s.CDSCode = sa.cds` is a standard way to join a schools table with a SAT scores table using a common identifier.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School\\n```' name='query_checker_sql_db' tool_call_id='6d60acab-8152-4eb3-967d-8f5afdbd7afd'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School'}"], "input_tokens": 4371, "output_tokens": 3416, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School\"}'}\nTool: The Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   `NOT IN` with `NULL` values: Not used.\n*   `UNION` vs. `UNION ALL`: Not used.\n*   `BETWEEN` for exclusive ranges: Not used.\n*   Data type mismatch in predicates: `SUBSTRING` extracts a string, which is then `CAST` to `INT` for comparison with integer literals (`1991`, `2000`). This is correct. Join condition `s.CDSCode = sa.cds` assumes compatible types, which is standard for join keys.\n*   Properly quoting identifiers: Identifiers like `s.School`, `s.OpenDate`, etc., are standard and do not require special quoting (like backticks) in Spark SQL unless they are reserved keywords or contain special characters, which is not the case here.\n*   Use `` ` `` for the in-query strings: This typically refers to quoting identifiers, not string literals. There are no string literals used as identifiers here.\n*   Correct number of arguments for functions: `SUBSTRING(s.OpenDate, 7, 4)` and `CAST(... AS INT)` use the correct number of arguments. `SUBSTRING` with `(string, start_position, length)` is standard.\n*   Casting to the correct data type: Casting the extracted year to `INT` is appropriate for numerical comparison.\n*   Proper columns for joins: `s.CDSCode = sa.cds` is a standard way to join a schools table with a SAT scores table using a common identifier.\n\nThe query is correct as written.\n\n```sql\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 7, 4) AS INT) > 1991 OR (s.ClosedDate IS NOT NULL AND CAST(SUBSTRING(s.ClosedDate, 7, 4) AS INT) < 2000) ORDER BY s.School\n```", "final_answer": "", "replica": 5, "timestamp": 1768937748.3818984}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": 0.0521004459047172, "spider_em": 0, "sparksql_query": "SELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000", "execution_status": "VALID", "query_result": [["Crescent View West Charter", "None", "(559) 222-8439"], ["Hume Lake Charter", "None", "(559) 305-7565"], ["Big Picture Educational Academy", "None", "(559) 420-1234"], ["Clovis North High", "519.0", "(559) 327-5000"], ["Clovis Online Charter", "None", "(559) 327-4400"], ["Buchanan High", "507.0", "(559) 327-3000"], ["Clovis East High", "455.0", "(559) 327-4000"], ["Design Science Early College High", "468.0", "(559) 248-7353"], ["Sierra Charter", "None", "(559) 490-4290"], ["University High", "593.0", "(559) 278-8263"], ["Fresno Academy for Civic and Entrepreneurial Leadership", "None", "None"], ["School of Unlimited Learning", "None", "(559) 498-8543"], ["Sunnyside High", "399.0", "(559) 253-6700"], ["Carter G. Woodson Public Charter", "None", "(559) 229-3529"], ["Kingsburg Independent Study High", "None", "(559) 897-3880"], ["Orange Cove High", "405.0", "(559) 626-5900"], ["Dunlap Leadership Academy", "None", "(559) 305-7320"], ["National University Academy - Orange Center", "None", "None"], ["Academy of Arts and Sciences: Fresno", "None", "(855) 937-4227"], ["Ambassador Phillip V. Sanchez Public Charter", "None", "(559) 255-9017"], ["Hallmark Charter", "460.0", "(559) 524-7170"], ["Selma Independent", "None", "(559) 898-6670"], ["West Park Charter Academy", "None", "(559) 233-6501"], ["Crescent View South Charter", "None", "(559) 222-8439"], ["Opportunities For Learning - Fresno", "None", "(626) 921-8200"], ["Central High East Campus", "449.0", "(559) 276-0280"], ["Mendota High", "378.0", "(559) 655-1993"], ["Elm High", "None", "(559) 485-8805"], ["W. E. B. DuBois Public Charter", "None", "(559) 486-1166"], ["Success One!", "None", "(530) 934-6320"], ["Conservation Corps of Long Beach Gateway Cities Charter", "None", "(562) 216-1790"], ["Northcoast Preparatory and Performing Arts Academy", "579.0", "None"], ["Six Rivers Charter High", "472.0", "(707) 825-2428"], ["Laurel Tree Charter", "None", "(707) 822-5626"], ["Academy of the Redwoods", "524.0", "(707) 476-4203"], ["Pacific View Charter", "None", "(707) 269-9490"], ["Alder Grove Charter", "None", "(707) 268-0854"], ["Mattole Triple Junction High", "None", "(707) 629-3250"], ["Mattole Valley Charter (#159)", "None", "(707) 629-3634"], ["Southwest High", "468.0", "(760) 336-4100"], ["YouthBuild Charter School of California", "None", "(213) 741-2600"], ["YouthBuild Charter School of California Central", "None", "None"], ["The Education Corps", "None", "(323) 249-7845"], ["College Bridge Academy", "None", "(323) 249-7845"], ["Bishop Independent Study", "None", "(760) 938-2001"], ["Wonderful College Prep Academy", "377.0", "(661) 454-3000"], ["Valley Oaks Charter", "502.0", "(661) 852-6700"], ["Cesar E. Chavez High", "439.0", "(661) 720-4501"], ["Robert F. Kennedy High", "449.0", "(661) 720-5117"], ["Golden Valley High", "424.0", "(661) 827-0800"], ["Frontier High", "475.0", "(661) 829-1107"], ["Independence High", "463.0", "(661) 834-8001"], ["Mira Monte High", "403.0", "(661) 366-1800"], ["Centennial High", "489.0", "(661) 588-8601"], ["Ridgeview High", "421.0", "(661) 398-3100"], ["Kern Workforce 2000 Academy", "None", "(661) 827-3158"], ["Liberty High", "501.0", "(661) 587-0925"], ["Insight School of California", "None", "(805) 581-0202"], ["California City High", "424.0", "(760) 373-5263"], ["Abraham Lincoln Alternative", "None", "(661) 256-5090"], ["Frazier Mountain High", "443.0", "(661) 248-0310"], ["Crossroads Charter", "None", "(559) 583-5060"], ["California Virtual Academy @ Kings", "None", "(805) 581-0202"], ["National University Academy, Armona", "None", "None"], ["Sierra Pacific High", "464.0", "(559) 583-5912"], ["Hanford West High", "450.0", "(559) 583-5903"], ["Lemoore Middle College High", "464.0", "(559) 925-3552"], ["New Day Academy", "None", "(530) 233-3861"], ["Westwood Charter", "None", "(530) 256-2994"], ["Mt. Lassen Charter", "None", "(530) 827-2129"], ["Los Angeles International Charter High", "428.0", "(323) 257-1499"], ["Optimist Charter", "None", "(323) 443-3100"], ["International Polytechnic High", "495.0", "(909) 839-2320"], ["Soledad Enrichment Action Charter High", "335.0", "(213) 480-4200"], ["William J. (Pete) Knight High", "442.0", "(661) 533-9000"], ["Eastside High", "409.0", "(661) 946-3800"], ["SOAR High (Students On Academic Rise)", "496.0", "(661) 722-6300"], ["Los Angeles County Online High", "None", "(800) 985-0770"], ["Academies of the Antelope Valley", "None", "(661) 948-7655"], ["Lancaster High", "449.0", "(661) 726-7649"], ["Desert Sands Charter", "None", "(661) 942-3357"], ["Opportunities For Learning - Baldwin Park II", "426.0", "(626) 962-3311"], ["Opportunities for Learning - Baldwin Park", "447.0", "(626) 814-0161"], ["Options for Youth-Burbank Charter", "464.0", "(818) 566-7525"], ["Centinela Valley Independent Study", "None", "(310) 263-4469"], ["Family First Charter", "None", "(310) 355-0001"], ["New Opportunities Charter", "None", "(310) 355-0001"], ["Lawndale High", "423.0", "(310) 263-3102"], ["Opportunities for Learning - Duarte", "None", "(626) 921-8200"], ["South El Monte High", "427.0", "(626) 442-0218"], ["Anderson W. Clark Magnet High", "539.0", "(818) 248-8324"], ["Gorman Learning Center", "473.0", "(909) 307-6312"], ["Hawthorne Math and Science Academy", "492.0", "(310) 973-8184"], ["City Honors College Preparatory Academy", "442.0", "(310) 680-4880"], ["Animo Inglewood Charter High", "448.0", "(310) 673-0956"], ["Environmental Charter High", "446.0", "(310) 214-3400"], ["Lennox Mathematics, Science and Technology Academy", "418.0", "(310) 680-5600"], ["Animo Leadership High", "416.0", "(310) 216-3277"], ["Beach High-Intensive Learning Program", "None", "(562) 595-8893"], ["Cabrillo High", "388.0", "(562) 951-7700"], ["Renaissance High School for the Arts", "483.0", "(562) 901-0168"], ["High Tech LA", "508.0", "(818) 609-2640"], ["Wallis Annenberg High", "416.0", "(323) 235-6343"], ["North Valley Military Institute College Preparatory Academy", "None", "(818) 368-1557"], ["Central City Value", "404.0", "(213) 471-4686"], ["View Park Preparatory Accelerated High", "382.0", "(323) 290-6975"], ["Crenshaw Arts-Technology Charter High", "381.0", "(323) 293-3917"], ["Oscar De La Hoya Animo Charter High", "398.0", "(323) 780-1259"], ["Renaissance Arts Academy", "506.0", "(323) 259-5700"], ["Animo South Los Angeles Charter", "376.0", "(323) 779-0544"], ["New Designs Charter", "411.0", "(213) 765-9084"], ["Middle College High", "435.0", "(323) 418-4700"], ["Harbor Teacher Preparation Academy", "509.0", "(310) 834-3932"], ["Ivy Academia", "431.0", "(818) 716-0771"], ["Camino Nuevo Charter High", "413.0", "(213) 240-8700"], ["Animo Venice Charter High", "414.0", "(310) 392-8751"], ["Animo Pat Brown", "377.0", "(323) 585-3312"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex", "436.0", "(213) 745-8141"], ["Orthopaedic Hospital", "444.0", "(213) 765-2088"], ["Northridge Academy High", "464.0", "(818) 700-2222"], ["International Studies Learning Center at Legacy High School Complex", "457.0", "(323) 357-7521"], ["Port of Los Angeles High", "487.0", "(310) 832-9201"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing", "497.0", "(818) 994-7614"], ["Alliance Judy Ivie Burton Technology Academy High", "408.0", "(323) 920-6125"], ["Alliance Collins Family College-Ready High", "390.0", "(323) 923-1588"], ["Pacific Boulevard", "None", "(323) 586-8640"], ["Santee Education Complex", "382.0", "(213) 763-1000"], ["South East High", "439.0", "(323) 568-3400"], ["Maywood Academy High", "420.0", "(323) 838-6000"], ["PUC CA Academy for Liberal Studies Early College High", "437.0", "None"], ["Los Angeles Academy of Arts & Enterprise Charter", "388.0", "(213) 487-0600"], ["Frida Kahlo High", "None", "(213) 763-1090"], ["New Village Girls Academy", "374.0", "(213) 385-4015"], ["Alliance Patti And Peter Neuwirth Leadership Academy", "386.0", "(213) 342-2874"], ["Alliance Dr. Olga Mohan High", "407.0", "(213) 342-2870"], ["Animo Ralph Bunche Charter High", "387.0", "(323) 232-9436"], ["Animo Jackie Robinson High", "377.0", "(323) 846-5800"], ["Animo Watts College Preparatory Academy", "362.0", "(323) 756-3930"], ["Alliance Ouchi-O'Donovan 6-12 Complex", "397.0", "(323) 596-2290"], ["Alliance Marc & Eva Stern Math and Science", "439.0", "(323) 987-2144"], ["School of Business and Tourism at Contreras Learning Complex", "403.0", "(213) 240-3800"], ["East Valley Senior High", "415.0", "(818) 753-4400"], ["Arleta High", "397.0", "(818) 686-4100"], ["Panorama High", "411.0", "(818) 909-4500"], ["Bright Star Secondary Charter Academy", "435.0", "(424) 789-8337"], ["Frederick Douglass Academy High", "378.0", "None"], ["Student Empowerment Academy", "372.0", "None"], ["Contreras Learning Center-Los Angeles School of Global Studies", "378.0", "(213) 240-3850"], ["West Adams Preparatory High", "385.0", "(323) 373-2500"], ["Magnolia Science Academy 3", "418.0", "(310) 637-3806"], ["Magnolia Science Academy 2", "427.0", "(818) 758-0300"], ["Discovery Charter Preparatory School #2", "373.0", "(818) 897-1187"], ["Alliance Morgan McKinzie High", "375.0", "(323) 859-0750"], ["Edward R. Roybal Learning Center", "408.0", "(213) 580-6400"], ["Helen Bernstein High", "391.0", "(323) 817-6460"], ["APEX Academy", "368.0", "(323) 817-6550"], ["Alliance Piera Barabaglia Shaheen Health Services Academy", "393.0", "(323) 972-9010"], ["Alliance Leichtman-Levine Family Foundation Environmental Science High", "444.0", "(323) 739-0560"], ["Magnolia Science Academy 4", "405.0", "(310) 473-2464"], ["Contreras Learning Center-Academic Leadership Community", "390.0", "(213) 240-3815"], ["Los Angeles High School of the Arts", "409.0", "(213) 480-4600"], ["Los Angeles Teacher Preparatory Academy", "339.0", "None"], ["School for the Visual Arts and Humanities", "394.0", "(213) 480-4700"], ["New Millennium Secondary", "388.0", "(310) 999-6162"], ["Alain Leroy Locke College Preparatory Academy", "364.0", "(323) 420-2100"], ["Sun Valley High", "385.0", "(818) 394-4600"], ["New Open World Academy K-12", "402.0", "(213) 480-3700"], ["UCLA Community K-12", "392.0", "(213) 480-3750"], ["Ramon C. Cortines School of Visual and Performing Arts", "446.0", "(213) 217-8600"], ["Felicitas and Gonzalo Mendez High", "382.0", "(323) 981-6100"], ["New Designs Charter School-Watts", "371.0", "(323) 418-0600"], ["Daniel Pearl Journalism & Communications Magnet", "470.0", "(818) 654-3775"], ["Ambassador-Global Leadership", "412.0", "(213) 480-4540"], ["Alliance Cindy and Bill Simon Technology Academy High", "364.0", "(323) 744-2122"], ["Alliance Tennenbaum Family Technology High", "385.0", "(323) 276-5545"], ["Environmental and Social Policy Magnet", "390.0", "(323) 441-4577"], ["Math, Science, & Technology Magnet Academy at Roosevelt High", "447.0", "(323) 780-6500"], ["Esteban Torres East LA Performing Arts Magnet", "378.0", "(323) 265-6725"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4", "386.0", "(323) 265-6830"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5", "371.0", "(323) 265-6865"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2", "388.0", "(323) 265-6760"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3", "395.0", "(323) 285-6795"], ["PUC Triumph Charter High", "None", "None"], ["PUC Lakeview Charter High", "390.0", "(818) 356-2591"], ["Aspire Pacific Academy", "394.0", "(323) 589-2800"], ["Los Angeles Big Picture High", "None", "None"], ["Alliance Ted K. Tajima High", "378.0", "(213) 241-8533"], ["Valley Academy of Arts and Sciences", "440.0", "(818) 832-7750"], ["Cesar E. Chavez Learning Academy - Arts/Theatre/Entertain Mag", "369.0", "(818) 837-6428"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy", "401.0", "(818) 838-3915"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)", "413.0", "(818) 838-3926"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy", "401.0", "(818) 838-3946"], ["Los Angeles River at Sonia Sotomayor Learning Academies", "383.0", "(323) 276-5535"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies", "430.0", "(323) 276-5500"], ["Dr. Maya Angelou Community High", "363.0", "(323) 846-4700"], ["Public Service Community at Diego Rivera Learning Complex", "406.0", "(323) 846-2128"], ["Communication and Technology at Diego Rivera Learning Complex", "373.0", "(323) 846-2118"], ["Green Design at Diego Rivera Learning Complex", "375.0", "(323) 846-2108"], ["Performing Arts Community at Diego Rivera Learning Complex", "372.0", "(323) 846-2136"], ["Rancho Dominguez Preparatory", "420.0", "(310) 354-3400"], ["Synergy Quantum Academy", "419.0", "(323) 846-4716"], ["Animo College Preparatory Academy", "359.0", "(323) 568-4136"], ["Alliance Renee and Meyer Luskin Academy High", "364.0", "(323) 905-1210"], ["PUC Early College Academy for Leaders and Scholars (ECALS)", "401.0", "(323) 276-5525"], ["Alliance Margaret M. Bloomfield Technology Academy High", "None", "(323) 537-2060"], ["Leadership in Entertainment and Media Arts (LEMA)", "354.0", "None"], ["STEM Academy at Bernstein High", "399.0", "(323) 817-6461"], ["Academy of Science and Engineering", "None", "(323) 545-1100"], ["Augustus F. Hawkins High A Critical Design and Gaming", "354.0", "(323) 789-1282"], ["Augustus F. Hawkins High B Community Health Advocates", "366.0", "(323) 789-1282"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship", "346.0", "(323) 789-1282"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "431.0", "(323) 568-3800"], ["Linda Esperanza Marquez High B LIBRA Academy", "410.0", "(323) 584-3800"], ["Linda Esperanza Marquez High C School of Social Justice", "423.0", "(323) 584-3800"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex", "383.0", "(323) 357-7545"], ["Visual and Performing Arts at Legacy High School Complex", "386.0", "(323) 357-7500"], ["Academy for Multilingual Arts and Science at Mervyn M. Dymally High", "377.0", "(323) 565-4600"], ["Academies of Education and Empowerment at Carson High", "403.0", "(310) 847-1455"], ["Academy of Medical Arts at Carson High", "417.0", "(310) 847-1465"], ["Humanities and Arts (HARTS) Academy of Los Angeles", "425.0", "(310) 257-7100"], ["Contreras Learning Center-School of Social Justice", "383.0", "(213) 240-3800"], ["Early College Academy-LA Trade Tech College", "None", "(323) 763-3685"], ["Camino Nuevo High #2", "None", "(213) 736-5566"], ["Youth Opportunities Unlimited", "None", "(323) 789-4731"], ["Palisades Charter High", "525.0", "(310) 230-6623"], ["City of Angels", "501.0", "(323) 415-8350"], ["Los Angeles Leadership Academy", "425.0", "(323) 227-7719"], ["PUC Community Charter Middle and PUC Community Charter Early College High", "None", "(818) 485-0933"], ["Magnolia Science Academy", "470.0", "(818) 609-0507"], ["Marco Antonio Firebaugh High", "412.0", "(310) 886-5200"], ["Pathway Independent Study", "None", "(310) 603-1516"], ["Mountain Park", "468.0", "(626) 471-3014"], ["Applied Technology Center", "420.0", "(323) 248-2500"], ["Antelope Valley Learning Academy", "None", "(661) 952-6028"], ["Palmdale Aerospace Academy", "None", "(661) 273-3680"], ["Guidance Charter", "407.0", "(661) 285-1600"], ["Palos Verdes High", "564.0", "(310) 378-8471"], ["Paramount Alternative Education Center", "None", "None"], ["Aveson Global Leadership Academy", "None", "(626) 797-1438"], ["CIS Academy", "None", "(626) 396-5883"], ["Learning Works", "None", "(626) 564-2871"], ["School of Extended Educational Options", "None", "(909) 397-4900"], ["Diamond Ranch High", "472.0", "(909) 397-4715"], ["Village Academy High School at Indian Hill", "442.0", "(909) 397-4900"], ["Malibu High", "553.0", "(310) 457-6801"], ["California Virtual Academy @ Los Angeles", "521.0", "(805) 581-0202"], ["Edgewood High", "493.0", "(626) 939-0600"], ["Insight @ Los Angeles", "425.0", "None"], ["Golden Valley High", "500.0", "(661) 298-8140"], ["West Ranch High", "539.0", "(661) 222-1220"], ["Mission View Public", "None", "(661) 200-5595"], ["Santa Clarita Valley International", "443.0", "(661) 705-4820"], ["Albert Einstein Academy for Letters, Arts and Sciences", "None", "(661) 702-0755"], ["Valencia High", "528.0", "(661) 294-1188"], ["Opportunities for Learning - Santa Clarita", "489.0", "(661) 424-1337"], ["Academy of the Canyons", "596.0", "(661) 362-3056"], ["Thurgood Marshall", "None", "(310) 898-6340"], ["iQ Academy California-Los Angeles", "None", "(888) 997-4722"], ["Gabrielino High", "518.0", "(626) 573-2415"], ["Options for Youth San Gabriel", "455.0", "(626) 921-8200"], ["Del Mar High", "None", "(626) 291-5723"], ["Assurance Learning Academy", "None", "(661) 272-1225"], ["Inspire Charter School", "None", "(661) 269-2214"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "None", "(855) 937-4227"], ["SIATech Academy South", "None", "(760) 945-1227"], ["Vasquez High", "500.0", "(661) 269-0451"], ["Redondo Shores High (Continuation)", "None", "(310) 798-8690"], ["School of Arts and Enterprise", "473.0", "(909) 622-0699"], ["Lifeline Education Charter", "359.0", "(310) 605-2510"], ["Da Vinci Science", "467.0", "(310) 725-5800"], ["Da Vinci Design", "459.0", "(310) 725-5800"], ["Anahuacalmecac International University Preparatory of North America", "None", "None"], ["Madera County Independent Academy", "None", "(559) 662-4636"], ["Pioneer Technical Center", "None", "(559) 662-6294"], ["Madera South High", "414.0", "(559) 675-4450"], ["Sherman Thomas Charter High", "None", "(559) 675-6626"], ["Liberty High", "472.0", "(559) 645-3500"], ["Minarets High", "472.0", "(559) 868-8689"], ["Minarets Charter High", "463.0", "(559) 868-8659"], ["Chawanakee Academy", "None", "None"], ["Glacier High School Charter", "None", "(559) 642-1422"], ["San Andreas High (Continuation)", "None", "(415) 945-3751"], ["Ukiah Independent Study Academy", "None", "(707) 472-5062"], ["Redwood Academy of Ukiah", "540.0", "(707) 467-0500"], ["Accelerated Achievement Academy", "None", "(707) 463-7080"], ["New Horizons", "None", "(707) 459-4801"], ["Willits Charter", "None", "(707) 459-5506"], ["Merced Scholars Charter", "None", "(209) 381-5165"], ["Crossroads Alternative Education Center", "None", "(209) 826-4013"], ["Pacheco High", "441.0", "(209) 826-3801"], ["Golden Valley High", "436.0", "(209) 325-1800"], ["Buhach Colony High", "438.0", "(209) 325-1400"], ["Shattuck Independent Study", "None", "(209) 656-2012"], ["Delhi High", "419.0", "(209) 656-2050"], ["Urban Corps of San Diego County Charter", "None", "(619) 235-6884"], ["Orange County Conservation Corps Charter", "None", "(714) 956-6222"], ["Monterey County Home Charter", "None", "(831) 755-0331"], ["Greenfield High", "427.0", "(831) 674-2751"], ["Marina High", "454.0", "(831) 583-2060"], ["Learning for Life Charter", "None", "(831) 582-9820"], ["El Puente", "None", "(831) 796-7700"], ["Everett Alvarez High", "446.0", "(831) 796-7800"], ["Soledad High", "428.0", "(831) 678-6400"], ["Gonzales High", "425.0", "(831) 675-2495"], ["Napa Valley Independent Studies", "None", "(707) 259-8577"], ["American Canyon High", "470.0", "(707) 265-2710"], ["New Technology High", "500.0", "(707) 259-8557"], ["Bitney College Preparatory High", "482.0", "(530) 477-1235"], ["Forest Charter", "508.0", "(530) 265-4823"], ["EPIC de Cesar Chavez", "None", "(661) 822-4381"], ["John Muir Charter Schools", "None", "(530) 272-4008"], ["William & Marian Ghidotti High", "576.0", "(530) 274-5270"], ["Vantage Point Charter", "None", "(530) 432-5312"], ["OCCS:CHEP/PCHS", "528.0", "(714) 327-1000"], ["Oxford Academy", "634.0", "(714) 220-3055"], ["Capistrano Connections Academy", "512.0", "(949) 461-1667"], ["San Juan Hills High", "534.0", "(949) 234-5900"], ["California Preparatory Academy", "None", "(949) 234-5317"], ["Aliso Niguel High", "548.0", "(949) 831-5590"], ["Tesoro High", "545.0", "(949) 234-5310"], ["Opportunities for Learning - Capistrano", "None", "(949) 248-1282"], ["Early College High", "478.0", "(714) 241-6108"], ["OUSD Home Sch", "None", "(714) 628-5479"], ["Yorba Linda High", "543.0", "(714) 986-7500"], ["Parkview", "None", "(714) 986-7050"], ["Nova Academy", "448.0", "(714) 569-0948"], ["Segerstrom High", "463.0", "(714) 241-5000"], ["Hector G. Godinez", "433.0", "(714) 433-6790"], ["Cesar E. Chavez High", "None", "(714) 430-5700"], ["Middle College High", "483.0", "(714) 953-3900"], ["OCSA", "582.0", "(714) 560-9000"], ["Arnold O. Beckman High", "572.0", "(714) 734-2900"], ["Northwood High", "621.0", "(949) 936-7200"], ["CORE Placer Charter", "None", "(530) 346-8340"], ["John Adams Academy", "576.0", "(916) 780-6800"], ["Foresthill High", "490.0", "(530) 367-5244"], ["Antelope High", "469.0", "(916) 726-1400"], ["Woodcreek High", "501.0", "(916) 771-6565"], ["Granite Bay High", "551.0", "(916) 786-8676"], ["Cold Stream Alternative", "None", "(530) 582-2640"], ["Partnerships for Student-Centered Learning", "None", "(916) 408-5200"], ["Horizon Charter", "456.0", "(916) 408-5200"], ["Whitney High", "502.0", "(916) 632-6500"], ["Western Sierra Collegiate Academy", "547.0", "(916) 778-4544"], ["Rocklin Independent Charter Academy", "None", "(916) 632-3195"], ["Rocklin High", "527.0", "(916) 632-1600"], ["Victory High", "None", "(916) 632-3195"], ["Plumas Charter", "None", "(530) 283-3851"], ["River Springs Charter", "478.0", "(951) 252-8800"], ["Riverside County Education Academy", "None", "(951) 826-6602"], ["Come Back Kids", "None", "(951) 826-6461"], ["Gateway College and Career Academy", "None", "(951) 222-8931"], ["Alvord Alternative Continuation High", "None", "(951) 509-6021"], ["Banning Independent Study", "None", "(951) 922-0268"], ["21st Century Learning Institute", "None", "(951) 769-8424"], ["Eleanor Roosevelt High", "486.0", "(951) 738-2100"], ["John F. Kennedy High", "497.0", "(951) 738-2200"], ["Corona-Norco Alternative", "None", "(951) 736-3367"], ["Lee V. Pollard High", "None", "(951) 736-3367"], ["Santiago High", "499.0", "(951) 739-5600"], ["Shadow Hills High", "434.0", "(760) 393-5400"], ["La Quinta High", "462.0", "(760) 772-4150"], ["Horizon", "None", "(760) 238-9720"], ["Hamilton High", "481.0", "(951) 763-1865"], ["Tahquitz High", "445.0", "(951) 765-6300"], ["College Prep High", "463.0", "(951) 925-5155"], ["Patriot High", "463.0", "(951) 361-6500"], ["Rivercrest Preparatory", "None", "(951) 360-2660"], ["Santa Rosa Academy", "503.0", "(951) 672-2400"], ["Moreno Valley Online Academy", "None", "(951) 571-4800"], ["Vista del Lago High", "424.0", "(951) 571-4880"], ["Nuview Bridge Early College High", "471.0", "(951) 928-8498"], ["Desert Hot Springs High", "429.0", "(760) 288-7000"], ["California Military Institute", "423.0", "(951) 443-2731"], ["Heritage High", "444.0", "(951) 940-5447"], ["Paloma Valley High", "450.0", "(951) 672-6030"], ["Riverside Virtual", "None", "(951) 276-2006"], ["Martin Luther King Jr. High", "494.0", "(951) 789-5690"], ["Mountain Heights Academy", "None", "(951) 487-7710"], ["San Jacinto Valley Academy", "466.0", "(951) 654-6113"], ["Desert Mirage High", "414.0", "(760) 397-2255"], ["NOVA Academy - Coachella", "403.0", "(714) 569-0948"], ["Lakeside High", "454.0", "(951) 253-7300"], ["Keith McCarthy Academy", "None", "(951) 253-7777"], ["Southern California Online Academy", "None", "None"], ["Great Oak High", "505.0", "(951) 294-6450"], ["Susan H. Nelson", "None", "(951) 695-7360"], ["Chaparral High", "491.0", "(951) 695-4200"], ["Temecula Preparatory", "539.0", "(951) 926-6776"], ["Vista Murrieta High", "491.0", "(951) 894-5750"], ["Murrieta Canyon Academy", "None", "(951) 696-1661"], ["Murrieta Mesa High", "478.0", "(951) 677-0568"], ["Citrus Hill High", "405.0", "(951) 490-0400"], ["Val Verde Academy", "None", "(951) 443-2450"], ["Monterey Trail High", "444.0", "(916) 688-0050"], ["Pleasant Grove High", "513.0", "(916) 686-0230"], ["Cosumnes Oaks High", "491.0", "(916) 683-7670"], ["Laguna Creek High", "483.0", "(916) 683-1339"], ["Sheldon High", "472.0", "(916) 681-7500"], ["Franklin High", "512.0", "(916) 714-8150"], ["Elk Grove Charter", "None", "(916) 714-1653"], ["Vista del Lago High", "552.0", "(916) 294-2410"], ["Liberty Ranch High", "496.0", "(209) 744-4250"], ["New Technology High", "432.0", "(916) 395-5254"], ["George Washington Carver School of Arts and Science", "526.0", "(916) 395-5266"], ["The MET", "468.0", "(916) 395-5417"], ["Rosemont High", "452.0", "(916) 395-5130"], ["Sacramento Charter High", "403.0", "(916) 277-6200"], ["Arthur A. Benjamin Health Professions High", "449.0", "(916) 395-5010"], ["School of Engineering & Sciences", "420.0", "(916) 395-5040"], ["Capital City Independent Study", "None", "(916) 433-5187"], ["West Campus", "500.0", "(916) 277-6400"], ["Aspire Alexander Twilight Secondary Academy", "403.0", "(916) 979-1788"], ["Options for Youth-San Juan", "431.0", "(916) 485-5155"], ["Visions In Education", "533.0", "(916) 971-7037"], ["San Juan Choices Charter", "None", "(916) 979-8378"], ["Global Youth Charter", "None", "(916) 339-4680"], ["Antelope View Charter", "None", "None"], ["Inderkum High", "449.0", "(916) 567-5640"], ["Natomas Pacific Pathways Prep", "477.0", "(916) 567-5740"], ["Natomas High", "454.0", "(916) 641-4960"], ["Natomas Charter", "524.0", "(916) 928-5353"], ["Futures High", "489.0", "(916) 286-1902"], ["Heritage Peak Charter", "458.0", "(866) 992-9033"], ["Creative Connections Arts Academy", "None", "(916) 566-1870"], ["Community Collaborative Charter", "None", "(916) 286-5161"], ["SAVA: Sacramento Academic and Vocational Academy", "None", "(916) 387-8063"], ["Highlands Community Charter", "None", "(916) 844-2283"], ["Elwood J. Keema High", "None", "(916) 566-3410"], ["Vista Nueva Career and Technology High", "None", "(916) 566-2750"], ["Anzar High", "479.0", "(831) 623-7660"], ["Alta Vista Public", "None", "(760) 947-0006"], ["Chaffey District Online High", "None", "(909) 985-0966"], ["Rancho Cucamonga High", "489.0", "(909) 989-1600"], ["Los Osos High", "511.0", "(909) 477-6900"], ["Colony High", "450.0", "(909) 930-2929"], ["Chino Hills High", "508.0", "(909) 606-7540"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "441.0", "(909) 580-5006"], ["Summit High", "425.0", "(909) 357-5950"], ["Jurupa Hills High", "424.0", "(909) 357-6300"], ["Henry J. Kaiser High", "417.0", "(909) 357-5900"], ["Academy of Careers and Exploration", "462.0", "(760) 952-1266"], ["Empire Springs Charter", "None", "(951) 252-8800"], ["Independence Charter Academy", "None", "(760) 952-1760"], ["Alta Vista South Public Charter", "None", "(661) 272-1225"], ["Hope Academy Charter", "None", "None"], ["Mojave River Academy", "None", "(760) 245-3222"], ["Riverside Preparatory", "447.0", "(760) 243-5884"], ["Citrus Valley High", "473.0", "(909) 799-2300"], ["Redlands eAcademy", "None", "(909) 748-6941"], ["Redlands East Valley High", "498.0", "(909) 389-2500"], ["Grove", "535.0", "(909) 798-7831"], ["Wilmer Amina Carter High", "436.0", "(909) 854-4100"], ["Rialto High", "421.0", "(909) 421-7500"], ["ASA Charter", "None", "(909) 475-3322"], ["Public Safety Academy", "None", "(909) 382-2211"], ["Options for Youth-San Bernardino", "457.0", "(626) 685-9300"], ["Indian Springs High", "400.0", "(909) 383-1360"], ["Provisional Accelerated Learning Academy", "None", "(909) 887-7002"], ["Arroyo Valley High", "406.0", "(909) 381-4295"], ["Middle College High", "469.0", "(909) 888-4041"], ["University Preparatory", "500.0", "(760) 243-5940"], ["Adelanto High", "421.0", "(760) 246-3909"], ["Options for Youth-Victorville Charter", "419.0", "(626) 685-9300"], ["Excelsior Charter", "473.0", "(760) 245-4262"], ["Silverado High", "422.0", "(760) 955-3353"], ["Silver Valley Academy", "None", "(760) 254-2715"], ["Summit Leadership Academy-High Desert", "370.0", "(760) 949-9202"], ["Mirus Secondary", "None", "(760) 244-3764"], ["Encore Jr./Sr. High School for the Performing and Visual Arts", "486.0", "(760) 956-2632"], ["Oak Hills High", "450.0", "(760) 244-2283"], ["Sultana High", "448.0", "(760) 947-6777"], ["Shadow Ridge", "None", "(760) 949-8267"], ["Sky Mountain Charter", "None", "(530) 295-3566"], ["Granite Hills High", "479.0", "(760) 961-2290"], ["High Desert Premier Academy", "None", "(760) 240-4252"], ["Academy for Academic Excellence", "505.0", "(760) 946-5414"], ["San Pasqual Academy", "363.0", "(760) 233-6003"], ["Monarch", "None", "(619) 652-4100"], ["Literacy First Charter", "None", "(619) 579-7232"], ["Juan Bautista de Anza", "None", "(760) 767-5850"], ["Diego Springs Academy", "None", "(661) 272-1225"], ["Coronado Pathways Charter", "None", "None"], ["Diego Hills Charter", "None", "(619) 286-0312"], ["Dehesa Charter", "529.0", "(760) 743-7880"], ["Classical Academy High", "548.0", "(760) 480-9845"], ["Escondido Charter High", "513.0", "(760) 737-3154"], ["Oasis High (Alternative)", "None", "(760) 723-6395"], ["Steele Canyon High", "492.0", "(619) 660-3550"], ["Grossmont Middle College High", "525.0", "(619) 644-7524"], ["Helix High", "464.0", "(619) 466-4194"], ["Greater San Diego Academy", "None", "(619) 669-3050"], ["Diego Valley Charter", "None", "(619) 286-0312"], ["Julian Charter", "517.0", "(760) 765-3847"], ["National University Academy", "None", "(760) 631-5842"], ["River Valley Charter", "555.0", "(619) 390-2579"], ["San Diego Virtual", "None", "(619) 713-7271"], ["Pivot Charter School - San Diego", "None", "(760) 591-0217"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "None", "None"], ["Academy of Arts and Sciences", "None", "(855) 937-4227"], ["Del Norte High", "565.0", "(858) 487-0877"], ["Westview High", "581.0", "(858) 780-2000"], ["Future Bound Independent Study Secondary", "None", "(760) 787-2068"], ["Mountain Valley Academy", "None", "(760) 787-3600"], ["High Tech High International", "477.0", "(619) 243-5014"], ["Learning Choice Academy", "None", "(619) 463-6849"], ["San Diego International Studies", "523.0", "(619) 525-7464"], ["San Diego Business/Leadership", "402.0", "(619) 525-7461"], ["San Diego MVP Arts", "405.0", "None"], ["Kearny Digital Media & Design", "482.0", "(858) 496-8370"], ["Kearny SCT", "452.0", "(858) 496-8370"], ["Kearny College Connections", "450.0", "(858) 496-8370"], ["Kearny Eng, Innov & Design", "426.0", "(858) 496-8370"], ["Crawford High", "380.0", "(619) 362-3700"], ["San Diego Science and Technology", "423.0", "(619) 525-7459"], ["San Diego Metro Career and Tech", "489.0", "(619) 388-2299"], ["High Tech High Media Arts", "457.0", "(619) 398-8632"], ["Lincoln High", "389.0", "(619) 266-6500"], ["Health Sciences High", "422.0", "(619) 528-9070"], ["Arroyo Paseo Charter High", "None", "(619) 677-3017"], ["East Village High", "483.0", "(619) 525-2000"], ["King-Chavez Community High", "369.0", "(619) 704-1020"], ["Gompers Preparatory Academy", "363.0", "(619) 263-2171"], ["iHigh Virtual Academy", "None", "(619) 764-5440"], ["School for Entrepreneurship and Technology", "453.0", "(858) 874-4338"], ["Home & Hosp/Transition Support", "None", "(619) 344-6435"], ["Laurel Preparatory Academy", "None", "(858) 678-4812"], ["Scripps Ranch High", "564.0", "(858) 621-9020"], ["Charter School of San Diego", "479.0", "(858) 678-2020"], ["Preuss School UCSD", "520.0", "(858) 822-3000"], ["High Tech High", "477.0", "(619) 243-5014"], ["Audeo Charter", "483.0", "(858) 678-2050"], ["Canyon Crest Academy", "611.0", "(858) 350-0253"], ["La Costa Canyon High", "542.0", "(760) 436-6136"], ["Insight @ San Diego", "None", "(805) 581-0202"], ["California Virtual Academy @ San Diego", "517.0", "(805) 581-0202"], ["Olympian High", "476.0", "(619) 656-2400"], ["Eastlake High", "498.0", "(619) 397-3800"], ["Options Secondary", "None", "(619) 796-7320"], ["MAAC Community Charter", "None", "(619) 476-0749"], ["Alta Vista Academy", "None", "(619) 216-5160"], ["San Ysidro High", "431.0", "(619) 710-2300"], ["Otay Ranch Senior High", "474.0", "(619) 591-5000"], ["RAI Online Charter", "None", "None"], ["Taylion San Diego Academy", "None", "(760) 295-5564"], ["SIATech", "None", "(760) 945-1227"], ["North County Trade Tech High", "None", "(760) 598-0782"], ["Mission Vista High", "501.0", "(760) 758-6800"], ["Guajome Learning Center", "None", "(760) 631-8500"], ["Vista Visions Academy", "None", "(760) 724-4785"], ["Guajome Park Academy Charter", "531.0", "(760) 631-8500"], ["Carlsbad Seaside Academy", "None", "(760) 331-5299"], ["Pacific View Charter", "None", "(760) 757-0161"], ["Mission Hills High", "495.0", "(760) 290-2700"], ["Bayshore Preparatory Charter", "None", "(760) 471-0847"], ["Warner Junior/Senior High", "None", "(760) 782-3517"], ["Valley Center High", "474.0", "(760) 751-5502"], ["Valley Center Prep", "None", "(760) 751-0455"], ["High Tech High Chula Vista", "471.0", "(619) 243-5014"], ["High Tech High North County", "511.0", "(619) 243-5014"], ["Five Keys Charter (SF Sheriff's)", "None", "(415) 734-3310"], ["Jordan (June) School for Equity", "None", "(415) 452-4922"], ["City Arts and Tech High", "395.0", "(415) 841-2200"], ["Five Keys Adult School (SF Sheriff's)", "None", "(415) 734-3310"], ["Five Keys Independence HS (SF Sheriff's)", "None", "(415) 734-3310"], ["S.F. International High", "318.0", "(415) 695-5781"], ["Academy (The)- SF @McAteer", "456.0", "(415) 695-5700"], ["Gateway to College", "None", "(415) 452-5768"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "553.0", "(415) 695-5700"], ["Marshall (Thurgood) High", "364.0", "(415) 695-5612"], ["Leadership High", "408.0", "(415) 841-8910"], ["Gateway High", "483.0", "(415) 749-3600"], ["San Francisco Flex Academy", "502.0", "None"], ["one.Charter", "None", "(209) 468-9079"], ["San Joaquin Building Futures Academy", "None", "(209) 468-8140"], ["Venture Academy", "458.0", "(209) 468-5940"], ["Aspire Benjamin Holt College Preparatory Academy", "503.0", "(209) 955-1477"], ["Ronald E. McNair High", "436.0", "(209) 953-9245"], ["Rio Valley Charter", "None", "(209) 368-4934"], ["Independence", "None", "(209) 331-8275"], ["Middle College High", "565.0", "(209) 954-5790"], ["Weston Ranch High", "454.0", "(209) 938-6245"], ["New Vision High", "None", "(209) 938-6225"], ["Lathrop High", "432.0", "(209) 938-6350"], ["be.tech", "None", "(209) 858-7460"], ["Sierra High", "463.0", "(209) 858-7410"], ["Humphreys College Academy of Business, Law and Education", "424.0", "(209) 478-1600"], ["California Virtual Academy @ San Joaquin", "None", "(805) 581-0202"], ["Renew Virtual Academy K12 #1", "None", "None"], ["Delta Home Charter", "None", "(209) 830-6363"], ["Valley View Charter Prep", "None", "(916) 866-9033"], ["Delta Charter Online", "None", "(209) 830-6363"], ["Delta Charter", "468.0", "(209) 830-6363"], ["California Connections Academy @ Ripon", "535.0", "(209) 253-1208"], ["Cesar Chavez High", "417.0", "(209) 933-7480"], ["Edward C. Merlo Institute of Environmental Studies", "370.0", "(209) 933-7190"], ["Aspire Langston Hughes Academy", "408.0", "(209) 943-2389"], ["Stockton Unified Early College Academy", "519.0", "(209) 933-7370"], ["Stockton High", "None", "(209) 933-7365"], ["Stockton Collegiate International Secondary", "475.0", "(209) 390-9861"], ["Health Careers Academy", "418.0", "(209) 933-7360"], ["Pacific Law Academy", "None", "(209) 933-7475"], ["Weber Institute", "420.0", "(209) 933-7330"], ["Millennium Charter", "480.0", "(209) 831-5240"], ["John C. Kimball High", "500.0", "(209) 832-6600"], ["Merrill F. West High", "479.0", "(209) 830-3370"], ["Grizzly ChalleNGe Charter", "None", "(805) 782-6882"], ["Nipomo High", "490.0", "(805) 474-3300"], ["Templeton Independent Study High", "None", "(805) 434-5805"], ["Independence High", "None", "(805) 769-1620"], ["California Virtual Academy @ San Mateo", "None", "(805) 581-0202"], ["Aspire East Palo Alto Charter", "None", "None"], ["Peninsula High", "None", "(650) 558-2499"], ["Summit Preparatory Charter High", "522.0", "(650) 556-1110"], ["Everest Public High", "538.0", "(650) 366-1050"], ["East Palo Alto Academy", "403.0", "(650) 893-8900"], ["Family Partnership Home Study Charter", "None", "(805) 348-3333"], ["Los Olivos Charter School", "None", "None"], ["Orcutt Academy Charter", "492.0", "(805) 938-8900"], ["Pioneer Valley High", "451.0", "(805) 922-1305"], ["Alta Vista Alternative High", "558.0", "(805) 965-1916"], ["Leadership Public Schools - San Jose", "381.0", "None"], ["University Preparatory Academy Charter", "537.0", "(408) 723-1839"], ["Magnolia Science Academy Santa Clara", "None", "None"], ["Silicon Valley Flex Academy", "None", "None"], ["Summit Public School: Tahoma", "483.0", "(408) 729-1981"], ["Branham High", "540.0", "(408) 626-3407"], ["Escuela Popular/Center for Training and Careers, Family Learning", "None", "(408) 275-7191"], ["KIPP San Jose Collegiate", "482.0", "(408) 937-3752"], ["Summit Public School: Rainier", "493.0", "(408) 831-3104"], ["Calero High", "None", "(408) 347-7600"], ["Apollo High", "None", "(408) 928-5400"], ["Latino College Preparatory Academy", "380.0", "(408) 729-2281"], ["San Jose Conservation Corps Charter", "None", "(408) 459-6404"], ["Evergreen Valley High", "565.0", "(408) 347-7000"], ["Escuela Popular Accelerated Family Learning", "None", "(408) 275-7190"], ["Dr. TJ Owens Gilroy Early College Academy", "552.0", "(408) 846-4909"], ["Christopher High", "484.0", "(408) 848-7171"], ["Ann Sobrato High", "515.0", "(408) 201-6200"], ["Liberty High (Alternative)", "None", "(408) 535-6327"], ["Downtown College Preparatory", "None", "(408) 271-8120"], ["Middle College High", "None", "(408) 298-2181"], ["Pacific Collegiate Charter", "630.0", "(831) 479-7785"], ["Cypress Charter High", "506.0", "(831) 477-0302"], ["Pajaro Valley High", "430.0", "(831) 728-8102"], ["Ceiba College Preparatory Academy", "None", "(831) 728-6208"], ["Pacific Coast Charter", "None", "(831) 761-6021"], ["Ocean Grove Charter", "554.0", "(530) 295-3566"], ["SLVUSD Charter", "None", "(831) 335-0932"], ["Delta Charter", "None", "(831) 477-5212"], ["Alternative Family Education", "None", "(831) 429-3898"], ["Scotts Valley High", "547.0", "(831) 439-9555"], ["Anderson New Technology High", "None", "(530) 365-3100"], ["Stellar Secondary Charter High", "None", "(530) 245-7730"], ["University Preparatory", "551.0", "(530) 245-2790"], ["Shasta Charter Academy", "None", "(530) 245-2600"], ["North State Independence High", "None", "(530) 245-2760"], ["Northern Summit Academy", "None", "(530) 949-0154"], ["Academy of Personalized Learning", "None", "(530) 222-9280"], ["Gateway Educational Options", "None", "(530) 245-7960"], ["Golden Eagle Charter", "None", "(530) 926-5800"], ["Matt Garcia Career and College Academy", "None", "(707) 424-9400"], ["Angelo Rodriguez High", "489.0", "(707) 863-7950"], ["Elise P. Buckingham Charter Magnet High", "533.0", "(707) 453-7300"], ["Jesse M. Bethel High", "447.0", "(707) 556-5700"], ["MIT Academy", "None", "(707) 552-6482"], ["Geyserville New Tech Academy", "None", "(707) 857-3592"], ["Pathways Charter", "None", "(707) 585-6510"], ["California Virtual Academy @ Sonoma", "None", "(805) 581-0202"], ["Pivot Online Charter - North Bay", "None", "(707) 843-4676"], ["Gateway to College Academy", "None", "(707) 778-4621"], ["Valley Oaks High (Alternative)", "None", "(707) 778-4794"], ["Northwest Prep Charter", "None", "(707) 522-3320"], ["Roseland Charter", "410.0", "(707) 545-0102"], ["Abraxis Charter", "None", "(707) 539-2897"], ["Elsie Allen High", "457.0", "(707) 528-5020"], ["Maria Carrillo High", "563.0", "(707) 528-5790"], ["Orchard View", "None", "(707) 823-4709"], ["Credo High", "None", "(707) 664-0600"], ["Academy of Arts and Sciences: Sonoma", "None", "(855) 937-4227"], ["Technology High", "567.0", "(707) 792-4825"], ["Windsor High", "516.0", "(707) 837-7767"], ["Stanislaus Alternative Charter", "None", "(209) 238-6801"], ["Valley Charter High", "489.0", "(209) 238-6800"], ["Whitmore Charter High", "542.0", "(209) 556-1617"], ["Central Valley High", "433.0", "(209) 556-1900"], ["Endeavor Alternative", "None", "(209) 556-1805"], ["Denair Charter Academy", "None", "(209) 634-0917"], ["Hart-Ransom Academic Charter", "None", "(209) 523-0401"], ["Keyes to Learning Charter", "None", "(209) 634-6467"], ["James C. Enochs High", "487.0", "(209) 550-3400"], ["Aspire Vanguard College Preparatory Academy", "None", "(209) 521-3010"], ["Joseph A. Gregori High", "465.0", "(209) 550-3421"], ["Peter Johansen High", "435.0", "(209) 576-4702"], ["Oakdale Charter", "None", "(209) 848-4361"], ["Valley Oak Junior and Senior High", "None", "(209) 847-3097"], ["Waterford High", "465.0", "(209) 874-9060"], ["Connecting Waters Charter", "504.0", "(209) 874-9463"], ["eCademy Charter at Crane", "None", "(209) 669-3410"], ["Fusion Charter", "None", "(209) 667-0327"], ["John H. Pitman High", "480.0", "(209) 656-1592"], ["South Sutter Charter", "465.0", "(530) 295-3566"], ["California Virtual Academy @ Sutter", "None", "(805) 581-0202"], ["River Valley High", "479.0", "(530) 822-2500"], ["Yuba City Charter", "None", "(530) 822-9667"], ["Tehama eLearning Academy", "None", "(530) 527-0188"], ["University Preparatory High", "498.0", "(559) 730-2529"], ["La Sierra High", "None", "(559) 733-6963"], ["Eleanor Roosevelt Community Learning Center", "None", "(559) 592-9160"], ["California Connections Academy@Central", "None", "(559) 713-1324"], ["Summit Charter Academy", "None", "(559) 782-5902"], ["Burton Horizon Academy", "None", "(559) 782-4748"], ["Loma Vista Charter", "None", "(559) 562-5111"], ["Crescent Valley Public Charter", "None", "(559) 970-5894"], ["Mission Oak High", "435.0", "(559) 688-2021"], ["Sierra Vista Charter High", "None", "(559) 687-7384"], ["Visalia Charter Independent Study", "442.0", "(559) 735-8055"], ["Visalia Technical Early College", "None", "(559) 622-3212"], ["El Diamante High", "475.0", "(559) 735-3501"], ["Farmersville High", "400.0", "(559) 594-4567"], ["Butterfield Charter High", "None", "(559) 782-7057"], ["Harmony Magnet Academy", "464.0", "(559) 568-0347"], ["Granite Hills High", "433.0", "(559) 782-7075"], ["Prospect Education Center", "None", "(559) 782-7095"], ["Ronald Reagan Academy", "None", "(559) 595-0563"], ["California Virtual Academy @ Jamestown", "None", "(805) 581-0202"], ["Gold Rush Charter", "None", "(209) 532-9781"], ["Connections Visual and Performing Arts Academy", "None", "(209) 928-4228"], ["Vista Real Charter High", "None", "(805) 486-5449"], ["River Oaks Academy", "None", "(805) 777-7999"], ["Golden Valley Charter", "None", "(805) 642-3435"], ["Academy of Arts and Sciences: Thousand Oaks & Simi Valley", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: Oxnard & Ventura", "None", "None"], ["Architecture, Construction & Engineering Charter High (ACE)", "None", "(805) 437-1410"], ["Condor High", "None", "(805) 385-2552"], ["Pacifica High", "454.0", "(805) 278-5000"], ["Santa Susana High", "556.0", "(805) 520-6800"], ["El Camino High", "537.0", "(805) 289-7955"], ["Foothill Technology High", "530.0", "(805) 289-0023"], ["Century Academy", "None", "(805) 496-0286"], ["Oak Park Independent", "488.0", "(818) 735-3260"], ["IvyTech Charter", "None", "(805) 222-5188"], ["The High School at Moorpark College", "519.0", "(805) 378-1444"], ["Da Vinci Charter Academy", "558.0", "(530) 757-7154"], ["West Sacramento Early College Prep Charter", "None", "(916) 375-7680"], ["Pioneer High", "455.0", "(530) 406-1148"], ["Yuba County Career Preparatory Charter", "None", "(530) 749-4000"], ["Camptonville Academy", "None", "(530) 742-2786"], ["Marysville Charter Academy for the Arts", "484.0", "(530) 749-6156"]], "spark_error": null, "total_time": 16.0463809967041, "spark_time": 0.15799951553344727, "translation_time": 15.888381481170654, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='148c4ebc-7dfe-4aac-a25e-a72c16ae81d0'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='cec0f29b-81d5-4ae2-96bd-217d04e10f6b'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}", "Observation: content='The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n```sql\\nSELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\\n```' name='query_checker_sql_db' tool_call_id='3a8f1cca-a336-42c1-bc4a-bc6f81f66f75'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}"], "input_tokens": 3987, "output_tokens": 2564, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n```sql\nSELECT s.School, ss.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\n```", "final_answer": "", "replica": 6, "timestamp": 1768937765.31672}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": 0.0521004459047172, "spider_em": 0, "sparksql_query": "SELECT `s`.`School`, AVG(`ss`.`AvgScrWrite`) AS `AverageWritingScore`, `s`.`Phone` FROM `schools` AS `s` JOIN `satscores` AS `ss` ON `s`.`CDSCode` = `ss`.`cds` WHERE CAST(SUBSTRING(`s`.`OpenDate`, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(`s`.`ClosedDate`, 1, 4) AS INT) < 2000 GROUP BY `s`.`School`, `s`.`Phone` ORDER BY `AverageWritingScore` DESC", "execution_status": "VALID", "query_result": [["Oxford Academy", "634.0", "(714) 220-3055"], ["Pacific Collegiate Charter", "630.0", "(831) 479-7785"], ["Northwood High", "621.0", "(949) 936-7200"], ["Canyon Crest Academy", "611.0", "(858) 350-0253"], ["Academy of the Canyons", "596.0", "(661) 362-3056"], ["University High", "593.0", "(559) 278-8263"], ["OCSA", "582.0", "(714) 560-9000"], ["Westview High", "581.0", "(858) 780-2000"], ["Northcoast Preparatory and Performing Arts Academy", "579.0", "None"], ["William & Marian Ghidotti High", "576.0", "(530) 274-5270"], ["John Adams Academy", "576.0", "(916) 780-6800"], ["Arnold O. Beckman High", "572.0", "(714) 734-2900"], ["Technology High", "567.0", "(707) 792-4825"], ["Del Norte High", "565.0", "(858) 487-0877"], ["Middle College High", "565.0", "(209) 954-5790"], ["Evergreen Valley High", "565.0", "(408) 347-7000"], ["Palos Verdes High", "564.0", "(310) 378-8471"], ["Scripps Ranch High", "564.0", "(858) 621-9020"], ["Maria Carrillo High", "563.0", "(707) 528-5790"], ["Alta Vista Alternative High", "558.0", "(805) 965-1916"], ["Da Vinci Charter Academy", "558.0", "(530) 757-7154"], ["Santa Susana High", "556.0", "(805) 520-6800"], ["River Valley Charter", "555.0", "(619) 390-2579"], ["Ocean Grove Charter", "554.0", "(530) 295-3566"], ["Malibu High", "553.0", "(310) 457-6801"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "553.0", "(415) 695-5700"], ["Vista del Lago High", "552.0", "(916) 294-2410"], ["Dr. TJ Owens Gilroy Early College Academy", "552.0", "(408) 846-4909"], ["Granite Bay High", "551.0", "(916) 786-8676"], ["University Preparatory", "551.0", "(530) 245-2790"], ["Aliso Niguel High", "548.0", "(949) 831-5590"], ["Classical Academy High", "548.0", "(760) 480-9845"], ["Western Sierra Collegiate Academy", "547.0", "(916) 778-4544"], ["Scotts Valley High", "547.0", "(831) 439-9555"], ["Tesoro High", "545.0", "(949) 234-5310"], ["Yorba Linda High", "543.0", "(714) 986-7500"], ["La Costa Canyon High", "542.0", "(760) 436-6136"], ["Whitmore Charter High", "542.0", "(209) 556-1617"], ["Redwood Academy of Ukiah", "540.0", "(707) 467-0500"], ["Branham High", "540.0", "(408) 626-3407"], ["Anderson W. Clark Magnet High", "539.0", "(818) 248-8324"], ["West Ranch High", "539.0", "(661) 222-1220"], ["Temecula Preparatory", "539.0", "(951) 926-6776"], ["Everest Public High", "538.0", "(650) 366-1050"], ["El Camino High", "537.0", "(805) 289-7955"], ["University Preparatory Academy Charter", "537.0", "(408) 723-1839"], ["Grove", "535.0", "(909) 798-7831"], ["California Connections Academy @ Ripon", "535.0", "(209) 253-1208"], ["San Juan Hills High", "534.0", "(949) 234-5900"], ["Visions In Education", "533.0", "(916) 971-7037"], ["Elise P. Buckingham Charter Magnet High", "533.0", "(707) 453-7300"], ["Guajome Park Academy Charter", "531.0", "(760) 631-8500"], ["Foothill Technology High", "530.0", "(805) 289-0023"], ["Dehesa Charter", "529.0", "(760) 743-7880"], ["OCCS:CHEP/PCHS", "528.0", "(714) 327-1000"], ["Valencia High", "528.0", "(661) 294-1188"], ["Rocklin High", "527.0", "(916) 632-1600"], ["George Washington Carver School of Arts and Science", "526.0", "(916) 395-5266"], ["Palisades Charter High", "525.0", "(310) 230-6623"], ["Grossmont Middle College High", "525.0", "(619) 644-7524"], ["Academy of the Redwoods", "524.0", "(707) 476-4203"], ["Natomas Charter", "524.0", "(916) 928-5353"], ["San Diego International Studies", "523.0", "(619) 525-7464"], ["Summit Preparatory Charter High", "522.0", "(650) 556-1110"], ["California Virtual Academy @ Los Angeles", "521.0", "(805) 581-0202"], ["Preuss School UCSD", "520.0", "(858) 822-3000"], ["Clovis North High", "519.0", "(559) 327-5000"], ["The High School at Moorpark College", "519.0", "(805) 378-1444"], ["Stockton Unified Early College Academy", "519.0", "(209) 933-7370"], ["Gabrielino High", "518.0", "(626) 573-2415"], ["California Virtual Academy @ San Diego", "517.0", "(805) 581-0202"], ["Julian Charter", "517.0", "(760) 765-3847"], ["Windsor High", "516.0", "(707) 837-7767"], ["Ann Sobrato High", "515.0", "(408) 201-6200"], ["Pleasant Grove High", "513.0", "(916) 686-0230"], ["Escondido Charter High", "513.0", "(760) 737-3154"], ["Capistrano Connections Academy", "512.0", "(949) 461-1667"], ["Franklin High", "512.0", "(916) 714-8150"], ["High Tech High North County", "511.0", "(619) 243-5014"], ["Los Osos High", "511.0", "(909) 477-6900"], ["Harbor Teacher Preparation Academy", "509.0", "(310) 834-3932"], ["Forest Charter", "508.0", "(530) 265-4823"], ["High Tech LA", "508.0", "(818) 609-2640"], ["Chino Hills High", "508.0", "(909) 606-7540"], ["Buchanan High", "507.0", "(559) 327-3000"], ["Renaissance Arts Academy", "506.0", "(323) 259-5700"], ["Cypress Charter High", "506.0", "(831) 477-0302"], ["Academy for Academic Excellence", "505.0", "(760) 946-5414"], ["Great Oak High", "505.0", "(951) 294-6450"], ["Connecting Waters Charter", "504.0", "(209) 874-9463"], ["Santa Rosa Academy", "503.0", "(951) 672-2400"], ["Aspire Benjamin Holt College Preparatory Academy", "503.0", "(209) 955-1477"], ["Valley Oaks Charter", "502.0", "(661) 852-6700"], ["Whitney High", "502.0", "(916) 632-6500"], ["San Francisco Flex Academy", "502.0", "None"], ["Liberty High", "501.0", "(661) 587-0925"], ["City of Angels", "501.0", "(323) 415-8350"], ["Mission Vista High", "501.0", "(760) 758-6800"], ["Woodcreek High", "501.0", "(916) 771-6565"], ["Golden Valley High", "500.0", "(661) 298-8140"], ["Vasquez High", "500.0", "(661) 269-0451"], ["New Technology High", "500.0", "(707) 259-8557"], ["West Campus", "500.0", "(916) 277-6400"], ["University Preparatory", "500.0", "(760) 243-5940"], ["John C. Kimball High", "500.0", "(209) 832-6600"], ["Santiago High", "499.0", "(951) 739-5600"], ["Redlands East Valley High", "498.0", "(909) 389-2500"], ["Eastlake High", "498.0", "(619) 397-3800"], ["University Preparatory High", "498.0", "(559) 730-2529"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing", "497.0", "(818) 994-7614"], ["John F. Kennedy High", "497.0", "(951) 738-2200"], ["SOAR High (Students On Academic Rise)", "496.0", "(661) 722-6300"], ["Liberty Ranch High", "496.0", "(209) 744-4250"], ["International Polytechnic High", "495.0", "(909) 839-2320"], ["Mission Hills High", "495.0", "(760) 290-2700"], ["Martin Luther King Jr. High", "494.0", "(951) 789-5690"], ["Edgewood High", "493.0", "(626) 939-0600"], ["Summit Public School: Rainier", "493.0", "(408) 831-3104"], ["Hawthorne Math and Science Academy", "492.0", "(310) 973-8184"], ["Steele Canyon High", "492.0", "(619) 660-3550"], ["Orcutt Academy Charter", "492.0", "(805) 938-8900"], ["Vista Murrieta High", "491.0", "(951) 894-5750"], ["Cosumnes Oaks High", "491.0", "(916) 683-7670"], ["Chaparral High", "491.0", "(951) 695-4200"], ["Foresthill High", "490.0", "(530) 367-5244"], ["Nipomo High", "490.0", "(805) 474-3300"], ["Centennial High", "489.0", "(661) 588-8601"], ["Opportunities for Learning - Santa Clarita", "489.0", "(661) 424-1337"], ["Futures High", "489.0", "(916) 286-1902"], ["Rancho Cucamonga High", "489.0", "(909) 989-1600"], ["San Diego Metro Career and Tech", "489.0", "(619) 388-2299"], ["Valley Charter High", "489.0", "(209) 238-6800"], ["Angelo Rodriguez High", "489.0", "(707) 863-7950"], ["Oak Park Independent", "488.0", "(818) 735-3260"], ["Port of Los Angeles High", "487.0", "(310) 832-9201"], ["James C. Enochs High", "487.0", "(209) 550-3400"], ["Eleanor Roosevelt High", "486.0", "(951) 738-2100"], ["Encore Jr./Sr. High School for the Performing and Visual Arts", "486.0", "(760) 956-2632"], ["Christopher High", "484.0", "(408) 848-7171"], ["Marysville Charter Academy for the Arts", "484.0", "(530) 749-6156"], ["Renaissance High School for the Arts", "483.0", "(562) 901-0168"], ["East Village High", "483.0", "(619) 525-2000"], ["Audeo Charter", "483.0", "(858) 678-2050"], ["Gateway High", "483.0", "(415) 749-3600"], ["Middle College High", "483.0", "(714) 953-3900"], ["Laguna Creek High", "483.0", "(916) 683-1339"], ["Summit Public School: Tahoma", "483.0", "(408) 729-1981"], ["Bitney College Preparatory High", "482.0", "(530) 477-1235"], ["Kearny Digital Media & Design", "482.0", "(858) 496-8370"], ["KIPP San Jose Collegiate", "482.0", "(408) 937-3752"], ["Hamilton High", "481.0", "(951) 763-1865"], ["Millennium Charter", "480.0", "(209) 831-5240"], ["John H. Pitman High", "480.0", "(209) 656-1592"], ["Granite Hills High", "479.0", "(760) 961-2290"], ["Anzar High", "479.0", "(831) 623-7660"], ["Charter School of San Diego", "479.0", "(858) 678-2020"], ["River Valley High", "479.0", "(530) 822-2500"], ["Merrill F. West High", "479.0", "(209) 830-3370"], ["Early College High", "478.0", "(714) 241-6108"], ["River Springs Charter", "478.0", "(951) 252-8800"], ["Murrieta Mesa High", "478.0", "(951) 677-0568"], ["High Tech High International", "477.0", "(619) 243-5014"], ["Natomas Pacific Pathways Prep", "477.0", "(916) 567-5740"], ["High Tech High", "477.0", "(619) 243-5014"], ["Olympian High", "476.0", "(619) 656-2400"], ["Frontier High", "475.0", "(661) 829-1107"], ["El Diamante High", "475.0", "(559) 735-3501"], ["Stockton Collegiate International Secondary", "475.0", "(209) 390-9861"], ["Otay Ranch Senior High", "474.0", "(619) 591-5000"], ["Valley Center High", "474.0", "(760) 751-5502"], ["School of Arts and Enterprise", "473.0", "(909) 622-0699"], ["Gorman Learning Center", "473.0", "(909) 307-6312"], ["Citrus Valley High", "473.0", "(909) 799-2300"], ["Excelsior Charter", "473.0", "(760) 245-4262"], ["Six Rivers Charter High", "472.0", "(707) 825-2428"], ["Liberty High", "472.0", "(559) 645-3500"], ["Minarets High", "472.0", "(559) 868-8689"], ["Diamond Ranch High", "472.0", "(909) 397-4715"], ["Sheldon High", "472.0", "(916) 681-7500"], ["High Tech High Chula Vista", "471.0", "(619) 243-5014"], ["Nuview Bridge Early College High", "471.0", "(951) 928-8498"], ["Magnolia Science Academy", "470.0", "(818) 609-0507"], ["Daniel Pearl Journalism & Communications Magnet", "470.0", "(818) 654-3775"], ["American Canyon High", "470.0", "(707) 265-2710"], ["Middle College High", "469.0", "(909) 888-4041"], ["Antelope High", "469.0", "(916) 726-1400"], ["Southwest High", "468.0", "(760) 336-4100"], ["Design Science Early College High", "468.0", "(559) 248-7353"], ["Mountain Park", "468.0", "(626) 471-3014"], ["The MET", "468.0", "(916) 395-5417"], ["Delta Charter", "468.0", "(209) 830-6363"], ["Da Vinci Science", "467.0", "(310) 725-5800"], ["San Jacinto Valley Academy", "466.0", "(951) 654-6113"], ["South Sutter Charter", "465.0", "(530) 295-3566"], ["Joseph A. Gregori High", "465.0", "(209) 550-3421"], ["Waterford High", "465.0", "(209) 874-9060"], ["Lemoore Middle College High", "464.0", "(559) 925-3552"], ["Options for Youth-Burbank Charter", "464.0", "(818) 566-7525"], ["Sierra Pacific High", "464.0", "(559) 583-5912"], ["Northridge Academy High", "464.0", "(818) 700-2222"], ["Helix High", "464.0", "(619) 466-4194"], ["Harmony Magnet Academy", "464.0", "(559) 568-0347"], ["Independence High", "463.0", "(661) 834-8001"], ["Minarets Charter High", "463.0", "(559) 868-8659"], ["Patriot High", "463.0", "(951) 361-6500"], ["Segerstrom High", "463.0", "(714) 241-5000"], ["College Prep High", "463.0", "(951) 925-5155"], ["Sierra High", "463.0", "(209) 858-7410"], ["La Quinta High", "462.0", "(760) 772-4150"], ["Academy of Careers and Exploration", "462.0", "(760) 952-1266"], ["Hallmark Charter", "460.0", "(559) 524-7170"], ["Da Vinci Design", "459.0", "(310) 725-5800"], ["Heritage Peak Charter", "458.0", "(866) 992-9033"], ["Venture Academy", "458.0", "(209) 468-5940"], ["International Studies Learning Center at Legacy High School Complex", "457.0", "(323) 357-7521"], ["Options for Youth-San Bernardino", "457.0", "(626) 685-9300"], ["High Tech High Media Arts", "457.0", "(619) 398-8632"], ["Elsie Allen High", "457.0", "(707) 528-5020"], ["Horizon Charter", "456.0", "(916) 408-5200"], ["Academy (The)- SF @McAteer", "456.0", "(415) 695-5700"], ["Clovis East High", "455.0", "(559) 327-4000"], ["Options for Youth San Gabriel", "455.0", "(626) 921-8200"], ["Pioneer High", "455.0", "(530) 406-1148"], ["Marina High", "454.0", "(831) 583-2060"], ["Lakeside High", "454.0", "(951) 253-7300"], ["Natomas High", "454.0", "(916) 641-4960"], ["Pacifica High", "454.0", "(805) 278-5000"], ["Weston Ranch High", "454.0", "(209) 938-6245"], ["School for Entrepreneurship and Technology", "453.0", "(858) 874-4338"], ["Rosemont High", "452.0", "(916) 395-5130"], ["Kearny SCT", "452.0", "(858) 496-8370"], ["Pioneer Valley High", "451.0", "(805) 922-1305"], ["Hanford West High", "450.0", "(559) 583-5903"], ["Paloma Valley High", "450.0", "(951) 672-6030"], ["Oak Hills High", "450.0", "(760) 244-2283"], ["Colony High", "450.0", "(909) 930-2929"], ["Kearny College Connections", "450.0", "(858) 496-8370"], ["Central High East Campus", "449.0", "(559) 276-0280"], ["Lancaster High", "449.0", "(661) 726-7649"], ["Robert F. Kennedy High", "449.0", "(661) 720-5117"], ["Inderkum High", "449.0", "(916) 567-5640"], ["Arthur A. Benjamin Health Professions High", "449.0", "(916) 395-5010"], ["Animo Inglewood Charter High", "448.0", "(310) 673-0956"], ["Sultana High", "448.0", "(760) 947-6777"], ["Nova Academy", "448.0", "(714) 569-0948"], ["Opportunities for Learning - Baldwin Park", "447.0", "(626) 814-0161"], ["Math, Science, & Technology Magnet Academy at Roosevelt High", "447.0", "(323) 780-6500"], ["Riverside Preparatory", "447.0", "(760) 243-5884"], ["Jesse M. Bethel High", "447.0", "(707) 556-5700"], ["Environmental Charter High", "446.0", "(310) 214-3400"], ["Ramon C. Cortines School of Visual and Performing Arts", "446.0", "(213) 217-8600"], ["Everett Alvarez High", "446.0", "(831) 796-7800"], ["Tahquitz High", "445.0", "(951) 765-6300"], ["Orthopaedic Hospital", "444.0", "(213) 765-2088"], ["Alliance Leichtman-Levine Family Foundation Environmental Science High", "444.0", "(323) 739-0560"], ["Monterey Trail High", "444.0", "(916) 688-0050"], ["Heritage High", "444.0", "(951) 940-5447"], ["Frazier Mountain High", "443.0", "(661) 248-0310"], ["Santa Clarita Valley International", "443.0", "(661) 705-4820"], ["William J. (Pete) Knight High", "442.0", "(661) 533-9000"], ["Village Academy High School at Indian Hill", "442.0", "(909) 397-4900"], ["City Honors College Preparatory Academy", "442.0", "(310) 680-4880"], ["Visalia Charter Independent Study", "442.0", "(559) 735-8055"], ["Pacheco High", "441.0", "(209) 826-3801"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "441.0", "(909) 580-5006"], ["Valley Academy of Arts and Sciences", "440.0", "(818) 832-7750"], ["Cesar E. Chavez High", "439.0", "(661) 720-4501"], ["South East High", "439.0", "(323) 568-3400"], ["Alliance Marc & Eva Stern Math and Science", "439.0", "(323) 987-2144"], ["Buhach Colony High", "438.0", "(209) 325-1400"], ["PUC CA Academy for Liberal Studies Early College High", "437.0", "None"], ["Golden Valley High", "436.0", "(209) 325-1800"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex", "436.0", "(213) 745-8141"], ["Wilmer Amina Carter High", "436.0", "(909) 854-4100"], ["Ronald E. McNair High", "436.0", "(209) 953-9245"], ["Bright Star Secondary Charter Academy", "435.0", "(424) 789-8337"], ["Middle College High", "435.0", "(323) 418-4700"], ["Peter Johansen High", "435.0", "(209) 576-4702"], ["Mission Oak High", "435.0", "(559) 688-2021"], ["Shadow Hills High", "434.0", "(760) 393-5400"], ["Hector G. Godinez", "433.0", "(714) 433-6790"], ["Central Valley High", "433.0", "(209) 556-1900"], ["Granite Hills High", "433.0", "(559) 782-7075"], ["New Technology High", "432.0", "(916) 395-5254"], ["Lathrop High", "432.0", "(209) 938-6350"], ["Ivy Academia", "431.0", "(818) 716-0771"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "431.0", "(323) 568-3800"], ["San Ysidro High", "431.0", "(619) 710-2300"], ["Options for Youth-San Juan", "431.0", "(916) 485-5155"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies", "430.0", "(323) 276-5500"], ["Pajaro Valley High", "430.0", "(831) 728-8102"], ["Desert Hot Springs High", "429.0", "(760) 288-7000"], ["Soledad High", "428.0", "(831) 678-6400"], ["Los Angeles International Charter High", "428.0", "(323) 257-1499"], ["South El Monte High", "427.0", "(626) 442-0218"], ["Greenfield High", "427.0", "(831) 674-2751"], ["Magnolia Science Academy 2", "427.0", "(818) 758-0300"], ["Kearny Eng, Innov & Design", "426.0", "(858) 496-8370"], ["Opportunities For Learning - Baldwin Park II", "426.0", "(626) 962-3311"], ["Gonzales High", "425.0", "(831) 675-2495"], ["Insight @ Los Angeles", "425.0", "None"], ["Los Angeles Leadership Academy", "425.0", "(323) 227-7719"], ["Humanities and Arts (HARTS) Academy of Los Angeles", "425.0", "(310) 257-7100"], ["Summit High", "425.0", "(909) 357-5950"], ["Jurupa Hills High", "424.0", "(909) 357-6300"], ["Vista del Lago High", "424.0", "(951) 571-4880"], ["Humphreys College Academy of Business, Law and Education", "424.0", "(209) 478-1600"], ["Golden Valley High", "424.0", "(661) 827-0800"], ["California City High", "424.0", "(760) 373-5263"], ["Linda Esperanza Marquez High C School of Social Justice", "423.0", "(323) 584-3800"], ["Lawndale High", "423.0", "(310) 263-3102"], ["San Diego Science and Technology", "423.0", "(619) 525-7459"], ["California Military Institute", "423.0", "(951) 443-2731"], ["Silverado High", "422.0", "(760) 955-3353"], ["Health Sciences High", "422.0", "(619) 528-9070"], ["Rialto High", "421.0", "(909) 421-7500"], ["Adelanto High", "421.0", "(760) 246-3909"], ["Ridgeview High", "421.0", "(661) 398-3100"], ["Applied Technology Center", "420.0", "(323) 248-2500"], ["Maywood Academy High", "420.0", "(323) 838-6000"], ["Rancho Dominguez Preparatory", "420.0", "(310) 354-3400"], ["School of Engineering & Sciences", "420.0", "(916) 395-5040"], ["Weber Institute", "420.0", "(209) 933-7330"], ["Delhi High", "419.0", "(209) 656-2050"], ["Synergy Quantum Academy", "419.0", "(323) 846-4716"], ["Options for Youth-Victorville Charter", "419.0", "(626) 685-9300"], ["Magnolia Science Academy 3", "418.0", "(310) 637-3806"], ["Lennox Mathematics, Science and Technology Academy", "418.0", "(310) 680-5600"], ["Health Careers Academy", "418.0", "(209) 933-7360"], ["Academy of Medical Arts at Carson High", "417.0", "(310) 847-1465"], ["Henry J. Kaiser High", "417.0", "(909) 357-5900"], ["Cesar Chavez High", "417.0", "(209) 933-7480"], ["Wallis Annenberg High", "416.0", "(323) 235-6343"], ["Animo Leadership High", "416.0", "(310) 216-3277"], ["East Valley Senior High", "415.0", "(818) 753-4400"], ["Animo Venice Charter High", "414.0", "(310) 392-8751"], ["Madera South High", "414.0", "(559) 675-4450"], ["Desert Mirage High", "414.0", "(760) 397-2255"], ["Camino Nuevo Charter High", "413.0", "(213) 240-8700"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)", "413.0", "(818) 838-3926"], ["Ambassador-Global Leadership", "412.0", "(213) 480-4540"], ["Marco Antonio Firebaugh High", "412.0", "(310) 886-5200"], ["New Designs Charter", "411.0", "(213) 765-9084"], ["Panorama High", "411.0", "(818) 909-4500"], ["Linda Esperanza Marquez High B LIBRA Academy", "410.0", "(323) 584-3800"], ["Roseland Charter", "410.0", "(707) 545-0102"], ["Los Angeles High School of the Arts", "409.0", "(213) 480-4600"], ["Eastside High", "409.0", "(661) 946-3800"], ["Edward R. Roybal Learning Center", "408.0", "(213) 580-6400"], ["Alliance Judy Ivie Burton Technology Academy High", "408.0", "(323) 920-6125"], ["Leadership High", "408.0", "(415) 841-8910"], ["Aspire Langston Hughes Academy", "408.0", "(209) 943-2389"], ["Guidance Charter", "407.0", "(661) 285-1600"], ["Alliance Dr. Olga Mohan High", "407.0", "(213) 342-2870"], ["Public Service Community at Diego Rivera Learning Complex", "406.0", "(323) 846-2128"], ["Arroyo Valley High", "406.0", "(909) 381-4295"], ["Magnolia Science Academy 4", "405.0", "(310) 473-2464"], ["San Diego MVP Arts", "405.0", "None"], ["Citrus Hill High", "405.0", "(951) 490-0400"], ["Orange Cove High", "405.0", "(559) 626-5900"], ["Central City Value", "404.0", "(213) 471-4686"], ["Academies of Education and Empowerment at Carson High", "403.0", "(310) 847-1455"], ["School of Business and Tourism at Contreras Learning Complex", "403.0", "(213) 240-3800"], ["NOVA Academy - Coachella", "403.0", "(714) 569-0948"], ["Aspire Alexander Twilight Secondary Academy", "403.0", "(916) 979-1788"], ["Sacramento Charter High", "403.0", "(916) 277-6200"], ["East Palo Alto Academy", "403.0", "(650) 893-8900"], ["Mira Monte High", "403.0", "(661) 366-1800"], ["San Diego Business/Leadership", "402.0", "(619) 525-7461"], ["New Open World Academy K-12", "402.0", "(213) 480-3700"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy", "401.0", "(818) 838-3946"], ["PUC Early College Academy for Leaders and Scholars (ECALS)", "401.0", "(323) 276-5525"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy", "401.0", "(818) 838-3915"], ["Indian Springs High", "400.0", "(909) 383-1360"], ["Farmersville High", "400.0", "(559) 594-4567"], ["Sunnyside High", "399.0", "(559) 253-6700"], ["STEM Academy at Bernstein High", "399.0", "(323) 817-6461"], ["Oscar De La Hoya Animo Charter High", "398.0", "(323) 780-1259"], ["Alliance Ouchi-O'Donovan 6-12 Complex", "397.0", "(323) 596-2290"], ["Arleta High", "397.0", "(818) 686-4100"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3", "395.0", "(323) 285-6795"], ["City Arts and Tech High", "395.0", "(415) 841-2200"], ["School for the Visual Arts and Humanities", "394.0", "(213) 480-4700"], ["Aspire Pacific Academy", "394.0", "(323) 589-2800"], ["Alliance Piera Barabaglia Shaheen Health Services Academy", "393.0", "(323) 972-9010"], ["UCLA Community K-12", "392.0", "(213) 480-3750"], ["Helen Bernstein High", "391.0", "(323) 817-6460"], ["PUC Lakeview Charter High", "390.0", "(818) 356-2591"], ["Alliance Collins Family College-Ready High", "390.0", "(323) 923-1588"], ["Environmental and Social Policy Magnet", "390.0", "(323) 441-4577"], ["Contreras Learning Center-Academic Leadership Community", "390.0", "(213) 240-3815"], ["Lincoln High", "389.0", "(619) 266-6500"], ["Cabrillo High", "388.0", "(562) 951-7700"], ["New Millennium Secondary", "388.0", "(310) 999-6162"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2", "388.0", "(323) 265-6760"], ["Los Angeles Academy of Arts & Enterprise Charter", "388.0", "(213) 487-0600"], ["Animo Ralph Bunche Charter High", "387.0", "(323) 232-9436"], ["Visual and Performing Arts at Legacy High School Complex", "386.0", "(323) 357-7500"], ["Alliance Patti And Peter Neuwirth Leadership Academy", "386.0", "(213) 342-2874"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4", "386.0", "(323) 265-6830"], ["Sun Valley High", "385.0", "(818) 394-4600"], ["West Adams Preparatory High", "385.0", "(323) 373-2500"], ["Alliance Tennenbaum Family Technology High", "385.0", "(323) 276-5545"], ["Contreras Learning Center-School of Social Justice", "383.0", "(213) 240-3800"], ["Los Angeles River at Sonia Sotomayor Learning Academies", "383.0", "(323) 276-5535"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex", "383.0", "(323) 357-7545"], ["Santee Education Complex", "382.0", "(213) 763-1000"], ["Felicitas and Gonzalo Mendez High", "382.0", "(323) 981-6100"], ["View Park Preparatory Accelerated High", "382.0", "(323) 290-6975"], ["Crenshaw Arts-Technology Charter High", "381.0", "(323) 293-3917"], ["Leadership Public Schools - San Jose", "381.0", "None"], ["Crawford High", "380.0", "(619) 362-3700"], ["Latino College Preparatory Academy", "380.0", "(408) 729-2281"], ["Mendota High", "378.0", "(559) 655-1993"], ["Esteban Torres East LA Performing Arts Magnet", "378.0", "(323) 265-6725"], ["Frederick Douglass Academy High", "378.0", "None"], ["Alliance Ted K. Tajima High", "378.0", "(213) 241-8533"], ["Contreras Learning Center-Los Angeles School of Global Studies", "378.0", "(213) 240-3850"], ["Wonderful College Prep Academy", "377.0", "(661) 454-3000"], ["Animo Pat Brown", "377.0", "(323) 585-3312"], ["Animo Jackie Robinson High", "377.0", "(323) 846-5800"], ["Academy for Multilingual Arts and Science at Mervyn M. Dymally High", "377.0", "(323) 565-4600"], ["Animo South Los Angeles Charter", "376.0", "(323) 779-0544"], ["Alliance Morgan McKinzie High", "375.0", "(323) 859-0750"], ["Green Design at Diego Rivera Learning Complex", "375.0", "(323) 846-2108"], ["New Village Girls Academy", "374.0", "(213) 385-4015"], ["Discovery Charter Preparatory School #2", "373.0", "(818) 897-1187"], ["Communication and Technology at Diego Rivera Learning Complex", "373.0", "(323) 846-2118"], ["Performing Arts Community at Diego Rivera Learning Complex", "372.0", "(323) 846-2136"], ["Student Empowerment Academy", "372.0", "None"], ["New Designs Charter School-Watts", "371.0", "(323) 418-0600"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5", "371.0", "(323) 265-6865"], ["Summit Leadership Academy-High Desert", "370.0", "(760) 949-9202"], ["Edward C. Merlo Institute of Environmental Studies", "370.0", "(209) 933-7190"], ["Cesar E. Chavez Learning Academy - Arts/Theatre/Entertain Mag", "369.0", "(818) 837-6428"], ["King-Chavez Community High", "369.0", "(619) 704-1020"], ["APEX Academy", "368.0", "(323) 817-6550"], ["Augustus F. Hawkins High B Community Health Advocates", "366.0", "(323) 789-1282"], ["Alliance Cindy and Bill Simon Technology Academy High", "364.0", "(323) 744-2122"], ["Alain Leroy Locke College Preparatory Academy", "364.0", "(323) 420-2100"], ["Alliance Renee and Meyer Luskin Academy High", "364.0", "(323) 905-1210"], ["Marshall (Thurgood) High", "364.0", "(415) 695-5612"], ["Dr. Maya Angelou Community High", "363.0", "(323) 846-4700"], ["San Pasqual Academy", "363.0", "(760) 233-6003"], ["Gompers Preparatory Academy", "363.0", "(619) 263-2171"], ["Animo Watts College Preparatory Academy", "362.0", "(323) 756-3930"], ["Lifeline Education Charter", "359.0", "(310) 605-2510"], ["Animo College Preparatory Academy", "359.0", "(323) 568-4136"], ["Augustus F. Hawkins High A Critical Design and Gaming", "354.0", "(323) 789-1282"], ["Leadership in Entertainment and Media Arts (LEMA)", "354.0", "None"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship", "346.0", "(323) 789-1282"], ["Los Angeles Teacher Preparatory Academy", "339.0", "None"], ["Soledad Enrichment Action Charter High", "335.0", "(213) 480-4200"], ["S.F. International High", "318.0", "(415) 695-5781"], ["Sierra Charter", "None", "(559) 490-4290"], ["W. E. B. DuBois Public Charter", "None", "(559) 486-1166"], ["Success One!", "None", "(530) 934-6320"], ["College Bridge Academy", "None", "(323) 249-7845"], ["Los Angeles County Online High", "None", "(800) 985-0770"], ["Hume Lake Charter", "None", "(559) 305-7565"], ["Desert Sands Charter", "None", "(661) 942-3357"], ["School of Unlimited Learning", "None", "(559) 498-8543"], ["Opportunities For Learning - Fresno", "None", "(626) 921-8200"], ["Alder Grove Charter", "None", "(707) 268-0854"], ["Mattole Valley Charter (#159)", "None", "(707) 629-3634"], ["YouthBuild Charter School of California", "None", "(213) 741-2600"], ["Crescent View West Charter", "None", "(559) 222-8439"], ["Clovis Online Charter", "None", "(559) 327-4400"], ["Carter G. Woodson Public Charter", "None", "(559) 229-3529"], ["Elm High", "None", "(559) 485-8805"], ["Laurel Tree Charter", "None", "(707) 822-5626"], ["Mattole Triple Junction High", "None", "(707) 629-3250"], ["Crossroads Charter", "None", "(559) 583-5060"], ["California Virtual Academy @ Kings", "None", "(805) 581-0202"], ["Kingsburg Independent Study High", "None", "(559) 897-3880"], ["Ambassador Phillip V. Sanchez Public Charter", "None", "(559) 255-9017"], ["New Day Academy", "None", "(530) 233-3861"], ["Academies of the Antelope Valley", "None", "(661) 948-7655"], ["West Park Charter Academy", "None", "(559) 233-6501"], ["Crescent View South Charter", "None", "(559) 222-8439"], ["Conservation Corps of Long Beach Gateway Cities Charter", "None", "(562) 216-1790"], ["National University Academy - Orange Center", "None", "None"], ["Big Picture Educational Academy", "None", "(559) 420-1234"], ["Academy of Arts and Sciences: Fresno", "None", "(855) 937-4227"], ["Selma Independent", "None", "(559) 898-6670"], ["Abraham Lincoln Alternative", "None", "(661) 256-5090"], ["Mt. Lassen Charter", "None", "(530) 827-2129"], ["Optimist Charter", "None", "(323) 443-3100"], ["Fresno Academy for Civic and Entrepreneurial Leadership", "None", "None"], ["YouthBuild Charter School of California Central", "None", "None"], ["Dunlap Leadership Academy", "None", "(559) 305-7320"], ["Pacific View Charter", "None", "(707) 269-9490"], ["The Education Corps", "None", "(323) 249-7845"], ["Bishop Independent Study", "None", "(760) 938-2001"], ["Kern Workforce 2000 Academy", "None", "(661) 827-3158"], ["Insight School of California", "None", "(805) 581-0202"], ["Westwood Charter", "None", "(530) 256-2994"], ["National University Academy, Armona", "None", "None"], ["Centinela Valley Independent Study", "None", "(310) 263-4469"], ["PUC Community Charter Middle and PUC Community Charter Early College High", "None", "(818) 485-0933"], ["Merced Scholars Charter", "None", "(209) 381-5165"], ["Anahuacalmecac International University Preparatory of North America", "None", "None"], ["Academy of Science and Engineering", "None", "(323) 545-1100"], ["Aveson Global Leadership Academy", "None", "(626) 797-1438"], ["Learning Works", "None", "(626) 564-2871"], ["iQ Academy California-Los Angeles", "None", "(888) 997-4722"], ["Crossroads Alternative Education Center", "None", "(209) 826-4013"], ["Opportunities for Learning - Capistrano", "None", "(949) 248-1282"], ["PUC Triumph Charter High", "None", "None"], ["Family First Charter", "None", "(310) 355-0001"], ["School of Extended Educational Options", "None", "(909) 397-4900"], ["Mission View Public", "None", "(661) 200-5595"], ["Inspire Charter School", "None", "(661) 269-2214"], ["SIATech Academy South", "None", "(760) 945-1227"], ["Madera County Independent Academy", "None", "(559) 662-4636"], ["San Andreas High (Continuation)", "None", "(415) 945-3751"], ["Ukiah Independent Study Academy", "None", "(707) 472-5062"], ["Monterey County Home Charter", "None", "(831) 755-0331"], ["Learning for Life Charter", "None", "(831) 582-9820"], ["New Opportunities Charter", "None", "(310) 355-0001"], ["Beach High-Intensive Learning Program", "None", "(562) 595-8893"], ["Pacific Boulevard", "None", "(323) 586-8640"], ["Frida Kahlo High", "None", "(213) 763-1090"], ["Antelope Valley Learning Academy", "None", "(661) 952-6028"], ["Palmdale Aerospace Academy", "None", "(661) 273-3680"], ["Del Mar High", "None", "(626) 291-5723"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "None", "(855) 937-4227"], ["Pioneer Technical Center", "None", "(559) 662-6294"], ["New Horizons", "None", "(707) 459-4801"], ["Willits Charter", "None", "(707) 459-5506"], ["California Preparatory Academy", "None", "(949) 234-5317"], ["Opportunities for Learning - Duarte", "None", "(626) 921-8200"], ["Alliance Margaret M. Bloomfield Technology Academy High", "None", "(323) 537-2060"], ["Youth Opportunities Unlimited", "None", "(323) 789-4731"], ["Albert Einstein Academy for Letters, Arts and Sciences", "None", "(661) 702-0755"], ["Redondo Shores High (Continuation)", "None", "(310) 798-8690"], ["Sherman Thomas Charter High", "None", "(559) 675-6626"], ["Accelerated Achievement Academy", "None", "(707) 463-7080"], ["Shattuck Independent Study", "None", "(209) 656-2012"], ["Urban Corps of San Diego County Charter", "None", "(619) 235-6884"], ["Camino Nuevo High #2", "None", "(213) 736-5566"], ["Thurgood Marshall", "None", "(310) 898-6340"], ["Glacier High School Charter", "None", "(559) 642-1422"], ["Napa Valley Independent Studies", "None", "(707) 259-8577"], ["EPIC de Cesar Chavez", "None", "(661) 822-4381"], ["Vantage Point Charter", "None", "(530) 432-5312"], ["Los Angeles Big Picture High", "None", "None"], ["Paramount Alternative Education Center", "None", "None"], ["North Valley Military Institute College Preparatory Academy", "None", "(818) 368-1557"], ["Pathway Independent Study", "None", "(310) 603-1516"], ["Orange County Conservation Corps Charter", "None", "(714) 956-6222"], ["El Puente", "None", "(831) 796-7700"], ["Chawanakee Academy", "None", "None"], ["Early College Academy-LA Trade Tech College", "None", "(323) 763-3685"], ["CIS Academy", "None", "(626) 396-5883"], ["Assurance Learning Academy", "None", "(661) 272-1225"], ["John Muir Charter Schools", "None", "(530) 272-4008"], ["Partnerships for Student-Centered Learning", "None", "(916) 408-5200"], ["Rocklin Independent Charter Academy", "None", "(916) 632-3195"], ["Gateway College and Career Academy", "None", "(951) 222-8931"], ["Moreno Valley Online Academy", "None", "(951) 571-4800"], ["Mountain Heights Academy", "None", "(951) 487-7710"], ["Murrieta Canyon Academy", "None", "(951) 696-1661"], ["Creative Connections Arts Academy", "None", "(916) 566-1870"], ["Alta Vista South Public Charter", "None", "(661) 272-1225"], ["Redlands eAcademy", "None", "(909) 748-6941"], ["Public Safety Academy", "None", "(909) 382-2211"], ["Silver Valley Academy", "None", "(760) 254-2715"], ["Juan Bautista de Anza", "None", "(760) 767-5850"], ["Diego Hills Charter", "None", "(619) 286-0312"], ["Diego Valley Charter", "None", "(619) 286-0312"], ["Future Bound Independent Study Secondary", "None", "(760) 787-2068"], ["SIATech", "None", "(760) 945-1227"], ["Carlsbad Seaside Academy", "None", "(760) 331-5299"], ["Five Keys Charter (SF Sheriff's)", "None", "(415) 734-3310"], ["Coronado Pathways Charter", "None", "None"], ["Riverside County Education Academy", "None", "(951) 826-6602"], ["Come Back Kids", "None", "(951) 826-6461"], ["Capital City Independent Study", "None", "(916) 433-5187"], ["Vista Nueva Career and Technology High", "None", "(916) 566-2750"], ["Alta Vista Public", "None", "(760) 947-0006"], ["Chaffey District Online High", "None", "(909) 985-0966"], ["ASA Charter", "None", "(909) 475-3322"], ["Shadow Ridge", "None", "(760) 949-8267"], ["Oasis High (Alternative)", "None", "(760) 723-6395"], ["San Diego Virtual", "None", "(619) 713-7271"], ["Academy of Arts and Sciences", "None", "(855) 937-4227"], ["Arroyo Paseo Charter High", "None", "(619) 677-3017"], ["Laurel Preparatory Academy", "None", "(858) 678-4812"], ["Insight @ San Diego", "None", "(805) 581-0202"], ["Southern California Online Academy", "None", "None"], ["Antelope View Charter", "None", "None"], ["21st Century Learning Institute", "None", "(951) 769-8424"], ["Lee V. Pollard High", "None", "(951) 736-3367"], ["Keith McCarthy Academy", "None", "(951) 253-7777"], ["Val Verde Academy", "None", "(951) 443-2450"], ["Elwood J. Keema High", "None", "(916) 566-3410"], ["Provisional Accelerated Learning Academy", "None", "(909) 887-7002"], ["Sky Mountain Charter", "None", "(530) 295-3566"], ["High Desert Premier Academy", "None", "(760) 240-4252"], ["Diego Springs Academy", "None", "(661) 272-1225"], ["Greater San Diego Academy", "None", "(619) 669-3050"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "None", "None"], ["RAI Online Charter", "None", "None"], ["CORE Placer Charter", "None", "(530) 346-8340"], ["Cold Stream Alternative", "None", "(530) 582-2640"], ["Plumas Charter", "None", "(530) 283-3851"], ["Alvord Alternative Continuation High", "None", "(951) 509-6021"], ["Rivercrest Preparatory", "None", "(951) 360-2660"], ["Riverside Virtual", "None", "(951) 276-2006"], ["Mountain Valley Academy", "None", "(760) 787-3600"], ["Home & Hosp/Transition Support", "None", "(619) 344-6435"], ["MAAC Community Charter", "None", "(619) 476-0749"], ["North County Trade Tech High", "None", "(760) 598-0782"], ["Five Keys Adult School (SF Sheriff's)", "None", "(415) 734-3310"], ["OUSD Home Sch", "None", "(714) 628-5479"], ["Susan H. Nelson", "None", "(951) 695-7360"], ["Community Collaborative Charter", "None", "(916) 286-5161"], ["Literacy First Charter", "None", "(619) 579-7232"], ["Pivot Charter School - San Diego", "None", "(760) 591-0217"], ["Bayshore Preparatory Charter", "None", "(760) 471-0847"], ["Five Keys Independence HS (SF Sheriff's)", "None", "(415) 734-3310"], ["Hope Academy Charter", "None", "None"], ["Parkview", "None", "(714) 986-7050"], ["Cesar E. Chavez High", "None", "(714) 430-5700"], ["Victory High", "None", "(916) 632-3195"], ["Banning Independent Study", "None", "(951) 922-0268"], ["Highlands Community Charter", "None", "(916) 844-2283"], ["Learning Choice Academy", "None", "(619) 463-6849"], ["iHigh Virtual Academy", "None", "(619) 764-5440"], ["Taylion San Diego Academy", "None", "(760) 295-5564"], ["Valley Center Prep", "None", "(760) 751-0455"], ["Gateway to College", "None", "(415) 452-5768"], ["Horizon", "None", "(760) 238-9720"], ["San Juan Choices Charter", "None", "(916) 979-8378"], ["Independence Charter Academy", "None", "(760) 952-1760"], ["Mirus Secondary", "None", "(760) 244-3764"], ["Options Secondary", "None", "(619) 796-7320"], ["Pacific View Charter", "None", "(760) 757-0161"], ["Warner Junior/Senior High", "None", "(760) 782-3517"], ["Jordan (June) School for Equity", "None", "(415) 452-4922"], ["Corona-Norco Alternative", "None", "(951) 736-3367"], ["Elk Grove Charter", "None", "(916) 714-1653"], ["Global Youth Charter", "None", "(916) 339-4680"], ["SAVA: Sacramento Academic and Vocational Academy", "None", "(916) 387-8063"], ["Empire Springs Charter", "None", "(951) 252-8800"], ["Mojave River Academy", "None", "(760) 245-3222"], ["Monarch", "None", "(619) 652-4100"], ["National University Academy", "None", "(760) 631-5842"], ["Alta Vista Academy", "None", "(619) 216-5160"], ["Guajome Learning Center", "None", "(760) 631-8500"], ["Vista Visions Academy", "None", "(760) 724-4785"], ["Valley View Charter Prep", "None", "(916) 866-9033"], ["Escuela Popular/Center for Training and Careers, Family Learning", "None", "(408) 275-7191"], ["Middle College High", "None", "(408) 298-2181"], ["Northern Summit Academy", "None", "(530) 949-0154"], ["Matt Garcia Career and College Academy", "None", "(707) 424-9400"], ["Endeavor Alternative", "None", "(209) 556-1805"], ["Aspire Vanguard College Preparatory Academy", "None", "(209) 521-3010"], ["Prospect Education Center", "None", "(559) 782-7095"], ["California Virtual Academy @ Jamestown", "None", "(805) 581-0202"], ["Golden Valley Charter", "None", "(805) 642-3435"], ["Academy of Arts and Sciences: Thousand Oaks & Simi Valley", "None", "(855) 937-4227"], ["Independence", "None", "(209) 331-8275"], ["New Vision High", "None", "(209) 938-6225"], ["Delta Charter Online", "None", "(209) 830-6363"], ["Family Partnership Home Study Charter", "None", "(805) 348-3333"], ["Stellar Secondary Charter High", "None", "(530) 245-7730"], ["Valley Oaks High (Alternative)", "None", "(707) 778-4794"], ["Keyes to Learning Charter", "None", "(209) 634-6467"], ["Tehama eLearning Academy", "None", "(530) 527-0188"], ["Visalia Technical Early College", "None", "(559) 622-3212"], ["Renew Virtual Academy K12 #1", "None", "None"], ["Stockton High", "None", "(209) 933-7365"], ["Calero High", "None", "(408) 347-7600"], ["Academy of Personalized Learning", "None", "(530) 222-9280"], ["Gateway Educational Options", "None", "(530) 245-7960"], ["Golden Eagle Charter", "None", "(530) 926-5800"], ["Credo High", "None", "(707) 664-0600"], ["Valley Oak Junior and Senior High", "None", "(209) 847-3097"], ["Gold Rush Charter", "None", "(209) 532-9781"], ["Camptonville Academy", "None", "(530) 742-2786"], ["Aspire East Palo Alto Charter", "None", "None"], ["one.Charter", "None", "(209) 468-9079"], ["San Joaquin Building Futures Academy", "None", "(209) 468-8140"], ["California Virtual Academy @ San Joaquin", "None", "(805) 581-0202"], ["Peninsula High", "None", "(650) 558-2499"], ["Liberty High (Alternative)", "None", "(408) 535-6327"], ["North State Independence High", "None", "(530) 245-2760"], ["MIT Academy", "None", "(707) 552-6482"], ["Pathways Charter", "None", "(707) 585-6510"], ["Ronald Reagan Academy", "None", "(559) 595-0563"], ["Vista Real Charter High", "None", "(805) 486-5449"], ["Architecture, Construction & Engineering Charter High (ACE)", "None", "(805) 437-1410"], ["Condor High", "None", "(805) 385-2552"], ["Yuba County Career Preparatory Charter", "None", "(530) 749-4000"], ["Academy of Arts and Sciences: Oxnard & Ventura", "None", "None"], ["be.tech", "None", "(209) 858-7460"], ["Delta Home Charter", "None", "(209) 830-6363"], ["Pacific Law Academy", "None", "(209) 933-7475"], ["Grizzly ChalleNGe Charter", "None", "(805) 782-6882"], ["California Virtual Academy @ San Mateo", "None", "(805) 581-0202"], ["Downtown College Preparatory", "None", "(408) 271-8120"], ["Alternative Family Education", "None", "(831) 429-3898"], ["California Virtual Academy @ Sonoma", "None", "(805) 581-0202"], ["Oakdale Charter", "None", "(209) 848-4361"], ["La Sierra High", "None", "(559) 733-6963"], ["California Connections Academy@Central", "None", "(559) 713-1324"], ["Summit Charter Academy", "None", "(559) 782-5902"], ["Sierra Vista Charter High", "None", "(559) 687-7384"], ["IvyTech Charter", "None", "(805) 222-5188"], ["Los Olivos Charter School", "None", "None"], ["Magnolia Science Academy Santa Clara", "None", "None"], ["Independence High", "None", "(805) 769-1620"], ["San Jose Conservation Corps Charter", "None", "(408) 459-6404"], ["Escuela Popular Accelerated Family Learning", "None", "(408) 275-7190"], ["Pacific Coast Charter", "None", "(831) 761-6021"], ["Geyserville New Tech Academy", "None", "(707) 857-3592"], ["Orchard View", "None", "(707) 823-4709"], ["Hart-Ransom Academic Charter", "None", "(209) 523-0401"], ["eCademy Charter at Crane", "None", "(209) 669-3410"], ["Silicon Valley Flex Academy", "None", "None"], ["Rio Valley Charter", "None", "(209) 368-4934"], ["Ceiba College Preparatory Academy", "None", "(831) 728-6208"], ["SLVUSD Charter", "None", "(831) 335-0932"], ["Delta Charter", "None", "(831) 477-5212"], ["Gateway to College Academy", "None", "(707) 778-4621"], ["Northwest Prep Charter", "None", "(707) 522-3320"], ["California Virtual Academy @ Sutter", "None", "(805) 581-0202"], ["Eleanor Roosevelt Community Learning Center", "None", "(559) 592-9160"], ["Burton Horizon Academy", "None", "(559) 782-4748"], ["Loma Vista Charter", "None", "(559) 562-5111"], ["Connections Visual and Performing Arts Academy", "None", "(209) 928-4228"], ["Century Academy", "None", "(805) 496-0286"], ["Templeton Independent Study High", "None", "(805) 434-5805"], ["Apollo High", "None", "(408) 928-5400"], ["Anderson New Technology High", "None", "(530) 365-3100"], ["Shasta Charter Academy", "None", "(530) 245-2600"], ["Pivot Online Charter - North Bay", "None", "(707) 843-4676"], ["Abraxis Charter", "None", "(707) 539-2897"], ["Academy of Arts and Sciences: Sonoma", "None", "(855) 937-4227"], ["Stanislaus Alternative Charter", "None", "(209) 238-6801"], ["Denair Charter Academy", "None", "(209) 634-0917"], ["Fusion Charter", "None", "(209) 667-0327"], ["Yuba City Charter", "None", "(530) 822-9667"], ["Crescent Valley Public Charter", "None", "(559) 970-5894"], ["Butterfield Charter High", "None", "(559) 782-7057"], ["River Oaks Academy", "None", "(805) 777-7999"], ["West Sacramento Early College Prep Charter", "None", "(916) 375-7680"]], "spark_error": null, "total_time": 31.55280375480652, "spark_time": 0.2908797264099121, "translation_time": 31.261924028396606, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='6a9da869-d909-4319-b150-9c081dd3ece7'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='0199572c-edad-4527-9fde-cc0815a618fd'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, AVG(ss.AvgScrWrite) AS AverageWritingScore, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 GROUP BY s.School, s.Phone ORDER BY AverageWritingScore DESC'}", "Observation: content='The original query has one potential area for improvement based on the provided instructions, specifically regarding \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While Spark SQL often allows simple alphanumeric identifiers without quoting, using backticks (`) for all identifiers (table names, column names, and aliases) is a robust practice that prevents issues with special characters, reserved keywords, or case sensitivity, and aligns with the instruction \"Use ` for the in-query strings\" if interpreted as a directive for identifiers.\\n\\nLet\\'s review the other points:\\n-   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n-   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n-   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used. The `>` and `<` operators correctly define exclusive ranges.\\n-   **Data type mismatch in predicates**:\\n    -   `CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991`: `SUBSTRING` extracts a string, which is then `CAST` to `INT` for comparison with an integer literal. This is correct.\\n    -   `CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000`: Same logic, correct.\\n    -   `s.CDSCode = ss.cds`: Assumed to be compatible types for the join. If they were different string/numeric types, Spark SQL might handle implicit casting, but explicit casting would be needed if an error occurred. Without schema, this is generally considered correct.\\n-   **Using the correct number of arguments for functions**: All functions (`AVG`, `SUBSTRING`, `CAST`) are used with the correct number of arguments.\\n-   **Casting to the correct data type**: Casting the extracted year to `INT` is appropriate for numerical comparison.\\n-   **Using the proper columns for joins**: `s.CDSCode = ss.cds` is a logical join condition between schools and their SAT scores.\\n\\nThe only change needed is to apply backticks to all identifiers for robustness and to strictly adhere to the \"Use ` for the in-query strings\" instruction when interpreted as applying to identifiers.\\n\\n```sql\\nSELECT\\n    `s`.`School`,\\n    AVG(`ss`.`AvgScrWrite`) AS `AverageWritingScore`,\\n    `s`.`Phone`\\nFROM\\n    `schools` AS `s`\\nJOIN\\n    `satscores` AS `ss` ON `s`.`CDSCode` = `ss`.`cds`\\nWHERE\\n    CAST(SUBSTRING(`s`.`OpenDate`, 1, 4) AS INT) > 1991\\n    OR CAST(SUBSTRING(`s`.`ClosedDate`, 1, 4) AS INT) < 2000\\nGROUP BY\\n    `s`.`School`,\\n    `s`.`Phone`\\nORDER BY\\n    `AverageWritingScore` DESC\\n```' name='query_checker_sql_db' tool_call_id='a6791eb8-da3c-4e65-985b-6789aa878778'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `s`.`School`, AVG(`ss`.`AvgScrWrite`) AS `AverageWritingScore`, `s`.`Phone` FROM `schools` AS `s` JOIN `satscores` AS `ss` ON `s`.`CDSCode` = `ss`.`cds` WHERE CAST(SUBSTRING(`s`.`OpenDate`, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(`s`.`ClosedDate`, 1, 4) AS INT) < 2000 GROUP BY `s`.`School`, `s`.`Phone` ORDER BY `AverageWritingScore` DESC'}"], "input_tokens": 4597, "output_tokens": 5613, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, AVG(ss.AvgScrWrite) AS AverageWritingScore, s.Phone FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000 GROUP BY s.School, s.Phone ORDER BY AverageWritingScore DESC\"}'}\nTool: The original query has one potential area for improvement based on the provided instructions, specifically regarding \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". While Spark SQL often allows simple alphanumeric identifiers without quoting, using backticks (`) for all identifiers (table names, column names, and aliases) is a robust practice that prevents issues with special characters, reserved keywords, or case sensitivity, and aligns with the instruction \"Use ` for the in-query strings\" if interpreted as a directive for identifiers.\n\nLet's review the other points:\n-   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n-   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n-   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used. The `>` and `<` operators correctly define exclusive ranges.\n-   **Data type mismatch in predicates**:\n    -   `CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991`: `SUBSTRING` extracts a string, which is then `CAST` to `INT` for comparison with an integer literal. This is correct.\n    -   `CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000`: Same logic, correct.\n    -   `s.CDSCode = ss.cds`: Assumed to be compatible types for the join. If they were different string/numeric types, Spark SQL might handle implicit casting, but explicit casting would be needed if an error occurred. Without schema, this is generally considered correct.\n-   **Using the correct number of arguments for functions**: All functions (`AVG`, `SUBSTRING`, `CAST`) are used with the correct number of arguments.\n-   **Casting to the correct data type**: Casting the extracted year to `INT` is appropriate for numerical comparison.\n-   **Using the proper columns for joins**: `s.CDSCode = ss.cds` is a logical join condition between schools and their SAT scores.\n\nThe only change needed is to apply backticks to all identifiers for robustness and to strictly adhere to the \"Use ` for the in-query strings\" instruction when interpreted as applying to identifiers.\n\n```sql\nSELECT\n    `s`.`School`,\n    AVG(`ss`.`AvgScrWrite`) AS `AverageWritingScore`,\n    `s`.`Phone`\nFROM\n    `schools` AS `s`\nJOIN\n    `satscores` AS `ss` ON `s`.`CDSCode` = `ss`.`cds`\nWHERE\n    CAST(SUBSTRING(`s`.`OpenDate`, 1, 4) AS INT) > 1991\n    OR CAST(SUBSTRING(`s`.`ClosedDate`, 1, 4) AS INT) < 2000\nGROUP BY\n    `s`.`School`,\n    `s`.`Phone`\nORDER BY\n    `AverageWritingScore` DESC\n```", "final_answer": "", "replica": 7, "timestamp": 1768937797.6635506}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": 0.0521004459047172, "spider_em": 0, "sparksql_query": "SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000", "execution_status": "VALID", "query_result": [["Crescent View West Charter", "None", "(559) 222-8439"], ["Hume Lake Charter", "None", "(559) 305-7565"], ["Big Picture Educational Academy", "None", "(559) 420-1234"], ["Clovis North High", "519.0", "(559) 327-5000"], ["Clovis Online Charter", "None", "(559) 327-4400"], ["Buchanan High", "507.0", "(559) 327-3000"], ["Clovis East High", "455.0", "(559) 327-4000"], ["Design Science Early College High", "468.0", "(559) 248-7353"], ["Sierra Charter", "None", "(559) 490-4290"], ["University High", "593.0", "(559) 278-8263"], ["Fresno Academy for Civic and Entrepreneurial Leadership", "None", "None"], ["School of Unlimited Learning", "None", "(559) 498-8543"], ["Sunnyside High", "399.0", "(559) 253-6700"], ["Carter G. Woodson Public Charter", "None", "(559) 229-3529"], ["Kingsburg Independent Study High", "None", "(559) 897-3880"], ["Orange Cove High", "405.0", "(559) 626-5900"], ["Dunlap Leadership Academy", "None", "(559) 305-7320"], ["National University Academy - Orange Center", "None", "None"], ["Academy of Arts and Sciences: Fresno", "None", "(855) 937-4227"], ["Ambassador Phillip V. Sanchez Public Charter", "None", "(559) 255-9017"], ["Hallmark Charter", "460.0", "(559) 524-7170"], ["Selma Independent", "None", "(559) 898-6670"], ["West Park Charter Academy", "None", "(559) 233-6501"], ["Crescent View South Charter", "None", "(559) 222-8439"], ["Opportunities For Learning - Fresno", "None", "(626) 921-8200"], ["Central High East Campus", "449.0", "(559) 276-0280"], ["Mendota High", "378.0", "(559) 655-1993"], ["Elm High", "None", "(559) 485-8805"], ["W. E. B. DuBois Public Charter", "None", "(559) 486-1166"], ["Success One!", "None", "(530) 934-6320"], ["Conservation Corps of Long Beach Gateway Cities Charter", "None", "(562) 216-1790"], ["Northcoast Preparatory and Performing Arts Academy", "579.0", "None"], ["Six Rivers Charter High", "472.0", "(707) 825-2428"], ["Laurel Tree Charter", "None", "(707) 822-5626"], ["Academy of the Redwoods", "524.0", "(707) 476-4203"], ["Pacific View Charter", "None", "(707) 269-9490"], ["Alder Grove Charter", "None", "(707) 268-0854"], ["Mattole Triple Junction High", "None", "(707) 629-3250"], ["Mattole Valley Charter (#159)", "None", "(707) 629-3634"], ["Southwest High", "468.0", "(760) 336-4100"], ["YouthBuild Charter School of California", "None", "(213) 741-2600"], ["YouthBuild Charter School of California Central", "None", "None"], ["The Education Corps", "None", "(323) 249-7845"], ["College Bridge Academy", "None", "(323) 249-7845"], ["Bishop Independent Study", "None", "(760) 938-2001"], ["Wonderful College Prep Academy", "377.0", "(661) 454-3000"], ["Valley Oaks Charter", "502.0", "(661) 852-6700"], ["Cesar E. Chavez High", "439.0", "(661) 720-4501"], ["Robert F. Kennedy High", "449.0", "(661) 720-5117"], ["Golden Valley High", "424.0", "(661) 827-0800"], ["Frontier High", "475.0", "(661) 829-1107"], ["Independence High", "463.0", "(661) 834-8001"], ["Mira Monte High", "403.0", "(661) 366-1800"], ["Centennial High", "489.0", "(661) 588-8601"], ["Ridgeview High", "421.0", "(661) 398-3100"], ["Kern Workforce 2000 Academy", "None", "(661) 827-3158"], ["Liberty High", "501.0", "(661) 587-0925"], ["Insight School of California", "None", "(805) 581-0202"], ["California City High", "424.0", "(760) 373-5263"], ["Abraham Lincoln Alternative", "None", "(661) 256-5090"], ["Frazier Mountain High", "443.0", "(661) 248-0310"], ["Crossroads Charter", "None", "(559) 583-5060"], ["California Virtual Academy @ Kings", "None", "(805) 581-0202"], ["National University Academy, Armona", "None", "None"], ["Sierra Pacific High", "464.0", "(559) 583-5912"], ["Hanford West High", "450.0", "(559) 583-5903"], ["Lemoore Middle College High", "464.0", "(559) 925-3552"], ["New Day Academy", "None", "(530) 233-3861"], ["Westwood Charter", "None", "(530) 256-2994"], ["Mt. Lassen Charter", "None", "(530) 827-2129"], ["Los Angeles International Charter High", "428.0", "(323) 257-1499"], ["Optimist Charter", "None", "(323) 443-3100"], ["International Polytechnic High", "495.0", "(909) 839-2320"], ["Soledad Enrichment Action Charter High", "335.0", "(213) 480-4200"], ["William J. (Pete) Knight High", "442.0", "(661) 533-9000"], ["Eastside High", "409.0", "(661) 946-3800"], ["SOAR High (Students On Academic Rise)", "496.0", "(661) 722-6300"], ["Los Angeles County Online High", "None", "(800) 985-0770"], ["Academies of the Antelope Valley", "None", "(661) 948-7655"], ["Lancaster High", "449.0", "(661) 726-7649"], ["Desert Sands Charter", "None", "(661) 942-3357"], ["Opportunities For Learning - Baldwin Park II", "426.0", "(626) 962-3311"], ["Opportunities for Learning - Baldwin Park", "447.0", "(626) 814-0161"], ["Options for Youth-Burbank Charter", "464.0", "(818) 566-7525"], ["Centinela Valley Independent Study", "None", "(310) 263-4469"], ["Family First Charter", "None", "(310) 355-0001"], ["New Opportunities Charter", "None", "(310) 355-0001"], ["Lawndale High", "423.0", "(310) 263-3102"], ["Opportunities for Learning - Duarte", "None", "(626) 921-8200"], ["South El Monte High", "427.0", "(626) 442-0218"], ["Anderson W. Clark Magnet High", "539.0", "(818) 248-8324"], ["Gorman Learning Center", "473.0", "(909) 307-6312"], ["Hawthorne Math and Science Academy", "492.0", "(310) 973-8184"], ["City Honors College Preparatory Academy", "442.0", "(310) 680-4880"], ["Animo Inglewood Charter High", "448.0", "(310) 673-0956"], ["Environmental Charter High", "446.0", "(310) 214-3400"], ["Lennox Mathematics, Science and Technology Academy", "418.0", "(310) 680-5600"], ["Animo Leadership High", "416.0", "(310) 216-3277"], ["Beach High-Intensive Learning Program", "None", "(562) 595-8893"], ["Cabrillo High", "388.0", "(562) 951-7700"], ["Renaissance High School for the Arts", "483.0", "(562) 901-0168"], ["High Tech LA", "508.0", "(818) 609-2640"], ["Wallis Annenberg High", "416.0", "(323) 235-6343"], ["North Valley Military Institute College Preparatory Academy", "None", "(818) 368-1557"], ["Central City Value", "404.0", "(213) 471-4686"], ["View Park Preparatory Accelerated High", "382.0", "(323) 290-6975"], ["Crenshaw Arts-Technology Charter High", "381.0", "(323) 293-3917"], ["Oscar De La Hoya Animo Charter High", "398.0", "(323) 780-1259"], ["Renaissance Arts Academy", "506.0", "(323) 259-5700"], ["Animo South Los Angeles Charter", "376.0", "(323) 779-0544"], ["New Designs Charter", "411.0", "(213) 765-9084"], ["Middle College High", "435.0", "(323) 418-4700"], ["Harbor Teacher Preparation Academy", "509.0", "(310) 834-3932"], ["Ivy Academia", "431.0", "(818) 716-0771"], ["Camino Nuevo Charter High", "413.0", "(213) 240-8700"], ["Animo Venice Charter High", "414.0", "(310) 392-8751"], ["Animo Pat Brown", "377.0", "(323) 585-3312"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex", "436.0", "(213) 745-8141"], ["Orthopaedic Hospital", "444.0", "(213) 765-2088"], ["Northridge Academy High", "464.0", "(818) 700-2222"], ["International Studies Learning Center at Legacy High School Complex", "457.0", "(323) 357-7521"], ["Port of Los Angeles High", "487.0", "(310) 832-9201"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing", "497.0", "(818) 994-7614"], ["Alliance Judy Ivie Burton Technology Academy High", "408.0", "(323) 920-6125"], ["Alliance Collins Family College-Ready High", "390.0", "(323) 923-1588"], ["Pacific Boulevard", "None", "(323) 586-8640"], ["Santee Education Complex", "382.0", "(213) 763-1000"], ["South East High", "439.0", "(323) 568-3400"], ["Maywood Academy High", "420.0", "(323) 838-6000"], ["PUC CA Academy for Liberal Studies Early College High", "437.0", "None"], ["Los Angeles Academy of Arts & Enterprise Charter", "388.0", "(213) 487-0600"], ["Frida Kahlo High", "None", "(213) 763-1090"], ["New Village Girls Academy", "374.0", "(213) 385-4015"], ["Alliance Patti And Peter Neuwirth Leadership Academy", "386.0", "(213) 342-2874"], ["Alliance Dr. Olga Mohan High", "407.0", "(213) 342-2870"], ["Animo Ralph Bunche Charter High", "387.0", "(323) 232-9436"], ["Animo Jackie Robinson High", "377.0", "(323) 846-5800"], ["Animo Watts College Preparatory Academy", "362.0", "(323) 756-3930"], ["Alliance Ouchi-O'Donovan 6-12 Complex", "397.0", "(323) 596-2290"], ["Alliance Marc & Eva Stern Math and Science", "439.0", "(323) 987-2144"], ["School of Business and Tourism at Contreras Learning Complex", "403.0", "(213) 240-3800"], ["East Valley Senior High", "415.0", "(818) 753-4400"], ["Arleta High", "397.0", "(818) 686-4100"], ["Panorama High", "411.0", "(818) 909-4500"], ["Bright Star Secondary Charter Academy", "435.0", "(424) 789-8337"], ["Frederick Douglass Academy High", "378.0", "None"], ["Student Empowerment Academy", "372.0", "None"], ["Contreras Learning Center-Los Angeles School of Global Studies", "378.0", "(213) 240-3850"], ["West Adams Preparatory High", "385.0", "(323) 373-2500"], ["Magnolia Science Academy 3", "418.0", "(310) 637-3806"], ["Magnolia Science Academy 2", "427.0", "(818) 758-0300"], ["Discovery Charter Preparatory School #2", "373.0", "(818) 897-1187"], ["Alliance Morgan McKinzie High", "375.0", "(323) 859-0750"], ["Edward R. Roybal Learning Center", "408.0", "(213) 580-6400"], ["Helen Bernstein High", "391.0", "(323) 817-6460"], ["APEX Academy", "368.0", "(323) 817-6550"], ["Alliance Piera Barabaglia Shaheen Health Services Academy", "393.0", "(323) 972-9010"], ["Alliance Leichtman-Levine Family Foundation Environmental Science High", "444.0", "(323) 739-0560"], ["Magnolia Science Academy 4", "405.0", "(310) 473-2464"], ["Contreras Learning Center-Academic Leadership Community", "390.0", "(213) 240-3815"], ["Los Angeles High School of the Arts", "409.0", "(213) 480-4600"], ["Los Angeles Teacher Preparatory Academy", "339.0", "None"], ["School for the Visual Arts and Humanities", "394.0", "(213) 480-4700"], ["New Millennium Secondary", "388.0", "(310) 999-6162"], ["Alain Leroy Locke College Preparatory Academy", "364.0", "(323) 420-2100"], ["Sun Valley High", "385.0", "(818) 394-4600"], ["New Open World Academy K-12", "402.0", "(213) 480-3700"], ["UCLA Community K-12", "392.0", "(213) 480-3750"], ["Ramon C. Cortines School of Visual and Performing Arts", "446.0", "(213) 217-8600"], ["Felicitas and Gonzalo Mendez High", "382.0", "(323) 981-6100"], ["New Designs Charter School-Watts", "371.0", "(323) 418-0600"], ["Daniel Pearl Journalism & Communications Magnet", "470.0", "(818) 654-3775"], ["Ambassador-Global Leadership", "412.0", "(213) 480-4540"], ["Alliance Cindy and Bill Simon Technology Academy High", "364.0", "(323) 744-2122"], ["Alliance Tennenbaum Family Technology High", "385.0", "(323) 276-5545"], ["Environmental and Social Policy Magnet", "390.0", "(323) 441-4577"], ["Math, Science, & Technology Magnet Academy at Roosevelt High", "447.0", "(323) 780-6500"], ["Esteban Torres East LA Performing Arts Magnet", "378.0", "(323) 265-6725"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4", "386.0", "(323) 265-6830"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5", "371.0", "(323) 265-6865"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2", "388.0", "(323) 265-6760"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3", "395.0", "(323) 285-6795"], ["PUC Triumph Charter High", "None", "None"], ["PUC Lakeview Charter High", "390.0", "(818) 356-2591"], ["Aspire Pacific Academy", "394.0", "(323) 589-2800"], ["Los Angeles Big Picture High", "None", "None"], ["Alliance Ted K. Tajima High", "378.0", "(213) 241-8533"], ["Valley Academy of Arts and Sciences", "440.0", "(818) 832-7750"], ["Cesar E. Chavez Learning Academy - Arts/Theatre/Entertain Mag", "369.0", "(818) 837-6428"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy", "401.0", "(818) 838-3915"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)", "413.0", "(818) 838-3926"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy", "401.0", "(818) 838-3946"], ["Los Angeles River at Sonia Sotomayor Learning Academies", "383.0", "(323) 276-5535"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies", "430.0", "(323) 276-5500"], ["Dr. Maya Angelou Community High", "363.0", "(323) 846-4700"], ["Public Service Community at Diego Rivera Learning Complex", "406.0", "(323) 846-2128"], ["Communication and Technology at Diego Rivera Learning Complex", "373.0", "(323) 846-2118"], ["Green Design at Diego Rivera Learning Complex", "375.0", "(323) 846-2108"], ["Performing Arts Community at Diego Rivera Learning Complex", "372.0", "(323) 846-2136"], ["Rancho Dominguez Preparatory", "420.0", "(310) 354-3400"], ["Synergy Quantum Academy", "419.0", "(323) 846-4716"], ["Animo College Preparatory Academy", "359.0", "(323) 568-4136"], ["Alliance Renee and Meyer Luskin Academy High", "364.0", "(323) 905-1210"], ["PUC Early College Academy for Leaders and Scholars (ECALS)", "401.0", "(323) 276-5525"], ["Alliance Margaret M. Bloomfield Technology Academy High", "None", "(323) 537-2060"], ["Leadership in Entertainment and Media Arts (LEMA)", "354.0", "None"], ["STEM Academy at Bernstein High", "399.0", "(323) 817-6461"], ["Academy of Science and Engineering", "None", "(323) 545-1100"], ["Augustus F. Hawkins High A Critical Design and Gaming", "354.0", "(323) 789-1282"], ["Augustus F. Hawkins High B Community Health Advocates", "366.0", "(323) 789-1282"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship", "346.0", "(323) 789-1282"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "431.0", "(323) 568-3800"], ["Linda Esperanza Marquez High B LIBRA Academy", "410.0", "(323) 584-3800"], ["Linda Esperanza Marquez High C School of Social Justice", "423.0", "(323) 584-3800"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex", "383.0", "(323) 357-7545"], ["Visual and Performing Arts at Legacy High School Complex", "386.0", "(323) 357-7500"], ["Academy for Multilingual Arts and Science at Mervyn M. Dymally High", "377.0", "(323) 565-4600"], ["Academies of Education and Empowerment at Carson High", "403.0", "(310) 847-1455"], ["Academy of Medical Arts at Carson High", "417.0", "(310) 847-1465"], ["Humanities and Arts (HARTS) Academy of Los Angeles", "425.0", "(310) 257-7100"], ["Contreras Learning Center-School of Social Justice", "383.0", "(213) 240-3800"], ["Early College Academy-LA Trade Tech College", "None", "(323) 763-3685"], ["Camino Nuevo High #2", "None", "(213) 736-5566"], ["Youth Opportunities Unlimited", "None", "(323) 789-4731"], ["Palisades Charter High", "525.0", "(310) 230-6623"], ["City of Angels", "501.0", "(323) 415-8350"], ["Los Angeles Leadership Academy", "425.0", "(323) 227-7719"], ["PUC Community Charter Middle and PUC Community Charter Early College High", "None", "(818) 485-0933"], ["Magnolia Science Academy", "470.0", "(818) 609-0507"], ["Marco Antonio Firebaugh High", "412.0", "(310) 886-5200"], ["Pathway Independent Study", "None", "(310) 603-1516"], ["Mountain Park", "468.0", "(626) 471-3014"], ["Applied Technology Center", "420.0", "(323) 248-2500"], ["Antelope Valley Learning Academy", "None", "(661) 952-6028"], ["Palmdale Aerospace Academy", "None", "(661) 273-3680"], ["Guidance Charter", "407.0", "(661) 285-1600"], ["Palos Verdes High", "564.0", "(310) 378-8471"], ["Paramount Alternative Education Center", "None", "None"], ["Aveson Global Leadership Academy", "None", "(626) 797-1438"], ["CIS Academy", "None", "(626) 396-5883"], ["Learning Works", "None", "(626) 564-2871"], ["School of Extended Educational Options", "None", "(909) 397-4900"], ["Diamond Ranch High", "472.0", "(909) 397-4715"], ["Village Academy High School at Indian Hill", "442.0", "(909) 397-4900"], ["Malibu High", "553.0", "(310) 457-6801"], ["California Virtual Academy @ Los Angeles", "521.0", "(805) 581-0202"], ["Edgewood High", "493.0", "(626) 939-0600"], ["Insight @ Los Angeles", "425.0", "None"], ["Golden Valley High", "500.0", "(661) 298-8140"], ["West Ranch High", "539.0", "(661) 222-1220"], ["Mission View Public", "None", "(661) 200-5595"], ["Santa Clarita Valley International", "443.0", "(661) 705-4820"], ["Albert Einstein Academy for Letters, Arts and Sciences", "None", "(661) 702-0755"], ["Valencia High", "528.0", "(661) 294-1188"], ["Opportunities for Learning - Santa Clarita", "489.0", "(661) 424-1337"], ["Academy of the Canyons", "596.0", "(661) 362-3056"], ["Thurgood Marshall", "None", "(310) 898-6340"], ["iQ Academy California-Los Angeles", "None", "(888) 997-4722"], ["Gabrielino High", "518.0", "(626) 573-2415"], ["Options for Youth San Gabriel", "455.0", "(626) 921-8200"], ["Del Mar High", "None", "(626) 291-5723"], ["Assurance Learning Academy", "None", "(661) 272-1225"], ["Inspire Charter School", "None", "(661) 269-2214"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "None", "(855) 937-4227"], ["SIATech Academy South", "None", "(760) 945-1227"], ["Vasquez High", "500.0", "(661) 269-0451"], ["Redondo Shores High (Continuation)", "None", "(310) 798-8690"], ["School of Arts and Enterprise", "473.0", "(909) 622-0699"], ["Lifeline Education Charter", "359.0", "(310) 605-2510"], ["Da Vinci Science", "467.0", "(310) 725-5800"], ["Da Vinci Design", "459.0", "(310) 725-5800"], ["Anahuacalmecac International University Preparatory of North America", "None", "None"], ["Madera County Independent Academy", "None", "(559) 662-4636"], ["Pioneer Technical Center", "None", "(559) 662-6294"], ["Madera South High", "414.0", "(559) 675-4450"], ["Sherman Thomas Charter High", "None", "(559) 675-6626"], ["Liberty High", "472.0", "(559) 645-3500"], ["Minarets High", "472.0", "(559) 868-8689"], ["Minarets Charter High", "463.0", "(559) 868-8659"], ["Chawanakee Academy", "None", "None"], ["Glacier High School Charter", "None", "(559) 642-1422"], ["San Andreas High (Continuation)", "None", "(415) 945-3751"], ["Ukiah Independent Study Academy", "None", "(707) 472-5062"], ["Redwood Academy of Ukiah", "540.0", "(707) 467-0500"], ["Accelerated Achievement Academy", "None", "(707) 463-7080"], ["New Horizons", "None", "(707) 459-4801"], ["Willits Charter", "None", "(707) 459-5506"], ["Merced Scholars Charter", "None", "(209) 381-5165"], ["Crossroads Alternative Education Center", "None", "(209) 826-4013"], ["Pacheco High", "441.0", "(209) 826-3801"], ["Golden Valley High", "436.0", "(209) 325-1800"], ["Buhach Colony High", "438.0", "(209) 325-1400"], ["Shattuck Independent Study", "None", "(209) 656-2012"], ["Delhi High", "419.0", "(209) 656-2050"], ["Urban Corps of San Diego County Charter", "None", "(619) 235-6884"], ["Orange County Conservation Corps Charter", "None", "(714) 956-6222"], ["Monterey County Home Charter", "None", "(831) 755-0331"], ["Greenfield High", "427.0", "(831) 674-2751"], ["Marina High", "454.0", "(831) 583-2060"], ["Learning for Life Charter", "None", "(831) 582-9820"], ["El Puente", "None", "(831) 796-7700"], ["Everett Alvarez High", "446.0", "(831) 796-7800"], ["Soledad High", "428.0", "(831) 678-6400"], ["Gonzales High", "425.0", "(831) 675-2495"], ["Napa Valley Independent Studies", "None", "(707) 259-8577"], ["American Canyon High", "470.0", "(707) 265-2710"], ["New Technology High", "500.0", "(707) 259-8557"], ["Bitney College Preparatory High", "482.0", "(530) 477-1235"], ["Forest Charter", "508.0", "(530) 265-4823"], ["EPIC de Cesar Chavez", "None", "(661) 822-4381"], ["John Muir Charter Schools", "None", "(530) 272-4008"], ["William & Marian Ghidotti High", "576.0", "(530) 274-5270"], ["Vantage Point Charter", "None", "(530) 432-5312"], ["OCCS:CHEP/PCHS", "528.0", "(714) 327-1000"], ["Oxford Academy", "634.0", "(714) 220-3055"], ["Capistrano Connections Academy", "512.0", "(949) 461-1667"], ["San Juan Hills High", "534.0", "(949) 234-5900"], ["California Preparatory Academy", "None", "(949) 234-5317"], ["Aliso Niguel High", "548.0", "(949) 831-5590"], ["Tesoro High", "545.0", "(949) 234-5310"], ["Opportunities for Learning - Capistrano", "None", "(949) 248-1282"], ["Early College High", "478.0", "(714) 241-6108"], ["OUSD Home Sch", "None", "(714) 628-5479"], ["Yorba Linda High", "543.0", "(714) 986-7500"], ["Parkview", "None", "(714) 986-7050"], ["Nova Academy", "448.0", "(714) 569-0948"], ["Segerstrom High", "463.0", "(714) 241-5000"], ["Hector G. Godinez", "433.0", "(714) 433-6790"], ["Cesar E. Chavez High", "None", "(714) 430-5700"], ["Middle College High", "483.0", "(714) 953-3900"], ["OCSA", "582.0", "(714) 560-9000"], ["Arnold O. Beckman High", "572.0", "(714) 734-2900"], ["Northwood High", "621.0", "(949) 936-7200"], ["CORE Placer Charter", "None", "(530) 346-8340"], ["John Adams Academy", "576.0", "(916) 780-6800"], ["Foresthill High", "490.0", "(530) 367-5244"], ["Antelope High", "469.0", "(916) 726-1400"], ["Woodcreek High", "501.0", "(916) 771-6565"], ["Granite Bay High", "551.0", "(916) 786-8676"], ["Cold Stream Alternative", "None", "(530) 582-2640"], ["Partnerships for Student-Centered Learning", "None", "(916) 408-5200"], ["Horizon Charter", "456.0", "(916) 408-5200"], ["Whitney High", "502.0", "(916) 632-6500"], ["Western Sierra Collegiate Academy", "547.0", "(916) 778-4544"], ["Rocklin Independent Charter Academy", "None", "(916) 632-3195"], ["Rocklin High", "527.0", "(916) 632-1600"], ["Victory High", "None", "(916) 632-3195"], ["Plumas Charter", "None", "(530) 283-3851"], ["River Springs Charter", "478.0", "(951) 252-8800"], ["Riverside County Education Academy", "None", "(951) 826-6602"], ["Come Back Kids", "None", "(951) 826-6461"], ["Gateway College and Career Academy", "None", "(951) 222-8931"], ["Alvord Alternative Continuation High", "None", "(951) 509-6021"], ["Banning Independent Study", "None", "(951) 922-0268"], ["21st Century Learning Institute", "None", "(951) 769-8424"], ["Eleanor Roosevelt High", "486.0", "(951) 738-2100"], ["John F. Kennedy High", "497.0", "(951) 738-2200"], ["Corona-Norco Alternative", "None", "(951) 736-3367"], ["Lee V. Pollard High", "None", "(951) 736-3367"], ["Santiago High", "499.0", "(951) 739-5600"], ["Shadow Hills High", "434.0", "(760) 393-5400"], ["La Quinta High", "462.0", "(760) 772-4150"], ["Horizon", "None", "(760) 238-9720"], ["Hamilton High", "481.0", "(951) 763-1865"], ["Tahquitz High", "445.0", "(951) 765-6300"], ["College Prep High", "463.0", "(951) 925-5155"], ["Patriot High", "463.0", "(951) 361-6500"], ["Rivercrest Preparatory", "None", "(951) 360-2660"], ["Santa Rosa Academy", "503.0", "(951) 672-2400"], ["Moreno Valley Online Academy", "None", "(951) 571-4800"], ["Vista del Lago High", "424.0", "(951) 571-4880"], ["Nuview Bridge Early College High", "471.0", "(951) 928-8498"], ["Desert Hot Springs High", "429.0", "(760) 288-7000"], ["California Military Institute", "423.0", "(951) 443-2731"], ["Heritage High", "444.0", "(951) 940-5447"], ["Paloma Valley High", "450.0", "(951) 672-6030"], ["Riverside Virtual", "None", "(951) 276-2006"], ["Martin Luther King Jr. High", "494.0", "(951) 789-5690"], ["Mountain Heights Academy", "None", "(951) 487-7710"], ["San Jacinto Valley Academy", "466.0", "(951) 654-6113"], ["Desert Mirage High", "414.0", "(760) 397-2255"], ["NOVA Academy - Coachella", "403.0", "(714) 569-0948"], ["Lakeside High", "454.0", "(951) 253-7300"], ["Keith McCarthy Academy", "None", "(951) 253-7777"], ["Southern California Online Academy", "None", "None"], ["Great Oak High", "505.0", "(951) 294-6450"], ["Susan H. Nelson", "None", "(951) 695-7360"], ["Chaparral High", "491.0", "(951) 695-4200"], ["Temecula Preparatory", "539.0", "(951) 926-6776"], ["Vista Murrieta High", "491.0", "(951) 894-5750"], ["Murrieta Canyon Academy", "None", "(951) 696-1661"], ["Murrieta Mesa High", "478.0", "(951) 677-0568"], ["Citrus Hill High", "405.0", "(951) 490-0400"], ["Val Verde Academy", "None", "(951) 443-2450"], ["Monterey Trail High", "444.0", "(916) 688-0050"], ["Pleasant Grove High", "513.0", "(916) 686-0230"], ["Cosumnes Oaks High", "491.0", "(916) 683-7670"], ["Laguna Creek High", "483.0", "(916) 683-1339"], ["Sheldon High", "472.0", "(916) 681-7500"], ["Franklin High", "512.0", "(916) 714-8150"], ["Elk Grove Charter", "None", "(916) 714-1653"], ["Vista del Lago High", "552.0", "(916) 294-2410"], ["Liberty Ranch High", "496.0", "(209) 744-4250"], ["New Technology High", "432.0", "(916) 395-5254"], ["George Washington Carver School of Arts and Science", "526.0", "(916) 395-5266"], ["The MET", "468.0", "(916) 395-5417"], ["Rosemont High", "452.0", "(916) 395-5130"], ["Sacramento Charter High", "403.0", "(916) 277-6200"], ["Arthur A. Benjamin Health Professions High", "449.0", "(916) 395-5010"], ["School of Engineering & Sciences", "420.0", "(916) 395-5040"], ["Capital City Independent Study", "None", "(916) 433-5187"], ["West Campus", "500.0", "(916) 277-6400"], ["Aspire Alexander Twilight Secondary Academy", "403.0", "(916) 979-1788"], ["Options for Youth-San Juan", "431.0", "(916) 485-5155"], ["Visions In Education", "533.0", "(916) 971-7037"], ["San Juan Choices Charter", "None", "(916) 979-8378"], ["Global Youth Charter", "None", "(916) 339-4680"], ["Antelope View Charter", "None", "None"], ["Inderkum High", "449.0", "(916) 567-5640"], ["Natomas Pacific Pathways Prep", "477.0", "(916) 567-5740"], ["Natomas High", "454.0", "(916) 641-4960"], ["Natomas Charter", "524.0", "(916) 928-5353"], ["Futures High", "489.0", "(916) 286-1902"], ["Heritage Peak Charter", "458.0", "(866) 992-9033"], ["Creative Connections Arts Academy", "None", "(916) 566-1870"], ["Community Collaborative Charter", "None", "(916) 286-5161"], ["SAVA: Sacramento Academic and Vocational Academy", "None", "(916) 387-8063"], ["Highlands Community Charter", "None", "(916) 844-2283"], ["Elwood J. Keema High", "None", "(916) 566-3410"], ["Vista Nueva Career and Technology High", "None", "(916) 566-2750"], ["Anzar High", "479.0", "(831) 623-7660"], ["Alta Vista Public", "None", "(760) 947-0006"], ["Chaffey District Online High", "None", "(909) 985-0966"], ["Rancho Cucamonga High", "489.0", "(909) 989-1600"], ["Los Osos High", "511.0", "(909) 477-6900"], ["Colony High", "450.0", "(909) 930-2929"], ["Chino Hills High", "508.0", "(909) 606-7540"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "441.0", "(909) 580-5006"], ["Summit High", "425.0", "(909) 357-5950"], ["Jurupa Hills High", "424.0", "(909) 357-6300"], ["Henry J. Kaiser High", "417.0", "(909) 357-5900"], ["Academy of Careers and Exploration", "462.0", "(760) 952-1266"], ["Empire Springs Charter", "None", "(951) 252-8800"], ["Independence Charter Academy", "None", "(760) 952-1760"], ["Alta Vista South Public Charter", "None", "(661) 272-1225"], ["Hope Academy Charter", "None", "None"], ["Mojave River Academy", "None", "(760) 245-3222"], ["Riverside Preparatory", "447.0", "(760) 243-5884"], ["Citrus Valley High", "473.0", "(909) 799-2300"], ["Redlands eAcademy", "None", "(909) 748-6941"], ["Redlands East Valley High", "498.0", "(909) 389-2500"], ["Grove", "535.0", "(909) 798-7831"], ["Wilmer Amina Carter High", "436.0", "(909) 854-4100"], ["Rialto High", "421.0", "(909) 421-7500"], ["ASA Charter", "None", "(909) 475-3322"], ["Public Safety Academy", "None", "(909) 382-2211"], ["Options for Youth-San Bernardino", "457.0", "(626) 685-9300"], ["Indian Springs High", "400.0", "(909) 383-1360"], ["Provisional Accelerated Learning Academy", "None", "(909) 887-7002"], ["Arroyo Valley High", "406.0", "(909) 381-4295"], ["Middle College High", "469.0", "(909) 888-4041"], ["University Preparatory", "500.0", "(760) 243-5940"], ["Adelanto High", "421.0", "(760) 246-3909"], ["Options for Youth-Victorville Charter", "419.0", "(626) 685-9300"], ["Excelsior Charter", "473.0", "(760) 245-4262"], ["Silverado High", "422.0", "(760) 955-3353"], ["Silver Valley Academy", "None", "(760) 254-2715"], ["Summit Leadership Academy-High Desert", "370.0", "(760) 949-9202"], ["Mirus Secondary", "None", "(760) 244-3764"], ["Encore Jr./Sr. High School for the Performing and Visual Arts", "486.0", "(760) 956-2632"], ["Oak Hills High", "450.0", "(760) 244-2283"], ["Sultana High", "448.0", "(760) 947-6777"], ["Shadow Ridge", "None", "(760) 949-8267"], ["Sky Mountain Charter", "None", "(530) 295-3566"], ["Granite Hills High", "479.0", "(760) 961-2290"], ["High Desert Premier Academy", "None", "(760) 240-4252"], ["Academy for Academic Excellence", "505.0", "(760) 946-5414"], ["San Pasqual Academy", "363.0", "(760) 233-6003"], ["Monarch", "None", "(619) 652-4100"], ["Literacy First Charter", "None", "(619) 579-7232"], ["Juan Bautista de Anza", "None", "(760) 767-5850"], ["Diego Springs Academy", "None", "(661) 272-1225"], ["Coronado Pathways Charter", "None", "None"], ["Diego Hills Charter", "None", "(619) 286-0312"], ["Dehesa Charter", "529.0", "(760) 743-7880"], ["Classical Academy High", "548.0", "(760) 480-9845"], ["Escondido Charter High", "513.0", "(760) 737-3154"], ["Oasis High (Alternative)", "None", "(760) 723-6395"], ["Steele Canyon High", "492.0", "(619) 660-3550"], ["Grossmont Middle College High", "525.0", "(619) 644-7524"], ["Helix High", "464.0", "(619) 466-4194"], ["Greater San Diego Academy", "None", "(619) 669-3050"], ["Diego Valley Charter", "None", "(619) 286-0312"], ["Julian Charter", "517.0", "(760) 765-3847"], ["National University Academy", "None", "(760) 631-5842"], ["River Valley Charter", "555.0", "(619) 390-2579"], ["San Diego Virtual", "None", "(619) 713-7271"], ["Pivot Charter School - San Diego", "None", "(760) 591-0217"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "None", "None"], ["Academy of Arts and Sciences", "None", "(855) 937-4227"], ["Del Norte High", "565.0", "(858) 487-0877"], ["Westview High", "581.0", "(858) 780-2000"], ["Future Bound Independent Study Secondary", "None", "(760) 787-2068"], ["Mountain Valley Academy", "None", "(760) 787-3600"], ["High Tech High International", "477.0", "(619) 243-5014"], ["Learning Choice Academy", "None", "(619) 463-6849"], ["San Diego International Studies", "523.0", "(619) 525-7464"], ["San Diego Business/Leadership", "402.0", "(619) 525-7461"], ["San Diego MVP Arts", "405.0", "None"], ["Kearny Digital Media & Design", "482.0", "(858) 496-8370"], ["Kearny SCT", "452.0", "(858) 496-8370"], ["Kearny College Connections", "450.0", "(858) 496-8370"], ["Kearny Eng, Innov & Design", "426.0", "(858) 496-8370"], ["Crawford High", "380.0", "(619) 362-3700"], ["San Diego Science and Technology", "423.0", "(619) 525-7459"], ["San Diego Metro Career and Tech", "489.0", "(619) 388-2299"], ["High Tech High Media Arts", "457.0", "(619) 398-8632"], ["Lincoln High", "389.0", "(619) 266-6500"], ["Health Sciences High", "422.0", "(619) 528-9070"], ["Arroyo Paseo Charter High", "None", "(619) 677-3017"], ["East Village High", "483.0", "(619) 525-2000"], ["King-Chavez Community High", "369.0", "(619) 704-1020"], ["Gompers Preparatory Academy", "363.0", "(619) 263-2171"], ["iHigh Virtual Academy", "None", "(619) 764-5440"], ["School for Entrepreneurship and Technology", "453.0", "(858) 874-4338"], ["Home & Hosp/Transition Support", "None", "(619) 344-6435"], ["Laurel Preparatory Academy", "None", "(858) 678-4812"], ["Scripps Ranch High", "564.0", "(858) 621-9020"], ["Charter School of San Diego", "479.0", "(858) 678-2020"], ["Preuss School UCSD", "520.0", "(858) 822-3000"], ["High Tech High", "477.0", "(619) 243-5014"], ["Audeo Charter", "483.0", "(858) 678-2050"], ["Canyon Crest Academy", "611.0", "(858) 350-0253"], ["La Costa Canyon High", "542.0", "(760) 436-6136"], ["Insight @ San Diego", "None", "(805) 581-0202"], ["California Virtual Academy @ San Diego", "517.0", "(805) 581-0202"], ["Olympian High", "476.0", "(619) 656-2400"], ["Eastlake High", "498.0", "(619) 397-3800"], ["Options Secondary", "None", "(619) 796-7320"], ["MAAC Community Charter", "None", "(619) 476-0749"], ["Alta Vista Academy", "None", "(619) 216-5160"], ["San Ysidro High", "431.0", "(619) 710-2300"], ["Otay Ranch Senior High", "474.0", "(619) 591-5000"], ["RAI Online Charter", "None", "None"], ["Taylion San Diego Academy", "None", "(760) 295-5564"], ["SIATech", "None", "(760) 945-1227"], ["North County Trade Tech High", "None", "(760) 598-0782"], ["Mission Vista High", "501.0", "(760) 758-6800"], ["Guajome Learning Center", "None", "(760) 631-8500"], ["Vista Visions Academy", "None", "(760) 724-4785"], ["Guajome Park Academy Charter", "531.0", "(760) 631-8500"], ["Carlsbad Seaside Academy", "None", "(760) 331-5299"], ["Pacific View Charter", "None", "(760) 757-0161"], ["Mission Hills High", "495.0", "(760) 290-2700"], ["Bayshore Preparatory Charter", "None", "(760) 471-0847"], ["Warner Junior/Senior High", "None", "(760) 782-3517"], ["Valley Center High", "474.0", "(760) 751-5502"], ["Valley Center Prep", "None", "(760) 751-0455"], ["High Tech High Chula Vista", "471.0", "(619) 243-5014"], ["High Tech High North County", "511.0", "(619) 243-5014"], ["Five Keys Charter (SF Sheriff's)", "None", "(415) 734-3310"], ["Jordan (June) School for Equity", "None", "(415) 452-4922"], ["City Arts and Tech High", "395.0", "(415) 841-2200"], ["Five Keys Adult School (SF Sheriff's)", "None", "(415) 734-3310"], ["Five Keys Independence HS (SF Sheriff's)", "None", "(415) 734-3310"], ["S.F. International High", "318.0", "(415) 695-5781"], ["Academy (The)- SF @McAteer", "456.0", "(415) 695-5700"], ["Gateway to College", "None", "(415) 452-5768"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "553.0", "(415) 695-5700"], ["Marshall (Thurgood) High", "364.0", "(415) 695-5612"], ["Leadership High", "408.0", "(415) 841-8910"], ["Gateway High", "483.0", "(415) 749-3600"], ["San Francisco Flex Academy", "502.0", "None"], ["one.Charter", "None", "(209) 468-9079"], ["San Joaquin Building Futures Academy", "None", "(209) 468-8140"], ["Venture Academy", "458.0", "(209) 468-5940"], ["Aspire Benjamin Holt College Preparatory Academy", "503.0", "(209) 955-1477"], ["Ronald E. McNair High", "436.0", "(209) 953-9245"], ["Rio Valley Charter", "None", "(209) 368-4934"], ["Independence", "None", "(209) 331-8275"], ["Middle College High", "565.0", "(209) 954-5790"], ["Weston Ranch High", "454.0", "(209) 938-6245"], ["New Vision High", "None", "(209) 938-6225"], ["Lathrop High", "432.0", "(209) 938-6350"], ["be.tech", "None", "(209) 858-7460"], ["Sierra High", "463.0", "(209) 858-7410"], ["Humphreys College Academy of Business, Law and Education", "424.0", "(209) 478-1600"], ["California Virtual Academy @ San Joaquin", "None", "(805) 581-0202"], ["Renew Virtual Academy K12 #1", "None", "None"], ["Delta Home Charter", "None", "(209) 830-6363"], ["Valley View Charter Prep", "None", "(916) 866-9033"], ["Delta Charter Online", "None", "(209) 830-6363"], ["Delta Charter", "468.0", "(209) 830-6363"], ["California Connections Academy @ Ripon", "535.0", "(209) 253-1208"], ["Cesar Chavez High", "417.0", "(209) 933-7480"], ["Edward C. Merlo Institute of Environmental Studies", "370.0", "(209) 933-7190"], ["Aspire Langston Hughes Academy", "408.0", "(209) 943-2389"], ["Stockton Unified Early College Academy", "519.0", "(209) 933-7370"], ["Stockton High", "None", "(209) 933-7365"], ["Stockton Collegiate International Secondary", "475.0", "(209) 390-9861"], ["Health Careers Academy", "418.0", "(209) 933-7360"], ["Pacific Law Academy", "None", "(209) 933-7475"], ["Weber Institute", "420.0", "(209) 933-7330"], ["Millennium Charter", "480.0", "(209) 831-5240"], ["John C. Kimball High", "500.0", "(209) 832-6600"], ["Merrill F. West High", "479.0", "(209) 830-3370"], ["Grizzly ChalleNGe Charter", "None", "(805) 782-6882"], ["Nipomo High", "490.0", "(805) 474-3300"], ["Templeton Independent Study High", "None", "(805) 434-5805"], ["Independence High", "None", "(805) 769-1620"], ["California Virtual Academy @ San Mateo", "None", "(805) 581-0202"], ["Aspire East Palo Alto Charter", "None", "None"], ["Peninsula High", "None", "(650) 558-2499"], ["Summit Preparatory Charter High", "522.0", "(650) 556-1110"], ["Everest Public High", "538.0", "(650) 366-1050"], ["East Palo Alto Academy", "403.0", "(650) 893-8900"], ["Family Partnership Home Study Charter", "None", "(805) 348-3333"], ["Los Olivos Charter School", "None", "None"], ["Orcutt Academy Charter", "492.0", "(805) 938-8900"], ["Pioneer Valley High", "451.0", "(805) 922-1305"], ["Alta Vista Alternative High", "558.0", "(805) 965-1916"], ["Leadership Public Schools - San Jose", "381.0", "None"], ["University Preparatory Academy Charter", "537.0", "(408) 723-1839"], ["Magnolia Science Academy Santa Clara", "None", "None"], ["Silicon Valley Flex Academy", "None", "None"], ["Summit Public School: Tahoma", "483.0", "(408) 729-1981"], ["Branham High", "540.0", "(408) 626-3407"], ["Escuela Popular/Center for Training and Careers, Family Learning", "None", "(408) 275-7191"], ["KIPP San Jose Collegiate", "482.0", "(408) 937-3752"], ["Summit Public School: Rainier", "493.0", "(408) 831-3104"], ["Calero High", "None", "(408) 347-7600"], ["Apollo High", "None", "(408) 928-5400"], ["Latino College Preparatory Academy", "380.0", "(408) 729-2281"], ["San Jose Conservation Corps Charter", "None", "(408) 459-6404"], ["Evergreen Valley High", "565.0", "(408) 347-7000"], ["Escuela Popular Accelerated Family Learning", "None", "(408) 275-7190"], ["Dr. TJ Owens Gilroy Early College Academy", "552.0", "(408) 846-4909"], ["Christopher High", "484.0", "(408) 848-7171"], ["Ann Sobrato High", "515.0", "(408) 201-6200"], ["Liberty High (Alternative)", "None", "(408) 535-6327"], ["Downtown College Preparatory", "None", "(408) 271-8120"], ["Middle College High", "None", "(408) 298-2181"], ["Pacific Collegiate Charter", "630.0", "(831) 479-7785"], ["Cypress Charter High", "506.0", "(831) 477-0302"], ["Pajaro Valley High", "430.0", "(831) 728-8102"], ["Ceiba College Preparatory Academy", "None", "(831) 728-6208"], ["Pacific Coast Charter", "None", "(831) 761-6021"], ["Ocean Grove Charter", "554.0", "(530) 295-3566"], ["SLVUSD Charter", "None", "(831) 335-0932"], ["Delta Charter", "None", "(831) 477-5212"], ["Alternative Family Education", "None", "(831) 429-3898"], ["Scotts Valley High", "547.0", "(831) 439-9555"], ["Anderson New Technology High", "None", "(530) 365-3100"], ["Stellar Secondary Charter High", "None", "(530) 245-7730"], ["University Preparatory", "551.0", "(530) 245-2790"], ["Shasta Charter Academy", "None", "(530) 245-2600"], ["North State Independence High", "None", "(530) 245-2760"], ["Northern Summit Academy", "None", "(530) 949-0154"], ["Academy of Personalized Learning", "None", "(530) 222-9280"], ["Gateway Educational Options", "None", "(530) 245-7960"], ["Golden Eagle Charter", "None", "(530) 926-5800"], ["Matt Garcia Career and College Academy", "None", "(707) 424-9400"], ["Angelo Rodriguez High", "489.0", "(707) 863-7950"], ["Elise P. Buckingham Charter Magnet High", "533.0", "(707) 453-7300"], ["Jesse M. Bethel High", "447.0", "(707) 556-5700"], ["MIT Academy", "None", "(707) 552-6482"], ["Geyserville New Tech Academy", "None", "(707) 857-3592"], ["Pathways Charter", "None", "(707) 585-6510"], ["California Virtual Academy @ Sonoma", "None", "(805) 581-0202"], ["Pivot Online Charter - North Bay", "None", "(707) 843-4676"], ["Gateway to College Academy", "None", "(707) 778-4621"], ["Valley Oaks High (Alternative)", "None", "(707) 778-4794"], ["Northwest Prep Charter", "None", "(707) 522-3320"], ["Roseland Charter", "410.0", "(707) 545-0102"], ["Abraxis Charter", "None", "(707) 539-2897"], ["Elsie Allen High", "457.0", "(707) 528-5020"], ["Maria Carrillo High", "563.0", "(707) 528-5790"], ["Orchard View", "None", "(707) 823-4709"], ["Credo High", "None", "(707) 664-0600"], ["Academy of Arts and Sciences: Sonoma", "None", "(855) 937-4227"], ["Technology High", "567.0", "(707) 792-4825"], ["Windsor High", "516.0", "(707) 837-7767"], ["Stanislaus Alternative Charter", "None", "(209) 238-6801"], ["Valley Charter High", "489.0", "(209) 238-6800"], ["Whitmore Charter High", "542.0", "(209) 556-1617"], ["Central Valley High", "433.0", "(209) 556-1900"], ["Endeavor Alternative", "None", "(209) 556-1805"], ["Denair Charter Academy", "None", "(209) 634-0917"], ["Hart-Ransom Academic Charter", "None", "(209) 523-0401"], ["Keyes to Learning Charter", "None", "(209) 634-6467"], ["James C. Enochs High", "487.0", "(209) 550-3400"], ["Aspire Vanguard College Preparatory Academy", "None", "(209) 521-3010"], ["Joseph A. Gregori High", "465.0", "(209) 550-3421"], ["Peter Johansen High", "435.0", "(209) 576-4702"], ["Oakdale Charter", "None", "(209) 848-4361"], ["Valley Oak Junior and Senior High", "None", "(209) 847-3097"], ["Waterford High", "465.0", "(209) 874-9060"], ["Connecting Waters Charter", "504.0", "(209) 874-9463"], ["eCademy Charter at Crane", "None", "(209) 669-3410"], ["Fusion Charter", "None", "(209) 667-0327"], ["John H. Pitman High", "480.0", "(209) 656-1592"], ["South Sutter Charter", "465.0", "(530) 295-3566"], ["California Virtual Academy @ Sutter", "None", "(805) 581-0202"], ["River Valley High", "479.0", "(530) 822-2500"], ["Yuba City Charter", "None", "(530) 822-9667"], ["Tehama eLearning Academy", "None", "(530) 527-0188"], ["University Preparatory High", "498.0", "(559) 730-2529"], ["La Sierra High", "None", "(559) 733-6963"], ["Eleanor Roosevelt Community Learning Center", "None", "(559) 592-9160"], ["California Connections Academy@Central", "None", "(559) 713-1324"], ["Summit Charter Academy", "None", "(559) 782-5902"], ["Burton Horizon Academy", "None", "(559) 782-4748"], ["Loma Vista Charter", "None", "(559) 562-5111"], ["Crescent Valley Public Charter", "None", "(559) 970-5894"], ["Mission Oak High", "435.0", "(559) 688-2021"], ["Sierra Vista Charter High", "None", "(559) 687-7384"], ["Visalia Charter Independent Study", "442.0", "(559) 735-8055"], ["Visalia Technical Early College", "None", "(559) 622-3212"], ["El Diamante High", "475.0", "(559) 735-3501"], ["Farmersville High", "400.0", "(559) 594-4567"], ["Butterfield Charter High", "None", "(559) 782-7057"], ["Harmony Magnet Academy", "464.0", "(559) 568-0347"], ["Granite Hills High", "433.0", "(559) 782-7075"], ["Prospect Education Center", "None", "(559) 782-7095"], ["Ronald Reagan Academy", "None", "(559) 595-0563"], ["California Virtual Academy @ Jamestown", "None", "(805) 581-0202"], ["Gold Rush Charter", "None", "(209) 532-9781"], ["Connections Visual and Performing Arts Academy", "None", "(209) 928-4228"], ["Vista Real Charter High", "None", "(805) 486-5449"], ["River Oaks Academy", "None", "(805) 777-7999"], ["Golden Valley Charter", "None", "(805) 642-3435"], ["Academy of Arts and Sciences: Thousand Oaks & Simi Valley", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: Oxnard & Ventura", "None", "None"], ["Architecture, Construction & Engineering Charter High (ACE)", "None", "(805) 437-1410"], ["Condor High", "None", "(805) 385-2552"], ["Pacifica High", "454.0", "(805) 278-5000"], ["Santa Susana High", "556.0", "(805) 520-6800"], ["El Camino High", "537.0", "(805) 289-7955"], ["Foothill Technology High", "530.0", "(805) 289-0023"], ["Century Academy", "None", "(805) 496-0286"], ["Oak Park Independent", "488.0", "(818) 735-3260"], ["IvyTech Charter", "None", "(805) 222-5188"], ["The High School at Moorpark College", "519.0", "(805) 378-1444"], ["Da Vinci Charter Academy", "558.0", "(530) 757-7154"], ["West Sacramento Early College Prep Charter", "None", "(916) 375-7680"], ["Pioneer High", "455.0", "(530) 406-1148"], ["Yuba County Career Preparatory Charter", "None", "(530) 749-4000"], ["Camptonville Academy", "None", "(530) 742-2786"], ["Marysville Charter Academy for the Arts", "484.0", "(530) 749-6156"]], "spark_error": null, "total_time": 18.931740045547485, "spark_time": 0.14299798011779785, "translation_time": 18.788742065429688, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='bcfbeb81-5a30-411e-8f46-39911a5646f0'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='5e95ff76-4629-433b-9dd6-cc0377a42a75'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION vs. UNION ALL**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The `CAST(SUBSTRING(..., 1, 4) AS INT)` correctly converts the year string to an integer for comparison with integer literals (1991, 2000). The join condition `s.CDSCode = sa.cds` assumes compatible types, which is standard for such identifiers.\\n*   **Properly quoting identifiers**: All identifiers (`s.School`, `sa.AvgScrWrite`, `s.Phone`, `schools`, `s`, `satscores`, `sa`, `s.CDSCode`, `sa.cds`, `s.OpenDate`, `s.ClosedDate`) are standard SQL identifiers and do not require special quoting (like backticks).\\n*   **Use `` ` `` for the in-query strings**: This point typically refers to quoting identifiers that are keywords or contain special characters. The query uses single quotes for string literals ('1', '4') and integer literals (1991, 2000), which is correct. No identifiers requiring backticks are present.\\n*   **Using the correct number of arguments for functions**: `SUBSTRING(string, start, length)` and `CAST(expression AS type)` are used with the correct number of arguments.\\n*   **Casting to the correct data type**: `CAST(... AS INT)` is appropriate for converting the year string to an integer for numeric comparison.\\n*   **Using the proper columns for joins**: `s.CDSCode = sa.cds` is a standard way to join a schools table with a related scores table using a common identifier.\\n\\nThe query is well-formed and follows standard SQL practices.\\n\\n```sql\\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\\n```\" name='query_checker_sql_db' tool_call_id='bb7d1f3d-cac4-49a8-b879-e5f310f62946'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}"], "input_tokens": 4378, "output_tokens": 3171, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION vs. UNION ALL**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The `CAST(SUBSTRING(..., 1, 4) AS INT)` correctly converts the year string to an integer for comparison with integer literals (1991, 2000). The join condition `s.CDSCode = sa.cds` assumes compatible types, which is standard for such identifiers.\n*   **Properly quoting identifiers**: All identifiers (`s.School`, `sa.AvgScrWrite`, `s.Phone`, `schools`, `s`, `satscores`, `sa`, `s.CDSCode`, `sa.cds`, `s.OpenDate`, `s.ClosedDate`) are standard SQL identifiers and do not require special quoting (like backticks).\n*   **Use `` ` `` for the in-query strings**: This point typically refers to quoting identifiers that are keywords or contain special characters. The query uses single quotes for string literals ('1', '4') and integer literals (1991, 2000), which is correct. No identifiers requiring backticks are present.\n*   **Using the correct number of arguments for functions**: `SUBSTRING(string, start, length)` and `CAST(expression AS type)` are used with the correct number of arguments.\n*   **Casting to the correct data type**: `CAST(... AS INT)` is appropriate for converting the year string to an integer for numeric comparison.\n*   **Using the proper columns for joins**: `s.CDSCode = sa.cds` is a standard way to join a schools table with a related scores table using a common identifier.\n\nThe query is well-formed and follows standard SQL practices.\n\n```sql\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\n```", "final_answer": "", "replica": 8, "timestamp": 1768937817.3577905}
{"query_id": 27, "provider": "google", "db": "california_schools", "nl_query": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' OR strftime('%Y', T2.ClosedDate) < '2000'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') > '1991' OR DATE_FORMAT(CAST(T2.ClosedDate AS TIMESTAMP), 'yyyy') < '2000'", "jaccard": 0.0521004459047172, "spider_em": 0, "sparksql_query": "SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000", "execution_status": "VALID", "query_result": [["Crescent View West Charter", "None", "(559) 222-8439"], ["Hume Lake Charter", "None", "(559) 305-7565"], ["Big Picture Educational Academy", "None", "(559) 420-1234"], ["Clovis North High", "519.0", "(559) 327-5000"], ["Clovis Online Charter", "None", "(559) 327-4400"], ["Buchanan High", "507.0", "(559) 327-3000"], ["Clovis East High", "455.0", "(559) 327-4000"], ["Design Science Early College High", "468.0", "(559) 248-7353"], ["Sierra Charter", "None", "(559) 490-4290"], ["University High", "593.0", "(559) 278-8263"], ["Fresno Academy for Civic and Entrepreneurial Leadership", "None", "None"], ["School of Unlimited Learning", "None", "(559) 498-8543"], ["Sunnyside High", "399.0", "(559) 253-6700"], ["Carter G. Woodson Public Charter", "None", "(559) 229-3529"], ["Kingsburg Independent Study High", "None", "(559) 897-3880"], ["Orange Cove High", "405.0", "(559) 626-5900"], ["Dunlap Leadership Academy", "None", "(559) 305-7320"], ["National University Academy - Orange Center", "None", "None"], ["Academy of Arts and Sciences: Fresno", "None", "(855) 937-4227"], ["Ambassador Phillip V. Sanchez Public Charter", "None", "(559) 255-9017"], ["Hallmark Charter", "460.0", "(559) 524-7170"], ["Selma Independent", "None", "(559) 898-6670"], ["West Park Charter Academy", "None", "(559) 233-6501"], ["Crescent View South Charter", "None", "(559) 222-8439"], ["Opportunities For Learning - Fresno", "None", "(626) 921-8200"], ["Central High East Campus", "449.0", "(559) 276-0280"], ["Mendota High", "378.0", "(559) 655-1993"], ["Elm High", "None", "(559) 485-8805"], ["W. E. B. DuBois Public Charter", "None", "(559) 486-1166"], ["Success One!", "None", "(530) 934-6320"], ["Conservation Corps of Long Beach Gateway Cities Charter", "None", "(562) 216-1790"], ["Northcoast Preparatory and Performing Arts Academy", "579.0", "None"], ["Six Rivers Charter High", "472.0", "(707) 825-2428"], ["Laurel Tree Charter", "None", "(707) 822-5626"], ["Academy of the Redwoods", "524.0", "(707) 476-4203"], ["Pacific View Charter", "None", "(707) 269-9490"], ["Alder Grove Charter", "None", "(707) 268-0854"], ["Mattole Triple Junction High", "None", "(707) 629-3250"], ["Mattole Valley Charter (#159)", "None", "(707) 629-3634"], ["Southwest High", "468.0", "(760) 336-4100"], ["YouthBuild Charter School of California", "None", "(213) 741-2600"], ["YouthBuild Charter School of California Central", "None", "None"], ["The Education Corps", "None", "(323) 249-7845"], ["College Bridge Academy", "None", "(323) 249-7845"], ["Bishop Independent Study", "None", "(760) 938-2001"], ["Wonderful College Prep Academy", "377.0", "(661) 454-3000"], ["Valley Oaks Charter", "502.0", "(661) 852-6700"], ["Cesar E. Chavez High", "439.0", "(661) 720-4501"], ["Robert F. Kennedy High", "449.0", "(661) 720-5117"], ["Golden Valley High", "424.0", "(661) 827-0800"], ["Frontier High", "475.0", "(661) 829-1107"], ["Independence High", "463.0", "(661) 834-8001"], ["Mira Monte High", "403.0", "(661) 366-1800"], ["Centennial High", "489.0", "(661) 588-8601"], ["Ridgeview High", "421.0", "(661) 398-3100"], ["Kern Workforce 2000 Academy", "None", "(661) 827-3158"], ["Liberty High", "501.0", "(661) 587-0925"], ["Insight School of California", "None", "(805) 581-0202"], ["California City High", "424.0", "(760) 373-5263"], ["Abraham Lincoln Alternative", "None", "(661) 256-5090"], ["Frazier Mountain High", "443.0", "(661) 248-0310"], ["Crossroads Charter", "None", "(559) 583-5060"], ["California Virtual Academy @ Kings", "None", "(805) 581-0202"], ["National University Academy, Armona", "None", "None"], ["Sierra Pacific High", "464.0", "(559) 583-5912"], ["Hanford West High", "450.0", "(559) 583-5903"], ["Lemoore Middle College High", "464.0", "(559) 925-3552"], ["New Day Academy", "None", "(530) 233-3861"], ["Westwood Charter", "None", "(530) 256-2994"], ["Mt. Lassen Charter", "None", "(530) 827-2129"], ["Los Angeles International Charter High", "428.0", "(323) 257-1499"], ["Optimist Charter", "None", "(323) 443-3100"], ["International Polytechnic High", "495.0", "(909) 839-2320"], ["Soledad Enrichment Action Charter High", "335.0", "(213) 480-4200"], ["William J. (Pete) Knight High", "442.0", "(661) 533-9000"], ["Eastside High", "409.0", "(661) 946-3800"], ["SOAR High (Students On Academic Rise)", "496.0", "(661) 722-6300"], ["Los Angeles County Online High", "None", "(800) 985-0770"], ["Academies of the Antelope Valley", "None", "(661) 948-7655"], ["Lancaster High", "449.0", "(661) 726-7649"], ["Desert Sands Charter", "None", "(661) 942-3357"], ["Opportunities For Learning - Baldwin Park II", "426.0", "(626) 962-3311"], ["Opportunities for Learning - Baldwin Park", "447.0", "(626) 814-0161"], ["Options for Youth-Burbank Charter", "464.0", "(818) 566-7525"], ["Centinela Valley Independent Study", "None", "(310) 263-4469"], ["Family First Charter", "None", "(310) 355-0001"], ["New Opportunities Charter", "None", "(310) 355-0001"], ["Lawndale High", "423.0", "(310) 263-3102"], ["Opportunities for Learning - Duarte", "None", "(626) 921-8200"], ["South El Monte High", "427.0", "(626) 442-0218"], ["Anderson W. Clark Magnet High", "539.0", "(818) 248-8324"], ["Gorman Learning Center", "473.0", "(909) 307-6312"], ["Hawthorne Math and Science Academy", "492.0", "(310) 973-8184"], ["City Honors College Preparatory Academy", "442.0", "(310) 680-4880"], ["Animo Inglewood Charter High", "448.0", "(310) 673-0956"], ["Environmental Charter High", "446.0", "(310) 214-3400"], ["Lennox Mathematics, Science and Technology Academy", "418.0", "(310) 680-5600"], ["Animo Leadership High", "416.0", "(310) 216-3277"], ["Beach High-Intensive Learning Program", "None", "(562) 595-8893"], ["Cabrillo High", "388.0", "(562) 951-7700"], ["Renaissance High School for the Arts", "483.0", "(562) 901-0168"], ["High Tech LA", "508.0", "(818) 609-2640"], ["Wallis Annenberg High", "416.0", "(323) 235-6343"], ["North Valley Military Institute College Preparatory Academy", "None", "(818) 368-1557"], ["Central City Value", "404.0", "(213) 471-4686"], ["View Park Preparatory Accelerated High", "382.0", "(323) 290-6975"], ["Crenshaw Arts-Technology Charter High", "381.0", "(323) 293-3917"], ["Oscar De La Hoya Animo Charter High", "398.0", "(323) 780-1259"], ["Renaissance Arts Academy", "506.0", "(323) 259-5700"], ["Animo South Los Angeles Charter", "376.0", "(323) 779-0544"], ["New Designs Charter", "411.0", "(213) 765-9084"], ["Middle College High", "435.0", "(323) 418-4700"], ["Harbor Teacher Preparation Academy", "509.0", "(310) 834-3932"], ["Ivy Academia", "431.0", "(818) 716-0771"], ["Camino Nuevo Charter High", "413.0", "(213) 240-8700"], ["Animo Venice Charter High", "414.0", "(310) 392-8751"], ["Animo Pat Brown", "377.0", "(323) 585-3312"], ["Alliance Gertz-Ressler Richard Merkin 6-12 Complex", "436.0", "(213) 745-8141"], ["Orthopaedic Hospital", "444.0", "(213) 765-2088"], ["Northridge Academy High", "464.0", "(818) 700-2222"], ["International Studies Learning Center at Legacy High School Complex", "457.0", "(323) 357-7521"], ["Port of Los Angeles High", "487.0", "(310) 832-9201"], ["CHAMPS - Charter HS of Arts-Multimedia & Performing", "497.0", "(818) 994-7614"], ["Alliance Judy Ivie Burton Technology Academy High", "408.0", "(323) 920-6125"], ["Alliance Collins Family College-Ready High", "390.0", "(323) 923-1588"], ["Pacific Boulevard", "None", "(323) 586-8640"], ["Santee Education Complex", "382.0", "(213) 763-1000"], ["South East High", "439.0", "(323) 568-3400"], ["Maywood Academy High", "420.0", "(323) 838-6000"], ["PUC CA Academy for Liberal Studies Early College High", "437.0", "None"], ["Los Angeles Academy of Arts & Enterprise Charter", "388.0", "(213) 487-0600"], ["Frida Kahlo High", "None", "(213) 763-1090"], ["New Village Girls Academy", "374.0", "(213) 385-4015"], ["Alliance Patti And Peter Neuwirth Leadership Academy", "386.0", "(213) 342-2874"], ["Alliance Dr. Olga Mohan High", "407.0", "(213) 342-2870"], ["Animo Ralph Bunche Charter High", "387.0", "(323) 232-9436"], ["Animo Jackie Robinson High", "377.0", "(323) 846-5800"], ["Animo Watts College Preparatory Academy", "362.0", "(323) 756-3930"], ["Alliance Ouchi-O'Donovan 6-12 Complex", "397.0", "(323) 596-2290"], ["Alliance Marc & Eva Stern Math and Science", "439.0", "(323) 987-2144"], ["School of Business and Tourism at Contreras Learning Complex", "403.0", "(213) 240-3800"], ["East Valley Senior High", "415.0", "(818) 753-4400"], ["Arleta High", "397.0", "(818) 686-4100"], ["Panorama High", "411.0", "(818) 909-4500"], ["Bright Star Secondary Charter Academy", "435.0", "(424) 789-8337"], ["Frederick Douglass Academy High", "378.0", "None"], ["Student Empowerment Academy", "372.0", "None"], ["Contreras Learning Center-Los Angeles School of Global Studies", "378.0", "(213) 240-3850"], ["West Adams Preparatory High", "385.0", "(323) 373-2500"], ["Magnolia Science Academy 3", "418.0", "(310) 637-3806"], ["Magnolia Science Academy 2", "427.0", "(818) 758-0300"], ["Discovery Charter Preparatory School #2", "373.0", "(818) 897-1187"], ["Alliance Morgan McKinzie High", "375.0", "(323) 859-0750"], ["Edward R. Roybal Learning Center", "408.0", "(213) 580-6400"], ["Helen Bernstein High", "391.0", "(323) 817-6460"], ["APEX Academy", "368.0", "(323) 817-6550"], ["Alliance Piera Barabaglia Shaheen Health Services Academy", "393.0", "(323) 972-9010"], ["Alliance Leichtman-Levine Family Foundation Environmental Science High", "444.0", "(323) 739-0560"], ["Magnolia Science Academy 4", "405.0", "(310) 473-2464"], ["Contreras Learning Center-Academic Leadership Community", "390.0", "(213) 240-3815"], ["Los Angeles High School of the Arts", "409.0", "(213) 480-4600"], ["Los Angeles Teacher Preparatory Academy", "339.0", "None"], ["School for the Visual Arts and Humanities", "394.0", "(213) 480-4700"], ["New Millennium Secondary", "388.0", "(310) 999-6162"], ["Alain Leroy Locke College Preparatory Academy", "364.0", "(323) 420-2100"], ["Sun Valley High", "385.0", "(818) 394-4600"], ["New Open World Academy K-12", "402.0", "(213) 480-3700"], ["UCLA Community K-12", "392.0", "(213) 480-3750"], ["Ramon C. Cortines School of Visual and Performing Arts", "446.0", "(213) 217-8600"], ["Felicitas and Gonzalo Mendez High", "382.0", "(323) 981-6100"], ["New Designs Charter School-Watts", "371.0", "(323) 418-0600"], ["Daniel Pearl Journalism & Communications Magnet", "470.0", "(818) 654-3775"], ["Ambassador-Global Leadership", "412.0", "(213) 480-4540"], ["Alliance Cindy and Bill Simon Technology Academy High", "364.0", "(323) 744-2122"], ["Alliance Tennenbaum Family Technology High", "385.0", "(323) 276-5545"], ["Environmental and Social Policy Magnet", "390.0", "(323) 441-4577"], ["Math, Science, & Technology Magnet Academy at Roosevelt High", "447.0", "(323) 780-6500"], ["Esteban Torres East LA Performing Arts Magnet", "378.0", "(323) 265-6725"], ["Humanitas Academy of Art and Technology at Esteban E. Torres High No. 4", "386.0", "(323) 265-6830"], ["Social Justice Leadership Academy at Esteban E. Torres High No. 5", "371.0", "(323) 265-6865"], ["East Los Angeles Renaissance Academy at Esteban E. Torres High No. 2", "388.0", "(323) 265-6760"], ["Engineering and Technology Academy at Esteban E. Torres High No. 3", "395.0", "(323) 285-6795"], ["PUC Triumph Charter High", "None", "None"], ["PUC Lakeview Charter High", "390.0", "(818) 356-2591"], ["Aspire Pacific Academy", "394.0", "(323) 589-2800"], ["Los Angeles Big Picture High", "None", "None"], ["Alliance Ted K. Tajima High", "378.0", "(213) 241-8533"], ["Valley Academy of Arts and Sciences", "440.0", "(818) 832-7750"], ["Cesar E. Chavez Learning Academy - Arts/Theatre/Entertain Mag", "369.0", "(818) 837-6428"], ["Cesar E. Chavez Learning Academies-Social Justice Humanitas Academy", "401.0", "(818) 838-3915"], ["Cesar E. Chavez Learning Academies-Academy of Scientific Exploration (ASE)", "413.0", "(818) 838-3926"], ["Cesar E. Chavez Learning Academies-Teacher Preparation Academy", "401.0", "(818) 838-3946"], ["Los Angeles River at Sonia Sotomayor Learning Academies", "383.0", "(323) 276-5535"], ["School of History and Dramatic Arts at Sonia Sotomayor Learning Academies", "430.0", "(323) 276-5500"], ["Dr. Maya Angelou Community High", "363.0", "(323) 846-4700"], ["Public Service Community at Diego Rivera Learning Complex", "406.0", "(323) 846-2128"], ["Communication and Technology at Diego Rivera Learning Complex", "373.0", "(323) 846-2118"], ["Green Design at Diego Rivera Learning Complex", "375.0", "(323) 846-2108"], ["Performing Arts Community at Diego Rivera Learning Complex", "372.0", "(323) 846-2136"], ["Rancho Dominguez Preparatory", "420.0", "(310) 354-3400"], ["Synergy Quantum Academy", "419.0", "(323) 846-4716"], ["Animo College Preparatory Academy", "359.0", "(323) 568-4136"], ["Alliance Renee and Meyer Luskin Academy High", "364.0", "(323) 905-1210"], ["PUC Early College Academy for Leaders and Scholars (ECALS)", "401.0", "(323) 276-5525"], ["Alliance Margaret M. Bloomfield Technology Academy High", "None", "(323) 537-2060"], ["Leadership in Entertainment and Media Arts (LEMA)", "354.0", "None"], ["STEM Academy at Bernstein High", "399.0", "(323) 817-6461"], ["Academy of Science and Engineering", "None", "(323) 545-1100"], ["Augustus F. Hawkins High A Critical Design and Gaming", "354.0", "(323) 789-1282"], ["Augustus F. Hawkins High B Community Health Advocates", "366.0", "(323) 789-1282"], ["Augustus F. Hawkins High C Responsible Indigenous Social Entrepreneurship", "346.0", "(323) 789-1282"], ["Linda Esperanza Marquez High A Huntington Park Institute of Applied Medicine", "431.0", "(323) 568-3800"], ["Linda Esperanza Marquez High B LIBRA Academy", "410.0", "(323) 584-3800"], ["Linda Esperanza Marquez High C School of Social Justice", "423.0", "(323) 584-3800"], ["Science, Technology, Engineering, Arts and Mathematics at Legacy High School Complex", "383.0", "(323) 357-7545"], ["Visual and Performing Arts at Legacy High School Complex", "386.0", "(323) 357-7500"], ["Academy for Multilingual Arts and Science at Mervyn M. Dymally High", "377.0", "(323) 565-4600"], ["Academies of Education and Empowerment at Carson High", "403.0", "(310) 847-1455"], ["Academy of Medical Arts at Carson High", "417.0", "(310) 847-1465"], ["Humanities and Arts (HARTS) Academy of Los Angeles", "425.0", "(310) 257-7100"], ["Contreras Learning Center-School of Social Justice", "383.0", "(213) 240-3800"], ["Early College Academy-LA Trade Tech College", "None", "(323) 763-3685"], ["Camino Nuevo High #2", "None", "(213) 736-5566"], ["Youth Opportunities Unlimited", "None", "(323) 789-4731"], ["Palisades Charter High", "525.0", "(310) 230-6623"], ["City of Angels", "501.0", "(323) 415-8350"], ["Los Angeles Leadership Academy", "425.0", "(323) 227-7719"], ["PUC Community Charter Middle and PUC Community Charter Early College High", "None", "(818) 485-0933"], ["Magnolia Science Academy", "470.0", "(818) 609-0507"], ["Marco Antonio Firebaugh High", "412.0", "(310) 886-5200"], ["Pathway Independent Study", "None", "(310) 603-1516"], ["Mountain Park", "468.0", "(626) 471-3014"], ["Applied Technology Center", "420.0", "(323) 248-2500"], ["Antelope Valley Learning Academy", "None", "(661) 952-6028"], ["Palmdale Aerospace Academy", "None", "(661) 273-3680"], ["Guidance Charter", "407.0", "(661) 285-1600"], ["Palos Verdes High", "564.0", "(310) 378-8471"], ["Paramount Alternative Education Center", "None", "None"], ["Aveson Global Leadership Academy", "None", "(626) 797-1438"], ["CIS Academy", "None", "(626) 396-5883"], ["Learning Works", "None", "(626) 564-2871"], ["School of Extended Educational Options", "None", "(909) 397-4900"], ["Diamond Ranch High", "472.0", "(909) 397-4715"], ["Village Academy High School at Indian Hill", "442.0", "(909) 397-4900"], ["Malibu High", "553.0", "(310) 457-6801"], ["California Virtual Academy @ Los Angeles", "521.0", "(805) 581-0202"], ["Edgewood High", "493.0", "(626) 939-0600"], ["Insight @ Los Angeles", "425.0", "None"], ["Golden Valley High", "500.0", "(661) 298-8140"], ["West Ranch High", "539.0", "(661) 222-1220"], ["Mission View Public", "None", "(661) 200-5595"], ["Santa Clarita Valley International", "443.0", "(661) 705-4820"], ["Albert Einstein Academy for Letters, Arts and Sciences", "None", "(661) 702-0755"], ["Valencia High", "528.0", "(661) 294-1188"], ["Opportunities for Learning - Santa Clarita", "489.0", "(661) 424-1337"], ["Academy of the Canyons", "596.0", "(661) 362-3056"], ["Thurgood Marshall", "None", "(310) 898-6340"], ["iQ Academy California-Los Angeles", "None", "(888) 997-4722"], ["Gabrielino High", "518.0", "(626) 573-2415"], ["Options for Youth San Gabriel", "455.0", "(626) 921-8200"], ["Del Mar High", "None", "(626) 291-5723"], ["Assurance Learning Academy", "None", "(661) 272-1225"], ["Inspire Charter School", "None", "(661) 269-2214"], ["Academy of Arts and Sciences: Los Angeles (9-12)", "None", "(855) 937-4227"], ["SIATech Academy South", "None", "(760) 945-1227"], ["Vasquez High", "500.0", "(661) 269-0451"], ["Redondo Shores High (Continuation)", "None", "(310) 798-8690"], ["School of Arts and Enterprise", "473.0", "(909) 622-0699"], ["Lifeline Education Charter", "359.0", "(310) 605-2510"], ["Da Vinci Science", "467.0", "(310) 725-5800"], ["Da Vinci Design", "459.0", "(310) 725-5800"], ["Anahuacalmecac International University Preparatory of North America", "None", "None"], ["Madera County Independent Academy", "None", "(559) 662-4636"], ["Pioneer Technical Center", "None", "(559) 662-6294"], ["Madera South High", "414.0", "(559) 675-4450"], ["Sherman Thomas Charter High", "None", "(559) 675-6626"], ["Liberty High", "472.0", "(559) 645-3500"], ["Minarets High", "472.0", "(559) 868-8689"], ["Minarets Charter High", "463.0", "(559) 868-8659"], ["Chawanakee Academy", "None", "None"], ["Glacier High School Charter", "None", "(559) 642-1422"], ["San Andreas High (Continuation)", "None", "(415) 945-3751"], ["Ukiah Independent Study Academy", "None", "(707) 472-5062"], ["Redwood Academy of Ukiah", "540.0", "(707) 467-0500"], ["Accelerated Achievement Academy", "None", "(707) 463-7080"], ["New Horizons", "None", "(707) 459-4801"], ["Willits Charter", "None", "(707) 459-5506"], ["Merced Scholars Charter", "None", "(209) 381-5165"], ["Crossroads Alternative Education Center", "None", "(209) 826-4013"], ["Pacheco High", "441.0", "(209) 826-3801"], ["Golden Valley High", "436.0", "(209) 325-1800"], ["Buhach Colony High", "438.0", "(209) 325-1400"], ["Shattuck Independent Study", "None", "(209) 656-2012"], ["Delhi High", "419.0", "(209) 656-2050"], ["Urban Corps of San Diego County Charter", "None", "(619) 235-6884"], ["Orange County Conservation Corps Charter", "None", "(714) 956-6222"], ["Monterey County Home Charter", "None", "(831) 755-0331"], ["Greenfield High", "427.0", "(831) 674-2751"], ["Marina High", "454.0", "(831) 583-2060"], ["Learning for Life Charter", "None", "(831) 582-9820"], ["El Puente", "None", "(831) 796-7700"], ["Everett Alvarez High", "446.0", "(831) 796-7800"], ["Soledad High", "428.0", "(831) 678-6400"], ["Gonzales High", "425.0", "(831) 675-2495"], ["Napa Valley Independent Studies", "None", "(707) 259-8577"], ["American Canyon High", "470.0", "(707) 265-2710"], ["New Technology High", "500.0", "(707) 259-8557"], ["Bitney College Preparatory High", "482.0", "(530) 477-1235"], ["Forest Charter", "508.0", "(530) 265-4823"], ["EPIC de Cesar Chavez", "None", "(661) 822-4381"], ["John Muir Charter Schools", "None", "(530) 272-4008"], ["William & Marian Ghidotti High", "576.0", "(530) 274-5270"], ["Vantage Point Charter", "None", "(530) 432-5312"], ["OCCS:CHEP/PCHS", "528.0", "(714) 327-1000"], ["Oxford Academy", "634.0", "(714) 220-3055"], ["Capistrano Connections Academy", "512.0", "(949) 461-1667"], ["San Juan Hills High", "534.0", "(949) 234-5900"], ["California Preparatory Academy", "None", "(949) 234-5317"], ["Aliso Niguel High", "548.0", "(949) 831-5590"], ["Tesoro High", "545.0", "(949) 234-5310"], ["Opportunities for Learning - Capistrano", "None", "(949) 248-1282"], ["Early College High", "478.0", "(714) 241-6108"], ["OUSD Home Sch", "None", "(714) 628-5479"], ["Yorba Linda High", "543.0", "(714) 986-7500"], ["Parkview", "None", "(714) 986-7050"], ["Nova Academy", "448.0", "(714) 569-0948"], ["Segerstrom High", "463.0", "(714) 241-5000"], ["Hector G. Godinez", "433.0", "(714) 433-6790"], ["Cesar E. Chavez High", "None", "(714) 430-5700"], ["Middle College High", "483.0", "(714) 953-3900"], ["OCSA", "582.0", "(714) 560-9000"], ["Arnold O. Beckman High", "572.0", "(714) 734-2900"], ["Northwood High", "621.0", "(949) 936-7200"], ["CORE Placer Charter", "None", "(530) 346-8340"], ["John Adams Academy", "576.0", "(916) 780-6800"], ["Foresthill High", "490.0", "(530) 367-5244"], ["Antelope High", "469.0", "(916) 726-1400"], ["Woodcreek High", "501.0", "(916) 771-6565"], ["Granite Bay High", "551.0", "(916) 786-8676"], ["Cold Stream Alternative", "None", "(530) 582-2640"], ["Partnerships for Student-Centered Learning", "None", "(916) 408-5200"], ["Horizon Charter", "456.0", "(916) 408-5200"], ["Whitney High", "502.0", "(916) 632-6500"], ["Western Sierra Collegiate Academy", "547.0", "(916) 778-4544"], ["Rocklin Independent Charter Academy", "None", "(916) 632-3195"], ["Rocklin High", "527.0", "(916) 632-1600"], ["Victory High", "None", "(916) 632-3195"], ["Plumas Charter", "None", "(530) 283-3851"], ["River Springs Charter", "478.0", "(951) 252-8800"], ["Riverside County Education Academy", "None", "(951) 826-6602"], ["Come Back Kids", "None", "(951) 826-6461"], ["Gateway College and Career Academy", "None", "(951) 222-8931"], ["Alvord Alternative Continuation High", "None", "(951) 509-6021"], ["Banning Independent Study", "None", "(951) 922-0268"], ["21st Century Learning Institute", "None", "(951) 769-8424"], ["Eleanor Roosevelt High", "486.0", "(951) 738-2100"], ["John F. Kennedy High", "497.0", "(951) 738-2200"], ["Corona-Norco Alternative", "None", "(951) 736-3367"], ["Lee V. Pollard High", "None", "(951) 736-3367"], ["Santiago High", "499.0", "(951) 739-5600"], ["Shadow Hills High", "434.0", "(760) 393-5400"], ["La Quinta High", "462.0", "(760) 772-4150"], ["Horizon", "None", "(760) 238-9720"], ["Hamilton High", "481.0", "(951) 763-1865"], ["Tahquitz High", "445.0", "(951) 765-6300"], ["College Prep High", "463.0", "(951) 925-5155"], ["Patriot High", "463.0", "(951) 361-6500"], ["Rivercrest Preparatory", "None", "(951) 360-2660"], ["Santa Rosa Academy", "503.0", "(951) 672-2400"], ["Moreno Valley Online Academy", "None", "(951) 571-4800"], ["Vista del Lago High", "424.0", "(951) 571-4880"], ["Nuview Bridge Early College High", "471.0", "(951) 928-8498"], ["Desert Hot Springs High", "429.0", "(760) 288-7000"], ["California Military Institute", "423.0", "(951) 443-2731"], ["Heritage High", "444.0", "(951) 940-5447"], ["Paloma Valley High", "450.0", "(951) 672-6030"], ["Riverside Virtual", "None", "(951) 276-2006"], ["Martin Luther King Jr. High", "494.0", "(951) 789-5690"], ["Mountain Heights Academy", "None", "(951) 487-7710"], ["San Jacinto Valley Academy", "466.0", "(951) 654-6113"], ["Desert Mirage High", "414.0", "(760) 397-2255"], ["NOVA Academy - Coachella", "403.0", "(714) 569-0948"], ["Lakeside High", "454.0", "(951) 253-7300"], ["Keith McCarthy Academy", "None", "(951) 253-7777"], ["Southern California Online Academy", "None", "None"], ["Great Oak High", "505.0", "(951) 294-6450"], ["Susan H. Nelson", "None", "(951) 695-7360"], ["Chaparral High", "491.0", "(951) 695-4200"], ["Temecula Preparatory", "539.0", "(951) 926-6776"], ["Vista Murrieta High", "491.0", "(951) 894-5750"], ["Murrieta Canyon Academy", "None", "(951) 696-1661"], ["Murrieta Mesa High", "478.0", "(951) 677-0568"], ["Citrus Hill High", "405.0", "(951) 490-0400"], ["Val Verde Academy", "None", "(951) 443-2450"], ["Monterey Trail High", "444.0", "(916) 688-0050"], ["Pleasant Grove High", "513.0", "(916) 686-0230"], ["Cosumnes Oaks High", "491.0", "(916) 683-7670"], ["Laguna Creek High", "483.0", "(916) 683-1339"], ["Sheldon High", "472.0", "(916) 681-7500"], ["Franklin High", "512.0", "(916) 714-8150"], ["Elk Grove Charter", "None", "(916) 714-1653"], ["Vista del Lago High", "552.0", "(916) 294-2410"], ["Liberty Ranch High", "496.0", "(209) 744-4250"], ["New Technology High", "432.0", "(916) 395-5254"], ["George Washington Carver School of Arts and Science", "526.0", "(916) 395-5266"], ["The MET", "468.0", "(916) 395-5417"], ["Rosemont High", "452.0", "(916) 395-5130"], ["Sacramento Charter High", "403.0", "(916) 277-6200"], ["Arthur A. Benjamin Health Professions High", "449.0", "(916) 395-5010"], ["School of Engineering & Sciences", "420.0", "(916) 395-5040"], ["Capital City Independent Study", "None", "(916) 433-5187"], ["West Campus", "500.0", "(916) 277-6400"], ["Aspire Alexander Twilight Secondary Academy", "403.0", "(916) 979-1788"], ["Options for Youth-San Juan", "431.0", "(916) 485-5155"], ["Visions In Education", "533.0", "(916) 971-7037"], ["San Juan Choices Charter", "None", "(916) 979-8378"], ["Global Youth Charter", "None", "(916) 339-4680"], ["Antelope View Charter", "None", "None"], ["Inderkum High", "449.0", "(916) 567-5640"], ["Natomas Pacific Pathways Prep", "477.0", "(916) 567-5740"], ["Natomas High", "454.0", "(916) 641-4960"], ["Natomas Charter", "524.0", "(916) 928-5353"], ["Futures High", "489.0", "(916) 286-1902"], ["Heritage Peak Charter", "458.0", "(866) 992-9033"], ["Creative Connections Arts Academy", "None", "(916) 566-1870"], ["Community Collaborative Charter", "None", "(916) 286-5161"], ["SAVA: Sacramento Academic and Vocational Academy", "None", "(916) 387-8063"], ["Highlands Community Charter", "None", "(916) 844-2283"], ["Elwood J. Keema High", "None", "(916) 566-3410"], ["Vista Nueva Career and Technology High", "None", "(916) 566-2750"], ["Anzar High", "479.0", "(831) 623-7660"], ["Alta Vista Public", "None", "(760) 947-0006"], ["Chaffey District Online High", "None", "(909) 985-0966"], ["Rancho Cucamonga High", "489.0", "(909) 989-1600"], ["Los Osos High", "511.0", "(909) 477-6900"], ["Colony High", "450.0", "(909) 930-2929"], ["Chino Hills High", "508.0", "(909) 606-7540"], ["Grand Terrace High School at the Ray Abril Jr. Educational Complex", "441.0", "(909) 580-5006"], ["Summit High", "425.0", "(909) 357-5950"], ["Jurupa Hills High", "424.0", "(909) 357-6300"], ["Henry J. Kaiser High", "417.0", "(909) 357-5900"], ["Academy of Careers and Exploration", "462.0", "(760) 952-1266"], ["Empire Springs Charter", "None", "(951) 252-8800"], ["Independence Charter Academy", "None", "(760) 952-1760"], ["Alta Vista South Public Charter", "None", "(661) 272-1225"], ["Hope Academy Charter", "None", "None"], ["Mojave River Academy", "None", "(760) 245-3222"], ["Riverside Preparatory", "447.0", "(760) 243-5884"], ["Citrus Valley High", "473.0", "(909) 799-2300"], ["Redlands eAcademy", "None", "(909) 748-6941"], ["Redlands East Valley High", "498.0", "(909) 389-2500"], ["Grove", "535.0", "(909) 798-7831"], ["Wilmer Amina Carter High", "436.0", "(909) 854-4100"], ["Rialto High", "421.0", "(909) 421-7500"], ["ASA Charter", "None", "(909) 475-3322"], ["Public Safety Academy", "None", "(909) 382-2211"], ["Options for Youth-San Bernardino", "457.0", "(626) 685-9300"], ["Indian Springs High", "400.0", "(909) 383-1360"], ["Provisional Accelerated Learning Academy", "None", "(909) 887-7002"], ["Arroyo Valley High", "406.0", "(909) 381-4295"], ["Middle College High", "469.0", "(909) 888-4041"], ["University Preparatory", "500.0", "(760) 243-5940"], ["Adelanto High", "421.0", "(760) 246-3909"], ["Options for Youth-Victorville Charter", "419.0", "(626) 685-9300"], ["Excelsior Charter", "473.0", "(760) 245-4262"], ["Silverado High", "422.0", "(760) 955-3353"], ["Silver Valley Academy", "None", "(760) 254-2715"], ["Summit Leadership Academy-High Desert", "370.0", "(760) 949-9202"], ["Mirus Secondary", "None", "(760) 244-3764"], ["Encore Jr./Sr. High School for the Performing and Visual Arts", "486.0", "(760) 956-2632"], ["Oak Hills High", "450.0", "(760) 244-2283"], ["Sultana High", "448.0", "(760) 947-6777"], ["Shadow Ridge", "None", "(760) 949-8267"], ["Sky Mountain Charter", "None", "(530) 295-3566"], ["Granite Hills High", "479.0", "(760) 961-2290"], ["High Desert Premier Academy", "None", "(760) 240-4252"], ["Academy for Academic Excellence", "505.0", "(760) 946-5414"], ["San Pasqual Academy", "363.0", "(760) 233-6003"], ["Monarch", "None", "(619) 652-4100"], ["Literacy First Charter", "None", "(619) 579-7232"], ["Juan Bautista de Anza", "None", "(760) 767-5850"], ["Diego Springs Academy", "None", "(661) 272-1225"], ["Coronado Pathways Charter", "None", "None"], ["Diego Hills Charter", "None", "(619) 286-0312"], ["Dehesa Charter", "529.0", "(760) 743-7880"], ["Classical Academy High", "548.0", "(760) 480-9845"], ["Escondido Charter High", "513.0", "(760) 737-3154"], ["Oasis High (Alternative)", "None", "(760) 723-6395"], ["Steele Canyon High", "492.0", "(619) 660-3550"], ["Grossmont Middle College High", "525.0", "(619) 644-7524"], ["Helix High", "464.0", "(619) 466-4194"], ["Greater San Diego Academy", "None", "(619) 669-3050"], ["Diego Valley Charter", "None", "(619) 286-0312"], ["Julian Charter", "517.0", "(760) 765-3847"], ["National University Academy", "None", "(760) 631-5842"], ["River Valley Charter", "555.0", "(619) 390-2579"], ["San Diego Virtual", "None", "(619) 713-7271"], ["Pivot Charter School - San Diego", "None", "(760) 591-0217"], ["Academy of Arts and Sciences: El Cajon Middle and High (6-12)", "None", "None"], ["Academy of Arts and Sciences", "None", "(855) 937-4227"], ["Del Norte High", "565.0", "(858) 487-0877"], ["Westview High", "581.0", "(858) 780-2000"], ["Future Bound Independent Study Secondary", "None", "(760) 787-2068"], ["Mountain Valley Academy", "None", "(760) 787-3600"], ["High Tech High International", "477.0", "(619) 243-5014"], ["Learning Choice Academy", "None", "(619) 463-6849"], ["San Diego International Studies", "523.0", "(619) 525-7464"], ["San Diego Business/Leadership", "402.0", "(619) 525-7461"], ["San Diego MVP Arts", "405.0", "None"], ["Kearny Digital Media & Design", "482.0", "(858) 496-8370"], ["Kearny SCT", "452.0", "(858) 496-8370"], ["Kearny College Connections", "450.0", "(858) 496-8370"], ["Kearny Eng, Innov & Design", "426.0", "(858) 496-8370"], ["Crawford High", "380.0", "(619) 362-3700"], ["San Diego Science and Technology", "423.0", "(619) 525-7459"], ["San Diego Metro Career and Tech", "489.0", "(619) 388-2299"], ["High Tech High Media Arts", "457.0", "(619) 398-8632"], ["Lincoln High", "389.0", "(619) 266-6500"], ["Health Sciences High", "422.0", "(619) 528-9070"], ["Arroyo Paseo Charter High", "None", "(619) 677-3017"], ["East Village High", "483.0", "(619) 525-2000"], ["King-Chavez Community High", "369.0", "(619) 704-1020"], ["Gompers Preparatory Academy", "363.0", "(619) 263-2171"], ["iHigh Virtual Academy", "None", "(619) 764-5440"], ["School for Entrepreneurship and Technology", "453.0", "(858) 874-4338"], ["Home & Hosp/Transition Support", "None", "(619) 344-6435"], ["Laurel Preparatory Academy", "None", "(858) 678-4812"], ["Scripps Ranch High", "564.0", "(858) 621-9020"], ["Charter School of San Diego", "479.0", "(858) 678-2020"], ["Preuss School UCSD", "520.0", "(858) 822-3000"], ["High Tech High", "477.0", "(619) 243-5014"], ["Audeo Charter", "483.0", "(858) 678-2050"], ["Canyon Crest Academy", "611.0", "(858) 350-0253"], ["La Costa Canyon High", "542.0", "(760) 436-6136"], ["Insight @ San Diego", "None", "(805) 581-0202"], ["California Virtual Academy @ San Diego", "517.0", "(805) 581-0202"], ["Olympian High", "476.0", "(619) 656-2400"], ["Eastlake High", "498.0", "(619) 397-3800"], ["Options Secondary", "None", "(619) 796-7320"], ["MAAC Community Charter", "None", "(619) 476-0749"], ["Alta Vista Academy", "None", "(619) 216-5160"], ["San Ysidro High", "431.0", "(619) 710-2300"], ["Otay Ranch Senior High", "474.0", "(619) 591-5000"], ["RAI Online Charter", "None", "None"], ["Taylion San Diego Academy", "None", "(760) 295-5564"], ["SIATech", "None", "(760) 945-1227"], ["North County Trade Tech High", "None", "(760) 598-0782"], ["Mission Vista High", "501.0", "(760) 758-6800"], ["Guajome Learning Center", "None", "(760) 631-8500"], ["Vista Visions Academy", "None", "(760) 724-4785"], ["Guajome Park Academy Charter", "531.0", "(760) 631-8500"], ["Carlsbad Seaside Academy", "None", "(760) 331-5299"], ["Pacific View Charter", "None", "(760) 757-0161"], ["Mission Hills High", "495.0", "(760) 290-2700"], ["Bayshore Preparatory Charter", "None", "(760) 471-0847"], ["Warner Junior/Senior High", "None", "(760) 782-3517"], ["Valley Center High", "474.0", "(760) 751-5502"], ["Valley Center Prep", "None", "(760) 751-0455"], ["High Tech High Chula Vista", "471.0", "(619) 243-5014"], ["High Tech High North County", "511.0", "(619) 243-5014"], ["Five Keys Charter (SF Sheriff's)", "None", "(415) 734-3310"], ["Jordan (June) School for Equity", "None", "(415) 452-4922"], ["City Arts and Tech High", "395.0", "(415) 841-2200"], ["Five Keys Adult School (SF Sheriff's)", "None", "(415) 734-3310"], ["Five Keys Independence HS (SF Sheriff's)", "None", "(415) 734-3310"], ["S.F. International High", "318.0", "(415) 695-5781"], ["Academy (The)- SF @McAteer", "456.0", "(415) 695-5700"], ["Gateway to College", "None", "(415) 452-5768"], ["Asawa (Ruth) SF Sch of the Arts, A Public School", "553.0", "(415) 695-5700"], ["Marshall (Thurgood) High", "364.0", "(415) 695-5612"], ["Leadership High", "408.0", "(415) 841-8910"], ["Gateway High", "483.0", "(415) 749-3600"], ["San Francisco Flex Academy", "502.0", "None"], ["one.Charter", "None", "(209) 468-9079"], ["San Joaquin Building Futures Academy", "None", "(209) 468-8140"], ["Venture Academy", "458.0", "(209) 468-5940"], ["Aspire Benjamin Holt College Preparatory Academy", "503.0", "(209) 955-1477"], ["Ronald E. McNair High", "436.0", "(209) 953-9245"], ["Rio Valley Charter", "None", "(209) 368-4934"], ["Independence", "None", "(209) 331-8275"], ["Middle College High", "565.0", "(209) 954-5790"], ["Weston Ranch High", "454.0", "(209) 938-6245"], ["New Vision High", "None", "(209) 938-6225"], ["Lathrop High", "432.0", "(209) 938-6350"], ["be.tech", "None", "(209) 858-7460"], ["Sierra High", "463.0", "(209) 858-7410"], ["Humphreys College Academy of Business, Law and Education", "424.0", "(209) 478-1600"], ["California Virtual Academy @ San Joaquin", "None", "(805) 581-0202"], ["Renew Virtual Academy K12 #1", "None", "None"], ["Delta Home Charter", "None", "(209) 830-6363"], ["Valley View Charter Prep", "None", "(916) 866-9033"], ["Delta Charter Online", "None", "(209) 830-6363"], ["Delta Charter", "468.0", "(209) 830-6363"], ["California Connections Academy @ Ripon", "535.0", "(209) 253-1208"], ["Cesar Chavez High", "417.0", "(209) 933-7480"], ["Edward C. Merlo Institute of Environmental Studies", "370.0", "(209) 933-7190"], ["Aspire Langston Hughes Academy", "408.0", "(209) 943-2389"], ["Stockton Unified Early College Academy", "519.0", "(209) 933-7370"], ["Stockton High", "None", "(209) 933-7365"], ["Stockton Collegiate International Secondary", "475.0", "(209) 390-9861"], ["Health Careers Academy", "418.0", "(209) 933-7360"], ["Pacific Law Academy", "None", "(209) 933-7475"], ["Weber Institute", "420.0", "(209) 933-7330"], ["Millennium Charter", "480.0", "(209) 831-5240"], ["John C. Kimball High", "500.0", "(209) 832-6600"], ["Merrill F. West High", "479.0", "(209) 830-3370"], ["Grizzly ChalleNGe Charter", "None", "(805) 782-6882"], ["Nipomo High", "490.0", "(805) 474-3300"], ["Templeton Independent Study High", "None", "(805) 434-5805"], ["Independence High", "None", "(805) 769-1620"], ["California Virtual Academy @ San Mateo", "None", "(805) 581-0202"], ["Aspire East Palo Alto Charter", "None", "None"], ["Peninsula High", "None", "(650) 558-2499"], ["Summit Preparatory Charter High", "522.0", "(650) 556-1110"], ["Everest Public High", "538.0", "(650) 366-1050"], ["East Palo Alto Academy", "403.0", "(650) 893-8900"], ["Family Partnership Home Study Charter", "None", "(805) 348-3333"], ["Los Olivos Charter School", "None", "None"], ["Orcutt Academy Charter", "492.0", "(805) 938-8900"], ["Pioneer Valley High", "451.0", "(805) 922-1305"], ["Alta Vista Alternative High", "558.0", "(805) 965-1916"], ["Leadership Public Schools - San Jose", "381.0", "None"], ["University Preparatory Academy Charter", "537.0", "(408) 723-1839"], ["Magnolia Science Academy Santa Clara", "None", "None"], ["Silicon Valley Flex Academy", "None", "None"], ["Summit Public School: Tahoma", "483.0", "(408) 729-1981"], ["Branham High", "540.0", "(408) 626-3407"], ["Escuela Popular/Center for Training and Careers, Family Learning", "None", "(408) 275-7191"], ["KIPP San Jose Collegiate", "482.0", "(408) 937-3752"], ["Summit Public School: Rainier", "493.0", "(408) 831-3104"], ["Calero High", "None", "(408) 347-7600"], ["Apollo High", "None", "(408) 928-5400"], ["Latino College Preparatory Academy", "380.0", "(408) 729-2281"], ["San Jose Conservation Corps Charter", "None", "(408) 459-6404"], ["Evergreen Valley High", "565.0", "(408) 347-7000"], ["Escuela Popular Accelerated Family Learning", "None", "(408) 275-7190"], ["Dr. TJ Owens Gilroy Early College Academy", "552.0", "(408) 846-4909"], ["Christopher High", "484.0", "(408) 848-7171"], ["Ann Sobrato High", "515.0", "(408) 201-6200"], ["Liberty High (Alternative)", "None", "(408) 535-6327"], ["Downtown College Preparatory", "None", "(408) 271-8120"], ["Middle College High", "None", "(408) 298-2181"], ["Pacific Collegiate Charter", "630.0", "(831) 479-7785"], ["Cypress Charter High", "506.0", "(831) 477-0302"], ["Pajaro Valley High", "430.0", "(831) 728-8102"], ["Ceiba College Preparatory Academy", "None", "(831) 728-6208"], ["Pacific Coast Charter", "None", "(831) 761-6021"], ["Ocean Grove Charter", "554.0", "(530) 295-3566"], ["SLVUSD Charter", "None", "(831) 335-0932"], ["Delta Charter", "None", "(831) 477-5212"], ["Alternative Family Education", "None", "(831) 429-3898"], ["Scotts Valley High", "547.0", "(831) 439-9555"], ["Anderson New Technology High", "None", "(530) 365-3100"], ["Stellar Secondary Charter High", "None", "(530) 245-7730"], ["University Preparatory", "551.0", "(530) 245-2790"], ["Shasta Charter Academy", "None", "(530) 245-2600"], ["North State Independence High", "None", "(530) 245-2760"], ["Northern Summit Academy", "None", "(530) 949-0154"], ["Academy of Personalized Learning", "None", "(530) 222-9280"], ["Gateway Educational Options", "None", "(530) 245-7960"], ["Golden Eagle Charter", "None", "(530) 926-5800"], ["Matt Garcia Career and College Academy", "None", "(707) 424-9400"], ["Angelo Rodriguez High", "489.0", "(707) 863-7950"], ["Elise P. Buckingham Charter Magnet High", "533.0", "(707) 453-7300"], ["Jesse M. Bethel High", "447.0", "(707) 556-5700"], ["MIT Academy", "None", "(707) 552-6482"], ["Geyserville New Tech Academy", "None", "(707) 857-3592"], ["Pathways Charter", "None", "(707) 585-6510"], ["California Virtual Academy @ Sonoma", "None", "(805) 581-0202"], ["Pivot Online Charter - North Bay", "None", "(707) 843-4676"], ["Gateway to College Academy", "None", "(707) 778-4621"], ["Valley Oaks High (Alternative)", "None", "(707) 778-4794"], ["Northwest Prep Charter", "None", "(707) 522-3320"], ["Roseland Charter", "410.0", "(707) 545-0102"], ["Abraxis Charter", "None", "(707) 539-2897"], ["Elsie Allen High", "457.0", "(707) 528-5020"], ["Maria Carrillo High", "563.0", "(707) 528-5790"], ["Orchard View", "None", "(707) 823-4709"], ["Credo High", "None", "(707) 664-0600"], ["Academy of Arts and Sciences: Sonoma", "None", "(855) 937-4227"], ["Technology High", "567.0", "(707) 792-4825"], ["Windsor High", "516.0", "(707) 837-7767"], ["Stanislaus Alternative Charter", "None", "(209) 238-6801"], ["Valley Charter High", "489.0", "(209) 238-6800"], ["Whitmore Charter High", "542.0", "(209) 556-1617"], ["Central Valley High", "433.0", "(209) 556-1900"], ["Endeavor Alternative", "None", "(209) 556-1805"], ["Denair Charter Academy", "None", "(209) 634-0917"], ["Hart-Ransom Academic Charter", "None", "(209) 523-0401"], ["Keyes to Learning Charter", "None", "(209) 634-6467"], ["James C. Enochs High", "487.0", "(209) 550-3400"], ["Aspire Vanguard College Preparatory Academy", "None", "(209) 521-3010"], ["Joseph A. Gregori High", "465.0", "(209) 550-3421"], ["Peter Johansen High", "435.0", "(209) 576-4702"], ["Oakdale Charter", "None", "(209) 848-4361"], ["Valley Oak Junior and Senior High", "None", "(209) 847-3097"], ["Waterford High", "465.0", "(209) 874-9060"], ["Connecting Waters Charter", "504.0", "(209) 874-9463"], ["eCademy Charter at Crane", "None", "(209) 669-3410"], ["Fusion Charter", "None", "(209) 667-0327"], ["John H. Pitman High", "480.0", "(209) 656-1592"], ["South Sutter Charter", "465.0", "(530) 295-3566"], ["California Virtual Academy @ Sutter", "None", "(805) 581-0202"], ["River Valley High", "479.0", "(530) 822-2500"], ["Yuba City Charter", "None", "(530) 822-9667"], ["Tehama eLearning Academy", "None", "(530) 527-0188"], ["University Preparatory High", "498.0", "(559) 730-2529"], ["La Sierra High", "None", "(559) 733-6963"], ["Eleanor Roosevelt Community Learning Center", "None", "(559) 592-9160"], ["California Connections Academy@Central", "None", "(559) 713-1324"], ["Summit Charter Academy", "None", "(559) 782-5902"], ["Burton Horizon Academy", "None", "(559) 782-4748"], ["Loma Vista Charter", "None", "(559) 562-5111"], ["Crescent Valley Public Charter", "None", "(559) 970-5894"], ["Mission Oak High", "435.0", "(559) 688-2021"], ["Sierra Vista Charter High", "None", "(559) 687-7384"], ["Visalia Charter Independent Study", "442.0", "(559) 735-8055"], ["Visalia Technical Early College", "None", "(559) 622-3212"], ["El Diamante High", "475.0", "(559) 735-3501"], ["Farmersville High", "400.0", "(559) 594-4567"], ["Butterfield Charter High", "None", "(559) 782-7057"], ["Harmony Magnet Academy", "464.0", "(559) 568-0347"], ["Granite Hills High", "433.0", "(559) 782-7075"], ["Prospect Education Center", "None", "(559) 782-7095"], ["Ronald Reagan Academy", "None", "(559) 595-0563"], ["California Virtual Academy @ Jamestown", "None", "(805) 581-0202"], ["Gold Rush Charter", "None", "(209) 532-9781"], ["Connections Visual and Performing Arts Academy", "None", "(209) 928-4228"], ["Vista Real Charter High", "None", "(805) 486-5449"], ["River Oaks Academy", "None", "(805) 777-7999"], ["Golden Valley Charter", "None", "(805) 642-3435"], ["Academy of Arts and Sciences: Thousand Oaks & Simi Valley", "None", "(855) 937-4227"], ["Academy of Arts and Sciences: Oxnard & Ventura", "None", "None"], ["Architecture, Construction & Engineering Charter High (ACE)", "None", "(805) 437-1410"], ["Condor High", "None", "(805) 385-2552"], ["Pacifica High", "454.0", "(805) 278-5000"], ["Santa Susana High", "556.0", "(805) 520-6800"], ["El Camino High", "537.0", "(805) 289-7955"], ["Foothill Technology High", "530.0", "(805) 289-0023"], ["Century Academy", "None", "(805) 496-0286"], ["Oak Park Independent", "488.0", "(818) 735-3260"], ["IvyTech Charter", "None", "(805) 222-5188"], ["The High School at Moorpark College", "519.0", "(805) 378-1444"], ["Da Vinci Charter Academy", "558.0", "(530) 757-7154"], ["West Sacramento Early College Prep Charter", "None", "(916) 375-7680"], ["Pioneer High", "455.0", "(530) 406-1148"], ["Yuba County Career Preparatory Charter", "None", "(530) 749-4000"], ["Camptonville Academy", "None", "(530) 742-2786"], ["Marysville Charter Academy for the Arts", "484.0", "(530) 749-6156"]], "spark_error": null, "total_time": 22.236313343048096, "spark_time": 0.13199877738952637, "translation_time": 22.10431456565857, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a1074d15-8157-4200-8376-e8f7f3442c78'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='09565bb5-f9a7-4fe5-810f-b11da2481458'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION vs. UNION ALL**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The `CAST(SUBSTRING(..., 1, 4) AS INT)` correctly converts the year string to an integer for comparison with integer literals (1991, 2000). The join condition `s.CDSCode = sa.cds` assumes compatible types, which is standard for such identifiers.\\n*   **Properly quoting identifiers**: All identifiers (`s.School`, `sa.AvgScrWrite`, `s.Phone`, `schools`, `s`, `satscores`, `sa`, `s.CDSCode`, `sa.cds`, `s.OpenDate`, `s.ClosedDate`) are standard SQL identifiers and do not require special quoting (like backticks).\\n*   **Use `` ` `` for the in-query strings**: This point typically refers to quoting identifiers that are keywords or contain special characters. The query uses single quotes for string literals ('1', '4') and integer literals (1991, 2000), which is correct. No identifiers requiring backticks are present.\\n*   **Using the correct number of arguments for functions**: `SUBSTRING(string, start, length)` and `CAST(expression AS type)` are used with the correct number of arguments.\\n*   **Casting to the correct data type**: `CAST(... AS INT)` is appropriate for converting the year string to an integer for numeric comparison.\\n*   **Using the proper columns for joins**: `s.CDSCode = sa.cds` is a standard way to join a schools table with a related scores table using a common identifier.\\n\\nThe query is well-formed and follows standard SQL practices.\\n\\n```sql\\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\\n```\" name='query_checker_sql_db' tool_call_id='00960c73-1294-4bff-9d3a-c636367c7845'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000'}"], "input_tokens": 4378, "output_tokens": 3170, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any. Communication number refers to phone number.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION vs. UNION ALL**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The `CAST(SUBSTRING(..., 1, 4) AS INT)` correctly converts the year string to an integer for comparison with integer literals (1991, 2000). The join condition `s.CDSCode = sa.cds` assumes compatible types, which is standard for such identifiers.\n*   **Properly quoting identifiers**: All identifiers (`s.School`, `sa.AvgScrWrite`, `s.Phone`, `schools`, `s`, `satscores`, `sa`, `s.CDSCode`, `sa.cds`, `s.OpenDate`, `s.ClosedDate`) are standard SQL identifiers and do not require special quoting (like backticks).\n*   **Use `` ` `` for the in-query strings**: This point typically refers to quoting identifiers that are keywords or contain special characters. The query uses single quotes for string literals ('1', '4') and integer literals (1991, 2000), which is correct. No identifiers requiring backticks are present.\n*   **Using the correct number of arguments for functions**: `SUBSTRING(string, start, length)` and `CAST(expression AS type)` are used with the correct number of arguments.\n*   **Casting to the correct data type**: `CAST(... AS INT)` is appropriate for converting the year string to an integer for numeric comparison.\n*   **Using the proper columns for joins**: `s.CDSCode = sa.cds` is a standard way to join a schools table with a related scores table using a common identifier.\n\nThe query is well-formed and follows standard SQL practices.\n\n```sql\nSELECT s.School, sa.AvgScrWrite, s.Phone FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE CAST(SUBSTRING(s.OpenDate, 1, 4) AS INT) > 1991 OR CAST(SUBSTRING(s.ClosedDate, 1, 4) AS INT) < 2000\n```", "final_answer": "", "replica": 9, "timestamp": 1768937840.6101007}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT DISTINCT FundingType FROM schools", "execution_status": "VALID", "query_result": [["Locally funded"], ["Directly funded"], ["Not in CS funding model"], ["None"]], "spark_error": null, "total_time": 6.148189067840576, "spark_time": 0.2459728717803955, "translation_time": 5.902216196060181, "llm_requests": 4, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='73fa0da2-792b-4266-8e24-b4510a62196b'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f67370c6-e7d6-466b-9c5d-41db819ee9ea'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='5f7b0bbe-d9e2-4e74-9ec8-643cf733e2c8'", "Action: query_sql_db\nAction Input: {'query': 'SELECT DISTINCT FundingType FROM schools'}"], "input_tokens": 3786, "output_tokens": 699, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);", "final_answer": "", "replica": 0, "timestamp": 1768937847.914304}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"Enrollment (K-12)\"'. SQLSTATE: 42601 (line 1, pos 116)\n\n== SQL ==\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\n--------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 24.288874864578247, "spark_time": 0.02396845817565918, "translation_time": 24.264906406402588, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='012c94b3-33a8-4e05-a66f-b6b7a198d6a8'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='3f5c3990-807a-4daf-8a2f-e63abddbe9d3'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='10784306-eb29-43e1-9ef6-71342a89db3a'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )'}", "Observation: content='The provided Spark SQL query is well-structured and appears to follow best practices for Spark SQL.\\n\\nLet\\'s review it against the common mistakes checklist:\\n\\n1.  **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n2.  **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n3.  **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n4.  **Data type mismatch in predicates**: The `Enrollment` columns are assumed to be numeric (e.g., `INT`, `BIGINT`, `DECIMAL`). If they were strings, Spark SQL would attempt implicit casting, which could lead to errors if the strings are not valid numbers. However, for enrollment data, numeric types are standard, so this is likely not an issue. The subtraction and comparison with `AVG` would then operate on compatible numeric types.\\n5.  **Properly quoting identifiers**: Column names with spaces like `\"Enrollment (K-12)\"` and `\"Enrollment (Ages 5-17)\"` are correctly quoted using double quotes (`\"`). This is valid in Spark SQL.\\n6.  **Use ` for the in-query strings**: This instruction usually refers to using backticks (`` ` ``) for quoting identifiers (like column names with spaces) in Spark SQL, although double quotes (`\"`) are also accepted and commonly used. String literals like `\\'Local\\'` are correctly enclosed in single quotes. Since `\"` is a valid way to quote identifiers in Spark SQL, the current query is considered properly quoted.\\n7.  **Using the correct number of arguments for functions**: The `AVG()` function is used correctly with a single argument.\\n8.  **Casting to the correct data type**: No explicit casting is used. As mentioned in point 4, this assumes the `Enrollment` columns are already numeric or implicitly castable.\\n9.  **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode` is appropriate for linking `frpm` and `schools` tables. The subquery also uses the same correct join.\\n\\nBased on this review, the query does not contain any of the specified common mistakes. The quoting of identifiers with double quotes (`\"`) is valid in Spark SQL.\\n\\n```sql\\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )\\n```' name='query_checker_sql_db' tool_call_id='40ee0cf2-4cb3-498f-853a-84298a827104'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )'}"], "input_tokens": 6228, "output_tokens": 3704, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.\\\\\"Enrollment (K-12)\\\\\" - f.\\\\\"Enrollment (Ages 5-17)\\\\\") > ( SELECT AVG(\\\\\"Enrollment (K-12)\\\\\" - \\\\\"Enrollment (Ages 5-17)\\\\\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )\"}'}\nTool: The provided Spark SQL query is well-structured and appears to follow best practices for Spark SQL.\n\nLet's review it against the common mistakes checklist:\n\n1.  **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n2.  **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n3.  **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n4.  **Data type mismatch in predicates**: The `Enrollment` columns are assumed to be numeric (e.g., `INT`, `BIGINT`, `DECIMAL`). If they were strings, Spark SQL would attempt implicit casting, which could lead to errors if the strings are not valid numbers. However, for enrollment data, numeric types are standard, so this is likely not an issue. The subtraction and comparison with `AVG` would then operate on compatible numeric types.\n5.  **Properly quoting identifiers**: Column names with spaces like `\"Enrollment (K-12)\"` and `\"Enrollment (Ages 5-17)\"` are correctly quoted using double quotes (`\"`). This is valid in Spark SQL.\n6.  **Use ` for the in-query strings**: This instruction usually refers to using backticks (`` ` ``) for quoting identifiers (like column names with spaces) in Spark SQL, although double quotes (`\"`) are also accepted and commonly used. String literals like `'Local'` are correctly enclosed in single quotes. Since `\"` is a valid way to quote identifiers in Spark SQL, the current query is considered properly quoted.\n7.  **Using the correct number of arguments for functions**: The `AVG()` function is used correctly with a single argument.\n8.  **Casting to the correct data type**: No explicit casting is used. As mentioned in point 4, this assumes the `Enrollment` columns are already numeric or implicitly castable.\n9.  **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode` is appropriate for linking `frpm` and `schools` tables. The subquery also uses the same correct join.\n\nBased on this review, the query does not contain any of the specified common mistakes. The quoting of identifiers with double quotes (`\"`) is valid in Spark SQL.\n\n```sql\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\n```", "final_answer": "", "replica": 1, "timestamp": 1768937872.336168}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local') ORDER BY T1.School", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 16.451646327972412, "spark_time": 0.16100096702575684, "translation_time": 16.290645360946655, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='e262cf0c-b8bf-4d8a-8ddb-c2d3de348469'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='4dfcfc5d-3b0b-464e-b405-f22f67577963'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='dcb38afa-0b0f-41a0-a060-8d944d2996d4'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local') ORDER BY T1.School\"}", "Observation: content=\"The Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION vs. UNION ALL**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The comparison `(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(...))` assumes `Enrollment` columns are numeric, which is standard for such data, and `AVG` will return a numeric type. The `FundingType = 'Local'` comparison is also correct for string types.\\n*   **Properly quoting identifiers**: Identifiers with spaces (e.g., ``Enrollment (K-12)``) are correctly quoted using backticks (` `). Other identifiers are standard and do not require special quoting.\\n*   **Use ` for the in-query strings**: String literals like `'Local'` are correctly quoted with single quotes. Backticks are for identifiers, not string literals.\\n*   **Correct number of arguments for functions**: `AVG()` is used correctly with one argument.\\n*   **Casting to the correct data type**: No explicit casting is used, but implicit casting for arithmetic operations and comparisons is appropriate given the likely numeric nature of the enrollment columns.\\n*   **Proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a standard and appropriate way to link `schools` and `frpm` tables.\\n\\nThe query is correct.\\n\\n```sql\\nSELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local') ORDER BY T1.School\\n```\" name='query_checker_sql_db' tool_call_id='8ef8ec04-3dba-49ed-b497-2069be242ae5'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local') ORDER BY T1.School\"}"], "input_tokens": 6007, "output_tokens": 2494, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = \\'Local\\' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = \\'Local\\') ORDER BY T1.School\"}'}\nTool: The Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION vs. UNION ALL**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The comparison `(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(...))` assumes `Enrollment` columns are numeric, which is standard for such data, and `AVG` will return a numeric type. The `FundingType = 'Local'` comparison is also correct for string types.\n*   **Properly quoting identifiers**: Identifiers with spaces (e.g., ``Enrollment (K-12)``) are correctly quoted using backticks (` `). Other identifiers are standard and do not require special quoting.\n*   **Use ` for the in-query strings**: String literals like `'Local'` are correctly quoted with single quotes. Backticks are for identifiers, not string literals.\n*   **Correct number of arguments for functions**: `AVG()` is used correctly with one argument.\n*   **Casting to the correct data type**: No explicit casting is used, but implicit casting for arithmetic operations and comparisons is appropriate given the likely numeric nature of the enrollment columns.\n*   **Proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a standard and appropriate way to link `schools` and `frpm` tables.\n\nThe query is correct.\n\n```sql\nSELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local') ORDER BY T1.School\n```", "final_answer": "", "replica": 2, "timestamp": 1768937889.6883245}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "WITH LocalFundedAvgDiff AS (\n    SELECT\n        AVG(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) AS AvgDiff\n    FROM\n        frpm f\n    JOIN\n        schools s ON f.CDSCode = s.CDSCode\n    WHERE\n        s.FundingType = 'Local'\n)\nSELECT\n    s.School,\n    s.DOCType\nFROM\n    frpm f\nJOIN\n    schools s ON f.CDSCode = s.CDSCode\nWHERE\n    s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AvgDiff FROM LocalFundedAvgDiff)\nORDER BY s.School", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 19.653414249420166, "spark_time": 0.24699997901916504, "translation_time": 19.406414270401, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='8cc995b7-9b9a-4716-ac63-615727228435'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f4426d30-a6d6-404e-9efa-365704676c6f'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='954818dd-24b9-4ea9-8049-b7e841af42bd'", "Action: query_checker_sql_db\nAction Input: {'query': \"\\nWITH LocalFundedAvgDiff AS (\\n    SELECT\\n        AVG(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) AS AvgDiff\\n    FROM\\n        frpm f\\n    JOIN\\n        schools s ON f.CDSCode = s.CDSCode\\n    WHERE\\n        s.FundingType = 'Local'\\n)\\nSELECT\\n    s.School,\\n    s.DOCType\\nFROM\\n    frpm f\\nJOIN\\n    schools s ON f.CDSCode = s.CDSCode\\nWHERE\\n    s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AvgDiff FROM LocalFundedAvgDiff)\\nORDER BY s.School\\n\"}", "Observation: content=\"The provided Spark SQL query is well-structured and appears to follow best practices for Spark SQL. Let's double-check against the common mistakes list:\\n\\n1.  **Using NOT IN with NULL values**: `NOT IN` is not used in this query.\\n2.  **Using UNION when UNION ALL should have been used**: `UNION` or `UNION ALL` are not used in this query.\\n3.  **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in this query.\\n4.  **Data type mismatch in predicates**:\\n    *   `f.`Enrollment (K-12)`` and `f.`Enrollment (Ages 5-17)`` are expected to be numeric, and their difference will also be numeric.\\n    *   `AVG` function returns a numeric (double) value.\\n    *   The comparison `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AvgDiff FROM LocalFundedAvgDiff)` compares two numeric values, which is perfectly valid.\\n    *   `s.FundingType = 'Local'` compares a string column with a string literal, which is correct.\\n    No data type mismatches are apparent.\\n5.  **Properly quoting identifiers**:\\n    *   Column names containing spaces (e.g., ``Enrollment (K-12)``, ``Enrollment (Ages 5-17)``) are correctly quoted using backticks (` `).\\n    *   Table aliases (`f`, `s`) do not require quoting.\\n    *   String literals (`'Local'`) are correctly enclosed in single quotes.\\n    This is handled correctly.\\n6.  **Use ` for the in-query strings**: This instruction typically refers to quoting identifiers that contain special characters or are reserved keywords. String literals should be enclosed in single quotes (`'`). The query correctly uses backticks for identifiers with spaces (e.g., ``Enrollment (K-12)``) and single quotes for string literals (e.g., `'Local'`). This is the correct Spark SQL syntax.\\n7.  **Using the correct number of arguments for functions**: The `AVG` function is used correctly with a single argument.\\n8.  **Casting to the correct data type**: No explicit casting is used, but Spark SQL's type inference and implicit casting for arithmetic operations and comparisons are generally robust for numeric types.\\n9.  **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode` is a standard and appropriate way to link `frpm` and `schools` tables, assuming `CDSCode` is the common identifier.\\n\\nThe query is well-formed and follows standard Spark SQL practices. There are no apparent mistakes based on the provided checklist.\\n\\n```sparksql\\nWITH LocalFundedAvgDiff AS (\\n    SELECT\\n        AVG(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) AS AvgDiff\\n    FROM\\n        frpm f\\n    JOIN\\n        schools s ON f.CDSCode = s.CDSCode\\n    WHERE\\n        s.FundingType = 'Local'\\n)\\nSELECT\\n    s.School,\\n    s.DOCType\\nFROM\\n    frpm f\\nJOIN\\n    schools s ON f.CDSCode = s.CDSCode\\nWHERE\\n    s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AvgDiff FROM LocalFundedAvgDiff)\\nORDER BY s.School\\n```\" name='query_checker_sql_db' tool_call_id='5a7c6af9-2bf0-4d1a-8f0e-714e3babc0e1'", "Action: query_sql_db\nAction Input: {'query': \"WITH LocalFundedAvgDiff AS (\\n    SELECT\\n        AVG(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) AS AvgDiff\\n    FROM\\n        frpm f\\n    JOIN\\n        schools s ON f.CDSCode = s.CDSCode\\n    WHERE\\n        s.FundingType = 'Local'\\n)\\nSELECT\\n    s.School,\\n    s.DOCType\\nFROM\\n    frpm f\\nJOIN\\n    schools s ON f.CDSCode = s.CDSCode\\nWHERE\\n    s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AvgDiff FROM LocalFundedAvgDiff)\\nORDER BY s.School\"}"], "input_tokens": 6403, "output_tokens": 3139, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"\\\\nWITH LocalFundedAvgDiff AS (\\\\n    SELECT\\\\n        AVG(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) AS AvgDiff\\\\n    FROM\\\\n        frpm f\\\\n    JOIN\\\\n        schools s ON f.CDSCode = s.CDSCode\\\\n    WHERE\\\\n        s.FundingType = \\'Local\\'\\\\n)\\\\nSELECT\\\\n    s.School,\\\\n    s.DOCType\\\\nFROM\\\\n    frpm f\\\\nJOIN\\\\n    schools s ON f.CDSCode = s.CDSCode\\\\nWHERE\\\\n    s.FundingType = \\'Local\\' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AvgDiff FROM LocalFundedAvgDiff)\\\\nORDER BY s.School\\\\n\"}'}\nTool: The provided Spark SQL query is well-structured and appears to follow best practices for Spark SQL. Let's double-check against the common mistakes list:\n\n1.  **Using NOT IN with NULL values**: `NOT IN` is not used in this query.\n2.  **Using UNION when UNION ALL should have been used**: `UNION` or `UNION ALL` are not used in this query.\n3.  **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in this query.\n4.  **Data type mismatch in predicates**:\n    *   `f.`Enrollment (K-12)`` and `f.`Enrollment (Ages 5-17)`` are expected to be numeric, and their difference will also be numeric.\n    *   `AVG` function returns a numeric (double) value.\n    *   The comparison `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AvgDiff FROM LocalFundedAvgDiff)` compares two numeric values, which is perfectly valid.\n    *   `s.FundingType = 'Local'` compares a string column with a string literal, which is correct.\n    No data type mismatches are apparent.\n5.  **Properly quoting identifiers**:\n    *   Column names containing spaces (e.g., ``Enrollment (K-12)``, ``Enrollment (Ages 5-17)``) are correctly quoted using backticks (` `).\n    *   Table aliases (`f`, `s`) do not require quoting.\n    *   String literals (`'Local'`) are correctly enclosed in single quotes.\n    This is handled correctly.\n6.  **Use ` for the in-query strings**: This instruction typically refers to quoting identifiers that contain special characters or are reserved keywords. String literals should be enclosed in single quotes (`'`). The query correctly uses backticks for identifiers with spaces (e.g., ``Enrollment (K-12)``) and single quotes for string literals (e.g., `'Local'`). This is the correct Spark SQL syntax.\n7.  **Using the correct number of arguments for functions**: The `AVG` function is used correctly with a single argument.\n8.  **Casting to the correct data type**: No explicit casting is used, but Spark SQL's type inference and implicit casting for arithmetic operations and comparisons are generally robust for numeric types.\n9.  **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode` is a standard and appropriate way to link `frpm` and `schools` tables, assuming `CDSCode` is the common identifier.\n\nThe query is well-formed and follows standard Spark SQL practices. There are no apparent mistakes based on the provided checklist.\n\n```sparksql\nWITH LocalFundedAvgDiff AS (\n    SELECT\n        AVG(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) AS AvgDiff\n    FROM\n        frpm f\n    JOIN\n        schools s ON f.CDSCode = s.CDSCode\n    WHERE\n        s.FundingType = 'Local'\n)\nSELECT\n    s.School,\n    s.DOCType\nFROM\n    frpm f\nJOIN\n    schools s ON f.CDSCode = s.CDSCode\nWHERE\n    s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AvgDiff FROM LocalFundedAvgDiff)\nORDER BY s.School\n```", "final_answer": "", "replica": 3, "timestamp": 1768937910.1347904}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT DISTINCT FundingType FROM schools", "execution_status": "VALID", "query_result": [["Locally funded"], ["Directly funded"], ["Not in CS funding model"], ["None"]], "spark_error": null, "total_time": 6.840965270996094, "spark_time": 0.16000032424926758, "translation_time": 6.680964946746826, "llm_requests": 4, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='6c6bf233-029d-4db1-b865-36203e6aa7e3'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='c392a206-488e-446e-9982-a8a03c9ffe0e'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='36109540-c5ea-48ac-9317-2ba1c3dff307'", "Action: query_sql_db\nAction Input: {'query': 'SELECT DISTINCT FundingType FROM schools'}"], "input_tokens": 3786, "output_tokens": 699, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);", "final_answer": "", "replica": 4, "timestamp": 1768937917.8907492}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"Enrollment (K-12)\"'. SQLSTATE: 42601 (line 1, pos 116)\n\n== SQL ==\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\n--------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 18.955148220062256, "spark_time": 0.011014223098754883, "translation_time": 18.9441339969635, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1d531c4b-eb2c-42ef-bbc2-b85eb62c3778'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='83af3e79-5a37-498e-b4b0-85e5f2826147'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='becac895-99a6-4149-8975-d44e199a9600'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )'}", "Observation: content='The provided Spark SQL query appears to be correctly written and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers:** Column names with special characters like `\"Enrollment (K-12)\"` are correctly enclosed in double quotes, which is standard for Spark SQL. Other identifiers are unquoted, which is appropriate as they don\\'t contain special characters or keywords.\\n*   **Data Types:** The arithmetic operation `f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\"` will result in a numeric type, which is compatible with the `AVG` function and the subsequent comparison.\\n*   **Joins:** The joins `f.CDSCode = s.CDSCode` and `f2.CDSCode = s2.CDSCode` use appropriate columns for linking the `frpm` and `schools` tables.\\n*   **Functions:** `AVG` is used with the correct number of arguments.\\n*   Other potential issues like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, or `BETWEEN` for exclusive ranges are not present in this query.\\n\\nThe original query is correct.\\n\\n```sql\\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )\\n```' name='query_checker_sql_db' tool_call_id='636704e6-4076-4f92-bf4b-5132256f3bfa'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )'}"], "input_tokens": 5976, "output_tokens": 2894, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.\\\\\"Enrollment (K-12)\\\\\" - f.\\\\\"Enrollment (Ages 5-17)\\\\\") > ( SELECT AVG(\\\\\"Enrollment (K-12)\\\\\" - \\\\\"Enrollment (Ages 5-17)\\\\\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )\"}'}\nTool: The provided Spark SQL query appears to be correctly written and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers:** Column names with special characters like `\"Enrollment (K-12)\"` are correctly enclosed in double quotes, which is standard for Spark SQL. Other identifiers are unquoted, which is appropriate as they don't contain special characters or keywords.\n*   **Data Types:** The arithmetic operation `f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\"` will result in a numeric type, which is compatible with the `AVG` function and the subsequent comparison.\n*   **Joins:** The joins `f.CDSCode = s.CDSCode` and `f2.CDSCode = s2.CDSCode` use appropriate columns for linking the `frpm` and `schools` tables.\n*   **Functions:** `AVG` is used with the correct number of arguments.\n*   Other potential issues like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, or `BETWEEN` for exclusive ranges are not present in this query.\n\nThe original query is correct.\n\n```sql\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\n```", "final_answer": "", "replica": 5, "timestamp": 1768937936.9974127}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 18.87341332435608, "spark_time": 0.10500335693359375, "translation_time": 18.768409967422485, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='24567c2f-a48b-4c9d-9a9b-eb86476d7e05'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a9158fed-2c2f-4d0b-9883-d248c5f1b8ca'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='ea7cefe3-4b0b-4c40-ab72-c82151cd0420'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\"}", "Observation: content=\"The Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values:** Not used.\\n*   **UNION vs. UNION ALL:** Not used.\\n*   **BETWEEN for exclusive ranges:** Not used.\\n*   **Data type mismatch in predicates:** The comparison `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AVG(...))` involves numeric types, which is correct. String literals like `'Local'` are correctly compared with string columns.\\n*   **Properly quoting identifiers:** Identifiers with special characters (spaces, parentheses) like ``Enrollment (K-12)`` are correctly quoted using backticks (` `). Other identifiers are unquoted, which is standard for valid SQL identifiers.\\n*   **Use ` for the in-query strings:** This point likely refers to identifiers with special characters, which are correctly handled with backticks. String literals are correctly enclosed in single quotes.\\n*   **Correct number of arguments for functions:** `AVG()` is used with one argument, which is correct.\\n*   **Casting to the correct data type:** Implicit type conversions for arithmetic operations and comparisons are standard and should work correctly. No explicit casting is needed here.\\n*   **Proper columns for joins:** `f.CDSCode = s.CDSCode` is a standard way to join school-related data, assuming `CDSCode` is the correct common identifier.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\\n```\" name='query_checker_sql_db' tool_call_id='0f81bffd-e23d-4f24-a9e9-561eb2cc302b'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\"}"], "input_tokens": 6064, "output_tokens": 2846, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )\"}'}\nTool: The Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values:** Not used.\n*   **UNION vs. UNION ALL:** Not used.\n*   **BETWEEN for exclusive ranges:** Not used.\n*   **Data type mismatch in predicates:** The comparison `(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > (SELECT AVG(...))` involves numeric types, which is correct. String literals like `'Local'` are correctly compared with string columns.\n*   **Properly quoting identifiers:** Identifiers with special characters (spaces, parentheses) like ``Enrollment (K-12)`` are correctly quoted using backticks (` `). Other identifiers are unquoted, which is standard for valid SQL identifiers.\n*   **Use ` for the in-query strings:** This point likely refers to identifiers with special characters, which are correctly handled with backticks. String literals are correctly enclosed in single quotes.\n*   **Correct number of arguments for functions:** `AVG()` is used with one argument, which is correct.\n*   **Casting to the correct data type:** Implicit type conversions for arithmetic operations and comparisons are standard and should work correctly. No explicit casting is needed here.\n*   **Proper columns for joins:** `f.CDSCode = s.CDSCode` is a standard way to join school-related data, assuming `CDSCode` is the correct common identifier.\n\nThe query is correct as written.\n\n```sql\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\n```", "final_answer": "", "replica": 6, "timestamp": 1768937956.7843418}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local')", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 15.802031993865967, "spark_time": 0.11099767684936523, "translation_time": 15.691034317016602, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='2aea7837-39ba-45cb-9682-ea2d621ce4aa'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='41a12f2e-4b91-49b0-80dc-8ae4c47b4712'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='a05f9e2b-63d0-471f-8ba9-7d196a389035'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local')\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION vs. UNION ALL**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The comparison `(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(...))` compares numeric values, which is correct. `T1.FundingType = 'Local'` compares a column (likely string) with a string literal, which is also correct.\\n*   **Properly quoting identifiers**: Column names with spaces like `Enrollment (K-12)` are correctly quoted using backticks (` `), which is standard for Spark SQL. Other identifiers are simple and don't require quoting.\\n*   **Use ` for in-query strings**: String literals like `'Local'` correctly use single quotes. Backticks are for identifiers, not string literals.\\n*   **Correct number of arguments for functions**: `AVG()` is used with one argument, which is correct.\\n*   **Casting to the correct data type**: No explicit casting is used, but the implicit conversions for numeric operations are appropriate, assuming `Enrollment` columns are numeric.\\n*   **Proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a standard and logical join condition between `schools` and `frpm` tables.\\n\\nThe query correctly identifies schools with `FundingType = 'Local'` where the difference between `Enrollment (K-12)` and `Enrollment (Ages 5-17)` is greater than the average of this difference for all `Local` funding type schools.\\n\\n```sql\\nSELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local')\\n```\" name='query_checker_sql_db' tool_call_id='c1f4f238-01c5-4acc-8698-7b90c88bf0af'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local')\"}"], "input_tokens": 6030, "output_tokens": 2367, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = \\'Local\\' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = \\'Local\\')\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION vs. UNION ALL**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The comparison `(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(...))` compares numeric values, which is correct. `T1.FundingType = 'Local'` compares a column (likely string) with a string literal, which is also correct.\n*   **Properly quoting identifiers**: Column names with spaces like `Enrollment (K-12)` are correctly quoted using backticks (` `), which is standard for Spark SQL. Other identifiers are simple and don't require quoting.\n*   **Use ` for in-query strings**: String literals like `'Local'` correctly use single quotes. Backticks are for identifiers, not string literals.\n*   **Correct number of arguments for functions**: `AVG()` is used with one argument, which is correct.\n*   **Casting to the correct data type**: No explicit casting is used, but the implicit conversions for numeric operations are appropriate, assuming `Enrollment` columns are numeric.\n*   **Proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a standard and logical join condition between `schools` and `frpm` tables.\n\nThe query correctly identifies schools with `FundingType = 'Local'` where the difference between `Enrollment (K-12)` and `Enrollment (Ages 5-17)` is greater than the average of this difference for all `Local` funding type schools.\n\n```sql\nSELECT T1.School, T1.DOCType FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local' AND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Local')\n```", "final_answer": "", "replica": 7, "timestamp": 1768937973.4083705}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 18.226004123687744, "spark_time": 0.10999369621276855, "translation_time": 18.116010427474976, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0617f4bd-2404-4c3c-8cde-67cc4039466f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='17d4f265-aa20-42e8-8a84-8c19afa2a845'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='57492a7a-df45-4916-ad76-0576438e8509'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION` or `UNION ALL`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (string comparison, numeric comparison) seem consistent.\\n*   Identifiers with spaces (`Enrollment (K-12)`, `Enrollment (Ages 5-17)`) are correctly quoted using backticks (` `). String literals like `'Local'` are correctly quoted with single quotes.\\n*   The `AVG()` function is used with the correct number of arguments.\\n*   No explicit casting is used, and the implicit type handling for arithmetic operations and comparisons should be fine.\\n*   The `CDSCode` column is used consistently for joining `frpm` and `schools` tables, which is a common and appropriate join key for such datasets.\\n\\nTherefore, the original query is reproduced as it is correct.\\n\\n```sql\\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\\n```\" name='query_checker_sql_db' tool_call_id='3b84f8b5-4d5c-4069-8fb0-e30d7174b90c'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\"}"], "input_tokens": 5959, "output_tokens": 2763, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = \\'Local\\' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = \\'Local\\' )\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION` or `UNION ALL`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (string comparison, numeric comparison) seem consistent.\n*   Identifiers with spaces (`Enrollment (K-12)`, `Enrollment (Ages 5-17)`) are correctly quoted using backticks (` `). String literals like `'Local'` are correctly quoted with single quotes.\n*   The `AVG()` function is used with the correct number of arguments.\n*   No explicit casting is used, and the implicit type handling for arithmetic operations and comparisons should be fine.\n*   The `CDSCode` column is used consistently for joining `frpm` and `schools` tables, which is a common and appropriate join key for such datasets.\n\nTherefore, the original query is reproduced as it is correct.\n\n```sql\nSELECT s.School, s.DOCType FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM frpm f2 JOIN schools s2 ON f2.CDSCode = s2.CDSCode WHERE s2.FundingType = 'Local' )\n```", "final_answer": "", "replica": 8, "timestamp": 1768937992.560385}
{"query_id": 28, "provider": "google", "db": "california_schools", "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "gold_spark": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')", "jaccard": null, "spider_em": null, "sparksql_query": "\nSELECT\n  s.School,\n  s.DOCType\nFROM\n  schools AS s\nJOIN\n  frpm AS f\nON\n  s.CDSCode = f.CDSCode\nWHERE\n  s.FundingType = 'Local'\n  AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > (\n    SELECT\n      AVG(f2.\"Enrollment (K-12)\" - f2.\"Enrollment (Ages 5-17)\")\n    FROM\n      schools AS s2\n    JOIN\n      frpm AS f2\n    ON\n      s2.CDSCode = f2.CDSCode\n    WHERE\n      s2.FundingType = 'Local'\n  )\nORDER BY\n  (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") DESC\n", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"Enrollment (K-12)\"'. SQLSTATE: 42601 (line 13, pos 9)\n\n== SQL ==\n\nSELECT\n  s.School,\n  s.DOCType\nFROM\n  schools AS s\nJOIN\n  frpm AS f\nON\n  s.CDSCode = f.CDSCode\nWHERE\n  s.FundingType = 'Local'\n  AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > (\n---------^^^\n    SELECT\n      AVG(f2.\"Enrollment (K-12)\" - f2.\"Enrollment (Ages 5-17)\")\n    FROM\n      schools AS s2\n    JOIN\n      frpm AS f2\n    ON\n      s2.CDSCode = f2.CDSCode\n    WHERE\n      s2.FundingType = 'Local'\n  )\nORDER BY\n  (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") DESC\n", "total_time": 23.77934956550598, "spark_time": 0.021981477737426758, "translation_time": 23.757368087768555, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='7f06a4c0-fdd0-4cca-82be-abef2f1ce564'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='c8ffa787-e872-47f3-b453-94fea716c1ab'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='63d278cb-4268-4ac9-b327-545c625355f4'", "Action: query_checker_sql_db\nAction Input: {'query': '\\nSELECT\\n  s.School,\\n  s.DOCType\\nFROM\\n  schools AS s\\nJOIN\\n  frpm AS f\\nON\\n  s.CDSCode = f.CDSCode\\nWHERE\\n  s.FundingType = \\'Local\\'\\n  AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > (\\n    SELECT\\n      AVG(f2.\"Enrollment (K-12)\" - f2.\"Enrollment (Ages 5-17)\")\\n    FROM\\n      schools AS s2\\n    JOIN\\n      frpm AS f2\\n    ON\\n      s2.CDSCode = f2.CDSCode\\n    WHERE\\n      s2.FundingType = \\'Local\\'\\n  )\\nORDER BY\\n  (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") DESC\\n'}", "Observation: content='The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed in the checklist.\\n\\nHere\\'s a breakdown of why:\\n\\n*   **Using NOT IN with NULL values:** The query does not use `NOT IN`.\\n*   **Using UNION when UNION ALL should have been used:** The query does not use `UNION` or `UNION ALL`.\\n*   **Using BETWEEN for exclusive ranges:** The query does not use `BETWEEN`.\\n*   **Data type mismatch in predicates:**\\n    *   `s.FundingType = \\'Local\\'`: `FundingType` is likely a string, and `\\'Local\\'` is a string literal. This is fine.\\n    *   `s.CDSCode = f.CDSCode`: `CDSCode` is a common identifier for joining school-related tables, assumed to be compatible types (e.g., string or integer).\\n    *   `f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\"`: Enrollment figures are typically numeric, so subtraction and comparison with an `AVG` result are valid numeric operations.\\n*   **Properly quoting identifiers:** Identifiers with spaces like `\"Enrollment (K-12)\"` are correctly quoted using double quotes (`\"`), which is standard SQL and supported by Spark SQL. Other identifiers without spaces are unquoted, which is also correct.\\n*   **Use `` ` `` for the in-query strings:** String literals like `\\'Local\\'` are correctly quoted with single quotes (`\\'`). Backticks (`` ` ``) are typically used for quoting identifiers in some SQL dialects or for specific purposes in Spark, but single quotes are standard for string literals.\\n*   **Using the correct number of arguments for functions:** The `AVG()` function is used correctly with a single numeric expression as its argument.\\n*   **Casting to the correct data type:** No explicit `CAST` is used, but the implicit type conversions for arithmetic and comparison operations are appropriate given the likely numeric nature of the enrollment columns.\\n*   **Using the proper columns for joins:** The join condition `s.CDSCode = f.CDSCode` is a logical and common way to link school information with enrollment data.\\n\\nThe query is syntactically correct and follows best practices for Spark SQL.\\n\\n```sql\\nSELECT\\n  s.School,\\n  s.DOCType\\nFROM\\n  schools AS s\\nJOIN\\n  frpm AS f\\nON\\n  s.CDSCode = f.CDSCode\\nWHERE\\n  s.FundingType = \\'Local\\'\\n  AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > (\\n    SELECT\\n      AVG(f2.\"Enrollment (K-12)\" - f2.\"Enrollment (Ages 5-17)\")\\n    FROM\\n      schools AS s2\\n    JOIN\\n      frpm AS f2\\n    ON\\n      s2.CDSCode = f2.CDSCode\\n    WHERE\\n      s2.FundingType = \\'Local\\'\\n  )\\nORDER BY\\n  (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") DESC\\n```' name='query_checker_sql_db' tool_call_id='dc1e1b97-e695-4cd4-b250-be4cbb33021d'", "Action: query_sql_db\nAction Input: {'query': '\\nSELECT\\n  s.School,\\n  s.DOCType\\nFROM\\n  schools AS s\\nJOIN\\n  frpm AS f\\nON\\n  s.CDSCode = f.CDSCode\\nWHERE\\n  s.FundingType = \\'Local\\'\\n  AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > (\\n    SELECT\\n      AVG(f2.\"Enrollment (K-12)\" - f2.\"Enrollment (Ages 5-17)\")\\n    FROM\\n      schools AS s2\\n    JOIN\\n      frpm AS f2\\n    ON\\n      s2.CDSCode = f2.CDSCode\\n    WHERE\\n      s2.FundingType = \\'Local\\'\\n  )\\nORDER BY\\n  (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") DESC\\n'}"], "input_tokens": 6512, "output_tokens": 3792, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"\\\\nSELECT\\\\n  s.School,\\\\n  s.DOCType\\\\nFROM\\\\n  schools AS s\\\\nJOIN\\\\n  frpm AS f\\\\nON\\\\n  s.CDSCode = f.CDSCode\\\\nWHERE\\\\n  s.FundingType = \\'Local\\'\\\\n  AND (f.\\\\\"Enrollment (K-12)\\\\\" - f.\\\\\"Enrollment (Ages 5-17)\\\\\") > (\\\\n    SELECT\\\\n      AVG(f2.\\\\\"Enrollment (K-12)\\\\\" - f2.\\\\\"Enrollment (Ages 5-17)\\\\\")\\\\n    FROM\\\\n      schools AS s2\\\\n    JOIN\\\\n      frpm AS f2\\\\n    ON\\\\n      s2.CDSCode = f2.CDSCode\\\\n    WHERE\\\\n      s2.FundingType = \\'Local\\'\\\\n  )\\\\nORDER BY\\\\n  (f.\\\\\"Enrollment (K-12)\\\\\" - f.\\\\\"Enrollment (Ages 5-17)\\\\\") DESC\\\\n\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed in the checklist.\n\nHere's a breakdown of why:\n\n*   **Using NOT IN with NULL values:** The query does not use `NOT IN`.\n*   **Using UNION when UNION ALL should have been used:** The query does not use `UNION` or `UNION ALL`.\n*   **Using BETWEEN for exclusive ranges:** The query does not use `BETWEEN`.\n*   **Data type mismatch in predicates:**\n    *   `s.FundingType = 'Local'`: `FundingType` is likely a string, and `'Local'` is a string literal. This is fine.\n    *   `s.CDSCode = f.CDSCode`: `CDSCode` is a common identifier for joining school-related tables, assumed to be compatible types (e.g., string or integer).\n    *   `f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\"`: Enrollment figures are typically numeric, so subtraction and comparison with an `AVG` result are valid numeric operations.\n*   **Properly quoting identifiers:** Identifiers with spaces like `\"Enrollment (K-12)\"` are correctly quoted using double quotes (`\"`), which is standard SQL and supported by Spark SQL. Other identifiers without spaces are unquoted, which is also correct.\n*   **Use `` ` `` for the in-query strings:** String literals like `'Local'` are correctly quoted with single quotes (`'`). Backticks (`` ` ``) are typically used for quoting identifiers in some SQL dialects or for specific purposes in Spark, but single quotes are standard for string literals.\n*   **Using the correct number of arguments for functions:** The `AVG()` function is used correctly with a single numeric expression as its argument.\n*   **Casting to the correct data type:** No explicit `CAST` is used, but the implicit type conversions for arithmetic and comparison operations are appropriate given the likely numeric nature of the enrollment columns.\n*   **Using the proper columns for joins:** The join condition `s.CDSCode = f.CDSCode` is a logical and common way to link school information with enrollment data.\n\nThe query is syntactically correct and follows best practices for Spark SQL.\n\n```sql\nSELECT\n  s.School,\n  s.DOCType\nFROM\n  schools AS s\nJOIN\n  frpm AS f\nON\n  s.CDSCode = f.CDSCode\nWHERE\n  s.FundingType = 'Local'\n  AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > (\n    SELECT\n      AVG(f2.\"Enrollment (K-12)\" - f2.\"Enrollment (Ages 5-17)\")\n    FROM\n      schools AS s2\n    JOIN\n      frpm AS f2\n    ON\n      s2.CDSCode = f2.CDSCode\n    WHERE\n      s2.FundingType = 'Local'\n  )\nORDER BY\n  (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") DESC\n```", "final_answer": "", "replica": 9, "timestamp": 1768938016.460736}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` IN ('K', '1') AND f.`High Grade` = '12' ORDER BY CAST(f.`Enrollment (K-12)` AS INT) DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 29.353546619415283, "spark_time": 0.24083590507507324, "translation_time": 29.11271071434021, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='82a73552-ad0d-4cb1-993e-6c8f91095b61'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='58686534-db2e-400c-9936-d82540540a62'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='f5278fc9-71e8-473a-bc40-54e2ac005126'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" IN (\\'K\\', \\'1\\') AND f.\"High Grade\" = \\'12\\' ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1'}", "Observation: content='The original query has a couple of potential issues based on the provided checklist and common Spark SQL practices:\\n\\n1.  **Quoting Identifiers**: The prompt explicitly states \"Use `` ` `` for the in-query strings\" (which refers to identifiers). The original query uses double quotes (`\"`) for identifiers like `\"Low Grade\"`, `\"High Grade\"`, and `\"Enrollment (K-12)\"`. While double quotes are often accepted in Spark SQL, backticks (`` ` ``) are the more idiomatic and recommended way to quote identifiers, especially those containing spaces or special characters.\\n\\n2.  **Data Type Mismatch in ORDER BY**: The column `f.\"Enrollment (K-12)\"` is likely intended to be a numeric value. If this column is stored as a string (which is a common data quality issue), `ORDER BY` will perform a lexicographical sort instead of a numerical sort, leading to incorrect results (e.g., \\'100\\' would come before \\'20\\'). It\\'s best practice to explicitly cast such columns to a numeric type (like `INT` or `BIGINT`) when ordering to ensure correct numerical sorting.\\n\\nHere\\'s the rewritten query addressing these points:\\n\\n```sql\\nSELECT s.OpenDate\\nFROM schools AS s\\nJOIN frpm AS f ON s.CDSCode = f.CDSCode\\nWHERE f.`Low Grade` IN (\\'K\\', \\'1\\')\\n  AND f.`High Grade` = \\'12\\'\\nORDER BY CAST(f.`Enrollment (K-12)` AS INT) DESC\\nLIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='914c5980-5e49-4887-83cb-0c5696cb1e83'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` IN ('K', '1') AND f.`High Grade` = '12' ORDER BY CAST(f.`Enrollment (K-12)` AS INT) DESC LIMIT 1\"}"], "input_tokens": 5453, "output_tokens": 3994, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\\\\\"Low Grade\\\\\" IN (\\'K\\', \\'1\\') AND f.\\\\\"High Grade\\\\\" = \\'12\\' ORDER BY f.\\\\\"Enrollment (K-12)\\\\\" DESC LIMIT 1\"}'}\nTool: The original query has a couple of potential issues based on the provided checklist and common Spark SQL practices:\n\n1.  **Quoting Identifiers**: The prompt explicitly states \"Use `` ` `` for the in-query strings\" (which refers to identifiers). The original query uses double quotes (`\"`) for identifiers like `\"Low Grade\"`, `\"High Grade\"`, and `\"Enrollment (K-12)\"`. While double quotes are often accepted in Spark SQL, backticks (`` ` ``) are the more idiomatic and recommended way to quote identifiers, especially those containing spaces or special characters.\n\n2.  **Data Type Mismatch in ORDER BY**: The column `f.\"Enrollment (K-12)\"` is likely intended to be a numeric value. If this column is stored as a string (which is a common data quality issue), `ORDER BY` will perform a lexicographical sort instead of a numerical sort, leading to incorrect results (e.g., '100' would come before '20'). It's best practice to explicitly cast such columns to a numeric type (like `INT` or `BIGINT`) when ordering to ensure correct numerical sorting.\n\nHere's the rewritten query addressing these points:\n\n```sql\nSELECT s.OpenDate\nFROM schools AS s\nJOIN frpm AS f ON s.CDSCode = f.CDSCode\nWHERE f.`Low Grade` IN ('K', '1')\n  AND f.`High Grade` = '12'\nORDER BY CAST(f.`Enrollment (K-12)` AS INT) DESC\nLIMIT 1\n```", "final_answer": "", "replica": 0, "timestamp": 1768938046.634193}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 13.648682117462158, "spark_time": 0.17166638374328613, "translation_time": 13.477015733718872, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='f8fd6097-5c14-4156-8728-af2971993f55'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='efc75c28-7f24-48bd-b1e9-85395e6b681d'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='36eb6397-22cd-4d27-b2e7-322c03233adf'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query appears to be correctly written and does not contain any of the common mistakes listed.\\n\\n*   **Quoting identifiers**: Column names with spaces or special characters (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (`` ` ``).\\n*   **String literals**: String literals (`'K'`, `'12'`) are correctly enclosed in single quotes.\\n*   **Join condition**: `T1.CDSCode = T2.CDSCode` is a logical join condition.\\n*   **Predicates**: The `WHERE` clause conditions `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` are correctly formed, assuming these columns are string types (which is common for grade levels like 'K').\\n*   **Ordering and Limiting**: The `ORDER BY` and `LIMIT` clauses are correctly used.\\n\\nTherefore, the original query is reproduced.\\n\\n```sql\\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='ceaceced-ffce-4683-b497-e1b39e55b9b3'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}"], "input_tokens": 5393, "output_tokens": 1940, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = \\'K\\' AND T2.`High Grade` = \\'12\\' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be correctly written and does not contain any of the common mistakes listed.\n\n*   **Quoting identifiers**: Column names with spaces or special characters (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (`` ` ``).\n*   **String literals**: String literals (`'K'`, `'12'`) are correctly enclosed in single quotes.\n*   **Join condition**: `T1.CDSCode = T2.CDSCode` is a logical join condition.\n*   **Predicates**: The `WHERE` clause conditions `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` are correctly formed, assuming these columns are string types (which is common for grade levels like 'K').\n*   **Ordering and Limiting**: The `ORDER BY` and `LIMIT` clauses are correctly used.\n\nTherefore, the original query is reproduced.\n\n```sql\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\n```", "final_answer": "", "replica": 1, "timestamp": 1768938061.0618737}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` = 'K' AND f.`High Grade` = '12' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 19.699392795562744, "spark_time": 0.1338343620300293, "translation_time": 19.565558433532715, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b4e35871-669d-4845-a4f1-4e2f7cd5f858'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f211bd26-616d-4346-adfc-ac57bd31acf8'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='3ee38436-3a8c-4701-9e65-81f9f550b060'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" = \\'K\\' AND f.\"High Grade\" = \\'12\\' ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1'}", "Observation: content='The original query uses double quotes for identifiers with spaces (e.g., `\"Low Grade\"`, `\"High Grade\"`, `\"Enrollment (K-12)\"`). While double quotes are often accepted in Spark SQL for quoting identifiers, the prompt specifically instructs to \"Use ` for the in-query strings\", which typically refers to using backticks for quoting identifiers in Spark SQL.\\n\\nTherefore, the query should be rewritten to use backticks for these identifiers to adhere to the specified quoting style.\\n\\nHere\\'s the rewritten query:\\n\\n```sql\\nSELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` = \\'K\\' AND f.`High Grade` = \\'12\\' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='95a41129-856b-4546-b1a5-da69b70a5143'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` = 'K' AND f.`High Grade` = '12' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1\"}"], "input_tokens": 5400, "output_tokens": 2512, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\\\\\"Low Grade\\\\\" = \\'K\\' AND f.\\\\\"High Grade\\\\\" = \\'12\\' ORDER BY f.\\\\\"Enrollment (K-12)\\\\\" DESC LIMIT 1\"}'}\nTool: The original query uses double quotes for identifiers with spaces (e.g., `\"Low Grade\"`, `\"High Grade\"`, `\"Enrollment (K-12)\"`). While double quotes are often accepted in Spark SQL for quoting identifiers, the prompt specifically instructs to \"Use ` for the in-query strings\", which typically refers to using backticks for quoting identifiers in Spark SQL.\n\nTherefore, the query should be rewritten to use backticks for these identifiers to adhere to the specified quoting style.\n\nHere's the rewritten query:\n\n```sql\nSELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` = 'K' AND f.`High Grade` = '12' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1\n```", "final_answer": "", "replica": 2, "timestamp": 1768938081.493269}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 17.229912042617798, "spark_time": 0.11818265914916992, "translation_time": 17.111729383468628, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='bb51d5d6-6332-49b7-a331-7f628716ca31'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='1dace0a2-750a-49e0-b98a-904cb9bce5c1'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='d06eac11-50f3-4cc8-83b0-0a36fef82a76'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}", "Observation: content=\"The Spark SQL query appears to be correct and follows best practices for Spark SQL, particularly in its use of backticks for identifiers containing spaces or special characters.\\n\\nHere's a breakdown of the checks:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` compare column values to string literals. It's common for grade columns to be stored as strings (e.g., to accommodate 'K' or 'PK'), so this is likely correct. Spark SQL is also flexible with implicit casting if '12' needed to be an integer, but comparing strings to strings is generally safe.\\n*   **Properly quoting identifiers**: All identifiers with spaces (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers without spaces are not quoted, which is also correct.\\n*   **Use ` for the in-query strings**: This instruction likely refers to quoting identifiers, which is correctly done with backticks. String literals ('K', '12') are correctly enclosed in single quotes (`'`).\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\\n*   **Casting to the correct data type**: No explicit casting is used, and implicit casting (if needed) would be handled by Spark SQL.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a common and logical way to link school information between two tables, assuming `CDSCode` is a unique identifier for schools in both tables.\\n\\nThe query is well-formed and robust.\\n\\n```sql\\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='9d92a327-22ff-4216-a465-591314d4c957'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}"], "input_tokens": 5627, "output_tokens": 2315, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = \\'K\\' AND T2.`High Grade` = \\'12\\' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}'}\nTool: The Spark SQL query appears to be correct and follows best practices for Spark SQL, particularly in its use of backticks for identifiers containing spaces or special characters.\n\nHere's a breakdown of the checks:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` compare column values to string literals. It's common for grade columns to be stored as strings (e.g., to accommodate 'K' or 'PK'), so this is likely correct. Spark SQL is also flexible with implicit casting if '12' needed to be an integer, but comparing strings to strings is generally safe.\n*   **Properly quoting identifiers**: All identifiers with spaces (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers without spaces are not quoted, which is also correct.\n*   **Use ` for the in-query strings**: This instruction likely refers to quoting identifiers, which is correctly done with backticks. String literals ('K', '12') are correctly enclosed in single quotes (`'`).\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\n*   **Casting to the correct data type**: No explicit casting is used, and implicit casting (if needed) would be handled by Spark SQL.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a common and logical way to link school information between two tables, assuming `CDSCode` is a unique identifier for schools in both tables.\n\nThe query is well-formed and robust.\n\n```sql\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\n```", "final_answer": "", "replica": 3, "timestamp": 1768938099.543068}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 23.081159114837646, "spark_time": 0.12686848640441895, "translation_time": 22.954290628433228, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='6e9e12d3-5672-41aa-892e-43af4ed91082'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='5cd8671f-2ff9-4a90-9b6a-d8c5f913f50a'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='6c681057-5c06-41d7-9058-f94290881326'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}", "Observation: content=\"The Spark SQL query appears to be correct and follows best practices for Spark SQL, particularly in its use of backticks for identifiers containing spaces or special characters.\\n\\nHere's a breakdown of the checks:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` compare column values to string literals. It's common for grade columns to be stored as strings (e.g., to accommodate 'K' or 'PK'), so this is likely correct. Spark SQL is also flexible with implicit casting if '12' needed to be an integer, but comparing strings to strings is generally safe.\\n*   **Properly quoting identifiers**: All identifiers with spaces (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers without spaces are not quoted, which is also correct.\\n*   **Use ` for the in-query strings**: This instruction likely refers to quoting identifiers, which is correctly done with backticks. String literals ('K', '12') are correctly enclosed in single quotes (`'`).\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\\n*   **Casting to the correct data type**: No explicit casting is used, and implicit casting (if needed) would be handled by Spark SQL.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a common and logical way to link school information between two tables, assuming `CDSCode` is a unique identifier for schools in both tables.\\n\\nThe query is well-formed and robust.\\n\\n```sql\\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='71a0184f-d7c5-4612-953b-b81cbcf9dbc0'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}"], "input_tokens": 5627, "output_tokens": 2476, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = \\'K\\' AND T2.`High Grade` = \\'12\\' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}'}\nTool: The Spark SQL query appears to be correct and follows best practices for Spark SQL, particularly in its use of backticks for identifiers containing spaces or special characters.\n\nHere's a breakdown of the checks:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` compare column values to string literals. It's common for grade columns to be stored as strings (e.g., to accommodate 'K' or 'PK'), so this is likely correct. Spark SQL is also flexible with implicit casting if '12' needed to be an integer, but comparing strings to strings is generally safe.\n*   **Properly quoting identifiers**: All identifiers with spaces (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers without spaces are not quoted, which is also correct.\n*   **Use ` for the in-query strings**: This instruction likely refers to quoting identifiers, which is correctly done with backticks. String literals ('K', '12') are correctly enclosed in single quotes (`'`).\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\n*   **Casting to the correct data type**: No explicit casting is used, and implicit casting (if needed) would be handled by Spark SQL.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a common and logical way to link school information between two tables, assuming `CDSCode` is a unique identifier for schools in both tables.\n\nThe query is well-formed and robust.\n\n```sql\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\n```", "final_answer": "", "replica": 4, "timestamp": 1768938123.1688917}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 20.975504398345947, "spark_time": 0.10800004005432129, "translation_time": 20.867504358291626, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='217a434c-f9ea-4306-9b2e-9b38b29a8fda'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='e7b4f9e1-1f85-4cfa-95b3-f1c034fb026a'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='2148d703-a69a-4371-8f5d-6026ab4fb402'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}", "Observation: content=\"The Spark SQL query appears to be correct and follows best practices for Spark SQL, particularly in its use of backticks for identifiers containing spaces or special characters.\\n\\nHere's a breakdown of the checks:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` compare column values to string literals. It's common for grade columns to be stored as strings (e.g., to accommodate 'K' or 'PK'), so this is likely correct. Spark SQL is also flexible with implicit casting if '12' needed to be an integer, but comparing strings to strings is generally safe.\\n*   **Properly quoting identifiers**: All identifiers with spaces (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers without spaces are not quoted, which is also correct.\\n*   **Use ` for the in-query strings**: This instruction likely refers to quoting identifiers, which is correctly done with backticks. String literals ('K', '12') are correctly enclosed in single quotes (`'`).\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\\n*   **Casting to the correct data type**: No explicit casting is used, and implicit casting (if needed) would be handled by Spark SQL.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a common and logical way to link school information between two tables, assuming `CDSCode` is a unique identifier for schools in both tables.\\n\\nThe query is well-formed and robust.\\n\\n```sql\\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='c0b1ba1b-2bed-4d98-8f63-f19cdbb2591d'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}"], "input_tokens": 5627, "output_tokens": 2315, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = \\'K\\' AND T2.`High Grade` = \\'12\\' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}'}\nTool: The Spark SQL query appears to be correct and follows best practices for Spark SQL, particularly in its use of backticks for identifiers containing spaces or special characters.\n\nHere's a breakdown of the checks:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` compare column values to string literals. It's common for grade columns to be stored as strings (e.g., to accommodate 'K' or 'PK'), so this is likely correct. Spark SQL is also flexible with implicit casting if '12' needed to be an integer, but comparing strings to strings is generally safe.\n*   **Properly quoting identifiers**: All identifiers with spaces (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers without spaces are not quoted, which is also correct.\n*   **Use ` for the in-query strings**: This instruction likely refers to quoting identifiers, which is correctly done with backticks. String literals ('K', '12') are correctly enclosed in single quotes (`'`).\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\n*   **Casting to the correct data type**: No explicit casting is used, and implicit casting (if needed) would be handled by Spark SQL.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a common and logical way to link school information between two tables, assuming `CDSCode` is a unique identifier for schools in both tables.\n\nThe query is well-formed and robust.\n\n```sql\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\n```", "final_answer": "", "replica": 5, "timestamp": 1768938144.7233956}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.OpenDate FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE (T2.`Low Grade` = 'K' OR T2.`Low Grade` = '1') AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 17.071712732315063, "spark_time": 0.12200021743774414, "translation_time": 16.94971251487732, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cb642fef-beb6-4f84-b3a9-12cc7b0c52d9'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='3dc6f802-96c4-4969-b439-29e7568bd9d5'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='e5bf365a-3625-4c47-9e14-fadabc5f38fc'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE (T2.`Low Grade` = 'K' OR T2.`Low Grade` = '1') AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}", "Observation: content=\"```sql\\nSELECT T1.OpenDate FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE (T2.`Low Grade` = 'K' OR T2.`Low Grade` = '1') AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='dbe349c2-050b-4437-8420-df4b074649ca'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE (T2.`Low Grade` = 'K' OR T2.`Low Grade` = '1') AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}"], "input_tokens": 5345, "output_tokens": 2295, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.OpenDate FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE (T2.`Low Grade` = \\'K\\' OR T2.`Low Grade` = \\'1\\') AND T2.`High Grade` = \\'12\\' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}'}\nTool: ```sql\nSELECT T1.OpenDate FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE (T2.`Low Grade` = 'K' OR T2.`Low Grade` = '1') AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\n```", "final_answer": "", "replica": 6, "timestamp": 1768938162.435624}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" = '1' AND f.\"High Grade\" = '12' ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"Low Grade\"'. SQLSTATE: 42601 (line 1, pos 84)\n\n== SQL ==\nSELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" = '1' AND f.\"High Grade\" = '12' ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1\n------------------------------------------------------------------------------------^^^\n", "total_time": 23.764112949371338, "spark_time": 0.015708208084106445, "translation_time": 23.74840474128723, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='23b07eec-9d1d-4d4b-bf42-1a1b70120b6e'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='721227ac-6e67-4191-9a83-0df8012a831c'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='6bb07fc2-990c-4d4d-be5c-e3ef34584350'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" = \\'1\\' AND f.\"High Grade\" = \\'12\\' ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1'}", "Observation: content='The original query has a potential data type mismatch in the `WHERE` clause predicates.\\n\\n**Mistake:**\\n*   **Data type mismatch in predicates:** `f.\"Low Grade\" = \\'1\\'` and `f.\"High Grade\" = \\'12\\'`. It is highly probable that `\"Low Grade\"` and `\"High Grade\"` columns store numeric values (like integers) representing grades. Comparing a numeric column to a string literal (e.g., `\\'1\\'`) can lead to implicit type casting, which might be inefficient or, in some edge cases, produce unexpected results depending on the SQL engine\\'s behavior. It\\'s best practice to compare numeric columns with numeric literals.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" = 1 AND f.\"High Grade\" = 12 ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='3de4fdbd-d350-4ced-896c-f8d1fa39cc57'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" = \\'1\\' AND f.\"High Grade\" = \\'12\\' ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1'}"], "input_tokens": 5441, "output_tokens": 3696, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\\\\\"Low Grade\\\\\" = \\'1\\' AND f.\\\\\"High Grade\\\\\" = \\'12\\' ORDER BY f.\\\\\"Enrollment (K-12)\\\\\" DESC LIMIT 1\"}'}\nTool: The original query has a potential data type mismatch in the `WHERE` clause predicates.\n\n**Mistake:**\n*   **Data type mismatch in predicates:** `f.\"Low Grade\" = '1'` and `f.\"High Grade\" = '12'`. It is highly probable that `\"Low Grade\"` and `\"High Grade\"` columns store numeric values (like integers) representing grades. Comparing a numeric column to a string literal (e.g., `'1'`) can lead to implicit type casting, which might be inefficient or, in some edge cases, produce unexpected results depending on the SQL engine's behavior. It's best practice to compare numeric columns with numeric literals.\n\n**Rewritten Query:**\n\n```sql\nSELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" = 1 AND f.\"High Grade\" = 12 ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1\n```", "final_answer": "", "replica": 7, "timestamp": 1768938186.331737}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 18.042951583862305, "spark_time": 0.11848235130310059, "translation_time": 17.924469232559204, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1b327107-74dd-4e3a-ab92-f2bef868f647'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='4f23a5dc-907c-4647-9882-c9b0a49f893f'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='3e81e858-284c-4df4-871d-5d22243ea996'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}", "Observation: content=\"The Spark SQL query appears to be correct and follows best practices for Spark SQL, particularly in its use of backticks for identifiers containing spaces or special characters.\\n\\nHere's a breakdown of the checks:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` compare column values to string literals. It's common for grade columns to be stored as strings (e.g., to accommodate 'K' or 'PK'), so this is likely correct. Spark SQL is also flexible with implicit casting if '12' needed to be an integer, but comparing strings to strings is generally safe.\\n*   **Properly quoting identifiers**: All identifiers with spaces (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers without spaces are not quoted, which is also correct.\\n*   **Use ` for the in-query strings**: This instruction likely refers to quoting identifiers, which is correctly done with backticks. String literals ('K', '12') are correctly enclosed in single quotes (`'`).\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\\n*   **Casting to the correct data type**: No explicit casting is used, and implicit casting (if needed) would be handled by Spark SQL.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a common and logical way to link school information between two tables, assuming `CDSCode` is a unique identifier for schools in both tables.\\n\\nThe query is well-formed and robust.\\n\\n```sql\\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='5980c7f6-a6c0-42bd-930a-c3d22dbf409f'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}"], "input_tokens": 5627, "output_tokens": 2476, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = \\'K\\' AND T2.`High Grade` = \\'12\\' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\"}'}\nTool: The Spark SQL query appears to be correct and follows best practices for Spark SQL, particularly in its use of backticks for identifiers containing spaces or special characters.\n\nHere's a breakdown of the checks:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `T2.`Low Grade` = 'K'` and `T2.`High Grade` = '12'` compare column values to string literals. It's common for grade columns to be stored as strings (e.g., to accommodate 'K' or 'PK'), so this is likely correct. Spark SQL is also flexible with implicit casting if '12' needed to be an integer, but comparing strings to strings is generally safe.\n*   **Properly quoting identifiers**: All identifiers with spaces (`Low Grade`, `High Grade`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers without spaces are not quoted, which is also correct.\n*   **Use ` for the in-query strings**: This instruction likely refers to quoting identifiers, which is correctly done with backticks. String literals ('K', '12') are correctly enclosed in single quotes (`'`).\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\n*   **Casting to the correct data type**: No explicit casting is used, and implicit casting (if needed) would be handled by Spark SQL.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` is a common and logical way to link school information between two tables, assuming `CDSCode` is a unique identifier for schools in both tables.\n\nThe query is well-formed and robust.\n\n```sql\nSELECT T1.OpenDate FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12' ORDER BY T2.`Enrollment (K-12)` DESC LIMIT 1\n```", "final_answer": "", "replica": 8, "timestamp": 1768938204.8987749}
{"query_id": 29, "provider": "google", "db": "california_schools", "nl_query": "When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade", "gold_sqlite": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "gold_spark": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` = 'K' AND f.`High Grade` = '12' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["2006-08-29"]], "spark_error": null, "total_time": 20.81722140312195, "spark_time": 0.10796833038330078, "translation_time": 20.709253072738647, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1ef1e348-dbfa-46ef-b951-6e94384e2436'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='0698bb6e-2dc9-4266-abc7-df49fbc76598'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, satscores'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='87e8216a-4d27-4c49-8156-c44b4fd2f1fc'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\"Low Grade\" = \\'K\\' AND f.\"High Grade\" = \\'12\\' ORDER BY f.\"Enrollment (K-12)\" DESC LIMIT 1'}", "Observation: content='The original query uses double quotes (`\"`) for identifiers that contain spaces or special characters (e.g., `\"Low Grade\"`, `\"High Grade\"`, `\"Enrollment (K-12)\"`). While many SQL dialects, including Spark SQL, often accept double quotes for this purpose, the idiomatic and recommended way to quote identifiers in Spark SQL is using backticks (`` ` ``).\\n\\nThe instruction \"Use `` ` `` for the in-query strings\" is interpreted as referring to quoted identifiers, as using backticks for string literals (like `\\'K\\'`) would be incorrect.\\n\\nTherefore, the query should be rewritten to use backticks for these identifiers.\\n\\n```sql\\nSELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` = \\'K\\' AND f.`High Grade` = \\'12\\' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='5762b0bd-f990-48ba-92aa-8680109b2fdc'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` = 'K' AND f.`High Grade` = '12' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1\"}"], "input_tokens": 5428, "output_tokens": 2945, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: When did the first-through-twelfth-grade school with the largest enrollment open? K-12 means First-through-twelfth-grade\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, satscores\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.\\\\\"Low Grade\\\\\" = \\'K\\' AND f.\\\\\"High Grade\\\\\" = \\'12\\' ORDER BY f.\\\\\"Enrollment (K-12)\\\\\" DESC LIMIT 1\"}'}\nTool: The original query uses double quotes (`\"`) for identifiers that contain spaces or special characters (e.g., `\"Low Grade\"`, `\"High Grade\"`, `\"Enrollment (K-12)\"`). While many SQL dialects, including Spark SQL, often accept double quotes for this purpose, the idiomatic and recommended way to quote identifiers in Spark SQL is using backticks (`` ` ``).\n\nThe instruction \"Use `` ` `` for the in-query strings\" is interpreted as referring to quoted identifiers, as using backticks for string literals (like `'K'`) would be incorrect.\n\nTherefore, the query should be rewritten to use backticks for these identifiers.\n\n```sql\nSELECT s.OpenDate FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` = 'K' AND f.`High Grade` = '12' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1\n```", "final_answer": "", "replica": 9, "timestamp": 1768938226.2777855}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.City, SUM(f.`Enrollment (K-12)`) AS TotalEnrollment FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS INT) >= 12 GROUP BY s.City ORDER BY TotalEnrollment ASC LIMIT 5;", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'K' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 126) ==\n... ON s.CDSCode = f.CDSCode WHERE CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 17.441874980926514, "spark_time": 0.08656454086303711, "translation_time": 17.355310440063477, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='16bbcfb3-1616-4327-85d2-18510ea56f0f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='a6844b18-8d6b-4397-aeaa-184842b53b95'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.City, SUM(f.`Enrollment (K-12)`) AS TotalEnrollment FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` <= '01' AND f.`High Grade` >= '12' GROUP BY s.City ORDER BY TotalEnrollment ASC LIMIT 5;\"}", "Observation: content='```sql\\nSELECT\\n    s.City,\\n    SUM(f.`Enrollment (K-12)`) AS TotalEnrollment\\nFROM\\n    schools AS s\\nJOIN\\n    frpm AS f\\nON\\n    s.CDSCode = f.CDSCode\\nWHERE\\n    CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS INT) >= 12\\nGROUP BY\\n    s.City\\nORDER BY\\n    TotalEnrollment ASC\\nLIMIT 5;\\n```' name='query_checker_sql_db' tool_call_id='8bd8f8e0-2767-4381-8ec2-ec882f1b8b3b'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.City, SUM(f.`Enrollment (K-12)`) AS TotalEnrollment FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS INT) >= 12 GROUP BY s.City ORDER BY TotalEnrollment ASC LIMIT 5;'}"], "input_tokens": 4249, "output_tokens": 3021, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.City, SUM(f.`Enrollment (K-12)`) AS TotalEnrollment FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` <= \\'01\\' AND f.`High Grade` >= \\'12\\' GROUP BY s.City ORDER BY TotalEnrollment ASC LIMIT 5;\"}'}\nTool: ```sql\nSELECT\n    s.City,\n    SUM(f.`Enrollment (K-12)`) AS TotalEnrollment\nFROM\n    schools AS s\nJOIN\n    frpm AS f\nON\n    s.CDSCode = f.CDSCode\nWHERE\n    CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS INT) >= 12\nGROUP BY\n    s.City\nORDER BY\n    TotalEnrollment ASC\nLIMIT 5;\n```", "final_answer": "", "replica": 0, "timestamp": 1768938243.8217432}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5", "execution_status": "VALID", "query_result": [["Coulterville", "2.0"], ["Shaver Lake", "4.0"], ["Pinecrest", "4.0"], ["Woody", "5.0"], ["Emigrant Gap", "5.0"]], "spark_error": null, "total_time": 15.983668327331543, "spark_time": 0.2487504482269287, "translation_time": 15.734917879104614, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='28c4d223-2dc7-49a2-86dd-d29c48f18fdf'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='e8af68f8-630e-40a9-9557-665d50b025cd'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` assumes `CDSCode` has compatible data types, which is standard for join keys. `SUM` on `Enrollment (K-12)` implies it's a numeric type, which is correct for summation.\\n*   **Properly quoting identifiers**: The identifier `Enrollment (K-12)` is correctly quoted with backticks (` `) because it contains spaces and special characters. Other identifiers like `City`, `CDSCode`, `frpm`, `schools` are simple and do not strictly require quoting, but backticks would also be acceptable.\\n*   **Use ` for the in-query strings**: Not applicable, there are no in-query string literals that would require backticks (which are for identifiers, not string literals).\\n*   **Using the correct number of arguments for functions**: `SUM()` takes one argument, `GROUP BY` takes one column, `ORDER BY` takes one column/alias, `LIMIT` takes one number. All are used correctly.\\n*   **Casting to the correct data type**: No explicit casting is needed; `SUM` will handle numeric types appropriately.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a standard and logical join condition between two tables likely related to schools and their data.\\n\\nThe query is well-formed and follows best practices for Spark SQL.\\n\\n```sql\\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='aa1b4b98-a8a5-41a3-bd29-120bdb47d1c4'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}"], "input_tokens": 4563, "output_tokens": 2434, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` assumes `CDSCode` has compatible data types, which is standard for join keys. `SUM` on `Enrollment (K-12)` implies it's a numeric type, which is correct for summation.\n*   **Properly quoting identifiers**: The identifier `Enrollment (K-12)` is correctly quoted with backticks (` `) because it contains spaces and special characters. Other identifiers like `City`, `CDSCode`, `frpm`, `schools` are simple and do not strictly require quoting, but backticks would also be acceptable.\n*   **Use ` for the in-query strings**: Not applicable, there are no in-query string literals that would require backticks (which are for identifiers, not string literals).\n*   **Using the correct number of arguments for functions**: `SUM()` takes one argument, `GROUP BY` takes one column, `ORDER BY` takes one column/alias, `LIMIT` takes one number. All are used correctly.\n*   **Casting to the correct data type**: No explicit casting is needed; `SUM` will handle numeric types appropriately.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a standard and logical join condition between two tables likely related to schools and their data.\n\nThe query is well-formed and follows best practices for Spark SQL.\n\n```sql\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\n```", "final_answer": "", "replica": 1, "timestamp": 1768938260.5344083}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'K' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 132) ==\n...N T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` A...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 16.004693031311035, "spark_time": 0.08234333992004395, "translation_time": 15.922349691390991, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cf95e111-0899-4a6a-b146-a15b51289288'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='1c722e20-041f-4280-aa3b-109186decc12'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}", "Observation: content='```sql\\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\\n```' name='query_checker_sql_db' tool_call_id='addb67e4-51fa-4b68-9218-060e17d3ec3c'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}"], "input_tokens": 4251, "output_tokens": 2652, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: ```sql\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\n```", "final_answer": "", "replica": 2, "timestamp": 1768938276.6491556}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) >= 1 AND CAST(T1.`High Grade` AS INT) <= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'K' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 132) ==\n...N T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) >= 1 AND CAST(T1.`High Grade` A...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 21.007438898086548, "spark_time": 0.07601809501647949, "translation_time": 20.93142080307007, "llm_requests": 6, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cef6e4be-685d-42b0-95ff-ee39c475b4ca'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='d34fc8b7-e170-4a69-b256-07207258fd0f'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='198d1625-101c-4e21-8393-6c8ac4377c42'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Low Grade` >= '01' AND T1.`High Grade` <= '12' GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}", "Observation: content=\"The query has a potential data type mismatch in the `WHERE` clause predicates.\\n\\nThe columns `T1.`Low Grade`` and `T1.`High Grade`` are compared with string literals (`'01'`, `'12'`). If these grade columns are stored as strings (e.g., `VARCHAR`), comparing them lexicographically might not yield the correct numeric order, especially if grades are not consistently zero-padded (e.g., '10' is lexicographically less than '2'). If they are stored as integers, Spark SQL would implicitly cast the string literals to integers, which would work, but explicit casting is clearer.\\n\\nTo ensure correct numeric comparison for grades, it's best practice to explicitly cast `T1.`Low Grade`` and `T1.`High Grade`` to an integer type.\\n\\nHere's the rewritten query:\\n\\n```sql\\nSELECT\\n    T2.City,\\n    SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment\\nFROM\\n    frpm AS T1\\nJOIN\\n    schools AS T2\\nON\\n    T1.CDSCode = T2.CDSCode\\nWHERE\\n    CAST(T1.`Low Grade` AS INT) >= 1 AND CAST(T1.`High Grade` AS INT) <= 12\\nGROUP BY\\n    T2.City\\nORDER BY\\n    TotalEnrollment ASC\\nLIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='721c841c-1c6a-47d2-aa34-18ffd180c841'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) >= 1 AND CAST(T1.`High Grade` AS INT) <= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}"], "input_tokens": 5486, "output_tokens": 3740, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Low Grade` >= \\'01\\' AND T1.`High Grade` <= \\'12\\' GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: The query has a potential data type mismatch in the `WHERE` clause predicates.\n\nThe columns `T1.`Low Grade`` and `T1.`High Grade`` are compared with string literals (`'01'`, `'12'`). If these grade columns are stored as strings (e.g., `VARCHAR`), comparing them lexicographically might not yield the correct numeric order, especially if grades are not consistently zero-padded (e.g., '10' is lexicographically less than '2'). If they are stored as integers, Spark SQL would implicitly cast the string literals to integers, which would work, but explicit casting is clearer.\n\nTo ensure correct numeric comparison for grades, it's best practice to explicitly cast `T1.`Low Grade`` and `T1.`High Grade`` to an integer type.\n\nHere's the rewritten query:\n\n```sql\nSELECT\n    T2.City,\n    SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment\nFROM\n    frpm AS T1\nJOIN\n    schools AS T2\nON\n    T1.CDSCode = T2.CDSCode\nWHERE\n    CAST(T1.`Low Grade` AS INT) >= 1 AND CAST(T1.`High Grade` AS INT) <= 12\nGROUP BY\n    T2.City\nORDER BY\n    TotalEnrollment ASC\nLIMIT 5\n```", "final_answer": "", "replica": 3, "timestamp": 1768938297.7796206}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5", "execution_status": "VALID", "query_result": [["Coulterville", "2.0"], ["Shaver Lake", "4.0"], ["Pinecrest", "4.0"], ["Woody", "5.0"], ["Emigrant Gap", "5.0"]], "spark_error": null, "total_time": 17.232974529266357, "spark_time": 0.17500019073486328, "translation_time": 17.057974338531494, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='f2440a02-5c75-4dbd-b5fe-1c3708bffdf5'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='9f3c96ab-321e-4b0b-8af1-c32d782723a0'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` assumes `CDSCode` has compatible data types, which is standard for join keys. `SUM` on `Enrollment (K-12)` implies it's a numeric type, which is correct for summation.\\n*   **Properly quoting identifiers**: The identifier `Enrollment (K-12)` is correctly quoted with backticks (` `) because it contains spaces and special characters. Other identifiers like `City`, `CDSCode`, `frpm`, `schools` are simple and do not strictly require quoting, but backticks would also be acceptable.\\n*   **Use ` for the in-query strings**: Not applicable, there are no in-query string literals that would require backticks (which are for identifiers, not string literals).\\n*   **Using the correct number of arguments for functions**: `SUM()` takes one argument, `GROUP BY` takes one column, `ORDER BY` takes one column/alias, `LIMIT` takes one number. All are used correctly.\\n*   **Casting to the correct data type**: No explicit casting is needed; `SUM` will handle numeric types appropriately.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a standard and logical join condition between two tables likely related to schools and their data.\\n\\nThe query is well-formed and follows best practices for Spark SQL.\\n\\n```sql\\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='50ad93be-59bc-462a-b110-51a48902caad'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}"], "input_tokens": 4563, "output_tokens": 2269, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` assumes `CDSCode` has compatible data types, which is standard for join keys. `SUM` on `Enrollment (K-12)` implies it's a numeric type, which is correct for summation.\n*   **Properly quoting identifiers**: The identifier `Enrollment (K-12)` is correctly quoted with backticks (` `) because it contains spaces and special characters. Other identifiers like `City`, `CDSCode`, `frpm`, `schools` are simple and do not strictly require quoting, but backticks would also be acceptable.\n*   **Use ` for the in-query strings**: Not applicable, there are no in-query string literals that would require backticks (which are for identifiers, not string literals).\n*   **Using the correct number of arguments for functions**: `SUM()` takes one argument, `GROUP BY` takes one column, `ORDER BY` takes one column/alias, `LIMIT` takes one number. All are used correctly.\n*   **Casting to the correct data type**: No explicit casting is needed; `SUM` will handle numeric types appropriately.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a standard and logical join condition between two tables likely related to schools and their data.\n\nThe query is well-formed and follows best practices for Spark SQL.\n\n```sql\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\n```", "final_answer": "", "replica": 4, "timestamp": 1768938315.6166978}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.City, SUM(f.`Enrollment (K-12)`) AS TotalEnrollment FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS INT) >= 12 GROUP BY s.City ORDER BY TotalEnrollment ASC LIMIT 5;", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'K' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 126) ==\n... ON s.CDSCode = f.CDSCode WHERE CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 18.135119438171387, "spark_time": 0.06962847709655762, "translation_time": 18.06549096107483, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='57f1ebc8-659e-49ba-9bf2-07e0b619022e'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='de5e8539-23bf-4046-9e7f-74ed04169faa'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.City, SUM(f.`Enrollment (K-12)`) AS TotalEnrollment FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` <= '01' AND f.`High Grade` >= '12' GROUP BY s.City ORDER BY TotalEnrollment ASC LIMIT 5;\"}", "Observation: content='```sql\\nSELECT\\n    s.City,\\n    SUM(f.`Enrollment (K-12)`) AS TotalEnrollment\\nFROM\\n    schools AS s\\nJOIN\\n    frpm AS f\\nON\\n    s.CDSCode = f.CDSCode\\nWHERE\\n    CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS INT) >= 12\\nGROUP BY\\n    s.City\\nORDER BY\\n    TotalEnrollment ASC\\nLIMIT 5;\\n```' name='query_checker_sql_db' tool_call_id='0a7ce553-4121-4882-8339-bd9bc0f18fc8'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.City, SUM(f.`Enrollment (K-12)`) AS TotalEnrollment FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS INT) >= 12 GROUP BY s.City ORDER BY TotalEnrollment ASC LIMIT 5;'}"], "input_tokens": 4249, "output_tokens": 3021, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.City, SUM(f.`Enrollment (K-12)`) AS TotalEnrollment FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Low Grade` <= \\'01\\' AND f.`High Grade` >= \\'12\\' GROUP BY s.City ORDER BY TotalEnrollment ASC LIMIT 5;\"}'}\nTool: ```sql\nSELECT\n    s.City,\n    SUM(f.`Enrollment (K-12)`) AS TotalEnrollment\nFROM\n    schools AS s\nJOIN\n    frpm AS f\nON\n    s.CDSCode = f.CDSCode\nWHERE\n    CAST(f.`Low Grade` AS INT) <= 1 AND CAST(f.`High Grade` AS INT) >= 12\nGROUP BY\n    s.City\nORDER BY\n    TotalEnrollment ASC\nLIMIT 5;\n```", "final_answer": "", "replica": 5, "timestamp": 1768938333.8628554}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5", "execution_status": "VALID", "query_result": [["Coulterville", "2.0"], ["Shaver Lake", "4.0"], ["Pinecrest", "4.0"], ["Woody", "5.0"], ["Emigrant Gap", "5.0"]], "spark_error": null, "total_time": 33.89031219482422, "spark_time": 0.19962739944458008, "translation_time": 33.69068479537964, "llm_requests": 8, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='8a9108a3-1aa6-47ed-946f-9a9cee1c1f96'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='6b628c71-c4a7-4cc0-b06c-f02da9a74295'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='b55aa5a8-8cab-4bd7-9095-8bc04e3513c0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Low Grade` <= '12' AND T1.`High Grade` >= '1' GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}", "Observation: content=\"The query has a potential data type mismatch in the `WHERE` clause predicates.\\n\\nThe columns `T1.`Low Grade`` and `T1.`High Grade`` likely store numerical values representing grades. Comparing them with string literals (`'12'` and `'1'`) is a common mistake. While Spark SQL might implicitly cast the string literals to numbers in many cases, it's better practice and more robust to compare numeric columns with numeric literals.\\n\\n**Mistake:**\\n*   `T1.`Low Grade` <= '12'`\\n*   `T1.`High Grade` >= '1'`\\n\\n**Correction:**\\nThe string literals `'12'` and `'1'` should be replaced with numeric literals `12` and `1`.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Low Grade` <= 12 AND T1.`High Grade` >= 1 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='c6c27d22-b711-4132-a5cc-bd53feee2236'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}", "Observation: content=\"The Spark SQL query provided is well-formed and does not exhibit any of the common mistakes listed:\\n\\n*   **`NOT IN` with `NULL`**: Not used.\\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\\n*   **`BETWEEN` for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` assumes compatible data types, which is standard for join keys. The `SUM` function operates on `Enrollment (K-12)`, implying it's a numeric type, which is appropriate.\\n*   **Properly quoting identifiers**: The identifier `Enrollment (K-12)` contains spaces and special characters, and it is correctly quoted using backticks (`` `Enrollment (K-12)` ``), which is the standard for Spark SQL. Other identifiers like `City`, `CDSCode`, `TotalEnrollment` are simple and do not require quoting.\\n*   **Use `` ` `` for the in-query strings**: This instruction typically refers to quoting identifiers. The query correctly uses backticks for the identifier `Enrollment (K-12)`. There are no string literals in the query that would be incorrectly quoted.\\n*   **Using the correct number of arguments for functions**: `SUM()` is used with one argument, which is correct.\\n*   **Casting to the correct data type**: No explicit casting is performed or appears necessary.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a logical join condition, assuming `CDSCode` is a common identifier between the `frpm` (Free and Reduced Price Meal) and `schools` tables.\\n\\nThe query is syntactically correct and follows best practices for Spark SQL regarding identifier quoting.\\n\\n```sql\\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='78b83a2d-d71e-4bc1-9c4a-1d1ba06c1b51'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}"], "input_tokens": 7809, "output_tokens": 4638, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Low Grade` <= \\'12\\' AND T1.`High Grade` >= \\'1\\' GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: The query has a potential data type mismatch in the `WHERE` clause predicates.\n\nThe columns `T1.`Low Grade`` and `T1.`High Grade`` likely store numerical values representing grades. Comparing them with string literals (`'12'` and `'1'`) is a common mistake. While Spark SQL might implicitly cast the string literals to numbers in many cases, it's better practice and more robust to compare numeric columns with numeric literals.\n\n**Mistake:**\n*   `T1.`Low Grade` <= '12'`\n*   `T1.`High Grade` >= '1'`\n\n**Correction:**\nThe string literals `'12'` and `'1'` should be replaced with numeric literals `12` and `1`.\n\n**Rewritten Query:**\n\n```sql\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Low Grade` <= 12 AND T1.`High Grade` >= 1 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: The Spark SQL query provided is well-formed and does not exhibit any of the common mistakes listed:\n\n*   **`NOT IN` with `NULL`**: Not used.\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\n*   **`BETWEEN` for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` assumes compatible data types, which is standard for join keys. The `SUM` function operates on `Enrollment (K-12)`, implying it's a numeric type, which is appropriate.\n*   **Properly quoting identifiers**: The identifier `Enrollment (K-12)` contains spaces and special characters, and it is correctly quoted using backticks (`` `Enrollment (K-12)` ``), which is the standard for Spark SQL. Other identifiers like `City`, `CDSCode`, `TotalEnrollment` are simple and do not require quoting.\n*   **Use `` ` `` for the in-query strings**: This instruction typically refers to quoting identifiers. The query correctly uses backticks for the identifier `Enrollment (K-12)`. There are no string literals in the query that would be incorrectly quoted.\n*   **Using the correct number of arguments for functions**: `SUM()` is used with one argument, which is correct.\n*   **Casting to the correct data type**: No explicit casting is performed or appears necessary.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a logical join condition, assuming `CDSCode` is a common identifier between the `frpm` (Free and Reduced Price Meal) and `schools` tables.\n\nThe query is syntactically correct and follows best practices for Spark SQL regarding identifier quoting.\n\n```sql\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\n```", "final_answer": "", "replica": 6, "timestamp": 1768938368.4480152}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'K' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 132) ==\n...N T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` A...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 17.56775403022766, "spark_time": 0.08470392227172852, "translation_time": 17.483050107955933, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='2c47efe1-ffa6-4706-919f-447a081988cf'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='56a80e61-3360-40c8-8591-1753102c041a'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}", "Observation: content='```sql\\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\\n```' name='query_checker_sql_db' tool_call_id='71a29683-a873-4d22-ac32-f9b697a64a90'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}"], "input_tokens": 4251, "output_tokens": 2652, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: ```sql\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\n```", "final_answer": "", "replica": 7, "timestamp": 1768938386.2266207}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'K' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 132) ==\n...N T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` A...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 17.143966913223267, "spark_time": 0.0786747932434082, "translation_time": 17.06529211997986, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a2ebb576-055c-442e-ad43-c743911e59c7'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='492c3016-fe07-4d05-a9d9-a3ad641e0244'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}", "Observation: content='```sql\\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\\n```' name='query_checker_sql_db' tool_call_id='26161b28-b682-4d3f-ab67-eb354eb45848'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}"], "input_tokens": 4251, "output_tokens": 2654, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: ```sql\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\n```", "final_answer": "", "replica": 8, "timestamp": 1768938403.5436294}
{"query_id": 30, "provider": "google", "db": "california_schools", "nl_query": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.", "gold_sqlite": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "gold_spark": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5", "execution_status": "ERROR", "query_result": null, "spark_error": "[CAST_INVALID_INPUT] The value 'K' of the type \"STRING\" cannot be cast to \"INT\" because it is malformed. Correct the value as per the syntax, or change its target type. Use `try_cast` to tolerate malformed input and return NULL instead. SQLSTATE: 22018\n== SQL (line 1, position 132) ==\n...N T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` A...\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "total_time": 19.21060872077942, "spark_time": 0.08116960525512695, "translation_time": 19.129439115524292, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='eb2bfe48-971f-44ab-b1b0-c945bd1b1cab'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='17653a75-6213-4eb8-863d-101d385d4a2f'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}", "Observation: content=\"The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\\n\\nHere's a breakdown of the checks:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used. The query uses `<=` and `>=` which are inclusive.\\n*   **Data type mismatch in predicates**: The `CAST` operations for `Low Grade` and `High Grade` to `INT` are appropriate for comparison with integer literals (1 and 12). The join condition `T1.CDSCode = T2.CDSCode` assumes compatible data types for `CDSCode` in both tables, which is a standard practice for join keys.\\n*   **Properly quoting identifiers**: Identifiers with spaces like ``Enrollment (K-12)``, ``Low Grade``, and ``High Grade`` are correctly quoted using backticks (` `). Other identifiers like `City`, `CDSCode` do not require backticks but are implicitly handled correctly.\\n*   **Use `` for the in-query strings**: This point refers to string literals. The query does not contain any string literals that would require quoting. It correctly uses backticks for column names.\\n*   **Using the correct number of arguments for functions**: `SUM()` and `CAST()` functions are used with the correct number of arguments.\\n*   **Casting to the correct data type**: Casting `Low Grade` and `High Grade` to `INT` is appropriate for numerical comparisons, assuming these columns contain numeric representations of grades (e.g., '1', '12') or actual numeric types. If 'K' or 'PK' are present as strings, the `CAST` might result in `NULL` or an error, but based on the common use of such data, `INT` is a reasonable assumption for numerical grades.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a standard and logical join condition to link school-level data from `frpm` to `schools` based on the CDSCode (California Department of Education School Code).\\n\\nThe query correctly filters for schools that cover the K-12 range (or broader, e.g., PK-12, 1-12) by checking if the `Low Grade` is 1 or less and `High Grade` is 12 or more. It then sums the enrollment, groups by city, orders by total enrollment, and limits to the top 5.\\n\\nThe query is correctly written.\\n\\n```sql\\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='ec531e9a-5534-4db3-9fbe-317aefbf4e98'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5'}"], "input_tokens": 4843, "output_tokens": 3211, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Which cities have the top 5 lowest enrollment number for students in grades 1 through 12? K-12 refers to students in grades 1 through 12.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\"}'}\nTool: The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\n\nHere's a breakdown of the checks:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used. The query uses `<=` and `>=` which are inclusive.\n*   **Data type mismatch in predicates**: The `CAST` operations for `Low Grade` and `High Grade` to `INT` are appropriate for comparison with integer literals (1 and 12). The join condition `T1.CDSCode = T2.CDSCode` assumes compatible data types for `CDSCode` in both tables, which is a standard practice for join keys.\n*   **Properly quoting identifiers**: Identifiers with spaces like ``Enrollment (K-12)``, ``Low Grade``, and ``High Grade`` are correctly quoted using backticks (` `). Other identifiers like `City`, `CDSCode` do not require backticks but are implicitly handled correctly.\n*   **Use `` for the in-query strings**: This point refers to string literals. The query does not contain any string literals that would require quoting. It correctly uses backticks for column names.\n*   **Using the correct number of arguments for functions**: `SUM()` and `CAST()` functions are used with the correct number of arguments.\n*   **Casting to the correct data type**: Casting `Low Grade` and `High Grade` to `INT` is appropriate for numerical comparisons, assuming these columns contain numeric representations of grades (e.g., '1', '12') or actual numeric types. If 'K' or 'PK' are present as strings, the `CAST` might result in `NULL` or an error, but based on the common use of such data, `INT` is a reasonable assumption for numerical grades.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a standard and logical join condition to link school-level data from `frpm` to `schools` based on the CDSCode (California Department of Education School Code).\n\nThe query correctly filters for schools that cover the K-12 range (or broader, e.g., PK-12, 1-12) by checking if the `Low Grade` is 1 or less and `High Grade` is 12 or more. It then sums the enrollment, groups by city, orders by total enrollment, and limits to the top 5.\n\nThe query is correctly written.\n\n```sql\nSELECT T2.City, SUM(T1.`Enrollment (K-12)`) AS TotalEnrollment FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE CAST(T1.`Low Grade` AS INT) <= 1 AND CAST(T1.`High Grade` AS INT) >= 12 GROUP BY T2.City ORDER BY TotalEnrollment ASC LIMIT 5\n```", "final_answer": "", "replica": 9, "timestamp": 1768938422.8857565}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `School Name`, `Enrollment (K-12)`, `Free Meal Count (K-12)`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'LIMIT'. SQLSTATE: 42601 (line 1, pos 223)\n\n== SQL ==\nSELECT `School Name`, `Enrollment (K-12)`, `Free Meal Count (K-12)`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 12.361731052398682, "spark_time": 0.022002458572387695, "translation_time": 12.339728593826294, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='95f5b963-003d-4dc5-b830-8aab404a5321'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='311b931a-4fb7-4927-80bb-22f140e9f004'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, `Enrollment (K-12)`, `Free Meal Count (K-12)`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n```sql\\nSELECT `School Name`, `Enrollment (K-12)`, `Free Meal Count (K-12)`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\\n```' name='query_checker_sql_db' tool_call_id='069bff1f-ccd8-4ed3-81f3-2fd1fe362fdd'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, `Enrollment (K-12)`, `Free Meal Count (K-12)`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}"], "input_tokens": 4414, "output_tokens": 1861, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, `Enrollment (K-12)`, `Free Meal Count (K-12)`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n```sql\nSELECT `School Name`, `Enrollment (K-12)`, `Free Meal Count (K-12)`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n```", "final_answer": "", "replica": 0, "timestamp": 1768938435.3774984}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `School Name`, (CAST(`Free Meal Count (K-12)` AS DOUBLE) / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'LIMIT'. SQLSTATE: 42601 (line 1, pos 192)\n\n== SQL ==\nSELECT `School Name`, (CAST(`Free Meal Count (K-12)` AS DOUBLE) / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 13.707419395446777, "spark_time": 0.019887685775756836, "translation_time": 13.68753170967102, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='ce9d2671-32f3-4c44-a1d6-d0a3e86deab9'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='5a66c75f-af8c-44b9-8be5-d64472dd73a4'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}", "Observation: content=\"The original query has a potential issue regarding data type casting for the division operation. If `Free Meal Count (K-12)` and `Enrollment (K-12)` are both integer types, the division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` might perform integer division in some SQL environments or older Spark versions, resulting in an integer rate (e.g., 0 instead of 0.5). To ensure a floating-point result for the `eligible_free_rate`, it's best practice to explicitly cast one of the operands to a floating-point type (like `DOUBLE`).\\n\\nHere's the corrected query:\\n\\n```sql\\nSELECT `School Name`, (CAST(`Free Meal Count (K-12)` AS DOUBLE) / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\\n```\" name='query_checker_sql_db' tool_call_id='5c957402-899c-497b-b126-dcc03cfd1ccf'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (CAST(`Free Meal Count (K-12)` AS DOUBLE) / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}"], "input_tokens": 4491, "output_tokens": 2328, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\"}'}\nTool: The original query has a potential issue regarding data type casting for the division operation. If `Free Meal Count (K-12)` and `Enrollment (K-12)` are both integer types, the division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` might perform integer division in some SQL environments or older Spark versions, resulting in an integer rate (e.g., 0 instead of 0.5). To ensure a floating-point result for the `eligible_free_rate`, it's best practice to explicitly cast one of the operands to a floating-point type (like `DOUBLE`).\n\nHere's the corrected query:\n\n```sql\nSELECT `School Name`, (CAST(`Free Meal Count (K-12)` AS DOUBLE) / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n```", "final_answer": "", "replica": 1, "timestamp": 1768938449.1919158}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "execution_status": "VALID", "query_result": [["Eleanor Roosevelt High", "0.2905894519131334"], ["El Camino Real Charter High", "0.1344364012409514"]], "spark_error": null, "total_time": 15.181416034698486, "spark_time": 0.18280863761901855, "translation_time": 14.998607397079468, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='575af976-2774-4d8f-a8f7-eba9ead3f5da'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='c5dfb1d0-e198-476e-800d-37e37ae51be2'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9'}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\nHere's a breakdown of why:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicate `WHERE `Enrollment (K-12)` > 0` compares a numeric column (presumably) with an integer literal, which is correct. The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` operates on numeric types, and Spark SQL will handle the resulting data type (typically `DOUBLE`) appropriately for a rate.\\n*   **Properly quoting identifiers**: All identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`) are correctly enclosed in backticks (`` ` ``), which is the standard for Spark SQL, especially when identifiers contain spaces.\\n*   **Use ` for the in-query strings**: There are no literal strings in the query. Backticks are correctly used for identifiers.\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\\n*   **Casting to the correct data type**: The division naturally produces a floating-point number, which is suitable for a rate. No explicit casting is needed unless a specific precision was required.\\n*   **Using the proper columns for joins**: Not applicable, no joins are used.\\n\\nThe query also correctly handles potential division by zero with `WHERE `Enrollment (K-12)` > 0` and uses `LIMIT` and `OFFSET` for pagination correctly.\\n\\nTherefore, the original query is correct.\\n\\n```sql\\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\\n```\" name='query_checker_sql_db' tool_call_id='b30d5a0f-7824-4cdb-9e5d-4de2e992a8dc'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9'}"], "input_tokens": 4754, "output_tokens": 2100, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\nHere's a breakdown of why:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicate `WHERE `Enrollment (K-12)` > 0` compares a numeric column (presumably) with an integer literal, which is correct. The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` operates on numeric types, and Spark SQL will handle the resulting data type (typically `DOUBLE`) appropriately for a rate.\n*   **Properly quoting identifiers**: All identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`) are correctly enclosed in backticks (`` ` ``), which is the standard for Spark SQL, especially when identifiers contain spaces.\n*   **Use ` for the in-query strings**: There are no literal strings in the query. Backticks are correctly used for identifiers.\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\n*   **Casting to the correct data type**: The division naturally produces a floating-point number, which is suitable for a rate. No explicit casting is needed unless a specific precision was required.\n*   **Using the proper columns for joins**: Not applicable, no joins are used.\n\nThe query also correctly handles potential division by zero with `WHERE `Enrollment (K-12)` > 0` and uses `LIMIT` and `OFFSET` for pagination correctly.\n\nTherefore, the original query is correct.\n\n```sql\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\n```", "final_answer": "", "replica": 2, "timestamp": 1768938464.8872385}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'LIMIT'. SQLSTATE: 42601 (line 1, pos 212)\n\n== SQL ==\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 13.058751106262207, "spark_time": 0.01199793815612793, "translation_time": 13.046753168106079, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cb31bbc7-e8bc-4b85-9009-33221a33510c'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f75adbba-ab95-46d2-b2cb-5d3c838d21eb'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\nHere\\'s a breakdown of why:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used. `IS NOT NULL` is used correctly.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The `WHERE` clause `Enrollment (K-12) IS NOT NULL AND Enrollment (K-12) > 0` correctly handles potential nulls and ensures a non-zero denominator for the division. Assuming `Enrollment (K-12)` and `Free Meal Count (K-12)` are numeric types, the comparison and division are valid. Spark SQL typically handles type promotion for division to a floating-point type (e.g., DOUBLE) automatically, which is suitable for a rate.\\n*   **Properly quoting identifiers**: Backticks (`` ` ``) are used correctly for all identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`), which is the standard for Spark SQL, especially for names containing spaces.\\n*   **Use ` for the in-query strings**: This point refers to string literals. The query does not contain any string literals that would require single quotes (`\\'`). It correctly uses backticks for identifiers.\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions requiring arguments are used.\\n*   **Casting to the correct data type**: The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` will result in a floating-point number, which is appropriate for a \"rate\". No explicit casting is needed unless a specific precision was required.\\n*   **Using the proper columns for joins**: Not applicable, no joins are present in the query.\\n\\nThe query correctly uses `OFFSET` and `LIMIT` for pagination after `ORDER BY`, and the `WHERE` clause correctly prevents division by zero.\\n\\n```sql\\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\\n```' name='query_checker_sql_db' tool_call_id='51250de1-54cc-4031-bab4-d9f46e1ee76b'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}"], "input_tokens": 4852, "output_tokens": 2040, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\nHere's a breakdown of why:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used. `IS NOT NULL` is used correctly.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The `WHERE` clause `Enrollment (K-12) IS NOT NULL AND Enrollment (K-12) > 0` correctly handles potential nulls and ensures a non-zero denominator for the division. Assuming `Enrollment (K-12)` and `Free Meal Count (K-12)` are numeric types, the comparison and division are valid. Spark SQL typically handles type promotion for division to a floating-point type (e.g., DOUBLE) automatically, which is suitable for a rate.\n*   **Properly quoting identifiers**: Backticks (`` ` ``) are used correctly for all identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`), which is the standard for Spark SQL, especially for names containing spaces.\n*   **Use ` for the in-query strings**: This point refers to string literals. The query does not contain any string literals that would require single quotes (`'`). It correctly uses backticks for identifiers.\n*   **Using the correct number of arguments for functions**: Not applicable, no functions requiring arguments are used.\n*   **Casting to the correct data type**: The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` will result in a floating-point number, which is appropriate for a \"rate\". No explicit casting is needed unless a specific precision was required.\n*   **Using the proper columns for joins**: Not applicable, no joins are present in the query.\n\nThe query correctly uses `OFFSET` and `LIMIT` for pagination after `ORDER BY`, and the `WHERE` clause correctly prevents division by zero.\n\n```sql\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n```", "final_answer": "", "replica": 3, "timestamp": 1768938478.063302}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'LIMIT'. SQLSTATE: 42601 (line 1, pos 212)\n\n== SQL ==\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 13.871564865112305, "spark_time": 0.012169837951660156, "translation_time": 13.859395027160645, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='9ae2c6de-9cbb-4406-a0a6-fbfa81c4582c'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='fc1737c3-74aa-4067-b97b-5c5cefc09d05'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\nHere\\'s a breakdown of why:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used. `IS NOT NULL` is used correctly.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The `WHERE` clause `Enrollment (K-12) IS NOT NULL AND Enrollment (K-12) > 0` correctly handles potential nulls and ensures a non-zero denominator for the division. Assuming `Enrollment (K-12)` and `Free Meal Count (K-12)` are numeric types, the comparison and division are valid. Spark SQL typically handles type promotion for division to a floating-point type (e.g., DOUBLE) automatically, which is suitable for a rate.\\n*   **Properly quoting identifiers**: Backticks (`` ` ``) are used correctly for all identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`), which is the standard for Spark SQL, especially for names containing spaces.\\n*   **Use ` for the in-query strings**: This point refers to string literals. The query does not contain any string literals that would require single quotes (`\\'`). It correctly uses backticks for identifiers.\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions requiring arguments are used.\\n*   **Casting to the correct data type**: The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` will result in a floating-point number, which is appropriate for a \"rate\". No explicit casting is needed unless a specific precision was required.\\n*   **Using the proper columns for joins**: Not applicable, no joins are present in the query.\\n\\nThe query correctly uses `OFFSET` and `LIMIT` for pagination after `ORDER BY`, and the `WHERE` clause correctly prevents division by zero.\\n\\n```sql\\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\\n```' name='query_checker_sql_db' tool_call_id='1015b2a3-c884-4957-9f12-f1226549966a'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}"], "input_tokens": 4852, "output_tokens": 2040, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\nHere's a breakdown of why:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used. `IS NOT NULL` is used correctly.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The `WHERE` clause `Enrollment (K-12) IS NOT NULL AND Enrollment (K-12) > 0` correctly handles potential nulls and ensures a non-zero denominator for the division. Assuming `Enrollment (K-12)` and `Free Meal Count (K-12)` are numeric types, the comparison and division are valid. Spark SQL typically handles type promotion for division to a floating-point type (e.g., DOUBLE) automatically, which is suitable for a rate.\n*   **Properly quoting identifiers**: Backticks (`` ` ``) are used correctly for all identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`), which is the standard for Spark SQL, especially for names containing spaces.\n*   **Use ` for the in-query strings**: This point refers to string literals. The query does not contain any string literals that would require single quotes (`'`). It correctly uses backticks for identifiers.\n*   **Using the correct number of arguments for functions**: Not applicable, no functions requiring arguments are used.\n*   **Casting to the correct data type**: The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` will result in a floating-point number, which is appropriate for a \"rate\". No explicit casting is needed unless a specific precision was required.\n*   **Using the proper columns for joins**: Not applicable, no joins are present in the query.\n\nThe query correctly uses `OFFSET` and `LIMIT` for pagination after `ORDER BY`, and the `WHERE` clause correctly prevents division by zero.\n\n```sql\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n```", "final_answer": "", "replica": 4, "timestamp": 1768938492.0630755}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'LIMIT'. SQLSTATE: 42601 (line 1, pos 212)\n\n== SQL ==\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 13.130144596099854, "spark_time": 0.011716842651367188, "translation_time": 13.118427753448486, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b1a0c111-231c-4627-ad8d-548b42c4db1b'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='3f112cf1-2a9a-46e8-8e3f-ccc667f15b3b'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\nHere\\'s a breakdown of why:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used. `IS NOT NULL` is used correctly.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The `WHERE` clause `Enrollment (K-12) IS NOT NULL AND Enrollment (K-12) > 0` correctly handles potential nulls and ensures a non-zero denominator for the division. Assuming `Enrollment (K-12)` and `Free Meal Count (K-12)` are numeric types, the comparison and division are valid. Spark SQL typically handles type promotion for division to a floating-point type (e.g., DOUBLE) automatically, which is suitable for a rate.\\n*   **Properly quoting identifiers**: Backticks (`` ` ``) are used correctly for all identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`), which is the standard for Spark SQL, especially for names containing spaces.\\n*   **Use ` for the in-query strings**: This point refers to string literals. The query does not contain any string literals that would require single quotes (`\\'`). It correctly uses backticks for identifiers.\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions requiring arguments are used.\\n*   **Casting to the correct data type**: The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` will result in a floating-point number, which is appropriate for a \"rate\". No explicit casting is needed unless a specific precision was required.\\n*   **Using the proper columns for joins**: Not applicable, no joins are present in the query.\\n\\nThe query correctly uses `OFFSET` and `LIMIT` for pagination after `ORDER BY`, and the `WHERE` clause correctly prevents division by zero.\\n\\n```sql\\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\\n```' name='query_checker_sql_db' tool_call_id='95e73e94-7d1b-4205-9ac8-e5735d5b2d40'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}"], "input_tokens": 4852, "output_tokens": 2040, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\nHere's a breakdown of why:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used. `IS NOT NULL` is used correctly.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The `WHERE` clause `Enrollment (K-12) IS NOT NULL AND Enrollment (K-12) > 0` correctly handles potential nulls and ensures a non-zero denominator for the division. Assuming `Enrollment (K-12)` and `Free Meal Count (K-12)` are numeric types, the comparison and division are valid. Spark SQL typically handles type promotion for division to a floating-point type (e.g., DOUBLE) automatically, which is suitable for a rate.\n*   **Properly quoting identifiers**: Backticks (`` ` ``) are used correctly for all identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`), which is the standard for Spark SQL, especially for names containing spaces.\n*   **Use ` for the in-query strings**: This point refers to string literals. The query does not contain any string literals that would require single quotes (`'`). It correctly uses backticks for identifiers.\n*   **Using the correct number of arguments for functions**: Not applicable, no functions requiring arguments are used.\n*   **Casting to the correct data type**: The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` will result in a floating-point number, which is appropriate for a \"rate\". No explicit casting is needed unless a specific precision was required.\n*   **Using the proper columns for joins**: Not applicable, no joins are present in the query.\n\nThe query correctly uses `OFFSET` and `LIMIT` for pagination after `ORDER BY`, and the `WHERE` clause correctly prevents division by zero.\n\n```sql\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n```", "final_answer": "", "replica": 5, "timestamp": 1768938505.3278062}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "execution_status": "VALID", "query_result": [["Eleanor Roosevelt High", "0.2905894519131334"], ["El Camino Real Charter High", "0.1344364012409514"]], "spark_error": null, "total_time": 11.299923181533813, "spark_time": 0.04908466339111328, "translation_time": 11.2508385181427, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d4c3c3aa-9b7f-4586-a1d7-2c01b1df3f2b'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='74ec4353-c553-4897-90a0-f99e39ccc3ee'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Quoting identifiers**: All identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`) are correctly quoted with backticks (` `), which is appropriate for Spark SQL, especially when identifiers contain spaces.\\n*   **Division by zero**: The `WHERE `Enrollment (K-12)` > 0` clause correctly prevents division by zero for the `eligible_free_rate` calculation.\\n*   **Data types**: The division of two numeric columns will result in a floating-point number, which is suitable for a rate. No explicit casting is needed unless a specific precision (e.g., `DECIMAL`) was required, which is not indicated.\\n*   **LIMIT/OFFSET**: The `LIMIT 2 OFFSET 9` clause is correctly used to retrieve specific rows after ordering.\\n*   Other points like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, function arguments, and joins are not applicable as these constructs are not used in the query.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\\n```' name='query_checker_sql_db' tool_call_id='d6e94237-22c6-4a17-b536-74d968be2151'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9'}"], "input_tokens": 4599, "output_tokens": 1923, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **Quoting identifiers**: All identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`) are correctly quoted with backticks (` `), which is appropriate for Spark SQL, especially when identifiers contain spaces.\n*   **Division by zero**: The `WHERE `Enrollment (K-12)` > 0` clause correctly prevents division by zero for the `eligible_free_rate` calculation.\n*   **Data types**: The division of two numeric columns will result in a floating-point number, which is suitable for a rate. No explicit casting is needed unless a specific precision (e.g., `DECIMAL`) was required, which is not indicated.\n*   **LIMIT/OFFSET**: The `LIMIT 2 OFFSET 9` clause is correctly used to retrieve specific rows after ordering.\n*   Other points like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, function arguments, and joins are not applicable as these constructs are not used in the query.\n\nThe query is correct as written.\n\n```sql\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\n```", "final_answer": "", "replica": 6, "timestamp": 1768938517.1288462}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'LIMIT'. SQLSTATE: 42601 (line 1, pos 176)\n\n== SQL ==\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 11.665245056152344, "spark_time": 0.013487815856933594, "translation_time": 11.65175724029541, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='309d647f-7ce4-448a-953f-2b94b58d1591'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='dfa95806-a9ad-41ec-9d2a-a3c0b355139d'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Properly quoting identifiers**: Backticks (`` ` ``) are correctly used for column names containing spaces.\\n*   **Data type handling**: The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` will correctly result in a floating-point number (double) in Spark SQL, which is appropriate for a rate. The `WHERE `Enrollment (K-12)` > 0` clause correctly prevents division by zero.\\n*   **No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, function argument issues, or join issues**: These are not present in the query.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\\n```' name='query_checker_sql_db' tool_call_id='36cda39e-daa4-4211-8fdf-46d7ba1e67a9'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}"], "input_tokens": 4517, "output_tokens": 1824, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **Properly quoting identifiers**: Backticks (`` ` ``) are correctly used for column names containing spaces.\n*   **Data type handling**: The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` will correctly result in a floating-point number (double) in Spark SQL, which is appropriate for a rate. The `WHERE `Enrollment (K-12)` > 0` clause correctly prevents division by zero.\n*   **No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, function argument issues, or join issues**: These are not present in the query.\n\nThe query is correct as written.\n\n```sql\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n```", "final_answer": "", "replica": 7, "timestamp": 1768938528.9010792}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'LIMIT'. SQLSTATE: 42601 (line 1, pos 212)\n\n== SQL ==\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 12.116267442703247, "spark_time": 0.012033462524414062, "translation_time": 12.104233980178833, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='581e24de-fc7a-4eb4-86e6-18aa105bb777'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='8c69cbd3-baa1-41a0-a3a3-28750c378c1b'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}", "Observation: content='```sql\\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\\n```' name='query_checker_sql_db' tool_call_id='5bb56926-cd4f-4c87-b424-66147019d5dd'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2'}"], "input_tokens": 4373, "output_tokens": 1851, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\"}'}\nTool: ```sql\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` IS NOT NULL AND `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC OFFSET 9 LIMIT 2\n```", "final_answer": "", "replica": 8, "timestamp": 1768938541.140051}
{"query_id": 31, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2", "gold_spark": "SELECT CAST(`Free Meal Count (K-12)` AS FLOAT) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9", "execution_status": "VALID", "query_result": [["El Camino Real Charter High", "0.1344364012409514"], ["Eleanor Roosevelt High", "0.2905894519131334"]], "spark_error": null, "total_time": 15.98293137550354, "spark_time": 0.0686028003692627, "translation_time": 15.914328575134277, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='e6b6ccdf-5f12-4954-a278-eb44f7a2bbf8'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f8fc1d24-3f9c-4e2a-a558-a11dd84c6b4e'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9'}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\nHere's a breakdown of why:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicate `WHERE `Enrollment (K-12)` > 0` compares a numeric column (presumably) with an integer literal, which is correct. The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` operates on numeric types, and Spark SQL will handle the resulting data type (typically `DOUBLE`) appropriately for a rate.\\n*   **Properly quoting identifiers**: All identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`) are correctly enclosed in backticks (`` ` ``), which is the standard for Spark SQL, especially when identifiers contain spaces.\\n*   **Use ` for the in-query strings**: There are no literal strings in the query. Backticks are correctly used for identifiers.\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\\n*   **Casting to the correct data type**: The division naturally produces a floating-point number, which is suitable for a rate. No explicit casting is needed unless a specific precision was required.\\n*   **Using the proper columns for joins**: Not applicable, no joins are used.\\n\\nThe query also correctly handles potential division by zero with `WHERE `Enrollment (K-12)` > 0` and uses `LIMIT` and `OFFSET` for pagination correctly.\\n\\nTherefore, the original query is correct.\\n\\n```sql\\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\\n```\" name='query_checker_sql_db' tool_call_id='59a07109-0734-4ad5-8bf4-5fdeb80883cf'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9'}"], "input_tokens": 4754, "output_tokens": 2100, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12? K-12 refers to students in grades 1 through 12; Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\nHere's a breakdown of why:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicate `WHERE `Enrollment (K-12)` > 0` compares a numeric column (presumably) with an integer literal, which is correct. The division `(`Free Meal Count (K-12)` / `Enrollment (K-12)`)` operates on numeric types, and Spark SQL will handle the resulting data type (typically `DOUBLE`) appropriately for a rate.\n*   **Properly quoting identifiers**: All identifiers (`School Name`, `Free Meal Count (K-12)`, `Enrollment (K-12)`, `frpm`) are correctly enclosed in backticks (`` ` ``), which is the standard for Spark SQL, especially when identifiers contain spaces.\n*   **Use ` for the in-query strings**: There are no literal strings in the query. Backticks are correctly used for identifiers.\n*   **Using the correct number of arguments for functions**: Not applicable, no functions are used.\n*   **Casting to the correct data type**: The division naturally produces a floating-point number, which is suitable for a rate. No explicit casting is needed unless a specific precision was required.\n*   **Using the proper columns for joins**: Not applicable, no joins are used.\n\nThe query also correctly handles potential division by zero with `WHERE `Enrollment (K-12)` > 0` and uses `LIMIT` and `OFFSET` for pagination correctly.\n\nTherefore, the original query is correct.\n\n```sql\nSELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS eligible_free_rate FROM frpm WHERE `Enrollment (K-12)` > 0 ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9\n```", "final_answer": "", "replica": 9, "timestamp": 1768938557.6268585}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name`, (CAST(T1.`FRPM Count (K-12)` AS DOUBLE) / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 23.02119016647339, "spark_time": 0.12821316719055176, "translation_time": 22.892976999282837, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='293b3a31-4df3-4df5-a9f0-ffd981552941'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='b39ca504-bc90-4f5d-b3c1-3aca473be59b'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}", "Observation: content=\"The query is mostly well-formed. However, to ensure accurate floating-point division for the rate calculation, especially if `FRPM Count (K-12)` and `Enrollment (K-12)` are integer types, it's best practice to explicitly cast one of the operands to a `DOUBLE` or `FLOAT`. While Spark SQL often handles this implicitly for the `/` operator, making it explicit improves robustness and clarity.\\n\\nHere's the revised query:\\n\\n```sql\\nSELECT T1.`School Name`, (CAST(T1.`FRPM Count (K-12)` AS DOUBLE) / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='da87eb5b-b0e5-43f9-a805-f6710beb3ae5'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (CAST(T1.`FRPM Count (K-12)` AS DOUBLE) / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}"], "input_tokens": 4569, "output_tokens": 2987, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = \\'66\\' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}'}\nTool: The query is mostly well-formed. However, to ensure accurate floating-point division for the rate calculation, especially if `FRPM Count (K-12)` and `Enrollment (K-12)` are integer types, it's best practice to explicitly cast one of the operands to a `DOUBLE` or `FLOAT`. While Spark SQL often handles this implicitly for the `/` operator, making it explicit improves robustness and clarity.\n\nHere's the revised query:\n\n```sql\nSELECT T1.`School Name`, (CAST(T1.`FRPM Count (K-12)` AS DOUBLE) / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\n```", "final_answer": "", "replica": 0, "timestamp": 1768938581.2445643}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": null, "spider_em": null, "sparksql_query": "\nSELECT\n  f.\"School Name\",\n  f.\"FRPM Count (K-12)\",\n  f.\"Enrollment (K-12)\",\n  (CAST(f.\"FRPM Count (K-12)\" AS DOUBLE) / NULLIF(f.\"Enrollment (K-12)\", 0)) AS Eligible_FRPM_Rate\nFROM frpm AS f\nJOIN schools AS s\n  ON f.CDSCode = s.CDSCode\nWHERE\n  s.SOC = '66'\nORDER BY\n  f.\"FRPM Count (K-12)\" DESC\nLIMIT 5\n", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"School Name\"'. SQLSTATE: 42601 (line 3, pos 4)\n\n== SQL ==\n\nSELECT\n  f.\"School Name\",\n----^^^\n  f.\"FRPM Count (K-12)\",\n  f.\"Enrollment (K-12)\",\n  (CAST(f.\"FRPM Count (K-12)\" AS DOUBLE) / NULLIF(f.\"Enrollment (K-12)\", 0)) AS Eligible_FRPM_Rate\nFROM frpm AS f\nJOIN schools AS s\n  ON f.CDSCode = s.CDSCode\nWHERE\n  s.SOC = '66'\nORDER BY\n  f.\"FRPM Count (K-12)\" DESC\nLIMIT 5\n", "total_time": 21.95485544204712, "spark_time": 0.010000944137573242, "translation_time": 21.944854497909546, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b92367b3-49c4-45b7-b503-6957ae432ca5'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='90cc0b02-cff1-4f19-81be-61841152989f'", "Action: query_checker_sql_db\nAction Input: {'query': '\\nSELECT\\n  f.\"School Name\",\\n  f.\"FRPM Count (K-12)\",\\n  f.\"Enrollment (K-12)\",\\n  (f.\"FRPM Count (K-12)\" / f.\"Enrollment (K-12)\") AS Eligible_FRPM_Rate\\nFROM frpm AS f\\nJOIN schools AS s\\n  ON f.CDSCode = s.CDSCode\\nWHERE\\n  s.SOC = \\'66\\'\\nORDER BY\\n  f.\"FRPM Count (K-12)\" DESC\\nLIMIT 5\\n'}", "Observation: content='The original query has a potential issue with the calculation of `Eligible_FRPM_Rate`. If `f.\"FRPM Count (K-12)\"` and `f.\"Enrollment (K-12)\"` are both integer types, Spark SQL will perform integer division, truncating any decimal part. This is usually not the desired behavior when calculating a rate. Additionally, if `f.\"Enrollment (K-12)\"` is zero, it would result in a division-by-zero error.\\n\\nTo fix this, we should:\\n1.  Cast one of the operands to a floating-point type (e.g., `DOUBLE`) to ensure floating-point division.\\n2.  Use `NULLIF` to handle cases where `f.\"Enrollment (K-12)\"` is zero, preventing a division-by-zero error and returning `NULL` for the rate in such instances.\\n\\nHere\\'s the corrected query:\\n\\n```sql\\nSELECT\\n  f.\"School Name\",\\n  f.\"FRPM Count (K-12)\",\\n  f.\"Enrollment (K-12)\",\\n  (CAST(f.\"FRPM Count (K-12)\" AS DOUBLE) / NULLIF(f.\"Enrollment (K-12)\", 0)) AS Eligible_FRPM_Rate\\nFROM frpm AS f\\nJOIN schools AS s\\n  ON f.CDSCode = s.CDSCode\\nWHERE\\n  s.SOC = \\'66\\'\\nORDER BY\\n  f.\"FRPM Count (K-12)\" DESC\\nLIMIT 5\\n```' name='query_checker_sql_db' tool_call_id='96341c50-91e1-495c-a0b2-a823dee474ca'", "Action: query_sql_db\nAction Input: {'query': '\\nSELECT\\n  f.\"School Name\",\\n  f.\"FRPM Count (K-12)\",\\n  f.\"Enrollment (K-12)\",\\n  (CAST(f.\"FRPM Count (K-12)\" AS DOUBLE) / NULLIF(f.\"Enrollment (K-12)\", 0)) AS Eligible_FRPM_Rate\\nFROM frpm AS f\\nJOIN schools AS s\\n  ON f.CDSCode = s.CDSCode\\nWHERE\\n  s.SOC = \\'66\\'\\nORDER BY\\n  f.\"FRPM Count (K-12)\" DESC\\nLIMIT 5\\n'}"], "input_tokens": 4795, "output_tokens": 3670, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"\\\\nSELECT\\\\n  f.\\\\\"School Name\\\\\",\\\\n  f.\\\\\"FRPM Count (K-12)\\\\\",\\\\n  f.\\\\\"Enrollment (K-12)\\\\\",\\\\n  (f.\\\\\"FRPM Count (K-12)\\\\\" / f.\\\\\"Enrollment (K-12)\\\\\") AS Eligible_FRPM_Rate\\\\nFROM frpm AS f\\\\nJOIN schools AS s\\\\n  ON f.CDSCode = s.CDSCode\\\\nWHERE\\\\n  s.SOC = \\'66\\'\\\\nORDER BY\\\\n  f.\\\\\"FRPM Count (K-12)\\\\\" DESC\\\\nLIMIT 5\\\\n\"}'}\nTool: The original query has a potential issue with the calculation of `Eligible_FRPM_Rate`. If `f.\"FRPM Count (K-12)\"` and `f.\"Enrollment (K-12)\"` are both integer types, Spark SQL will perform integer division, truncating any decimal part. This is usually not the desired behavior when calculating a rate. Additionally, if `f.\"Enrollment (K-12)\"` is zero, it would result in a division-by-zero error.\n\nTo fix this, we should:\n1.  Cast one of the operands to a floating-point type (e.g., `DOUBLE`) to ensure floating-point division.\n2.  Use `NULLIF` to handle cases where `f.\"Enrollment (K-12)\"` is zero, preventing a division-by-zero error and returning `NULL` for the rate in such instances.\n\nHere's the corrected query:\n\n```sql\nSELECT\n  f.\"School Name\",\n  f.\"FRPM Count (K-12)\",\n  f.\"Enrollment (K-12)\",\n  (CAST(f.\"FRPM Count (K-12)\" AS DOUBLE) / NULLIF(f.\"Enrollment (K-12)\", 0)) AS Eligible_FRPM_Rate\nFROM frpm AS f\nJOIN schools AS s\n  ON f.CDSCode = s.CDSCode\nWHERE\n  s.SOC = '66'\nORDER BY\n  f.\"FRPM Count (K-12)\" DESC\nLIMIT 5\n```", "final_answer": "", "replica": 1, "timestamp": 1768938603.308706}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 16.79057550430298, "spark_time": 0.09518814086914062, "translation_time": 16.695387363433838, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='9af65e8c-ed38-40de-8874-28684165daf0'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='d0e0470d-d21a-4bac-a28b-b81bc87ede33'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers**: All identifiers with spaces or special characters (e.g., `School Name`, `FRPM Count (K-12)`, `Enrollment (K-12)`, `Eligible Free or Reduced Price Meal Rate`) are correctly quoted using backticks (` `).\\n*   **String Literals**: The string literal `'66'` is correctly enclosed in single quotes.\\n*   **Join Condition**: The join `ON T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common identifier for schools, suggesting a proper join.\\n*   **Data Types**: The division `T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`` will result in a floating-point number, which is appropriate for a rate. The predicate `T2.SOC = '66'` assumes `SOC` is a string or compatible type, which is standard.\\n*   **No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, or complex function arguments** are present in the query.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='28891088-511b-44f7-bed7-05956c99f6af'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}"], "input_tokens": 4744, "output_tokens": 2178, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = \\'66\\' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers**: All identifiers with spaces or special characters (e.g., `School Name`, `FRPM Count (K-12)`, `Enrollment (K-12)`, `Eligible Free or Reduced Price Meal Rate`) are correctly quoted using backticks (` `).\n*   **String Literals**: The string literal `'66'` is correctly enclosed in single quotes.\n*   **Join Condition**: The join `ON T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common identifier for schools, suggesting a proper join.\n*   **Data Types**: The division `T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`` will result in a floating-point number, which is appropriate for a rate. The predicate `T2.SOC = '66'` assumes `SOC` is a string or compatible type, which is standard.\n*   **No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, or complex function arguments** are present in the query.\n\nThe query is correct as written.\n\n```sql\nSELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\n```", "final_answer": "", "replica": 2, "timestamp": 1768938620.6088238}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 15.764666318893433, "spark_time": 0.10031628608703613, "translation_time": 15.664350032806396, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='42479772-2cd8-405b-8027-a1633ef30f84'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='42d55e18-bb8b-4212-860d-5c6f486ebb72'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers**: All identifiers with spaces or special characters (e.g., `School Name`, `FRPM Count (K-12)`, `Enrollment (K-12)`, `Eligible Free or Reduced Price Meal Rate`) are correctly quoted using backticks (` `).\\n*   **String Literals**: The string literal `'66'` is correctly enclosed in single quotes.\\n*   **Join Condition**: The join `ON T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common identifier for schools, suggesting a proper join.\\n*   **Data Types**: The division `T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`` will result in a floating-point number, which is appropriate for a rate. The predicate `T2.SOC = '66'` assumes `SOC` is a string or compatible type, which is standard.\\n*   **No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, or complex function arguments** are present in the query.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='bb6658b5-0d71-4cba-b0bd-2135f22839e5'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}"], "input_tokens": 4744, "output_tokens": 2176, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = \\'66\\' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers**: All identifiers with spaces or special characters (e.g., `School Name`, `FRPM Count (K-12)`, `Enrollment (K-12)`, `Eligible Free or Reduced Price Meal Rate`) are correctly quoted using backticks (` `).\n*   **String Literals**: The string literal `'66'` is correctly enclosed in single quotes.\n*   **Join Condition**: The join `ON T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common identifier for schools, suggesting a proper join.\n*   **Data Types**: The division `T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`` will result in a floating-point number, which is appropriate for a rate. The predicate `T2.SOC = '66'` assumes `SOC` is a string or compatible type, which is standard.\n*   **No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, or complex function arguments** are present in the query.\n\nThe query is correct as written.\n\n```sql\nSELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\n```", "final_answer": "", "replica": 3, "timestamp": 1768938636.9680586}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' AND T1.`Enrollment (K-12)` IS NOT NULL AND T1.`Enrollment (K-12)` > 0 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 14.735572099685669, "spark_time": 0.13289380073547363, "translation_time": 14.602678298950195, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='371c1f49-5257-4f86-bf2c-64976510d642'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='f36c5475-0bba-4f35-a34d-91241e652266'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' AND T1.`Enrollment (K-12)` IS NOT NULL AND T1.`Enrollment (K-12)` > 0 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}", "Observation: content=\"```sql\\nSELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' AND T1.`Enrollment (K-12)` IS NOT NULL AND T1.`Enrollment (K-12)` > 0 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='5db5ef0a-af8d-4257-a511-8894ec55fa2a'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' AND T1.`Enrollment (K-12)` IS NOT NULL AND T1.`Enrollment (K-12)` > 0 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}"], "input_tokens": 4551, "output_tokens": 2037, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = \\'66\\' AND T1.`Enrollment (K-12)` IS NOT NULL AND T1.`Enrollment (K-12)` > 0 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}'}\nTool: ```sql\nSELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' AND T1.`Enrollment (K-12)` IS NOT NULL AND T1.`Enrollment (K-12)` > 0 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\n```", "final_answer": "", "replica": 4, "timestamp": 1768938652.2293885}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 18.629016399383545, "spark_time": 0.13631224632263184, "translation_time": 18.492704153060913, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='56f56035-8627-42b6-a380-7ed3a4c6c998'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='42520e76-8105-4684-b453-5d1b4024bfb0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}", "Observation: content=\"The original query has a potential issue with integer division if `FRPM Count (K-12)` and `Enrollment (K-12)` are integer data types. In many SQL dialects, including Spark SQL, dividing two integers results in an integer (truncating any decimal part). To ensure a floating-point result for the `eligible_frpm_rate`, at least one of the operands in the division should be cast to a floating-point type (e.g., `DOUBLE`).\\n\\nHere's the corrected query:\\n\\n```sql\\nSELECT\\n    f.`School Name`,\\n    (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate\\nFROM\\n    frpm AS f\\nJOIN\\n    schools AS s ON f.CDSCode = s.CDSCode\\nWHERE\\n    s.SOC = '66'\\nORDER BY\\n    f.`FRPM Count (K-12)` DESC\\nLIMIT 5;\\n```\" name='query_checker_sql_db' tool_call_id='114c8d52-e19e-4556-abc8-500e09118584'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}"], "input_tokens": 4573, "output_tokens": 2700, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = \\'66\\' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}'}\nTool: The original query has a potential issue with integer division if `FRPM Count (K-12)` and `Enrollment (K-12)` are integer data types. In many SQL dialects, including Spark SQL, dividing two integers results in an integer (truncating any decimal part). To ensure a floating-point result for the `eligible_frpm_rate`, at least one of the operands in the division should be cast to a floating-point type (e.g., `DOUBLE`).\n\nHere's the corrected query:\n\n```sql\nSELECT\n    f.`School Name`,\n    (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate\nFROM\n    frpm AS f\nJOIN\n    schools AS s ON f.CDSCode = s.CDSCode\nWHERE\n    s.SOC = '66'\nORDER BY\n    f.`FRPM Count (K-12)` DESC\nLIMIT 5;\n```", "final_answer": "", "replica": 5, "timestamp": 1768938671.442427}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 17.669028282165527, "spark_time": 0.12668514251708984, "translation_time": 17.542343139648438, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='7cd955e6-bc96-451a-a6c6-e7aeabc00c12'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='937a2ef6-391b-4bf0-a2c6-70f911ee09ca'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}", "Observation: content=\"The original query has a potential issue with integer division if `FRPM Count (K-12)` and `Enrollment (K-12)` are integer data types. In many SQL dialects, including Spark SQL, dividing two integers results in an integer (truncating any decimal part). To ensure a floating-point result for the `eligible_frpm_rate`, at least one of the operands in the division should be cast to a floating-point type (e.g., `DOUBLE`).\\n\\nHere's the corrected query:\\n\\n```sql\\nSELECT\\n    f.`School Name`,\\n    (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate\\nFROM\\n    frpm AS f\\nJOIN\\n    schools AS s ON f.CDSCode = s.CDSCode\\nWHERE\\n    s.SOC = '66'\\nORDER BY\\n    f.`FRPM Count (K-12)` DESC\\nLIMIT 5;\\n```\" name='query_checker_sql_db' tool_call_id='fd5ced22-a15e-42d1-9244-c774a20ecb96'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}"], "input_tokens": 4573, "output_tokens": 2700, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = \\'66\\' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}'}\nTool: The original query has a potential issue with integer division if `FRPM Count (K-12)` and `Enrollment (K-12)` are integer data types. In many SQL dialects, including Spark SQL, dividing two integers results in an integer (truncating any decimal part). To ensure a floating-point result for the `eligible_frpm_rate`, at least one of the operands in the division should be cast to a floating-point type (e.g., `DOUBLE`).\n\nHere's the corrected query:\n\n```sql\nSELECT\n    f.`School Name`,\n    (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate\nFROM\n    frpm AS f\nJOIN\n    schools AS s ON f.CDSCode = s.CDSCode\nWHERE\n    s.SOC = '66'\nORDER BY\n    f.`FRPM Count (K-12)` DESC\nLIMIT 5;\n```", "final_answer": "", "replica": 6, "timestamp": 1768938689.6169782}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 14.036742925643921, "spark_time": 0.10624313354492188, "translation_time": 13.930499792098999, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='90666ca1-acad-4848-af15-4e2c57a9e164'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='c1e3a75b-5746-4f51-8494-8893e5d35162'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers**: All identifiers with spaces or special characters (e.g., `School Name`, `FRPM Count (K-12)`, `Enrollment (K-12)`, `Eligible Free or Reduced Price Meal Rate`) are correctly quoted using backticks (` `).\\n*   **String Literals**: The string literal `'66'` is correctly enclosed in single quotes.\\n*   **Join Condition**: The join `ON T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common identifier for schools, suggesting a proper join.\\n*   **Data Types**: The division `T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`` will result in a floating-point number, which is appropriate for a rate. The predicate `T2.SOC = '66'` assumes `SOC` is a string or compatible type, which is standard.\\n*   **No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, or complex function arguments** are present in the query.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='c01ef887-c902-42b6-aeeb-350a7e27bb6f'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}"], "input_tokens": 4744, "output_tokens": 2178, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = \\'66\\' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers**: All identifiers with spaces or special characters (e.g., `School Name`, `FRPM Count (K-12)`, `Enrollment (K-12)`, `Eligible Free or Reduced Price Meal Rate`) are correctly quoted using backticks (` `).\n*   **String Literals**: The string literal `'66'` is correctly enclosed in single quotes.\n*   **Join Condition**: The join `ON T1.CDSCode = T2.CDSCode` uses `CDSCode`, which is a common identifier for schools, suggesting a proper join.\n*   **Data Types**: The division `T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`` will result in a floating-point number, which is appropriate for a rate. The predicate `T2.SOC = '66'` assumes `SOC` is a string or compatible type, which is standard.\n*   **No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, or complex function arguments** are present in the query.\n\nThe query is correct as written.\n\n```sql\nSELECT T1.`School Name`, (T1.`FRPM Count (K-12)` / T1.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = '66' ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5\n```", "final_answer": "", "replica": 7, "timestamp": 1768938704.1994002}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' AND f.`Enrollment (K-12)` IS NOT NULL AND f.`Enrollment (K-12)` > 0 ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 20.444201231002808, "spark_time": 0.1031193733215332, "translation_time": 20.341081857681274, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='6c3b8329-4a4a-4b2b-9de5-a3677c52ddfc'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='d6e69d73-5b98-40c1-a808-66381b38c268'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' AND f.`Enrollment (K-12)` IS NOT NULL AND f.`Enrollment (K-12)` > 0 ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5\"}", "Observation: content=\"The query has a potential common mistake related to data type handling in calculations, specifically for division. When calculating a rate or percentage, it's crucial to ensure floating-point division. If both `FRPM Count (K-12)` and `Enrollment (K-12)` columns are integer types, the division `f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`` might perform integer division in some SQL environments (including certain Spark configurations or versions), truncating the decimal part and leading to an inaccurate rate.\\n\\nTo guarantee floating-point division and thus an accurate rate, one of the operands should be explicitly cast to a floating-point data type (like `DOUBLE` or `DECIMAL`).\\n\\nHere's the rewritten query:\\n\\n```sql\\nSELECT\\n    f.`School Name`,\\n    (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate`\\nFROM\\n    frpm AS f\\nJOIN\\n    schools AS s ON f.CDSCode = s.CDSCode\\nWHERE\\n    s.SOC = '66'\\n    AND f.`Enrollment (K-12)` IS NOT NULL\\n    AND f.`Enrollment (K-12)` > 0\\nORDER BY\\n    f.`FRPM Count (K-12)` DESC\\nLIMIT 5\\n```\" name='query_checker_sql_db' tool_call_id='99b42138-c5ee-4fdc-8179-bbd4e77c87f9'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' AND f.`Enrollment (K-12)` IS NOT NULL AND f.`Enrollment (K-12)` > 0 ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5\"}"], "input_tokens": 4729, "output_tokens": 3231, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate` FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = \\'66\\' AND f.`Enrollment (K-12)` IS NOT NULL AND f.`Enrollment (K-12)` > 0 ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5\"}'}\nTool: The query has a potential common mistake related to data type handling in calculations, specifically for division. When calculating a rate or percentage, it's crucial to ensure floating-point division. If both `FRPM Count (K-12)` and `Enrollment (K-12)` columns are integer types, the division `f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`` might perform integer division in some SQL environments (including certain Spark configurations or versions), truncating the decimal part and leading to an inaccurate rate.\n\nTo guarantee floating-point division and thus an accurate rate, one of the operands should be explicitly cast to a floating-point data type (like `DOUBLE` or `DECIMAL`).\n\nHere's the rewritten query:\n\n```sql\nSELECT\n    f.`School Name`,\n    (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS `Eligible Free or Reduced Price Meal Rate`\nFROM\n    frpm AS f\nJOIN\n    schools AS s ON f.CDSCode = s.CDSCode\nWHERE\n    s.SOC = '66'\n    AND f.`Enrollment (K-12)` IS NOT NULL\n    AND f.`Enrollment (K-12)` > 0\nORDER BY\n    f.`FRPM Count (K-12)` DESC\nLIMIT 5\n```", "final_answer": "", "replica": 8, "timestamp": 1768938725.1706657}
{"query_id": 32, "provider": "google", "db": "california_schools", "nl_query": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`", "gold_sqlite": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "gold_spark": "SELECT CAST(T1.`FRPM Count (K-12)` AS FLOAT) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT f.`School Name`, (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;", "execution_status": "VALID", "query_result": [["Paramount High", "0.9179476526796843"], ["Calexico High", "0.9993290841999329"], ["Bell Senior High", "0.8964987714987716"], ["Anaheim High", "0.8958203368683718"], ["Bell Gardens High", "0.9141803553469662"]], "spark_error": null, "total_time": 19.278592824935913, "spark_time": 0.10140013694763184, "translation_time": 19.17719268798828, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='bd99805b-6c1a-4215-aa27-8b7f346b5c4c'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='db28a317-b147-4820-ad09-d067900475b2'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}", "Observation: content=\"The original query has a potential issue with integer division if `FRPM Count (K-12)` and `Enrollment (K-12)` are integer data types. In many SQL dialects, including Spark SQL, dividing two integers results in an integer (truncating any decimal part). To ensure a floating-point result for the `eligible_frpm_rate`, at least one of the operands in the division should be cast to a floating-point type (e.g., `DOUBLE`).\\n\\nHere's the corrected query:\\n\\n```sql\\nSELECT\\n    f.`School Name`,\\n    (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate\\nFROM\\n    frpm AS f\\nJOIN\\n    schools AS s ON f.CDSCode = s.CDSCode\\nWHERE\\n    s.SOC = '66'\\nORDER BY\\n    f.`FRPM Count (K-12)` DESC\\nLIMIT 5;\\n```\" name='query_checker_sql_db' tool_call_id='5caee397-68c5-486f-9cb3-c043bff0050e'", "Action: query_sql_db\nAction Input: {'query': \"SELECT f.`School Name`, (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}"], "input_tokens": 4573, "output_tokens": 2700, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66? grades 1-12 means K-12; Eligible free or reduced price meal rate for K-12 = `FRPM Count (K-12)` / `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT f.`School Name`, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS eligible_frpm_rate FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE s.SOC = \\'66\\' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5;\"}'}\nTool: The original query has a potential issue with integer division if `FRPM Count (K-12)` and `Enrollment (K-12)` are integer data types. In many SQL dialects, including Spark SQL, dividing two integers results in an integer (truncating any decimal part). To ensure a floating-point result for the `eligible_frpm_rate`, at least one of the operands in the division should be cast to a floating-point type (e.g., `DOUBLE`).\n\nHere's the corrected query:\n\n```sql\nSELECT\n    f.`School Name`,\n    (CAST(f.`FRPM Count (K-12)` AS DOUBLE) / f.`Enrollment (K-12)`) AS eligible_frpm_rate\nFROM\n    frpm AS f\nJOIN\n    schools AS s ON f.CDSCode = s.CDSCode\nWHERE\n    s.SOC = '66'\nORDER BY\n    f.`FRPM Count (K-12)` DESC\nLIMIT 5;\n```", "final_answer": "", "replica": 9, "timestamp": 1768938745.0378096}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.\"School Name\" = s.School WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"School Name\"'. SQLSTATE: 42601 (line 1, pos 91)\n\n== SQL ==\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.\"School Name\" = s.School WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000\n-------------------------------------------------------------------------------------------^^^\n", "total_time": 13.507895469665527, "spark_time": 0.009001016616821289, "translation_time": 13.498894453048706, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='4cfd57ad-9f07-4b2a-9368-e46d834c2b39'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='31474ae3-bf20-4e2d-a62d-0854303cb6c5'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.\"School Name\" = s.School WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000'}", "Observation: content='The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers**: Identifiers with spaces like `\"School Name\"` and `\"Free Meal Count (Ages 5-17)\"` are correctly quoted using double quotes, which is standard for Spark SQL.\\n*   **Join Conditions**: The join conditions `f.CDSCode = s.CDSCode` and `f.\"School Name\" = s.School` are logical for linking school data.\\n*   **Filtering**: The `WHERE` clause uses `>=` and `<=` for an inclusive range, which is the standard and correct way to define such a range.\\n*   **Data Types**: Assuming `\"Free Meal Count (Ages 5-17)\"` is a numeric type, comparing it with integer literals (1900, 2000) is appropriate.\\n*   No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, or function-related issues are present.\\n\\n```sql\\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.\"School Name\" = s.School WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000\\n```' name='query_checker_sql_db' tool_call_id='4c4abc29-8c0e-49a0-8658-c1598532ba43'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.\"School Name\" = s.School WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000'}"], "input_tokens": 4482, "output_tokens": 1927, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.\\\\\"School Name\\\\\" = s.School WHERE f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" >= 1900 AND f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" <= 2000\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers**: Identifiers with spaces like `\"School Name\"` and `\"Free Meal Count (Ages 5-17)\"` are correctly quoted using double quotes, which is standard for Spark SQL.\n*   **Join Conditions**: The join conditions `f.CDSCode = s.CDSCode` and `f.\"School Name\" = s.School` are logical for linking school data.\n*   **Filtering**: The `WHERE` clause uses `>=` and `<=` for an inclusive range, which is the standard and correct way to define such a range.\n*   **Data Types**: Assuming `\"Free Meal Count (Ages 5-17)\"` is a numeric type, comparing it with integer literals (1900, 2000) is appropriate.\n*   No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, or function-related issues are present.\n\n```sql\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.\"School Name\" = s.School WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000\n```", "final_answer": "", "replica": 0, "timestamp": 1768938758.6567106}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": null, "spider_em": null, "sparksql_query": "\nSELECT\n  s.School,\n  s.Website\nFROM\n  frpm AS f\nJOIN\n  schools AS s\nON\n  f.CDSCode = s.CDSCode\nWHERE\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\n", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"Free Meal Count (Ages 5-17)\"'. SQLSTATE: 42601 (line 12, pos 4)\n\n== SQL ==\n\nSELECT\n  s.School,\n  s.Website\nFROM\n  frpm AS f\nJOIN\n  schools AS s\nON\n  f.CDSCode = s.CDSCode\nWHERE\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\n----^^^\n", "total_time": 14.664047479629517, "spark_time": 0.01120901107788086, "translation_time": 14.652838468551636, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a147ee7e-9671-4562-9d4a-78bcdfd1131e'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='dbb44ff7-6549-40e0-9ab7-6267150ba62c'", "Action: query_checker_sql_db\nAction Input: {'query': '\\nSELECT\\n  s.School,\\n  s.Website\\nFROM\\n  frpm AS f\\nJOIN\\n  schools AS s\\nON\\n  f.CDSCode = s.CDSCode\\nWHERE\\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\\n'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION vs. UNION ALL**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used; the query uses `>=` and `<=` for an inclusive range, which is correct.\\n*   **Data type mismatch in predicates**: The comparison of `f.\"Free Meal Count (Ages 5-17)\"` with integer literals (1900, 2000) is standard and Spark SQL handles numeric type coercion appropriately.\\n*   **Properly quoting identifiers**: The identifier `f.\"Free Meal Count (Ages 5-17)\"` contains spaces and is correctly quoted using double quotes (`\"`), which is valid in Spark SQL. Other identifiers are simple and do not require quoting.\\n*   **Use `` for the in-query strings**: If this refers to quoting identifiers, double quotes are used, which is acceptable in Spark SQL. If it refers to string literals, there are none in the `WHERE` clause.\\n*   **Correct number of arguments for functions**: No functions are used.\\n*   **Casting to the correct data type**: Not explicitly needed for this query.\\n*   **Proper columns for joins**: The join condition `f.CDSCode = s.CDSCode` is logical for connecting `frpm` data with `schools` data.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT\\n  s.School,\\n  s.Website\\nFROM\\n  frpm AS f\\nJOIN\\n  schools AS s\\nON\\n  f.CDSCode = s.CDSCode\\nWHERE\\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\\n```' name='query_checker_sql_db' tool_call_id='853105b7-5026-4411-b66e-79827f32627e'", "Action: query_sql_db\nAction Input: {'query': '\\nSELECT\\n  s.School,\\n  s.Website\\nFROM\\n  frpm AS f\\nJOIN\\n  schools AS s\\nON\\n  f.CDSCode = s.CDSCode\\nWHERE\\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\\n'}"], "input_tokens": 4619, "output_tokens": 2283, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"\\\\nSELECT\\\\n  s.School,\\\\n  s.Website\\\\nFROM\\\\n  frpm AS f\\\\nJOIN\\\\n  schools AS s\\\\nON\\\\n  f.CDSCode = s.CDSCode\\\\nWHERE\\\\n  f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" >= 1900 AND f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" <= 2000;\\\\n\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION vs. UNION ALL**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used; the query uses `>=` and `<=` for an inclusive range, which is correct.\n*   **Data type mismatch in predicates**: The comparison of `f.\"Free Meal Count (Ages 5-17)\"` with integer literals (1900, 2000) is standard and Spark SQL handles numeric type coercion appropriately.\n*   **Properly quoting identifiers**: The identifier `f.\"Free Meal Count (Ages 5-17)\"` contains spaces and is correctly quoted using double quotes (`\"`), which is valid in Spark SQL. Other identifiers are simple and do not require quoting.\n*   **Use `` for the in-query strings**: If this refers to quoting identifiers, double quotes are used, which is acceptable in Spark SQL. If it refers to string literals, there are none in the `WHERE` clause.\n*   **Correct number of arguments for functions**: No functions are used.\n*   **Casting to the correct data type**: Not explicitly needed for this query.\n*   **Proper columns for joins**: The join condition `f.CDSCode = s.CDSCode` is logical for connecting `frpm` data with `schools` data.\n\nThe query is correct as written.\n\n```sql\nSELECT\n  s.School,\n  s.Website\nFROM\n  frpm AS f\nJOIN\n  schools AS s\nON\n  f.CDSCode = s.CDSCode\nWHERE\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\n```", "final_answer": "", "replica": 1, "timestamp": 1768938773.4317682}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000", "execution_status": "VALID", "query_result": [["South Gate Middle", "None"], ["Lynwood High", "http://lhs.lynwood.edlioschool.com/"], ["Katella High", "www.auhsd.us/katella"]], "spark_error": null, "total_time": 14.714388608932495, "spark_time": 0.13586688041687012, "translation_time": 14.578521728515625, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='057bdc84-d1ed-4555-9b69-3cf4983ca30f'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a3f423df-d8c1-45a4-bbdf-654b1120222e'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000'}", "Observation: content='The query has one minor issue based on the provided guidelines:\\n\\n*   **Properly quoting identifiers**: The column name `\"Free Meal Count (Ages 5-17)\"` contains spaces and is currently quoted with double quotes. While this often works in Spark SQL, the guideline explicitly states \"Use \\\\` for the in-query strings\", which refers to backticks for quoting identifiers in Spark SQL.\\n\\nHere\\'s the corrected query:\\n\\n```sql\\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000\\n```' name='query_checker_sql_db' tool_call_id='4826214d-e239-4cc0-a52b-1d43e1831088'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000'}"], "input_tokens": 4324, "output_tokens": 2140, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" >= 1900 AND f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" <= 2000\"}'}\nTool: The query has one minor issue based on the provided guidelines:\n\n*   **Properly quoting identifiers**: The column name `\"Free Meal Count (Ages 5-17)\"` contains spaces and is currently quoted with double quotes. While this often works in Spark SQL, the guideline explicitly states \"Use \\` for the in-query strings\", which refers to backticks for quoting identifiers in Spark SQL.\n\nHere's the corrected query:\n\n```sql\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000\n```", "final_answer": "", "replica": 2, "timestamp": 1768938788.7899475}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000", "execution_status": "VALID", "query_result": [["South Gate Middle", "None"], ["Lynwood High", "http://lhs.lynwood.edlioschool.com/"], ["Katella High", "www.auhsd.us/katella"]], "spark_error": null, "total_time": 14.239145517349243, "spark_time": 0.11499524116516113, "translation_time": 14.124150276184082, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cc4bed32-e30a-4803-bac6-69cac22c0567'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a32c37f9-60be-49b2-b282-6f8c8d940436'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000'}", "Observation: content='The query has one minor issue based on the provided guidelines:\\n\\n*   **Properly quoting identifiers**: The column name `\"Free Meal Count (Ages 5-17)\"` contains spaces and is currently quoted with double quotes. While this often works in Spark SQL, the guideline explicitly states \"Use \\\\` for the in-query strings\", which refers to backticks for quoting identifiers in Spark SQL.\\n\\nHere\\'s the corrected query:\\n\\n```sql\\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000\\n```' name='query_checker_sql_db' tool_call_id='8af953de-0eda-4f8b-98b7-6a8aa345842f'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000'}"], "input_tokens": 4324, "output_tokens": 2140, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" >= 1900 AND f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" <= 2000\"}'}\nTool: The query has one minor issue based on the provided guidelines:\n\n*   **Properly quoting identifiers**: The column name `\"Free Meal Count (Ages 5-17)\"` contains spaces and is currently quoted with double quotes. While this often works in Spark SQL, the guideline explicitly states \"Use \\` for the in-query strings\", which refers to backticks for quoting identifiers in Spark SQL.\n\nHere's the corrected query:\n\n```sql\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000\n```", "final_answer": "", "replica": 3, "timestamp": 1768938803.5348253}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": null, "spider_em": null, "sparksql_query": "\nSELECT\n  s.School,\n  s.Website\nFROM\n  frpm AS f\nJOIN\n  schools AS s\nON\n  f.CDSCode = s.CDSCode\nWHERE\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\n", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near '\"Free Meal Count (Ages 5-17)\"'. SQLSTATE: 42601 (line 12, pos 4)\n\n== SQL ==\n\nSELECT\n  s.School,\n  s.Website\nFROM\n  frpm AS f\nJOIN\n  schools AS s\nON\n  f.CDSCode = s.CDSCode\nWHERE\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\n----^^^\n", "total_time": 22.92361068725586, "spark_time": 0.011936426162719727, "translation_time": 22.91167426109314, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='78f97a24-87cd-4235-bcdc-b8b700cc523d'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f38a327a-aef0-4cbc-aa12-6773ead5a2d2'", "Action: query_checker_sql_db\nAction Input: {'query': '\\nSELECT\\n  s.School,\\n  s.Website\\nFROM\\n  frpm AS f\\nJOIN\\n  schools AS s\\nON\\n  f.CDSCode = s.CDSCode\\nWHERE\\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\\n'}", "Observation: content='The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **BETWEEN for exclusive ranges**: The query uses `>=` and `<=` for an inclusive range, which is standard and correct. If an exclusive range was intended, it would use `>` and `<`.\\n*   **Data type mismatch in predicates**: Assuming `f.\"Free Meal Count (Ages 5-17)\"` is a numeric type (like INT or BIGINT) and `f.CDSCode` and `s.CDSCode` are compatible types (e.g., both INT or both STRING), there is no apparent data type mismatch. The literals `1900` and `2000` are integers.\\n*   **Properly quoting identifiers**: Identifiers with spaces (e.g., `\"Free Meal Count (Ages 5-17)\"`) are correctly quoted using double quotes, which is standard for Spark SQL.\\n*   **Use `` ` `` for in-query strings**: Not applicable, there are no string literals in the query that would require backticks.\\n*   **Correct number of arguments for functions**: Not applicable, no functions are used.\\n*   **Casting to the correct data type**: Not applicable, no explicit casting is used. Implicit casting is assumed to be handled correctly for the join and filter conditions.\\n*   **Proper columns for joins**: The join condition `f.CDSCode = s.CDSCode` is a logical and common way to link school-related data between an `frpm` (Free and Reduced Price Meal) table and a `schools` table.\\n\\n```sql\\nSELECT\\n  s.School,\\n  s.Website\\nFROM\\n  frpm AS f\\nJOIN\\n  schools AS s\\nON\\n  f.CDSCode = s.CDSCode\\nWHERE\\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\\n```' name='query_checker_sql_db' tool_call_id='0d45c2c5-72c7-4d6e-ab46-a331092cd075'", "Action: query_sql_db\nAction Input: {'query': '\\nSELECT\\n  s.School,\\n  s.Website\\nFROM\\n  frpm AS f\\nJOIN\\n  schools AS s\\nON\\n  f.CDSCode = s.CDSCode\\nWHERE\\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\\n'}"], "input_tokens": 4692, "output_tokens": 2097, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"\\\\nSELECT\\\\n  s.School,\\\\n  s.Website\\\\nFROM\\\\n  frpm AS f\\\\nJOIN\\\\n  schools AS s\\\\nON\\\\n  f.CDSCode = s.CDSCode\\\\nWHERE\\\\n  f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" >= 1900 AND f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" <= 2000;\\\\n\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **BETWEEN for exclusive ranges**: The query uses `>=` and `<=` for an inclusive range, which is standard and correct. If an exclusive range was intended, it would use `>` and `<`.\n*   **Data type mismatch in predicates**: Assuming `f.\"Free Meal Count (Ages 5-17)\"` is a numeric type (like INT or BIGINT) and `f.CDSCode` and `s.CDSCode` are compatible types (e.g., both INT or both STRING), there is no apparent data type mismatch. The literals `1900` and `2000` are integers.\n*   **Properly quoting identifiers**: Identifiers with spaces (e.g., `\"Free Meal Count (Ages 5-17)\"`) are correctly quoted using double quotes, which is standard for Spark SQL.\n*   **Use `` ` `` for in-query strings**: Not applicable, there are no string literals in the query that would require backticks.\n*   **Correct number of arguments for functions**: Not applicable, no functions are used.\n*   **Casting to the correct data type**: Not applicable, no explicit casting is used. Implicit casting is assumed to be handled correctly for the join and filter conditions.\n*   **Proper columns for joins**: The join condition `f.CDSCode = s.CDSCode` is a logical and common way to link school-related data between an `frpm` (Free and Reduced Price Meal) table and a `schools` table.\n\n```sql\nSELECT\n  s.School,\n  s.Website\nFROM\n  frpm AS f\nJOIN\n  schools AS s\nON\n  f.CDSCode = s.CDSCode\nWHERE\n  f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000;\n```", "final_answer": "", "replica": 4, "timestamp": 1768938826.5628667}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.Website FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000", "execution_status": "VALID", "query_result": [["South Gate Middle", "None"], ["Lynwood High", "http://lhs.lynwood.edlioschool.com/"], ["Katella High", "www.auhsd.us/katella"]], "spark_error": null, "total_time": 16.437472820281982, "spark_time": 0.09767270088195801, "translation_time": 16.339800119400024, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='ec6e7f25-1d55-4c50-afb4-6488c5abc14d'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='da7f7060-6a65-4b99-84e2-4fcfe8ef55d4'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000'}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` with `NULL` values: Not used.\\n*   `UNION` vs. `UNION ALL`: Not used.\\n*   `BETWEEN` for exclusive ranges: `BETWEEN` is inherently inclusive (`>= AND <=`), and its usage here (`BETWEEN 1900 AND 2000`) correctly defines an inclusive range.\\n*   Data type mismatch in predicates: `f.`Free Meal Count (Ages 5-17)`` is compared with numeric literals, assuming the column is a numeric type, this is correct.\\n*   Properly quoting identifiers: The column name `Free Meal Count (Ages 5-17)` contains spaces and special characters, and it is correctly quoted using backticks (` `), which is standard for Spark SQL identifiers. Other identifiers like `School`, `Website`, `CDSCode` do not require quoting.\\n*   Use ` for the in-query strings: This point refers to string literals. The query does not contain any string literals, only numeric literals. If it refers to identifiers, it's covered by the previous point.\\n*   Correct number of arguments for functions: No functions are used.\\n*   Casting to the correct data type: No explicit casting is used, assuming the `Free Meal Count` column is already numeric.\\n*   Proper columns for joins: `s.CDSCode = f.CDSCode` is a standard and appropriate join condition, assuming `CDSCode` is the common key between the tables.\\n\\nThe query is well-formed.\\n\\n```sql\\nSELECT s.School, s.Website FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\\n```\" name='query_checker_sql_db' tool_call_id='7cc8df40-9b54-405d-8044-6618667b3f2c'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000'}"], "input_tokens": 4532, "output_tokens": 1881, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Website FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   `NOT IN` with `NULL` values: Not used.\n*   `UNION` vs. `UNION ALL`: Not used.\n*   `BETWEEN` for exclusive ranges: `BETWEEN` is inherently inclusive (`>= AND <=`), and its usage here (`BETWEEN 1900 AND 2000`) correctly defines an inclusive range.\n*   Data type mismatch in predicates: `f.`Free Meal Count (Ages 5-17)`` is compared with numeric literals, assuming the column is a numeric type, this is correct.\n*   Properly quoting identifiers: The column name `Free Meal Count (Ages 5-17)` contains spaces and special characters, and it is correctly quoted using backticks (` `), which is standard for Spark SQL identifiers. Other identifiers like `School`, `Website`, `CDSCode` do not require quoting.\n*   Use ` for the in-query strings: This point refers to string literals. The query does not contain any string literals, only numeric literals. If it refers to identifiers, it's covered by the previous point.\n*   Correct number of arguments for functions: No functions are used.\n*   Casting to the correct data type: No explicit casting is used, assuming the `Free Meal Count` column is already numeric.\n*   Proper columns for joins: `s.CDSCode = f.CDSCode` is a standard and appropriate join condition, assuming `CDSCode` is the common key between the tables.\n\nThe query is well-formed.\n\n```sql\nSELECT s.School, s.Website FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\n```", "final_answer": "", "replica": 5, "timestamp": 1768938843.5030823}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000", "execution_status": "VALID", "query_result": [["South Gate Middle", "None"], ["Lynwood High", "http://lhs.lynwood.edlioschool.com/"], ["Katella High", "www.auhsd.us/katella"]], "spark_error": null, "total_time": 16.94829034805298, "spark_time": 0.13498973846435547, "translation_time": 16.813300609588623, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='7e5ae986-9235-4aca-9570-a93fd9808ddb'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='ac05a9ce-0f01-434c-b675-1da0200e2b69'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000'}", "Observation: content='The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` with `NULL` values: Not used.\\n*   `UNION` when `UNION ALL` should have been used: Not used.\\n*   `BETWEEN` for exclusive ranges: `BETWEEN` is inclusive in SQL, which is the standard behavior. If an exclusive range was intended, `>` and `<` would be used. Assuming the inclusive range is correct.\\n*   Data type mismatch in predicates: The join conditions (`CDSCode` and `School Name`/`School`) and the `WHERE` clause (`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000) imply consistent data types (e.g., numeric for counts, string for names, consistent types for `CDSCode`).\\n*   Properly quoting identifiers: Identifiers with spaces (`Free Meal Count (Ages 5-17)`, `School Name`) are correctly quoted with backticks (` `).\\n*   Use ` for the in-query strings: There are no string literals in the query that would require backticks. Numeric literals are used correctly.\\n*   Using the correct number of arguments for functions: No functions are used.\\n*   Casting to the correct data type: No explicit casting is used, assuming data types are compatible for the operations.\\n*   Using the proper columns for joins: `CDSCode` and `School Name`/`School` are appropriate columns for joining school-related information between the `frpm` and `schools` tables.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\\n```' name='query_checker_sql_db' tool_call_id='aadab852-7bce-4ab7-b183-357d2be031c0'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000'}"], "input_tokens": 4565, "output_tokens": 2123, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   `NOT IN` with `NULL` values: Not used.\n*   `UNION` when `UNION ALL` should have been used: Not used.\n*   `BETWEEN` for exclusive ranges: `BETWEEN` is inclusive in SQL, which is the standard behavior. If an exclusive range was intended, `>` and `<` would be used. Assuming the inclusive range is correct.\n*   Data type mismatch in predicates: The join conditions (`CDSCode` and `School Name`/`School`) and the `WHERE` clause (`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000) imply consistent data types (e.g., numeric for counts, string for names, consistent types for `CDSCode`).\n*   Properly quoting identifiers: Identifiers with spaces (`Free Meal Count (Ages 5-17)`, `School Name`) are correctly quoted with backticks (` `).\n*   Use ` for the in-query strings: There are no string literals in the query that would require backticks. Numeric literals are used correctly.\n*   Using the correct number of arguments for functions: No functions are used.\n*   Casting to the correct data type: No explicit casting is used, assuming data types are compatible for the operations.\n*   Using the proper columns for joins: `CDSCode` and `School Name`/`School` are appropriate columns for joining school-related information between the `frpm` and `schools` tables.\n\nThe query is correct as written.\n\n```sql\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\n```", "final_answer": "", "replica": 6, "timestamp": 1768938861.0093386}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000", "execution_status": "VALID", "query_result": [["South Gate Middle", "None"], ["Lynwood High", "http://lhs.lynwood.edlioschool.com/"], ["Katella High", "www.auhsd.us/katella"]], "spark_error": null, "total_time": 17.031065464019775, "spark_time": 0.1259753704071045, "translation_time": 16.90509009361267, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='9da807ba-801f-45ed-999e-c4496c325f41'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='2bc57e5b-2ae3-453a-92a2-b95b0256f83f'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000'}", "Observation: content='The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION when UNION ALL should have been used**: Not used.\\n*   **BETWEEN for exclusive ranges**: `BETWEEN` is inherently inclusive in SQL (`value >= lower AND value <= upper`). This is the standard behavior, so it\\'s not a mistake unless an exclusive range was explicitly intended, in which case `>` and `<` operators would be used. Assuming inclusive is the intent, this is correct.\\n*   **Data type mismatch in predicates**: The predicate `f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000` assumes `Free Meal Count (Ages 5-17)` is a numeric type, which is a reasonable assumption for a \"Count\" column. If it were a string, it would be a mismatch, but this is unlikely for such a column name.\\n*   **Properly quoting identifiers**: Identifiers with spaces or special characters (e.g., `f.`Free Meal Count (Ages 5-17)``, `f.`School Name``) are correctly quoted using backticks (`` ` ``), which is standard in Spark SQL. Other identifiers like `s.School`, `s.Website`, `f.CDSCode`, `s.CDSCode` do not require quoting.\\n*   **Use `` for the in-query strings**: This point likely refers to quoting identifiers with backticks, which is correctly done for `Free Meal Count (Ages 5-17)` and `School Name`. String literals (if any were present) would use single quotes (`\\'`).\\n*   **Using the correct number of arguments for functions**: No functions are used in the query.\\n*   **Casting to the correct data type**: No explicit casting is used.\\n*   **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode AND f.`School Name` = s.School` uses `CDSCode` and school names from both tables, which are appropriate columns for linking school-related data.\\n\\nTherefore, the query is correct as written.\\n\\n```sql\\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\\n```' name='query_checker_sql_db' tool_call_id='1ffb04df-5d98-494b-8c4d-434e608f0653'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000'}"], "input_tokens": 4694, "output_tokens": 2396, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION when UNION ALL should have been used**: Not used.\n*   **BETWEEN for exclusive ranges**: `BETWEEN` is inherently inclusive in SQL (`value >= lower AND value <= upper`). This is the standard behavior, so it's not a mistake unless an exclusive range was explicitly intended, in which case `>` and `<` operators would be used. Assuming inclusive is the intent, this is correct.\n*   **Data type mismatch in predicates**: The predicate `f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000` assumes `Free Meal Count (Ages 5-17)` is a numeric type, which is a reasonable assumption for a \"Count\" column. If it were a string, it would be a mismatch, but this is unlikely for such a column name.\n*   **Properly quoting identifiers**: Identifiers with spaces or special characters (e.g., `f.`Free Meal Count (Ages 5-17)``, `f.`School Name``) are correctly quoted using backticks (`` ` ``), which is standard in Spark SQL. Other identifiers like `s.School`, `s.Website`, `f.CDSCode`, `s.CDSCode` do not require quoting.\n*   **Use `` for the in-query strings**: This point likely refers to quoting identifiers with backticks, which is correctly done for `Free Meal Count (Ages 5-17)` and `School Name`. String literals (if any were present) would use single quotes (`'`).\n*   **Using the correct number of arguments for functions**: No functions are used in the query.\n*   **Casting to the correct data type**: No explicit casting is used.\n*   **Using the proper columns for joins**: The join condition `f.CDSCode = s.CDSCode AND f.`School Name` = s.School` uses `CDSCode` and school names from both tables, which are appropriate columns for linking school-related data.\n\nTherefore, the query is correct as written.\n\n```sql\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode AND f.`School Name` = s.School WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000\n```", "final_answer": "", "replica": 7, "timestamp": 1768938878.6352942}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000", "execution_status": "VALID", "query_result": [["South Gate Middle", "None"], ["Lynwood High", "http://lhs.lynwood.edlioschool.com/"], ["Katella High", "www.auhsd.us/katella"]], "spark_error": null, "total_time": 13.243511438369751, "spark_time": 0.109100341796875, "translation_time": 13.134411096572876, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='682bccc7-cecf-42ef-902e-d70f60d3aa21'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f56a9cd9-1f20-4e8f-9a1f-a8c0c9e8d0dc'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000'}", "Observation: content='The query has one minor issue based on the provided guidelines:\\n\\n*   **Properly quoting identifiers**: The column name `\"Free Meal Count (Ages 5-17)\"` contains spaces and is currently quoted with double quotes. While this often works in Spark SQL, the guideline explicitly states \"Use \\\\` for the in-query strings\", which refers to backticks for quoting identifiers in Spark SQL.\\n\\nHere\\'s the corrected query:\\n\\n```sql\\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000\\n```' name='query_checker_sql_db' tool_call_id='c5b78901-36ce-45dd-81ce-d0d3f99392f9'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000'}"], "input_tokens": 4324, "output_tokens": 2140, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" >= 1900 AND f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" <= 2000\"}'}\nTool: The query has one minor issue based on the provided guidelines:\n\n*   **Properly quoting identifiers**: The column name `\"Free Meal Count (Ages 5-17)\"` contains spaces and is currently quoted with double quotes. While this often works in Spark SQL, the guideline explicitly states \"Use \\` for the in-query strings\", which refers to backticks for quoting identifiers in Spark SQL.\n\nHere's the corrected query:\n\n```sql\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000\n```", "final_answer": "", "replica": 8, "timestamp": 1768938892.4368203}
{"query_id": 33, "provider": "google", "db": "california_schools", "nl_query": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. ", "gold_sqlite": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL", "gold_spark": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND NOT T2.Website IS NULL", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000", "execution_status": "VALID", "query_result": [["South Gate Middle", "None"], ["Lynwood High", "http://lhs.lynwood.edlioschool.com/"], ["Katella High", "www.auhsd.us/katella"]], "spark_error": null, "total_time": 16.06759762763977, "spark_time": 0.14849615097045898, "translation_time": 15.919101476669312, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='4dd658a9-150e-4575-ad1f-280a0381f9a5'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='431b9b73-2a89-4779-bc47-1a14d4e623ab'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.\"Free Meal Count (Ages 5-17)\" >= 1900 AND f.\"Free Meal Count (Ages 5-17)\" <= 2000'}", "Observation: content='The query has one common mistake according to the provided guidelines:\\n\\n*   **Properly quoting identifiers**: In Spark SQL, identifiers containing special characters (like spaces, parentheses, or hyphens) should be enclosed in backticks (`` ` ``) rather than double quotes (`\"`). The column `f.\"Free Meal Count (Ages 5-17)\"` should be `f.`Free Meal Count (Ages 5-17)``.\\n\\nHere\\'s the corrected query:\\n\\n```sql\\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000\\n```' name='query_checker_sql_db' tool_call_id='291697c9-c43b-4ec0-b565-ff8dde9e66cd'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000'}"], "input_tokens": 4334, "output_tokens": 2350, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" >= 1900 AND f.\\\\\"Free Meal Count (Ages 5-17)\\\\\" <= 2000\"}'}\nTool: The query has one common mistake according to the provided guidelines:\n\n*   **Properly quoting identifiers**: In Spark SQL, identifiers containing special characters (like spaces, parentheses, or hyphens) should be enclosed in backticks (`` ` ``) rather than double quotes (`\"`). The column `f.\"Free Meal Count (Ages 5-17)\"` should be `f.`Free Meal Count (Ages 5-17)``.\n\nHere's the corrected query:\n\n```sql\nSELECT s.School, s.Website FROM frpm AS f JOIN schools AS s ON f.CDSCode = s.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` >= 1900 AND f.`Free Meal Count (Ages 5-17)` <= 2000\n```", "final_answer": "", "replica": 9, "timestamp": 1768938909.0734181}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 17.14811897277832, "spark_time": 0.1416769027709961, "translation_time": 17.006442070007324, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='078f35af-1136-4172-b9b4-cfa9480794d0'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='951d38f9-cce0-48ff-9a22-998fc85c8671'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\"}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\\n*   **Using BETWEEN for exclusive ranges**: The query does not use `BETWEEN`.\\n*   **Data type mismatch in predicates**: The predicates `T2.AdmFName1 = 'Kacey'` and `T2.AdmLName1 = 'Gibson'` compare string columns with string literals, which is appropriate. The join condition `T1.CDSCode = T2.CDSCode` assumes compatible types for `CDSCode`, which is standard for join keys.\\n*   **Properly quoting identifiers**: Identifiers with spaces like `` `Free Meal Count (Ages 5-17)` `` and `` `Enrollment (Ages 5-17)` `` are correctly quoted with backticks. Simple identifiers like `CDSCode`, `AdmFName1`, `AdmLName1` do not require backticks, but would still work with them.\\n*   **Use `` ` `` for the in-query strings**: This point likely refers to quoting identifiers. String literals ('Kacey', 'Gibson') are correctly enclosed in single quotes, which is standard SQL. Backticks are for identifiers, not string literals.\\n*   **Using the correct number of arguments for functions**: The query does not use any functions that take arguments.\\n*   **Casting to the correct data type**: The division operation `/` in Spark SQL typically handles type promotion correctly, resulting in a floating-point number even if both operands are integers. No explicit casting seems immediately necessary.\\n*   **Using the proper columns for joins**: `CDSCode` (County-District-School Code) is a standard and appropriate column for joining `frpm` (Free Reduced Price Meal) data with `schools` data.\\n\\nThe query is well-formed based on the provided checklist.\\n\\n```sql\\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\\n```\" name='query_checker_sql_db' tool_call_id='569b3ecb-6906-4738-aa84-2ab648d06b93'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4756, "output_tokens": 2621, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = \\'Kacey\\' AND T2.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\n*   **Using BETWEEN for exclusive ranges**: The query does not use `BETWEEN`.\n*   **Data type mismatch in predicates**: The predicates `T2.AdmFName1 = 'Kacey'` and `T2.AdmLName1 = 'Gibson'` compare string columns with string literals, which is appropriate. The join condition `T1.CDSCode = T2.CDSCode` assumes compatible types for `CDSCode`, which is standard for join keys.\n*   **Properly quoting identifiers**: Identifiers with spaces like `` `Free Meal Count (Ages 5-17)` `` and `` `Enrollment (Ages 5-17)` `` are correctly quoted with backticks. Simple identifiers like `CDSCode`, `AdmFName1`, `AdmLName1` do not require backticks, but would still work with them.\n*   **Use `` ` `` for the in-query strings**: This point likely refers to quoting identifiers. String literals ('Kacey', 'Gibson') are correctly enclosed in single quotes, which is standard SQL. Backticks are for identifiers, not string literals.\n*   **Using the correct number of arguments for functions**: The query does not use any functions that take arguments.\n*   **Casting to the correct data type**: The division operation `/` in Spark SQL typically handles type promotion correctly, resulting in a floating-point number even if both operands are integers. No explicit casting seems immediately necessary.\n*   **Using the proper columns for joins**: `CDSCode` (County-District-School Code) is a standard and appropriate column for joining `frpm` (Free Reduced Price Meal) data with `schools` data.\n\nThe query is well-formed based on the provided checklist.\n\n```sql\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 0, "timestamp": 1768938926.839535}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 16.705943822860718, "spark_time": 0.13501310348510742, "translation_time": 16.57093071937561, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='65ae273e-3456-4fe4-94a6-909dc7e73649'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='84a42a83-f17f-49e7-8b22-6f8f07442a49'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}", "Observation: content=\"The Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\\n\\n*   **NOT IN with NULL values**: Not applicable as `NOT IN` is not used.\\n*   **UNION when UNION ALL should have been used**: Not applicable as `UNION` is not used.\\n*   **BETWEEN for exclusive ranges**: Not applicable as `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` and the `WHERE` clause predicates `T1.AdmFName1 = 'Kacey'` and `T1.AdmLName1 = 'Gibson'` assume compatible data types (e.g., `CDSCode` as numeric/string, `AdmFName1`/`AdmLName1` as string), which is standard practice. The division operands are assumed to be numeric, which is necessary for the operation.\\n*   **Properly quoting identifiers**: Identifiers with spaces, such as ``Free Meal Count (Ages 5-17)`` and ``Enrollment (Ages 5-17)``, are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers like `schools`, `frpm`, `CDSCode`, `AdmFName1`, `AdmLName1` are simple and do not require quoting.\\n*   **Use ` for the in-query strings**: String literals (`'Kacey'`, `'Gibson'`) are correctly quoted using single quotes (`'`). Backticks (` `) are for identifiers, not string literals. The query follows correct SQL syntax for string literals.\\n*   **Using the correct number of arguments for functions**: No functions are explicitly used in the query.\\n*   **Casting to the correct data type**: In Spark SQL, the division operator (`/`) between numeric types (even integers) typically results in a `DOUBLE` (floating-point) value. Therefore, explicit casting to `DOUBLE` for the division operands is not strictly necessary to achieve a fractional result.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a logical and common join condition between `schools` and `frpm` tables, assuming `CDSCode` is the primary key/foreign key relationship.\\n\\nThe query is well-formed and follows Spark SQL best practices for the operations it performs.\\n\\n```sql\\nSELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\\n```\" name='query_checker_sql_db' tool_call_id='4f5490cc-e1dd-4482-900f-c6d646626645'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4832, "output_tokens": 2782, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = \\'Kacey\\' AND T1.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\n\n*   **NOT IN with NULL values**: Not applicable as `NOT IN` is not used.\n*   **UNION when UNION ALL should have been used**: Not applicable as `UNION` is not used.\n*   **BETWEEN for exclusive ranges**: Not applicable as `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` and the `WHERE` clause predicates `T1.AdmFName1 = 'Kacey'` and `T1.AdmLName1 = 'Gibson'` assume compatible data types (e.g., `CDSCode` as numeric/string, `AdmFName1`/`AdmLName1` as string), which is standard practice. The division operands are assumed to be numeric, which is necessary for the operation.\n*   **Properly quoting identifiers**: Identifiers with spaces, such as ``Free Meal Count (Ages 5-17)`` and ``Enrollment (Ages 5-17)``, are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers like `schools`, `frpm`, `CDSCode`, `AdmFName1`, `AdmLName1` are simple and do not require quoting.\n*   **Use ` for the in-query strings**: String literals (`'Kacey'`, `'Gibson'`) are correctly quoted using single quotes (`'`). Backticks (` `) are for identifiers, not string literals. The query follows correct SQL syntax for string literals.\n*   **Using the correct number of arguments for functions**: No functions are explicitly used in the query.\n*   **Casting to the correct data type**: In Spark SQL, the division operator (`/`) between numeric types (even integers) typically results in a `DOUBLE` (floating-point) value. Therefore, explicit casting to `DOUBLE` for the division operands is not strictly necessary to achieve a fractional result.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a logical and common join condition between `schools` and `frpm` tables, assuming `CDSCode` is the primary key/foreign key relationship.\n\nThe query is well-formed and follows Spark SQL best practices for the operations it performs.\n\n```sql\nSELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 1, "timestamp": 1768938944.1943336}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 18.187998056411743, "spark_time": 0.12465715408325195, "translation_time": 18.06334090232849, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0e58cb03-bb8c-40d2-8f23-191d9d110296'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='6a897160-9cd7-42c5-8aaf-f61998453207'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}", "Observation: content=\"The Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\\n\\n*   **NOT IN with NULL values**: Not applicable as `NOT IN` is not used.\\n*   **UNION when UNION ALL should have been used**: Not applicable as `UNION` is not used.\\n*   **BETWEEN for exclusive ranges**: Not applicable as `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` and the `WHERE` clause predicates `T1.AdmFName1 = 'Kacey'` and `T1.AdmLName1 = 'Gibson'` assume compatible data types (e.g., `CDSCode` as numeric/string, `AdmFName1`/`AdmLName1` as string), which is standard practice. The division operands are assumed to be numeric, which is necessary for the operation.\\n*   **Properly quoting identifiers**: Identifiers with spaces, such as ``Free Meal Count (Ages 5-17)`` and ``Enrollment (Ages 5-17)``, are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers like `schools`, `frpm`, `CDSCode`, `AdmFName1`, `AdmLName1` are simple and do not require quoting.\\n*   **Use ` for the in-query strings**: String literals (`'Kacey'`, `'Gibson'`) are correctly quoted using single quotes (`'`). Backticks (` `) are for identifiers, not string literals. The query follows correct SQL syntax for string literals.\\n*   **Using the correct number of arguments for functions**: No functions are explicitly used in the query.\\n*   **Casting to the correct data type**: In Spark SQL, the division operator (`/`) between numeric types (even integers) typically results in a `DOUBLE` (floating-point) value. Therefore, explicit casting to `DOUBLE` for the division operands is not strictly necessary to achieve a fractional result.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a logical and common join condition between `schools` and `frpm` tables, assuming `CDSCode` is the primary key/foreign key relationship.\\n\\nThe query is well-formed and follows Spark SQL best practices for the operations it performs.\\n\\n```sql\\nSELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\\n```\" name='query_checker_sql_db' tool_call_id='2088bd6f-8d58-4156-929d-21059ac06b28'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4832, "output_tokens": 2782, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = \\'Kacey\\' AND T1.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\n\n*   **NOT IN with NULL values**: Not applicable as `NOT IN` is not used.\n*   **UNION when UNION ALL should have been used**: Not applicable as `UNION` is not used.\n*   **BETWEEN for exclusive ranges**: Not applicable as `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.CDSCode` and the `WHERE` clause predicates `T1.AdmFName1 = 'Kacey'` and `T1.AdmLName1 = 'Gibson'` assume compatible data types (e.g., `CDSCode` as numeric/string, `AdmFName1`/`AdmLName1` as string), which is standard practice. The division operands are assumed to be numeric, which is necessary for the operation.\n*   **Properly quoting identifiers**: Identifiers with spaces, such as ``Free Meal Count (Ages 5-17)`` and ``Enrollment (Ages 5-17)``, are correctly quoted using backticks (` `), which is the standard for Spark SQL. Other identifiers like `schools`, `frpm`, `CDSCode`, `AdmFName1`, `AdmLName1` are simple and do not require quoting.\n*   **Use ` for the in-query strings**: String literals (`'Kacey'`, `'Gibson'`) are correctly quoted using single quotes (`'`). Backticks (` `) are for identifiers, not string literals. The query follows correct SQL syntax for string literals.\n*   **Using the correct number of arguments for functions**: No functions are explicitly used in the query.\n*   **Casting to the correct data type**: In Spark SQL, the division operator (`/`) between numeric types (even integers) typically results in a `DOUBLE` (floating-point) value. Therefore, explicit casting to `DOUBLE` for the division operands is not strictly necessary to achieve a fractional result.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a logical and common join condition between `schools` and `frpm` tables, assuming `CDSCode` is the primary key/foreign key relationship.\n\nThe query is well-formed and follows Spark SQL best practices for the operations it performs.\n\n```sql\nSELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 2, "timestamp": 1768938962.99734}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 21.365262985229492, "spark_time": 0.15503787994384766, "translation_time": 21.210225105285645, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d4762207-d545-466a-bdca-4d78b5af6e94'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='8b802dfa-86f9-441d-979c-b47f2e9e5c79'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}", "Observation: content='The provided Spark SQL query is checked against the list of common mistakes:\\n\\n1.  **Using NOT IN with NULL values**: The query does not use `NOT IN`.\\n2.  **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\\n3.  **Using BETWEEN for exclusive ranges**: The query does not use `BETWEEN`.\\n4.  **Data type mismatch in predicates**:\\n    *   `T1.AdmFName1 = \\'Kacey\\'` and `T1.AdmLName1 = \\'Gibson\\'`: Assuming `AdmFName1` and `AdmLName1` are string types, this is correct.\\n    *   `T1.CDSCode = T2.CDSCode`: Assuming `CDSCode` in both tables are of compatible numeric or string types, this is correct.\\n5.  **Properly quoting identifiers**: Identifiers with spaces like `` `Free Meal Count (Ages 5-17)` `` and `` `Enrollment (Ages 5-17)` `` are correctly quoted with backticks. String literals like `\\'Kacey\\'` and `\\'Gibson\\'` are correctly quoted with single quotes.\\n6.  **Use ` for the in-query strings**: String literals are correctly enclosed in single quotes (`\\'...\\'`). Identifiers requiring special quoting use backticks (`` `...` ``). This is correct.\\n7.  **Using the correct number of arguments for functions**: The query does not use any functions that take arguments.\\n8.  **Casting to the correct data type**: The division operation `/` in Spark SQL typically performs floating-point division when operands are numeric, which is usually desired for ratios. No explicit casting is strictly necessary for this operation to produce a ratio.\\n9.  **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` assumes `CDSCode` is the correct common identifier between the `schools` and `frpm` tables, which is a standard practice for school data.\\n\\nA potential runtime issue could be division by zero if `T2.`Enrollment (Ages 5-17)`` is 0. While this is a common data validity concern in SQL, it is not explicitly listed as one of the specific mistakes to check for (e.g., \"data type mismatch\" or \"incorrect casting\"). Based strictly on the provided list of common mistakes, the query does not contain any of them.\\n\\n```sql\\nSELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = \\'Kacey\\' AND T1.AdmLName1 = \\'Gibson\\'\\n```' name='query_checker_sql_db' tool_call_id='5d07812d-8410-49be-b5eb-b17ba63e9416'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4858, "output_tokens": 3154, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = \\'Kacey\\' AND T1.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The provided Spark SQL query is checked against the list of common mistakes:\n\n1.  **Using NOT IN with NULL values**: The query does not use `NOT IN`.\n2.  **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\n3.  **Using BETWEEN for exclusive ranges**: The query does not use `BETWEEN`.\n4.  **Data type mismatch in predicates**:\n    *   `T1.AdmFName1 = 'Kacey'` and `T1.AdmLName1 = 'Gibson'`: Assuming `AdmFName1` and `AdmLName1` are string types, this is correct.\n    *   `T1.CDSCode = T2.CDSCode`: Assuming `CDSCode` in both tables are of compatible numeric or string types, this is correct.\n5.  **Properly quoting identifiers**: Identifiers with spaces like `` `Free Meal Count (Ages 5-17)` `` and `` `Enrollment (Ages 5-17)` `` are correctly quoted with backticks. String literals like `'Kacey'` and `'Gibson'` are correctly quoted with single quotes.\n6.  **Use ` for the in-query strings**: String literals are correctly enclosed in single quotes (`'...'`). Identifiers requiring special quoting use backticks (`` `...` ``). This is correct.\n7.  **Using the correct number of arguments for functions**: The query does not use any functions that take arguments.\n8.  **Casting to the correct data type**: The division operation `/` in Spark SQL typically performs floating-point division when operands are numeric, which is usually desired for ratios. No explicit casting is strictly necessary for this operation to produce a ratio.\n9.  **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.CDSCode` assumes `CDSCode` is the correct common identifier between the `schools` and `frpm` tables, which is a standard practice for school data.\n\nA potential runtime issue could be division by zero if `T2.`Enrollment (Ages 5-17)`` is 0. While this is a common data validity concern in SQL, it is not explicitly listed as one of the specific mistakes to check for (e.g., \"data type mismatch\" or \"incorrect casting\"). Based strictly on the provided list of common mistakes, the query does not contain any of them.\n\n```sql\nSELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 3, "timestamp": 1768938985.004904}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 17.831533432006836, "spark_time": 0.1326894760131836, "translation_time": 17.698843955993652, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a041a8a7-f28f-4379-aaf0-d52c48b0cf58'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='1fb07c87-cd6a-4ec4-8a14-8d562fb4c468'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\"}", "Observation: content=\"The Spark SQL query provided appears to be free of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `T2.AdmFName1 = 'Kacey'` and `T2.AdmLName1 = 'Gibson'` assume string types, which is standard. The join condition `T1.CDSCode = T2.CDSCode` assumes compatible types for `CDSCode` in both tables, which is typical for join keys.\\n*   **Properly quoting identifiers**: Identifiers with spaces or special characters (e.g., ``Free Meal Count (Ages 5-17)``) are correctly quoted using backticks (` `), which is the standard for Spark SQL.\\n*   **Use ` for the in-query strings**: String literals (`'Kacey'`, `'Gibson'`) are correctly enclosed in single quotes (`'`). Backticks are for identifiers, not string literals.\\n*   **Using the correct number of arguments for functions**: Not applicable, no functions requiring arguments are used.\\n*   **Casting to the correct data type**: The division operation `T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)`` will typically result in a floating-point number in Spark SQL, which is usually desired for ratios. No explicit casting is needed for this operation to work correctly. (A potential runtime issue could be division by zero if `Enrollment (Ages 5-17)` is 0, but this is a data issue, not a syntax or type mismatch mistake from the list).\\n*   **Using the proper columns for joins**: `CDSCode` is a common and appropriate column for joining school-related data between `frpm` and `schools` tables.\\n\\nThe query is well-formed and follows Spark SQL conventions.\\n\\n```sql\\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\\n```\" name='query_checker_sql_db' tool_call_id='34358932-3b6f-44e4-abeb-f719137b42f2'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4780, "output_tokens": 2621, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = \\'Kacey\\' AND T2.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The Spark SQL query provided appears to be free of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `T2.AdmFName1 = 'Kacey'` and `T2.AdmLName1 = 'Gibson'` assume string types, which is standard. The join condition `T1.CDSCode = T2.CDSCode` assumes compatible types for `CDSCode` in both tables, which is typical for join keys.\n*   **Properly quoting identifiers**: Identifiers with spaces or special characters (e.g., ``Free Meal Count (Ages 5-17)``) are correctly quoted using backticks (` `), which is the standard for Spark SQL.\n*   **Use ` for the in-query strings**: String literals (`'Kacey'`, `'Gibson'`) are correctly enclosed in single quotes (`'`). Backticks are for identifiers, not string literals.\n*   **Using the correct number of arguments for functions**: Not applicable, no functions requiring arguments are used.\n*   **Casting to the correct data type**: The division operation `T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)`` will typically result in a floating-point number in Spark SQL, which is usually desired for ratios. No explicit casting is needed for this operation to work correctly. (A potential runtime issue could be division by zero if `Enrollment (Ages 5-17)` is 0, but this is a data issue, not a syntax or type mismatch mistake from the list).\n*   **Using the proper columns for joins**: `CDSCode` is a common and appropriate column for joining school-related data between `frpm` and `schools` tables.\n\nThe query is well-formed and follows Spark SQL conventions.\n\n```sql\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 4, "timestamp": 1768939003.5082898}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS DOUBLE) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 19.530908823013306, "spark_time": 0.12047576904296875, "translation_time": 19.410433053970337, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c741411e-93fe-4d74-a03c-61d79ef6478c'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='f78bc57d-bd47-410e-bc73-051cc3789d93'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}", "Observation: content=\"The query has a potential mistake regarding data type handling for division. If `T2.`Free Meal Count (Ages 5-17)`` and `T2.`Enrollment (Ages 5-17)`` are both integer types, Spark SQL will perform integer division, truncating any decimal part. To get a precise floating-point ratio, at least one of the operands should be cast to a floating-point type (e.g., `DOUBLE`).\\n\\nHere's the rewritten query:\\n\\n```sql\\nSELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS DOUBLE) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\\n```\" name='query_checker_sql_db' tool_call_id='cdf2ea8e-eb47-406f-9c27-3750446316b7'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS DOUBLE) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4431, "output_tokens": 2159, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = \\'Kacey\\' AND T1.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The query has a potential mistake regarding data type handling for division. If `T2.`Free Meal Count (Ages 5-17)`` and `T2.`Enrollment (Ages 5-17)`` are both integer types, Spark SQL will perform integer division, truncating any decimal part. To get a precise floating-point ratio, at least one of the operands should be cast to a floating-point type (e.g., `DOUBLE`).\n\nHere's the rewritten query:\n\n```sql\nSELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS DOUBLE) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 5, "timestamp": 1768939023.750187}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 16.328638792037964, "spark_time": 0.1270608901977539, "translation_time": 16.20157790184021, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='8dd335eb-fbf4-4291-91b5-e20d1eed2447'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='e99adbbc-0145-46d1-a46f-77d7d7ac15ad'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}", "Observation: content=\"The Spark SQL query appears to be well-formed and does not exhibit any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates `T1.AdmFName1 = 'Kacey'` and `T1.AdmLName1 = 'Gibson'` correctly compare string columns with string literals. The join condition `T1.CDSCode = T2.CDSCode` assumes compatible types, which is standard for join keys.\\n*   **Properly quoting identifiers**: Identifiers with spaces like ``Free Meal Count (Ages 5-17)`` and ``Enrollment (Ages 5-17)`` are correctly enclosed in backticks (` `), which is the standard for Spark SQL. Other identifiers like `schools`, `frpm`, `CDSCode`, `AdmFName1`, `AdmLName1` do not require backticks.\\n*   **Use ` for the in-query strings**: String literals like `'Kacey'` and `'Gibson'` are correctly enclosed in single quotes (`' '`), which is standard SQL. Backticks are for identifiers, not string literals.\\n*   **Using the correct number of arguments for functions**: No functions requiring arguments are used in the query.\\n*   **Casting to the correct data type**: The division operation `T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)`` will typically result in a floating-point number in Spark SQL, even if the underlying columns are integers, due to automatic type promotion for the division operator. Explicit casting is not strictly necessary to avoid integer division in most Spark versions.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a logical and common join condition between a `schools` table and a `frpm` (Free/Reduced Price Meal) table, as `CDSCode` typically represents a unique school identifier.\\n\\nThe query is syntactically correct and follows best practices for Spark SQL.\\n\\n```sql\\nSELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\\n```\" name='query_checker_sql_db' tool_call_id='b02813e7-4607-49f8-b2f6-707dc9f328f4'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4824, "output_tokens": 2413, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = \\'Kacey\\' AND T1.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The Spark SQL query appears to be well-formed and does not exhibit any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates `T1.AdmFName1 = 'Kacey'` and `T1.AdmLName1 = 'Gibson'` correctly compare string columns with string literals. The join condition `T1.CDSCode = T2.CDSCode` assumes compatible types, which is standard for join keys.\n*   **Properly quoting identifiers**: Identifiers with spaces like ``Free Meal Count (Ages 5-17)`` and ``Enrollment (Ages 5-17)`` are correctly enclosed in backticks (` `), which is the standard for Spark SQL. Other identifiers like `schools`, `frpm`, `CDSCode`, `AdmFName1`, `AdmLName1` do not require backticks.\n*   **Use ` for the in-query strings**: String literals like `'Kacey'` and `'Gibson'` are correctly enclosed in single quotes (`' '`), which is standard SQL. Backticks are for identifiers, not string literals.\n*   **Using the correct number of arguments for functions**: No functions requiring arguments are used in the query.\n*   **Casting to the correct data type**: The division operation `T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)`` will typically result in a floating-point number in Spark SQL, even if the underlying columns are integers, due to automatic type promotion for the division operator. Explicit casting is not strictly necessary to avoid integer division in most Spark versions.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a logical and common join condition between a `schools` table and a `frpm` (Free/Reduced Price Meal) table, as `CDSCode` typically represents a unique school identifier.\n\nThe query is syntactically correct and follows best practices for Spark SQL.\n\n```sql\nSELECT T2.`Free Meal Count (Ages 5-17)` / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 6, "timestamp": 1768939040.6973925}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 20.855908393859863, "spark_time": 0.14211416244506836, "translation_time": 20.713794231414795, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='778a2086-1512-430e-b7e4-71ca7e57d118'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='fb9f7446-26cb-4694-8c33-49c65be24264'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not exhibit any of the common mistakes listed:\\n\\n1.  **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n2.  **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n3.  **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n4.  **Data type mismatch in predicates**: The predicates `T2.AdmFName1 = 'Kacey'` and `T2.AdmLName1 = 'Gibson'` assume string comparisons, which is standard. The join condition `T1.CDSCode = T2.CDSCode` assumes compatible data types for `CDSCode` in both tables. The division operation implies numeric types for the columns involved. These seem appropriate.\\n5.  **Properly quoting identifiers**: Identifiers with spaces like ``Free Meal Count (Ages 5-17)`` and ``Enrollment (Ages 5-17)`` are correctly quoted using backticks (` `), which is standard for Spark SQL.\\n6.  **Use ` for the in-query strings**: String literals like `'Kacey'` and `'Gibson'` are correctly quoted with single quotes (`'`). Backticks (` `) are for identifiers, not string literals. The query follows this convention correctly.\\n7.  **Using the correct number of arguments for functions**: Not applicable, no functions with arguments are used.\\n8.  **Casting to the correct data type**: No explicit casting is used, and for a ratio calculation, implicit casting to a floating-point type for division is usually desired.\\n9.  **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a common and logical join key for linking school-related data.\\n\\nOne potential runtime issue not explicitly covered by the list but worth noting is **division by zero** if `T1.`Enrollment (Ages 5-17)`` could be zero. However, based strictly on the provided list of common mistakes, the query is correct.\\n\\n```sql\\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\\n```\" name='query_checker_sql_db' tool_call_id='cc2b6579-ec22-47d3-9a03-8319f3c8a437'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4785, "output_tokens": 2651, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = \\'Kacey\\' AND T2.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not exhibit any of the common mistakes listed:\n\n1.  **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n2.  **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n3.  **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n4.  **Data type mismatch in predicates**: The predicates `T2.AdmFName1 = 'Kacey'` and `T2.AdmLName1 = 'Gibson'` assume string comparisons, which is standard. The join condition `T1.CDSCode = T2.CDSCode` assumes compatible data types for `CDSCode` in both tables. The division operation implies numeric types for the columns involved. These seem appropriate.\n5.  **Properly quoting identifiers**: Identifiers with spaces like ``Free Meal Count (Ages 5-17)`` and ``Enrollment (Ages 5-17)`` are correctly quoted using backticks (` `), which is standard for Spark SQL.\n6.  **Use ` for the in-query strings**: String literals like `'Kacey'` and `'Gibson'` are correctly quoted with single quotes (`'`). Backticks (` `) are for identifiers, not string literals. The query follows this convention correctly.\n7.  **Using the correct number of arguments for functions**: Not applicable, no functions with arguments are used.\n8.  **Casting to the correct data type**: No explicit casting is used, and for a ratio calculation, implicit casting to a floating-point type for division is usually desired.\n9.  **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a common and logical join key for linking school-related data.\n\nOne potential runtime issue not explicitly covered by the list but worth noting is **division by zero** if `T1.`Enrollment (Ages 5-17)`` could be zero. However, based strictly on the provided list of common mistakes, the query is correct.\n\n```sql\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 7, "timestamp": 1768939062.245737}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson' AND T1.`Enrollment (Ages 5-17)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` != 0", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 17.386733055114746, "spark_time": 0.16927170753479004, "translation_time": 17.217461347579956, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='98e5060c-5670-49d8-a7ec-6f506940050d'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='69ffb3cb-ff38-45b1-8aa1-27a8ec7a5373'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson' AND T1.`Enrollment (Ages 5-17)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` != 0\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   **Quoting Identifiers:** Identifiers with spaces or special characters (e.g., ``Free Meal Count (Ages 5-17)``) are correctly quoted using backticks (` `).\\n*   **String Literals:** String literals (e.g., `'Kacey'`, `'Gibson'`) are correctly quoted using single quotes (`'`).\\n*   **NULL and Zero Checks:** The `WHERE` clause correctly handles potential division by zero and `NULL` values for the denominator: `T1.`Enrollment (Ages 5-17)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` != 0`.\\n*   **Join Columns:** The join condition `T1.CDSCode = T2.CDSCode` uses appropriate columns, assuming `CDSCode` is the common key between the `frpm` and `schools` tables.\\n*   Other points like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, `BETWEEN` ranges, data type mismatches, function arguments, and explicit casting are either not applicable or correctly handled implicitly by Spark SQL.\\n\\nTherefore, the original query is reproduced as it is correct.\\n\\n```sql\\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson' AND T1.`Enrollment (Ages 5-17)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` != 0\\n```\" name='query_checker_sql_db' tool_call_id='095dd20b-5cd9-409a-9903-154dee8a1348'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson' AND T1.`Enrollment (Ages 5-17)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` != 0\"}"], "input_tokens": 4709, "output_tokens": 2389, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = \\'Kacey\\' AND T2.AdmLName1 = \\'Gibson\\' AND T1.`Enrollment (Ages 5-17)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` != 0\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   **Quoting Identifiers:** Identifiers with spaces or special characters (e.g., ``Free Meal Count (Ages 5-17)``) are correctly quoted using backticks (` `).\n*   **String Literals:** String literals (e.g., `'Kacey'`, `'Gibson'`) are correctly quoted using single quotes (`'`).\n*   **NULL and Zero Checks:** The `WHERE` clause correctly handles potential division by zero and `NULL` values for the denominator: `T1.`Enrollment (Ages 5-17)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` != 0`.\n*   **Join Columns:** The join condition `T1.CDSCode = T2.CDSCode` uses appropriate columns, assuming `CDSCode` is the common key between the `frpm` and `schools` tables.\n*   Other points like `NOT IN` with `NULL`, `UNION` vs `UNION ALL`, `BETWEEN` ranges, data type mismatches, function arguments, and explicit casting are either not applicable or correctly handled implicitly by Spark SQL.\n\nTherefore, the original query is reproduced as it is correct.\n\n```sql\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson' AND T1.`Enrollment (Ages 5-17)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` != 0\n```", "final_answer": "", "replica": 8, "timestamp": 1768939080.2660425}
{"query_id": 34, "provider": "google", "db": "california_schools", "nl_query": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "gold_sqlite": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "gold_spark": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS FLOAT) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode AND T1.`School Name` = T2.School WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'", "execution_status": "VALID", "query_result": [["0.20174165457184326"]], "spark_error": null, "total_time": 20.232450485229492, "spark_time": 0.16792702674865723, "translation_time": 20.064523458480835, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0a7c8575-2b9e-4457-9f51-5d60b4df8a2c'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='0f0706d8-2002-4366-bdbb-277fb102904c'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode AND T1.`School Name` = T2.School WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\"}", "Observation: content=\"The Spark SQL query appears to be well-formed and does not contain the common mistakes listed:\\n\\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The predicates (`CDSCode`, `School Name`/`School`, `AdmFName1`, `AdmLName1`) are compared with values or columns that are highly likely to be of compatible data types (e.g., string to string, numeric to numeric for `CDSCode`). The division operation assumes numeric types, which is standard for count/enrollment columns.\\n*   **Properly quoting identifiers**: Identifiers with spaces (e.g., ``Free Meal Count (Ages 5-17)``, ``Enrollment (Ages 5-17)``, ``School Name``) are correctly quoted using backticks (` `), which is appropriate for Spark SQL.\\n*   **Use ` for the in-query strings**: This point likely refers to quoting identifiers, which is done correctly. String literals like `'Kacey'` and `'Gibson'` correctly use single quotes.\\n*   **Using the correct number of arguments for functions**: No functions are explicitly used in the query (other than the division operator).\\n*   **Casting to the correct data type**: No explicit casts are used, and the implicit type promotion for division is standard.\\n*   **Using the proper columns for joins**: The join conditions `T1.CDSCode = T2.CDSCode` and `T1.`School Name` = T2.School` are appropriate for linking school-related tables.\\n\\nOne potential logical consideration (not a syntax error from the list) is division by zero if `T1.`Enrollment (Ages 5-17)`` could be 0. In Spark SQL, division by zero typically results in `NULL`, which might be acceptable depending on the desired outcome. If a specific value (e.g., 0) or filtering is required, a `CASE` statement or `WHERE` clause would be needed, but this is beyond the scope of the requested common mistakes.\\n\\nGiven the specific list of common mistakes, the query is correct.\\n\\n```sql\\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode AND T1.`School Name` = T2.School WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\\n```\" name='query_checker_sql_db' tool_call_id='4292203b-5005-447a-9772-46735e3eb2e6'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode AND T1.`School Name` = T2.School WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\"}"], "input_tokens": 4867, "output_tokens": 2772, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson? Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode AND T1.`School Name` = T2.School WHERE T2.AdmFName1 = \\'Kacey\\' AND T2.AdmLName1 = \\'Gibson\\'\"}'}\nTool: The Spark SQL query appears to be well-formed and does not contain the common mistakes listed:\n\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The predicates (`CDSCode`, `School Name`/`School`, `AdmFName1`, `AdmLName1`) are compared with values or columns that are highly likely to be of compatible data types (e.g., string to string, numeric to numeric for `CDSCode`). The division operation assumes numeric types, which is standard for count/enrollment columns.\n*   **Properly quoting identifiers**: Identifiers with spaces (e.g., ``Free Meal Count (Ages 5-17)``, ``Enrollment (Ages 5-17)``, ``School Name``) are correctly quoted using backticks (` `), which is appropriate for Spark SQL.\n*   **Use ` for the in-query strings**: This point likely refers to quoting identifiers, which is done correctly. String literals like `'Kacey'` and `'Gibson'` correctly use single quotes.\n*   **Using the correct number of arguments for functions**: No functions are explicitly used in the query (other than the division operator).\n*   **Casting to the correct data type**: No explicit casts are used, and the implicit type promotion for division is standard.\n*   **Using the proper columns for joins**: The join conditions `T1.CDSCode = T2.CDSCode` and `T1.`School Name` = T2.School` are appropriate for linking school-related tables.\n\nOne potential logical consideration (not a syntax error from the list) is division by zero if `T1.`Enrollment (Ages 5-17)`` could be 0. In Spark SQL, division by zero typically results in `NULL`, which might be acceptable depending on the desired outcome. If a specific value (e.g., 0) or filtering is required, a `CASE` statement or `WHERE` clause would be needed, but this is beyond the scope of the requested common mistakes.\n\nGiven the specific list of common mistakes, the query is correct.\n\n```sql\nSELECT T1.`Free Meal Count (Ages 5-17)` / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode AND T1.`School Name` = T2.School WHERE T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson'\n```", "final_answer": "", "replica": 9, "timestamp": 1768939101.1215372}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 11.0907301902771, "spark_time": 0.21274590492248535, "translation_time": 10.877984285354614, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='5be47964-70cf-4d4b-ba99-335cc1852256'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f458b622-56e2-4c06-ac7b-a9dfd2786608'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;'}", "Observation: content='No mistakes were found in the query based on the provided checklist. The identifiers are properly quoted, common join columns are used, and there are no obvious data type mismatches or incorrect function usages.\\n\\n```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='f727a176-9217-4f74-bd2c-b3614886a36e'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;'}"], "input_tokens": 4335, "output_tokens": 1783, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\"}'}\nTool: No mistakes were found in the query based on the provided checklist. The identifiers are properly quoted, common join columns are used, and there are no obvious data type mismatches or incorrect function usages.\n\n```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\n```", "final_answer": "", "replica": 0, "timestamp": 1768939112.917265}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 11.28391170501709, "spark_time": 0.15084147453308105, "translation_time": 11.133070230484009, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='87393469-b9de-438e-b630-119fc8a426bd'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='ec1d4e7a-2787-4637-8042-d08d3c8851c7'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}", "Observation: content='```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='872340bf-da28-48a0-a1d9-e641da027560'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}"], "input_tokens": 4282, "output_tokens": 1615, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\"}'}\nTool: ```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\n```", "final_answer": "", "replica": 1, "timestamp": 1768939124.8401542}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 14.245362758636475, "spark_time": 0.14904332160949707, "translation_time": 14.096319437026978, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='08e9f297-acd2-41d6-a40a-46f50bd27309'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='253474a9-b2e1-4515-ba19-dca8a397e6de'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}", "Observation: content='```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='cf9b3763-badc-4aa7-9824-d937d9d71575'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}"], "input_tokens": 4282, "output_tokens": 1615, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\"}'}\nTool: ```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\n```", "final_answer": "", "replica": 2, "timestamp": 1768939139.752588}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 16.636367559432983, "spark_time": 0.15195083618164062, "translation_time": 16.484416723251343, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='5e2316c8-d16b-4b03-98dc-fea65d4831d6'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='66777b43-89eb-492b-85ee-379ef81d3c3e'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}", "Observation: content='```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='af66c233-3904-4cfe-9ad3-a851276ea208'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}"], "input_tokens": 4282, "output_tokens": 1615, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\"}'}\nTool: ```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\n```", "final_answer": "", "replica": 3, "timestamp": 1768939157.035504}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 15.366435050964355, "spark_time": 0.15257644653320312, "translation_time": 15.213858604431152, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='4f5492ad-8e19-4d79-b241-f5888c4498f4'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='d4e81ce9-0d61-47ab-bcc3-519a6fdabeb4'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and correctly handles common issues.\\n\\nHere's a breakdown of the checks:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**:\\n    *   `T1.`Charter School (Y/N)` = 1`: This assumes the `Charter School (Y/N)` column is a numerical type (e.g., TINYINT, INT) where `1` represents 'Yes' or 'True'. This is a common and acceptable practice. If it were a string ('Y'/'N'), it would be a mismatch, but `1` is a strong indicator of a numeric/boolean type.\\n    *   `T1.CDSCode = T2.CDSCode`: Assumes `CDSCode` in both tables have compatible data types, which is standard for join keys.\\n*   **Properly quoting identifiers**: All identifiers containing spaces or special characters (`AdmEmail1`, `Charter School (Y/N)`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. `CDSCode` is also quoted, which is good practice even if not strictly necessary for that specific name.\\n*   **Use `` for the in-query strings**: No in-query string literals are present. Backticks are correctly used for identifiers.\\n*   **Using the correct number of arguments for functions**: No functions are used.\\n*   **Casting to the correct data type**: No explicit casting is used, and the implicit conversions (if any) seem appropriate for the operations.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a very common and logical join condition between a table like `frpm` (Free and Reduced Price Meal Program, often school-level data) and a `schools` table.\\n\\nThe query is robust and correctly written for Spark SQL.\\n\\n```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='5b817a96-5f17-4ee4-85bc-abd1bf09992c'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}"], "input_tokens": 4766, "output_tokens": 2204, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be well-formed and correctly handles common issues.\n\nHere's a breakdown of the checks:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**:\n    *   `T1.`Charter School (Y/N)` = 1`: This assumes the `Charter School (Y/N)` column is a numerical type (e.g., TINYINT, INT) where `1` represents 'Yes' or 'True'. This is a common and acceptable practice. If it were a string ('Y'/'N'), it would be a mismatch, but `1` is a strong indicator of a numeric/boolean type.\n    *   `T1.CDSCode = T2.CDSCode`: Assumes `CDSCode` in both tables have compatible data types, which is standard for join keys.\n*   **Properly quoting identifiers**: All identifiers containing spaces or special characters (`AdmEmail1`, `Charter School (Y/N)`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. `CDSCode` is also quoted, which is good practice even if not strictly necessary for that specific name.\n*   **Use `` for the in-query strings**: No in-query string literals are present. Backticks are correctly used for identifiers.\n*   **Using the correct number of arguments for functions**: No functions are used.\n*   **Casting to the correct data type**: No explicit casting is used, and the implicit conversions (if any) seem appropriate for the operations.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a very common and logical join condition between a table like `frpm` (Free and Reduced Price Meal Program, often school-level data) and a `schools` table.\n\nThe query is robust and correctly written for Spark SQL.\n\n```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\n```", "final_answer": "", "replica": 4, "timestamp": 1768939173.055021}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 12.574381351470947, "spark_time": 0.1520378589630127, "translation_time": 12.422343492507935, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='e4dbb9f9-08f3-4511-94a9-ad58d9190766'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='5c93bb92-37b4-4bea-86b3-7f7a8d7b4a20'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}", "Observation: content='```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='5feef76b-b96a-4929-96cc-b1bd5a37004e'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}"], "input_tokens": 4282, "output_tokens": 1651, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\"}'}\nTool: ```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\n```", "final_answer": "", "replica": 5, "timestamp": 1768939186.345449}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 12.524154663085938, "spark_time": 0.16528892517089844, "translation_time": 12.358865737915039, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='29b1ff3c-5cdc-4d84-9752-6490be520227'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='37d69f92-9196-4264-b3d5-8fb354ebbf87'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}", "Observation: content='```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='e9aefa81-7a0e-44f1-b9fb-32c6b281863b'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}"], "input_tokens": 4282, "output_tokens": 1615, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\"}'}\nTool: ```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\n```", "final_answer": "", "replica": 6, "timestamp": 1768939199.5412118}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 22.05275273323059, "spark_time": 0.13104748725891113, "translation_time": 21.92170524597168, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cabf19b1-26af-4a1a-9e59-0367d6864d89'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='91375510-9c88-42aa-bace-ba278fdf55ed'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and correctly handles common issues.\\n\\nHere's a breakdown of the checks:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**:\\n    *   `T1.`Charter School (Y/N)` = 1`: This assumes the `Charter School (Y/N)` column is a numerical type (e.g., TINYINT, INT) where `1` represents 'Yes' or 'True'. This is a common and acceptable practice. If it were a string ('Y'/'N'), it would be a mismatch, but `1` is a strong indicator of a numeric/boolean type.\\n    *   `T1.CDSCode = T2.CDSCode`: Assumes `CDSCode` in both tables have compatible data types, which is standard for join keys.\\n*   **Properly quoting identifiers**: All identifiers containing spaces or special characters (`AdmEmail1`, `Charter School (Y/N)`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. `CDSCode` is also quoted, which is good practice even if not strictly necessary for that specific name.\\n*   **Use `` for the in-query strings**: No in-query string literals are present. Backticks are correctly used for identifiers.\\n*   **Using the correct number of arguments for functions**: No functions are used.\\n*   **Casting to the correct data type**: No explicit casting is used, and the implicit conversions (if any) seem appropriate for the operations.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a very common and logical join condition between a table like `frpm` (Free and Reduced Price Meal Program, often school-level data) and a `schools` table.\\n\\nThe query is robust and correctly written for Spark SQL.\\n\\n```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='4342b6b3-4184-4c59-a237-c203ada6f780'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1'}"], "input_tokens": 4766, "output_tokens": 2133, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be well-formed and correctly handles common issues.\n\nHere's a breakdown of the checks:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**:\n    *   `T1.`Charter School (Y/N)` = 1`: This assumes the `Charter School (Y/N)` column is a numerical type (e.g., TINYINT, INT) where `1` represents 'Yes' or 'True'. This is a common and acceptable practice. If it were a string ('Y'/'N'), it would be a mismatch, but `1` is a strong indicator of a numeric/boolean type.\n    *   `T1.CDSCode = T2.CDSCode`: Assumes `CDSCode` in both tables have compatible data types, which is standard for join keys.\n*   **Properly quoting identifiers**: All identifiers containing spaces or special characters (`AdmEmail1`, `Charter School (Y/N)`, `Enrollment (K-12)`) are correctly quoted using backticks (` `), which is the standard for Spark SQL. `CDSCode` is also quoted, which is good practice even if not strictly necessary for that specific name.\n*   **Use `` for the in-query strings**: No in-query string literals are present. Backticks are correctly used for identifiers.\n*   **Using the correct number of arguments for functions**: No functions are used.\n*   **Casting to the correct data type**: No explicit casting is used, and the implicit conversions (if any) seem appropriate for the operations.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.CDSCode` is a very common and logical join condition between a table like `frpm` (Free and Reduced Price Meal Program, often school-level data) and a `schools` table.\n\nThe query is robust and correctly written for Spark SQL.\n\n```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1\n```", "final_answer": "", "replica": 7, "timestamp": 1768939222.2699885}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 11.239660501480103, "spark_time": 0.1586294174194336, "translation_time": 11.081031084060669, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='9602f031-64a9-4183-9161-be7d1b867696'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='49dab32c-75b0-4f14-8a94-00975cd8c628'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;'}", "Observation: content='```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='6358eab2-04ca-4d74-9518-9a3beaac5490'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;'}"], "input_tokens": 4293, "output_tokens": 1519, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\"}'}\nTool: ```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\n```", "final_answer": "", "replica": 8, "timestamp": 1768939234.23965}
{"query_id": 35, "provider": "google", "db": "california_schools", "nl_query": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`", "gold_sqlite": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "gold_spark": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;", "execution_status": "VALID", "query_result": [["mjennings@kesd.org"]], "spark_error": null, "total_time": 11.293458700180054, "spark_time": 0.16138505935668945, "translation_time": 11.132073640823364, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='42e42dea-7f21-42a9-96a9-c7223c6c3f23'", "Action: schema_sql_db\nAction Input: {'table_names': 'frpm, schools'}", "Observation: content='CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='62e5f1c3-f740-4419-8a8c-ac119e669b7f'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;'}", "Observation: content='No mistakes were found in the query based on the provided checklist. The identifiers are properly quoted, common join columns are used, and there are no obvious data type mismatches or incorrect function usages.\\n\\n```sql\\nSELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='3eef6abd-1691-4de8-8e98-4dee93352bd9'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;'}"], "input_tokens": 4335, "output_tokens": 1783, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12? Charted school means `Charter School (Y/N)` = 1 in the table frpm; Students enrolled in grades 1 through 12 refers to `Enrollment (K-12)`\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"frpm, schools\"}'}\nTool: CREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\"}'}\nTool: No mistakes were found in the query based on the provided checklist. The identifiers are properly quoted, common join columns are used, and there are no obvious data type mismatches or incorrect function usages.\n\n```sql\nSELECT T2.`AdmEmail1` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode` WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1;\n```", "final_answer": "", "replica": 9, "timestamp": 1768939246.1646776}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["Michelle King", "", ""]], "spark_error": null, "total_time": 35.773478269577026, "spark_time": 0.23729228973388672, "translation_time": 35.53618597984314, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='be05d042-53e7-492a-ac2c-ebfc61239a20'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='7cab442a-fef3-4e93-8a89-3167143a933a'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='e9d22886-bc6b-4f03-a6d0-47901f9bf7f0'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='181a9f23-6047-4350-a98c-eafc2d843870'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1;\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The join condition `T1.cds = T2.CDSCode` assumes `cds` and `CDSCode` columns have compatible data types (e.g., both strings or both integers representing codes), which is a standard and usually correct assumption for such identifiers.\\n*   **Properly quoting identifiers**: Identifiers like `T2.AdmFName1`, `T1.cds`, etc., are standard alphanumeric names and do not require quoting with backticks in Spark SQL. If they contained special characters or were reserved keywords, backticks would be necessary.\\n*   **Use ` for the in-query strings**: This instruction typically refers to quoting identifiers that contain special characters or are reserved keywords. For string literals (like the space `' '` in `CONCAT_WS`), single quotes are the standard and correct way to define them in Spark SQL. Using backticks for string literals would be incorrect syntax. The query correctly uses single quotes for string literals.\\n*   **Using the correct number of arguments for functions**: `CONCAT_WS` is used correctly with a separator and two string arguments. `LIMIT 1` and `ORDER BY` are also used correctly.\\n*   **Casting to the correct data type**: No explicit casts are used, and none appear to be immediately necessary based on the query's logic.\\n*   **Using the proper columns for joins**: The join `T1.cds = T2.CDSCode` correctly links the `satscores` and `schools` tables using their respective code columns.\\n\\nThe query is well-formed and follows standard Spark SQL practices.\\n\\n```sql\\nSELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='0a7dc383-f158-41ff-9a98-e7d46d9b5695'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1;\"}"], "input_tokens": 6363, "output_tokens": 3623, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CONCAT_WS(\\' \\', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(\\' \\', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(\\' \\', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1;\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The join condition `T1.cds = T2.CDSCode` assumes `cds` and `CDSCode` columns have compatible data types (e.g., both strings or both integers representing codes), which is a standard and usually correct assumption for such identifiers.\n*   **Properly quoting identifiers**: Identifiers like `T2.AdmFName1`, `T1.cds`, etc., are standard alphanumeric names and do not require quoting with backticks in Spark SQL. If they contained special characters or were reserved keywords, backticks would be necessary.\n*   **Use ` for the in-query strings**: This instruction typically refers to quoting identifiers that contain special characters or are reserved keywords. For string literals (like the space `' '` in `CONCAT_WS`), single quotes are the standard and correct way to define them in Spark SQL. Using backticks for string literals would be incorrect syntax. The query correctly uses single quotes for string literals.\n*   **Using the correct number of arguments for functions**: `CONCAT_WS` is used correctly with a separator and two string arguments. `LIMIT 1` and `ORDER BY` are also used correctly.\n*   **Casting to the correct data type**: No explicit casts are used, and none appear to be immediately necessary based on the query's logic.\n*   **Using the proper columns for joins**: The join `T1.cds = T2.CDSCode` correctly links the `satscores` and `schools` tables using their respective code columns.\n\nThe query is well-formed and follows standard Spark SQL practices.\n\n```sql\nSELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1;\n```", "final_answer": "", "replica": 0, "timestamp": 1768939282.5844257}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT CASE WHEN s.AdmFName1 IS NOT NULL AND s.AdmLName1 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) ELSE NULL END AS Administrator1, CASE WHEN s.AdmFName2 IS NOT NULL AND s.AdmLName2 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) ELSE NULL END AS Administrator2, CASE WHEN s.AdmFName3 IS NOT NULL AND s.AdmLName3 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) ELSE NULL END AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["Michelle King", "None", "None"]], "spark_error": null, "total_time": 35.282888650894165, "spark_time": 0.3631284236907959, "translation_time": 34.91976022720337, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='556dae83-e080-4203-8fb6-8d374f92d608'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='2d1c93f1-ab2e-4454-bd6e-348a973d93b1'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='647beb00-f825-4748-bb47-8869a9f9fdc0'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='13bf5081-5072-4573-8109-6ee445300a82'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CASE WHEN s.AdmFName1 IS NOT NULL AND s.AdmLName1 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) ELSE NULL END AS Administrator1, CASE WHEN s.AdmFName2 IS NOT NULL AND s.AdmLName2 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) ELSE NULL END AS Administrator2, CASE WHEN s.AdmFName3 IS NOT NULL AND s.AdmLName3 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) ELSE NULL END AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION` or `UNION ALL`.\\n*   It does not use `BETWEEN` for exclusive ranges.\\n*   There are no apparent data type mismatches in predicates, assuming `ss.cds` and `s.CDSCode` are compatible types (e.g., both strings or integers) and `ss.NumGE1500` is numeric.\\n*   Identifiers are not quoted with backticks (` `), but for simple column names like `AdmFName1`, `AdmLName1`, `cds`, `CDSCode`, etc., Spark SQL typically does not require them unless the names contain special characters, spaces, or are reserved keywords. The query will execute correctly as written.\\n*   Functions like `CONCAT_WS` and `IS NOT NULL` are used with the correct number of arguments.\\n*   There is no explicit casting, and implicit casting (e.g., within `CONCAT_WS`) is handled correctly by Spark SQL.\\n*   The join condition `ss.cds = s.CDSCode` uses appropriate columns to link SAT scores to school information.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT CASE WHEN s.AdmFName1 IS NOT NULL AND s.AdmLName1 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) ELSE NULL END AS Administrator1, CASE WHEN s.AdmFName2 IS NOT NULL AND s.AdmLName2 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) ELSE NULL END AS Administrator2, CASE WHEN s.AdmFName3 IS NOT NULL AND s.AdmLName3 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) ELSE NULL END AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='17f4e97b-c208-4640-b431-219c44da099c'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CASE WHEN s.AdmFName1 IS NOT NULL AND s.AdmLName1 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) ELSE NULL END AS Administrator1, CASE WHEN s.AdmFName2 IS NOT NULL AND s.AdmLName2 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) ELSE NULL END AS Administrator2, CASE WHEN s.AdmFName3 IS NOT NULL AND s.AdmLName3 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) ELSE NULL END AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\"}"], "input_tokens": 6396, "output_tokens": 3367, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CASE WHEN s.AdmFName1 IS NOT NULL AND s.AdmLName1 IS NOT NULL THEN CONCAT_WS(\\' \\', s.AdmFName1, s.AdmLName1) ELSE NULL END AS Administrator1, CASE WHEN s.AdmFName2 IS NOT NULL AND s.AdmLName2 IS NOT NULL THEN CONCAT_WS(\\' \\', s.AdmFName2, s.AdmLName2) ELSE NULL END AS Administrator2, CASE WHEN s.AdmFName3 IS NOT NULL AND s.AdmLName3 IS NOT NULL THEN CONCAT_WS(\\' \\', s.AdmFName3, s.AdmLName3) ELSE NULL END AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION` or `UNION ALL`.\n*   It does not use `BETWEEN` for exclusive ranges.\n*   There are no apparent data type mismatches in predicates, assuming `ss.cds` and `s.CDSCode` are compatible types (e.g., both strings or integers) and `ss.NumGE1500` is numeric.\n*   Identifiers are not quoted with backticks (` `), but for simple column names like `AdmFName1`, `AdmLName1`, `cds`, `CDSCode`, etc., Spark SQL typically does not require them unless the names contain special characters, spaces, or are reserved keywords. The query will execute correctly as written.\n*   Functions like `CONCAT_WS` and `IS NOT NULL` are used with the correct number of arguments.\n*   There is no explicit casting, and implicit casting (e.g., within `CONCAT_WS`) is handled correctly by Spark SQL.\n*   The join condition `ss.cds = s.CDSCode` uses appropriate columns to link SAT scores to school information.\n\nThe query is correct as written.\n\n```sql\nSELECT CASE WHEN s.AdmFName1 IS NOT NULL AND s.AdmLName1 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) ELSE NULL END AS Administrator1, CASE WHEN s.AdmFName2 IS NOT NULL AND s.AdmLName2 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) ELSE NULL END AS Administrator2, CASE WHEN s.AdmFName3 IS NOT NULL AND s.AdmLName3 IS NOT NULL THEN CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) ELSE NULL END AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\n```", "final_answer": "", "replica": 1, "timestamp": 1768939318.587331}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 1, "sparksql_query": "SELECT s.AdmFName1, s.AdmLName1, s.AdmFName2, s.AdmLName2, s.AdmFName3, s.AdmLName3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["Michelle", "King", "None", "None", "None", "None"]], "spark_error": null, "total_time": 15.345120429992676, "spark_time": 0.1824803352355957, "translation_time": 15.16264009475708, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cb401f73-8782-47dd-8290-b18d0ffd8254'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='bae8417a-c6a2-4d9c-ac58-4ca97502de9a'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='afd8a3bb-c829-4f9d-9532-7bcca9edacde'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='9c83e3ba-7b7e-429c-88fb-c9ef2db326cc'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AdmFName1, s.AdmLName1, s.AdmFName2, s.AdmLName2, s.AdmFName3, s.AdmLName3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1;'}", "Observation: content='```sql\\nSELECT s.AdmFName1, s.AdmLName1, s.AdmFName2, s.AdmLName2, s.AdmFName3, s.AdmLName3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='abb318b4-4612-40ca-a447-90dd52a5d482'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.AdmFName1, s.AdmLName1, s.AdmFName2, s.AdmLName2, s.AdmFName3, s.AdmLName3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1;'}"], "input_tokens": 5790, "output_tokens": 1847, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AdmFName1, s.AdmLName1, s.AdmFName2, s.AdmLName2, s.AdmFName3, s.AdmLName3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1;\"}'}\nTool: ```sql\nSELECT s.AdmFName1, s.AdmLName1, s.AdmFName2, s.AdmLName2, s.AdmFName3, s.AdmLName3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1;\n```", "final_answer": "", "replica": 2, "timestamp": 1768939334.6157694}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT CONCAT_WS(' ', `s`.`AdmFName1`, `s`.`AdmLName1`) AS `Administrator1`, CONCAT_WS(' ', `s`.`AdmFName2`, `s`.`AdmLName2`) AS `Administrator2`, CONCAT_WS(' ', `s`.`AdmFName3`, `s`.`AdmLName3`) AS `Administrator3` FROM `satscores` AS `ss` JOIN `schools` AS `s` ON `ss`.`cds` = `s`.`CDSCode` ORDER BY `ss`.`NumGE1500` DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["Michelle King", "", ""]], "spark_error": null, "total_time": 23.88195538520813, "spark_time": 0.1736588478088379, "translation_time": 23.708296537399292, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='ca302fcb-ab37-4b49-8c1b-c0b5cf2ae875'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='496f1460-a09f-46b3-9185-e7e9cbdc31ea'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='292f8f05-e512-4682-a3f8-177213e3a2f2'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='b182a952-3f48-4ab6-b33f-98ad6f08c89d'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\"}", "Observation: content='The query has a minor issue regarding the explicit instruction to \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which refers to identifiers in Spark SQL). While many identifiers might work unquoted, it\\'s best practice in Spark SQL to quote them with backticks (`) to avoid issues with reserved keywords or special characters, and to ensure consistency.\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT CONCAT_WS(\\' \\', `s`.`AdmFName1`, `s`.`AdmLName1`) AS `Administrator1`, CONCAT_WS(\\' \\', `s`.`AdmFName2`, `s`.`AdmLName2`) AS `Administrator2`, CONCAT_WS(\\' \\', `s`.`AdmFName3`, `s`.`AdmLName3`) AS `Administrator3` FROM `satscores` AS `ss` JOIN `schools` AS `s` ON `ss`.`cds` = `s`.`CDSCode` ORDER BY `ss`.`NumGE1500` DESC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='02bb30ce-557a-45a8-b450-3aff2dec72fc'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', `s`.`AdmFName1`, `s`.`AdmLName1`) AS `Administrator1`, CONCAT_WS(' ', `s`.`AdmFName2`, `s`.`AdmLName2`) AS `Administrator2`, CONCAT_WS(' ', `s`.`AdmFName3`, `s`.`AdmLName3`) AS `Administrator3` FROM `satscores` AS `ss` JOIN `schools` AS `s` ON `ss`.`cds` = `s`.`CDSCode` ORDER BY `ss`.`NumGE1500` DESC LIMIT 1;\"}"], "input_tokens": 6020, "output_tokens": 2844, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CONCAT_WS(\\' \\', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(\\' \\', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(\\' \\', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\"}'}\nTool: The query has a minor issue regarding the explicit instruction to \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which refers to identifiers in Spark SQL). While many identifiers might work unquoted, it's best practice in Spark SQL to quote them with backticks (`) to avoid issues with reserved keywords or special characters, and to ensure consistency.\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT CONCAT_WS(' ', `s`.`AdmFName1`, `s`.`AdmLName1`) AS `Administrator1`, CONCAT_WS(' ', `s`.`AdmFName2`, `s`.`AdmLName2`) AS `Administrator2`, CONCAT_WS(' ', `s`.`AdmFName3`, `s`.`AdmLName3`) AS `Administrator3` FROM `satscores` AS `ss` JOIN `schools` AS `s` ON `ss`.`cds` = `s`.`CDSCode` ORDER BY `ss`.`NumGE1500` DESC LIMIT 1;\n```", "final_answer": "", "replica": 3, "timestamp": 1768939359.1197217}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1", "execution_status": "VALID", "query_result": [["Michelle King", "", ""]], "spark_error": null, "total_time": 36.670231103897095, "spark_time": 0.16699814796447754, "translation_time": 36.50323295593262, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='72f601d4-f5f0-4b6f-9be2-be8257f1f452'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='5fb4fc93-282f-43e8-80d2-420ba0bd63fa'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='a6c98b38-755d-4888-b43a-d6a1a9d58aae'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='52a8abbb-dc9b-4163-a1a8-99fb1b2469a0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1\"}", "Observation: content=\"SELECT CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1\" name='query_checker_sql_db' tool_call_id='7cb78447-83ac-4c8f-ad6a-cc000383faf9'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1\"}"], "input_tokens": 5883, "output_tokens": 2755, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CONCAT_WS(\\' \\', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(\\' \\', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(\\' \\', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1\"}'}\nTool: SELECT CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM schools AS s JOIN satscores AS ss ON s.CDSCode = ss.cds ORDER BY ss.NumGE1500 DESC LIMIT 1", "final_answer": "", "replica": 4, "timestamp": 1768939396.5765564}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1", "execution_status": "ERROR", "query_result": null, "spark_error": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `s`.`school_id` cannot be resolved. Did you mean one of the following? [`s`.`School`, `s`.`Phone`, `s`.`Charter`, `s`.`City`, `s`.`County`]. SQLSTATE: 42703; line 1 pos 360;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Sort ['ss.NumGE1500 DESC NULLS LAST], true\n      +- 'Project ['CONCAT_WS( , 's.administrator_first_name_1, 's.administrator_last_name_1) AS administrator_1_full_name#16949, 'CONCAT_WS( , 's.administrator_first_name_2, 's.administrator_last_name_2) AS administrator_2_full_name#16950, 'CONCAT_WS( , 's.administrator_first_name_3, 's.administrator_last_name_3) AS administrator_3_full_name#16951]\n         +- 'Join Inner, ('s.school_id = 'ss.school_id)\n            :- SubqueryAlias s\n            :  +- SubqueryAlias schools\n            :     +- View (`schools`, [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields])\n            :        +- LocalRelation [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields]\n            +- SubqueryAlias ss\n               +- SubqueryAlias satscores\n                  +- View (`satscores`, [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39])\n                     +- LocalRelation [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39]\n", "total_time": 19.492348194122314, "spark_time": 0.05889272689819336, "translation_time": 19.43345546722412, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0aa8fc38-9ddd-4bf8-a6ae-fc469df2b8f4'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='f4039704-0b37-4b2d-85c4-96469439861b'", "Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='184e5d4f-8b73-47cc-8685-e467bd6b8d14'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='a680ed1c-5a8d-4933-8809-8d890d528436'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION` or `UNION ALL`.\\n*   It does not use `BETWEEN` for ranges.\\n*   The join condition `s.school_id = ss.school_id` assumes compatible data types for `school_id` in both tables, which is standard practice for foreign key relationships.\\n*   Identifiers like table and column names are not quoted with backticks (` `), but they are simple names and do not contain special characters or reserved keywords, so quoting is not strictly necessary in Spark SQL. The string literal `' '` used in `CONCAT_WS` is correctly quoted with single quotes.\\n*   The `CONCAT_WS` function is used with the correct number of arguments (separator and two string columns).\\n*   No explicit casting is used or appears to be immediately necessary.\\n*   The join columns `s.school_id` and `ss.school_id` are appropriate for linking schools to their SAT scores.\\n\\nThe query correctly identifies the school with the highest `NumGE1500` score and retrieves the full names of its administrators.\\n\\n```sql\\nSELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='dbbc9ffc-1520-41a2-9af2-fa2961297d4b'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\"}"], "input_tokens": 5706, "output_tokens": 3147, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CONCAT_WS(\\' \\', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(\\' \\', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(\\' \\', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION` or `UNION ALL`.\n*   It does not use `BETWEEN` for ranges.\n*   The join condition `s.school_id = ss.school_id` assumes compatible data types for `school_id` in both tables, which is standard practice for foreign key relationships.\n*   Identifiers like table and column names are not quoted with backticks (` `), but they are simple names and do not contain special characters or reserved keywords, so quoting is not strictly necessary in Spark SQL. The string literal `' '` used in `CONCAT_WS` is correctly quoted with single quotes.\n*   The `CONCAT_WS` function is used with the correct number of arguments (separator and two string columns).\n*   No explicit casting is used or appears to be immediately necessary.\n*   The join columns `s.school_id` and `ss.school_id` are appropriate for linking schools to their SAT scores.\n\nThe query correctly identifies the school with the highest `NumGE1500` score and retrieves the full names of its administrators.\n\n```sql\nSELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\n```", "final_answer": "", "replica": 5, "timestamp": 1768939416.2059062}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1", "execution_status": "ERROR", "query_result": null, "spark_error": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `s`.`school_id` cannot be resolved. Did you mean one of the following? [`s`.`School`, `s`.`Phone`, `s`.`Charter`, `s`.`City`, `s`.`County`]. SQLSTATE: 42703; line 1 pos 360;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Sort ['ss.NumGE1500 DESC NULLS LAST], true\n      +- 'Project ['CONCAT_WS( , 's.administrator_first_name_1, 's.administrator_last_name_1) AS administrator_1_full_name#16965, 'CONCAT_WS( , 's.administrator_first_name_2, 's.administrator_last_name_2) AS administrator_2_full_name#16966, 'CONCAT_WS( , 's.administrator_first_name_3, 's.administrator_last_name_3) AS administrator_3_full_name#16967]\n         +- 'Join Inner, ('s.school_id = 'ss.school_id)\n            :- SubqueryAlias s\n            :  +- SubqueryAlias schools\n            :     +- View (`schools`, [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields])\n            :        +- LocalRelation [CDSCode#40, NCESDist#41, NCESSchool#42, StatusType#43, County#44, District#45, School#46, Street#47, StreetAbr#48, City#49, Zip#50, State#51, MailStreet#52, MailStrAbr#53, MailCity#54, MailZip#55, MailState#56, Phone#57, Ext#58, Website#59, OpenDate#60, ClosedDate#61, Charter#62, CharterNum#63, FundingType#64, ... 24 more fields]\n            +- SubqueryAlias ss\n               +- SubqueryAlias satscores\n                  +- View (`satscores`, [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39])\n                     +- LocalRelation [cds#29, rtype#30, sname#31, dname#32, cname#33, enroll12#34L, NumTstTakr#35L, AvgScrRead#36, AvgScrMath#37, AvgScrWrite#38, NumGE1500#39]\n", "total_time": 22.02459192276001, "spark_time": 0.05500531196594238, "translation_time": 21.969586610794067, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='97719160-0c51-4970-8a86-347f22498a75'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='c164511c-104b-449d-a57f-c78c63fe7bb7'", "Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='42ac0679-b813-421d-8b09-4af78e38a213'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='9b550740-49aa-4250-877c-748613574328'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION` or `UNION ALL`.\\n*   It does not use `BETWEEN` for ranges.\\n*   The join condition `s.school_id = ss.school_id` assumes compatible data types for `school_id` in both tables, which is standard practice for foreign key relationships.\\n*   Identifiers like table and column names are not quoted with backticks (` `), but they are simple names and do not contain special characters or reserved keywords, so quoting is not strictly necessary in Spark SQL. The string literal `' '` used in `CONCAT_WS` is correctly quoted with single quotes.\\n*   The `CONCAT_WS` function is used with the correct number of arguments (separator and two string columns).\\n*   No explicit casting is used or appears to be immediately necessary.\\n*   The join columns `s.school_id` and `ss.school_id` are appropriate for linking schools to their SAT scores.\\n\\nThe query correctly identifies the school with the highest `NumGE1500` score and retrieves the full names of its administrators.\\n\\n```sql\\nSELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='fe30ad08-e40b-4530-823a-ed6332543cd2'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\"}"], "input_tokens": 5706, "output_tokens": 3147, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CONCAT_WS(\\' \\', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(\\' \\', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(\\' \\', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION` or `UNION ALL`.\n*   It does not use `BETWEEN` for ranges.\n*   The join condition `s.school_id = ss.school_id` assumes compatible data types for `school_id` in both tables, which is standard practice for foreign key relationships.\n*   Identifiers like table and column names are not quoted with backticks (` `), but they are simple names and do not contain special characters or reserved keywords, so quoting is not strictly necessary in Spark SQL. The string literal `' '` used in `CONCAT_WS` is correctly quoted with single quotes.\n*   The `CONCAT_WS` function is used with the correct number of arguments (separator and two string columns).\n*   No explicit casting is used or appears to be immediately necessary.\n*   The join columns `s.school_id` and `ss.school_id` are appropriate for linking schools to their SAT scores.\n\nThe query correctly identifies the school with the highest `NumGE1500` score and retrieves the full names of its administrators.\n\n```sql\nSELECT CONCAT_WS(' ', s.administrator_first_name_1, s.administrator_last_name_1) AS administrator_1_full_name, CONCAT_WS(' ', s.administrator_first_name_2, s.administrator_last_name_2) AS administrator_2_full_name, CONCAT_WS(' ', s.administrator_first_name_3, s.administrator_last_name_3) AS administrator_3_full_name FROM schools AS s JOIN satscores AS ss ON s.school_id = ss.school_id ORDER BY ss.NumGE1500 DESC LIMIT 1\n```", "final_answer": "", "replica": 6, "timestamp": 1768939438.579641}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "execution_status": "VALID", "query_result": [["Michelle King", "", ""]], "spark_error": null, "total_time": 30.364757776260376, "spark_time": 0.14020752906799316, "translation_time": 30.224550247192383, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a5a60a61-796f-44df-847b-2f80b96a5a86'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='2b3a7435-960a-48ba-9a23-93ec3ba6f778'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='9abc75a4-1032-41eb-8268-e1addff3087f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='eeaeec7b-cbb4-4126-a814-59e38ed3cd6e'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   The data types in predicates (`T1.cds = T2.CDSCode`) are assumed to be compatible, which is standard for ID columns. `T1.NumGE1500` is correctly used for ordering.\\n*   Identifiers are properly unquoted as they are standard SQL identifiers.\\n*   String literals (e.g., `' '` in `CONCAT_WS`) are correctly quoted with single quotes, not backticks (backticks are for identifiers).\\n*   `CONCAT_WS` is used with the correct number of arguments (separator, string1, string2).\\n*   No explicit casting is used or seems immediately necessary given the typical data types for name columns.\\n*   The join columns `T1.cds` and `T2.CDSCode` are appropriate for linking SAT scores to schools.\\n\\nThe query is well-formed and follows best practices for the operations it performs.\\n\\n```sql\\nSELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='91af2d8a-03d7-4423-890b-9702156c53ce'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\"}"], "input_tokens": 6181, "output_tokens": 2993, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CONCAT_WS(\\' \\', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(\\' \\', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(\\' \\', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   The data types in predicates (`T1.cds = T2.CDSCode`) are assumed to be compatible, which is standard for ID columns. `T1.NumGE1500` is correctly used for ordering.\n*   Identifiers are properly unquoted as they are standard SQL identifiers.\n*   String literals (e.g., `' '` in `CONCAT_WS`) are correctly quoted with single quotes, not backticks (backticks are for identifiers).\n*   `CONCAT_WS` is used with the correct number of arguments (separator, string1, string2).\n*   No explicit casting is used or seems immediately necessary given the typical data types for name columns.\n*   The join columns `T1.cds` and `T2.CDSCode` are appropriate for linking SAT scores to schools.\n\nThe query is well-formed and follows best practices for the operations it performs.\n\n```sql\nSELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\n```", "final_answer": "", "replica": 7, "timestamp": 1768939469.5759268}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "execution_status": "VALID", "query_result": [["Michelle King", "", ""]], "spark_error": null, "total_time": 22.15576672554016, "spark_time": 0.1801469326019287, "translation_time": 21.975619792938232, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='19542729-b083-4896-a229-7e4304a72b84'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='b748591e-3deb-4afe-a4e5-8c23f281da1f'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='2069970b-1ad2-4502-826b-5399e8c72931'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='658dfb1a-b6d5-4519-9525-ae04a18a83e5'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   The data types in predicates (`T1.cds = T2.CDSCode`) are assumed to be compatible, which is standard for ID columns. `T1.NumGE1500` is correctly used for ordering.\\n*   Identifiers are properly unquoted as they are standard SQL identifiers.\\n*   String literals (e.g., `' '` in `CONCAT_WS`) are correctly quoted with single quotes, not backticks (backticks are for identifiers).\\n*   `CONCAT_WS` is used with the correct number of arguments (separator, string1, string2).\\n*   No explicit casting is used or seems immediately necessary given the typical data types for name columns.\\n*   The join columns `T1.cds` and `T2.CDSCode` are appropriate for linking SAT scores to schools.\\n\\nThe query is well-formed and follows best practices for the operations it performs.\\n\\n```sql\\nSELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='f69427f3-9478-4635-9f4a-015b7425d635'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\"}"], "input_tokens": 6181, "output_tokens": 2993, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CONCAT_WS(\\' \\', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(\\' \\', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(\\' \\', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   The data types in predicates (`T1.cds = T2.CDSCode`) are assumed to be compatible, which is standard for ID columns. `T1.NumGE1500` is correctly used for ordering.\n*   Identifiers are properly unquoted as they are standard SQL identifiers.\n*   String literals (e.g., `' '` in `CONCAT_WS`) are correctly quoted with single quotes, not backticks (backticks are for identifiers).\n*   `CONCAT_WS` is used with the correct number of arguments (separator, string1, string2).\n*   No explicit casting is used or seems immediately necessary given the typical data types for name columns.\n*   The join columns `T1.cds` and `T2.CDSCode` are appropriate for linking SAT scores to schools.\n\nThe query is well-formed and follows best practices for the operations it performs.\n\n```sql\nSELECT CONCAT_WS(' ', T2.AdmFName1, T2.AdmLName1) AS Administrator1, CONCAT_WS(' ', T2.AdmFName2, T2.AdmLName2) AS Administrator2, CONCAT_WS(' ', T2.AdmFName3, T2.AdmLName3) AS Administrator3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1\n```", "final_answer": "", "replica": 8, "timestamp": 1768939492.3787117}
{"query_id": 36, "provider": "google", "db": "california_schools", "nl_query": "Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500", "gold_sqlite": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT CONCAT_WS(' ', s.`AdmFName1`, s.`AdmLName1`) AS `Administrator1`, CONCAT_WS(' ', s.`AdmFName2`, s.`AdmLName2`) AS `Administrator2`, CONCAT_WS(' ', s.`AdmFName3`, s.`AdmLName3`) AS `Administrator3` FROM `satscores` AS ss JOIN `schools` AS s ON ss.`cds` = s.`CDSCode` ORDER BY ss.`NumGE1500` DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["Michelle King", "", ""]], "spark_error": null, "total_time": 39.14694595336914, "spark_time": 0.14318299293518066, "translation_time": 39.00376296043396, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='da46d715-aca9-4628-adaa-d2e01b5dcb3f'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='7761c25d-bf4f-4d13-b2d8-774c4bd08d35'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='926cbc8a-ca18-49e5-8d8d-cd8499791b8f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='b50fe778-751c-4e84-9463-494455f7263c'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(' ', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(' ', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\"}", "Observation: content='The original query is mostly correct and would likely execute successfully in Spark SQL. However, based on the specific instructions provided, particularly \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", the identifiers (table names, column names, and aliases) should ideally be enclosed in backticks (`` ` ``) for robustness and explicit clarity, even if they don\\'t strictly require it in this specific case (i.e., if they are not keywords and do not contain special characters).\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT\\n  CONCAT_WS(\\' \\', s.`AdmFName1`, s.`AdmLName1`) AS `Administrator1`,\\n  CONCAT_WS(\\' \\', s.`AdmFName2`, s.`AdmLName2`) AS `Administrator2`,\\n  CONCAT_WS(\\' \\', s.`AdmFName3`, s.`AdmLName3`) AS `Administrator3`\\nFROM `satscores` AS ss\\nJOIN `schools` AS s ON ss.`cds` = s.`CDSCode`\\nORDER BY ss.`NumGE1500` DESC\\nLIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='c18a32de-c321-4b99-a617-f73cc80bba52'", "Action: query_sql_db\nAction Input: {'query': \"SELECT CONCAT_WS(' ', s.`AdmFName1`, s.`AdmLName1`) AS `Administrator1`, CONCAT_WS(' ', s.`AdmFName2`, s.`AdmLName2`) AS `Administrator2`, CONCAT_WS(' ', s.`AdmFName3`, s.`AdmLName3`) AS `Administrator3` FROM `satscores` AS ss JOIN `schools` AS s ON ss.`cds` = s.`CDSCode` ORDER BY ss.`NumGE1500` DESC LIMIT 1;\"}"], "input_tokens": 6041, "output_tokens": 3396, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Under whose administration is the school with the highest number of students scoring 1500 or more on the SAT? Indicate their full names. full name means first name, last name; There are at most 3 administrators for each school; SAT Scores are greater or equal to 1500 refers to NumGE1500\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT CONCAT_WS(\\' \\', s.AdmFName1, s.AdmLName1) AS Administrator1, CONCAT_WS(\\' \\', s.AdmFName2, s.AdmLName2) AS Administrator2, CONCAT_WS(\\' \\', s.AdmFName3, s.AdmLName3) AS Administrator3 FROM satscores AS ss JOIN schools AS s ON ss.cds = s.CDSCode ORDER BY ss.NumGE1500 DESC LIMIT 1;\"}'}\nTool: The original query is mostly correct and would likely execute successfully in Spark SQL. However, based on the specific instructions provided, particularly \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", the identifiers (table names, column names, and aliases) should ideally be enclosed in backticks (`` ` ``) for robustness and explicit clarity, even if they don't strictly require it in this specific case (i.e., if they are not keywords and do not contain special characters).\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT\n  CONCAT_WS(' ', s.`AdmFName1`, s.`AdmLName1`) AS `Administrator1`,\n  CONCAT_WS(' ', s.`AdmFName2`, s.`AdmLName2`) AS `Administrator2`,\n  CONCAT_WS(' ', s.`AdmFName3`, s.`AdmLName3`) AS `Administrator3`\nFROM `satscores` AS ss\nJOIN `schools` AS s ON ss.`cds` = s.`CDSCode`\nORDER BY ss.`NumGE1500` DESC\nLIMIT 1;\n```", "final_answer": "", "replica": 9, "timestamp": 1768939532.2182002}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;", "execution_status": "VALID", "query_result": [["390 Monte Vista Avenue", "Costa Mesa", "92627-1495", "CA"]], "spark_error": null, "total_time": 14.751413583755493, "spark_time": 0.2510337829589844, "translation_time": 14.500379800796509, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b71c7daa-15f7-4196-a690-cd4c8bd9dab5'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='62e6d251-ea89-477b-a05e-ac79d7508121'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='e676c441-9240-491f-8b24-b0a0fdab16fc'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='c101f262-9bab-41ce-948a-815ad66122cd'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (sa.NumGE1500 / sa.NumTstTakr) ASC LIMIT 1;'}", "Observation: content=\"The query has a potential mistake regarding data type handling in the `ORDER BY` clause. If `sa.NumGE1500` and `sa.NumTstTakr` are integer types, the division `sa.NumGE1500 / sa.NumTstTakr` will perform integer division in Spark SQL, truncating any decimal part. This would lead to an incorrect ratio for sorting purposes. To ensure floating-point division and accurate sorting by the actual ratio, one of the operands should be cast to a floating-point type (e.g., `DOUBLE`).\\n\\nHere's the corrected query:\\n\\n```sql\\nSELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='cf3ac243-6ee2-49a9-9dca-cb226ea49ed7'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;'}"], "input_tokens": 5863, "output_tokens": 2116, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (sa.NumGE1500 / sa.NumTstTakr) ASC LIMIT 1;\"}'}\nTool: The query has a potential mistake regarding data type handling in the `ORDER BY` clause. If `sa.NumGE1500` and `sa.NumTstTakr` are integer types, the division `sa.NumGE1500 / sa.NumTstTakr` will perform integer division in Spark SQL, truncating any decimal part. This would lead to an incorrect ratio for sorting purposes. To ensure floating-point division and accurate sorting by the actual ratio, one of the operands should be cast to a floating-point type (e.g., `DOUBLE`).\n\nHere's the corrected query:\n\n```sql\nSELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;\n```", "final_answer": "", "replica": 0, "timestamp": 1768939547.7023747}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["220 North Kenwood", "Glendale", "91206-4209", "CA"]], "spark_error": null, "total_time": 14.35615849494934, "spark_time": 0.16304349899291992, "translation_time": 14.193114995956421, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='698a25cd-d8b9-4b1d-b8a8-91637ba09139'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='aaf2e1c2-9ba3-4285-97e8-786838b4d1fa'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1'}", "Observation: content=\"The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION when UNION ALL should have been used**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: `NumTstTakr` is compared to `0`, which is appropriate for a numeric column. The division `T1.NumGE1500 / T1.NumTstTakr` will result in a floating-point number, which is suitable for ordering.\\n*   **Properly quoting identifiers**: Column names like `Street`, `City`, `Zip`, `State`, `cds`, `CDSCode`, `NumTstTakr`, `NumGE1500` are simple identifiers and do not require backticks in Spark SQL. If they were reserved keywords or contained special characters, backticks would be necessary, but this is not the case here.\\n*   **Use `` for the in-query strings**: No in-query strings are present.\\n*   **Using the correct number of arguments for functions**: No functions are used that would have this issue.\\n*   **Casting to the correct data type**: Not explicitly needed; Spark SQL handles implicit casting for arithmetic operations like division appropriately.\\n*   **Using the proper columns for joins**: The join condition `T1.cds = T2.CDSCode` seems logical, assuming `cds` in `satscores` refers to the school's CDS code, which matches `CDSCode` in the `schools` table.\\n*   **Division by zero**: The `WHERE` clause `T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0` correctly prevents division by zero in the `ORDER BY` clause.\\n\\nThe query is robust and correctly implements the logic to find the school with the lowest ratio of students scoring 1500 or above to the total test takers.\\n\\n```sql\\nSELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='22a38e47-4152-4a00-8d7a-6b015f92e952'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1'}"], "input_tokens": 4406, "output_tokens": 2033, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION when UNION ALL should have been used**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: `NumTstTakr` is compared to `0`, which is appropriate for a numeric column. The division `T1.NumGE1500 / T1.NumTstTakr` will result in a floating-point number, which is suitable for ordering.\n*   **Properly quoting identifiers**: Column names like `Street`, `City`, `Zip`, `State`, `cds`, `CDSCode`, `NumTstTakr`, `NumGE1500` are simple identifiers and do not require backticks in Spark SQL. If they were reserved keywords or contained special characters, backticks would be necessary, but this is not the case here.\n*   **Use `` for the in-query strings**: No in-query strings are present.\n*   **Using the correct number of arguments for functions**: No functions are used that would have this issue.\n*   **Casting to the correct data type**: Not explicitly needed; Spark SQL handles implicit casting for arithmetic operations like division appropriately.\n*   **Using the proper columns for joins**: The join condition `T1.cds = T2.CDSCode` seems logical, assuming `cds` in `satscores` refers to the school's CDS code, which matches `CDSCode` in the `schools` table.\n*   **Division by zero**: The `WHERE` clause `T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0` correctly prevents division by zero in the `ORDER BY` clause.\n\nThe query is robust and correctly implements the logic to find the school with the lowest ratio of students scoring 1500 or above to the total test takers.\n\n```sql\nSELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\n```", "final_answer": "", "replica": 1, "timestamp": 1768939562.7545307}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["390 Monte Vista Avenue", "Costa Mesa", "92627-1495", "CA"]], "spark_error": null, "total_time": 13.585601568222046, "spark_time": 0.15400433540344238, "translation_time": 13.431597232818604, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='9e9f0474-d280-435e-8f2f-6a8dd8ce75d6'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='6d40189d-8785-4789-8f7f-bb76c885bc8f'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1'}", "Observation: content=\"The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used.\\n*   **UNION when UNION ALL should have been used**: Not used.\\n*   **BETWEEN for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: `NumTstTakr` is compared to `0`, which is appropriate for a numeric column. The division `T1.NumGE1500 / T1.NumTstTakr` will result in a floating-point number, which is suitable for ordering.\\n*   **Properly quoting identifiers**: Column names like `Street`, `City`, `Zip`, `State`, `cds`, `CDSCode`, `NumTstTakr`, `NumGE1500` are simple identifiers and do not require backticks in Spark SQL. If they were reserved keywords or contained special characters, backticks would be necessary, but this is not the case here.\\n*   **Use `` for the in-query strings**: No in-query strings are present.\\n*   **Using the correct number of arguments for functions**: No functions are used that would have this issue.\\n*   **Casting to the correct data type**: Not explicitly needed; Spark SQL handles implicit casting for arithmetic operations like division appropriately.\\n*   **Using the proper columns for joins**: The join condition `T1.cds = T2.CDSCode` seems logical, assuming `cds` in `satscores` refers to the school's CDS code, which matches `CDSCode` in the `schools` table.\\n*   **Division by zero**: The `WHERE` clause `T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0` correctly prevents division by zero in the `ORDER BY` clause.\\n\\nThe query is robust and correctly implements the logic to find the school with the lowest ratio of students scoring 1500 or above to the total test takers.\\n\\n```sql\\nSELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='502b617b-bf0b-4e58-8c72-a949e0691642'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1'}"], "input_tokens": 4406, "output_tokens": 2033, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be well-constructed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used.\n*   **UNION when UNION ALL should have been used**: Not used.\n*   **BETWEEN for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: `NumTstTakr` is compared to `0`, which is appropriate for a numeric column. The division `T1.NumGE1500 / T1.NumTstTakr` will result in a floating-point number, which is suitable for ordering.\n*   **Properly quoting identifiers**: Column names like `Street`, `City`, `Zip`, `State`, `cds`, `CDSCode`, `NumTstTakr`, `NumGE1500` are simple identifiers and do not require backticks in Spark SQL. If they were reserved keywords or contained special characters, backticks would be necessary, but this is not the case here.\n*   **Use `` for the in-query strings**: No in-query strings are present.\n*   **Using the correct number of arguments for functions**: No functions are used that would have this issue.\n*   **Casting to the correct data type**: Not explicitly needed; Spark SQL handles implicit casting for arithmetic operations like division appropriately.\n*   **Using the proper columns for joins**: The join condition `T1.cds = T2.CDSCode` seems logical, assuming `cds` in `satscores` refers to the school's CDS code, which matches `CDSCode` in the `schools` table.\n*   **Division by zero**: The `WHERE` clause `T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0` correctly prevents division by zero in the `ORDER BY` clause.\n\nThe query is robust and correctly implements the logic to find the school with the lowest ratio of students scoring 1500 or above to the total test takers.\n\n```sql\nSELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\n```", "final_answer": "", "replica": 2, "timestamp": 1768939576.960239}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;", "execution_status": "VALID", "query_result": [["1111 Van Ness Avenue", "Fresno", "93721-2002", "CA"]], "spark_error": null, "total_time": 18.73930263519287, "spark_time": 0.15810871124267578, "translation_time": 18.581193923950195, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='499be5ed-bb74-4199-9ecf-b42dda68e560'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores,schools'}", "Observation: content='' name='schema_sql_db' tool_call_id='2728f939-8b17-4336-a486-b4a474c0a321'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='8ffa579f-fb26-44c5-8c90-2a37a7e84715'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='94722247-6a52-4f7a-958d-4b7109357163'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (sa.NumGE1500 / sa.NumTstTakr) ASC LIMIT 1;'}", "Observation: content=\"The query has a potential mistake regarding data type handling in the `ORDER BY` clause. If `sa.NumGE1500` and `sa.NumTstTakr` are integer types, the division `sa.NumGE1500 / sa.NumTstTakr` will perform integer division in Spark SQL, truncating any decimal part. This would lead to an incorrect ratio for sorting purposes. To ensure floating-point division and accurate sorting by the actual ratio, one of the operands should be cast to a floating-point type (e.g., `DOUBLE`).\\n\\nHere's the corrected query:\\n\\n```sql\\nSELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='3eeb3cdf-bd0c-4f52-98de-4699da4d4c3d'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;'}"], "input_tokens": 5863, "output_tokens": 2109, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores,schools\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (sa.NumGE1500 / sa.NumTstTakr) ASC LIMIT 1;\"}'}\nTool: The query has a potential mistake regarding data type handling in the `ORDER BY` clause. If `sa.NumGE1500` and `sa.NumTstTakr` are integer types, the division `sa.NumGE1500 / sa.NumTstTakr` will perform integer division in Spark SQL, truncating any decimal part. This would lead to an incorrect ratio for sorting purposes. To ensure floating-point division and accurate sorting by the actual ratio, one of the operands should be cast to a floating-point type (e.g., `DOUBLE`).\n\nHere's the corrected query:\n\n```sql\nSELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;\n```", "final_answer": "", "replica": 3, "timestamp": 1768939596.4490266}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;", "execution_status": "VALID", "query_result": [["1110 West Kettleman Drive, Suite 10", "Lodi", "95240-6602", "CA"]], "spark_error": null, "total_time": 21.805720329284668, "spark_time": 0.1665339469909668, "translation_time": 21.6391863822937, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='866edde0-1728-4594-bf1d-6630a7eab60a'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='b9e6b996-1b6a-47a9-9e37-21d21cc737aa'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='66620e61-e036-47df-ab96-31c2ed3c0107'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='045087c6-7273-4c38-8601-cc8a163ef2f8'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (sa.NumGE1500 / sa.NumTstTakr) ASC LIMIT 1;'}", "Observation: content=\"The original query has a potential issue with integer division if `sa.NumGE1500` and `sa.NumTstTakr` are both integer types. In many SQL dialects, including Spark SQL (depending on version and configuration), dividing two integers results in an integer (truncating the decimal part). This can lead to incorrect ordering when calculating ratios, as multiple distinct ratios might evaluate to the same integer value (e.g., 0.1 and 0.2 both become 0).\\n\\nTo ensure accurate floating-point division for the ratio, one of the operands should be explicitly cast to a floating-point type (like `DOUBLE`).\\n\\nHere's the corrected query:\\n\\n```sql\\nSELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='d9d1f4cb-d71f-4e32-a9f4-d8877f0fa1b4'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;'}"], "input_tokens": 6024, "output_tokens": 2675, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (sa.NumGE1500 / sa.NumTstTakr) ASC LIMIT 1;\"}'}\nTool: The original query has a potential issue with integer division if `sa.NumGE1500` and `sa.NumTstTakr` are both integer types. In many SQL dialects, including Spark SQL (depending on version and configuration), dividing two integers results in an integer (truncating the decimal part). This can lead to incorrect ordering when calculating ratios, as multiple distinct ratios might evaluate to the same integer value (e.g., 0.1 and 0.2 both become 0).\n\nTo ensure accurate floating-point division for the ratio, one of the operands should be explicitly cast to a floating-point type (like `DOUBLE`).\n\nHere's the corrected query:\n\n```sql\nSELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (CAST(sa.NumGE1500 AS DOUBLE) / sa.NumTstTakr) ASC LIMIT 1;\n```", "final_answer": "", "replica": 4, "timestamp": 1768939618.897652}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT `s`.`Street`, `s`.`City`, `s`.`Zip`, `s`.`State` FROM `schools` AS `s` JOIN `satscores` AS `sa` ON `s`.`CDSCode` = `sa`.`cds` WHERE `sa`.`NumTstTakr` IS NOT NULL AND `sa`.`NumTstTakr` > 0 ORDER BY (`sa`.`NumGE1500` / `sa`.`NumTstTakr`) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["1111 Van Ness Avenue", "Fresno", "93721-2002", "CA"]], "spark_error": null, "total_time": 21.275264978408813, "spark_time": 0.19421172142028809, "translation_time": 21.081053256988525, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='7693d995-42b1-4373-9d87-29c19c2e8ffb'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='bce30521-94ce-4f17-a8fb-9b65d5f7c036'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (sa.NumGE1500 / sa.NumTstTakr) ASC LIMIT 1'}", "Observation: content='The original query has one potential area for improvement based on the provided checklist:\\n\\n*   **Properly quoting identifiers / Use ` for the in-query strings**: The instruction \"Use ` for the in-query strings\" implies that identifiers (table names, aliases, and column names) should be enclosed in backticks for robustness and to avoid potential issues with reserved keywords or special characters, even if not strictly required for simple names in Spark SQL. The original query does not use backticks for any identifiers.\\n\\nLet\\'s rewrite the query to include backticks for all identifiers.\\n\\n```sql\\nSELECT `s`.`Street`, `s`.`City`, `s`.`Zip`, `s`.`State`\\nFROM `schools` AS `s`\\nJOIN `satscores` AS `sa` ON `s`.`CDSCode` = `sa`.`cds`\\nWHERE `sa`.`NumTstTakr` IS NOT NULL AND `sa`.`NumTstTakr` > 0\\nORDER BY (`sa`.`NumGE1500` / `sa`.`NumTstTakr`) ASC\\nLIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='a99ec825-0189-4a81-8fd9-842ee7476e92'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `s`.`Street`, `s`.`City`, `s`.`Zip`, `s`.`State` FROM `schools` AS `s` JOIN `satscores` AS `sa` ON `s`.`CDSCode` = `sa`.`cds` WHERE `sa`.`NumTstTakr` IS NOT NULL AND `sa`.`NumTstTakr` > 0 ORDER BY (`sa`.`NumGE1500` / `sa`.`NumTstTakr`) ASC LIMIT 1'}"], "input_tokens": 4099, "output_tokens": 3375, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sa ON s.CDSCode = sa.cds WHERE sa.NumTstTakr IS NOT NULL AND sa.NumTstTakr > 0 ORDER BY (sa.NumGE1500 / sa.NumTstTakr) ASC LIMIT 1\"}'}\nTool: The original query has one potential area for improvement based on the provided checklist:\n\n*   **Properly quoting identifiers / Use ` for the in-query strings**: The instruction \"Use ` for the in-query strings\" implies that identifiers (table names, aliases, and column names) should be enclosed in backticks for robustness and to avoid potential issues with reserved keywords or special characters, even if not strictly required for simple names in Spark SQL. The original query does not use backticks for any identifiers.\n\nLet's rewrite the query to include backticks for all identifiers.\n\n```sql\nSELECT `s`.`Street`, `s`.`City`, `s`.`Zip`, `s`.`State`\nFROM `schools` AS `s`\nJOIN `satscores` AS `sa` ON `s`.`CDSCode` = `sa`.`cds`\nWHERE `sa`.`NumTstTakr` IS NOT NULL AND `sa`.`NumTstTakr` > 0\nORDER BY (`sa`.`NumGE1500` / `sa`.`NumTstTakr`) ASC\nLIMIT 1\n```", "final_answer": "", "replica": 5, "timestamp": 1768939640.8949156}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT `T1`.`Street`, `T1`.`City`, `T1`.`Zip`, `T1`.`State` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T2`.`NumTstTakr` IS NOT NULL AND `T2`.`NumTstTakr` != 0 ORDER BY (CAST(`T2`.`NumGE1500` AS DOUBLE) / `T2`.`NumTstTakr`) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["220 North Kenwood", "Glendale", "91206-4209", "CA"]], "spark_error": null, "total_time": 15.628996133804321, "spark_time": 0.15973210334777832, "translation_time": 15.469264030456543, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cbd51c46-01a0-4f58-900d-72bad543344c'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='d732e918-5843-4c97-8e6a-08f6feb8390f'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.Street, T1.City, T1.Zip, T1.State FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.NumTstTakr IS NOT NULL AND T2.NumTstTakr != 0 ORDER BY (T2.NumGE1500 / T2.NumTstTakr) ASC LIMIT 1'}", "Observation: content='The original query has a potential issue with integer division in the `ORDER BY` clause if `NumGE1500` and `NumTstTakr` are integer types. In Spark SQL (and many other SQL dialects), dividing two integers results in an integer, truncating any decimal part. This would lead to incorrect sorting if the ratio is a fraction. To ensure floating-point division for accurate ordering, one of the operands should be cast to a floating-point type (e.g., `DOUBLE`).\\n\\nAdditionally, the prompt specifically asks to \"Use ` for the in-query strings\", which is generally interpreted as quoting identifiers. While not strictly necessary for the simple identifiers used in the original query, it\\'s good practice and aligns with the instruction.\\n\\nHere\\'s the rewritten query addressing these points:\\n\\n```sql\\nSELECT\\n  `T1`.`Street`,\\n  `T1`.`City`,\\n  `T1`.`Zip`,\\n  `T1`.`State`\\nFROM `schools` AS `T1`\\nJOIN `satscores` AS `T2`\\n  ON `T1`.`CDSCode` = `T2`.`cds`\\nWHERE\\n  `T2`.`NumTstTakr` IS NOT NULL AND `T2`.`NumTstTakr` != 0\\nORDER BY\\n  (CAST(`T2`.`NumGE1500` AS DOUBLE) / `T2`.`NumTstTakr`) ASC\\nLIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='6521265d-c072-4866-a365-f73952582c34'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `T1`.`Street`, `T1`.`City`, `T1`.`Zip`, `T1`.`State` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T2`.`NumTstTakr` IS NOT NULL AND `T2`.`NumTstTakr` != 0 ORDER BY (CAST(`T2`.`NumGE1500` AS DOUBLE) / `T2`.`NumTstTakr`) ASC LIMIT 1'}"], "input_tokens": 4213, "output_tokens": 2756, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Street, T1.City, T1.Zip, T1.State FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.NumTstTakr IS NOT NULL AND T2.NumTstTakr != 0 ORDER BY (T2.NumGE1500 / T2.NumTstTakr) ASC LIMIT 1\"}'}\nTool: The original query has a potential issue with integer division in the `ORDER BY` clause if `NumGE1500` and `NumTstTakr` are integer types. In Spark SQL (and many other SQL dialects), dividing two integers results in an integer, truncating any decimal part. This would lead to incorrect sorting if the ratio is a fraction. To ensure floating-point division for accurate ordering, one of the operands should be cast to a floating-point type (e.g., `DOUBLE`).\n\nAdditionally, the prompt specifically asks to \"Use ` for the in-query strings\", which is generally interpreted as quoting identifiers. While not strictly necessary for the simple identifiers used in the original query, it's good practice and aligns with the instruction.\n\nHere's the rewritten query addressing these points:\n\n```sql\nSELECT\n  `T1`.`Street`,\n  `T1`.`City`,\n  `T1`.`Zip`,\n  `T1`.`State`\nFROM `schools` AS `T1`\nJOIN `satscores` AS `T2`\n  ON `T1`.`CDSCode` = `T2`.`cds`\nWHERE\n  `T2`.`NumTstTakr` IS NOT NULL AND `T2`.`NumTstTakr` != 0\nORDER BY\n  (CAST(`T2`.`NumGE1500` AS DOUBLE) / `T2`.`NumTstTakr`) ASC\nLIMIT 1\n```", "final_answer": "", "replica": 6, "timestamp": 1768939657.178508}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["1110 West Kettleman Drive, Suite 10", "Lodi", "95240-6602", "CA"]], "spark_error": null, "total_time": 17.955116987228394, "spark_time": 0.16822099685668945, "translation_time": 17.786895990371704, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='830e583c-122a-4fbd-a1e5-ec33d059ed16'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='73f6fdd4-f390-43e9-a384-d3b83ea6eb51'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1'}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **`NOT IN` with `NULL` values**: Not used.\\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\\n*   **`BETWEEN` for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The join condition `T1.cds = T2.CDSCode` assumes compatible types, which is standard for such joins. The `WHERE` clause `T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0` correctly handles potential `NULL` or zero values before division. Spark SQL typically handles division of numeric types (like integers) by promoting the result to a `DOUBLE`, so `(T1.NumGE1500 / T1.NumTstTakr)` will produce a floating-point ratio suitable for ordering.\\n*   **Properly quoting identifiers**: Column names are not quoted, which is acceptable in Spark SQL if they do not contain special characters or are not reserved keywords. Assuming standard column names, this is not a mistake.\\n*   **Use `` ` `` for the in-query strings**: Not applicable, no in-query strings are used.\\n*   **Using the correct number of arguments for functions**: No functions are used in a way that would cause this issue.\\n*   **Casting to the correct data type**: As mentioned, Spark SQL's default behavior for division of integers is to produce a `DOUBLE`, so explicit casting (e.g., `CAST(T1.NumGE1500 AS DOUBLE) / T1.NumTstTakr`) is not strictly necessary to achieve a floating-point result for the ratio. The current form is correct.\\n*   **Using the proper columns for joins**: `T1.cds = T2.CDSCode` is a logical and common join condition between a `satscores` table and a `schools` table, assuming `cds` in `satscores` refers to the school's CDS code.\\n\\nThe query is robust, especially with the explicit checks for `NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0` to prevent division by zero errors.\\n\\n```sql\\nSELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='5c003911-d40a-43a2-8bae-35452aff8148'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1'}"], "input_tokens": 4464, "output_tokens": 2782, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **`NOT IN` with `NULL` values**: Not used.\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\n*   **`BETWEEN` for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The join condition `T1.cds = T2.CDSCode` assumes compatible types, which is standard for such joins. The `WHERE` clause `T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0` correctly handles potential `NULL` or zero values before division. Spark SQL typically handles division of numeric types (like integers) by promoting the result to a `DOUBLE`, so `(T1.NumGE1500 / T1.NumTstTakr)` will produce a floating-point ratio suitable for ordering.\n*   **Properly quoting identifiers**: Column names are not quoted, which is acceptable in Spark SQL if they do not contain special characters or are not reserved keywords. Assuming standard column names, this is not a mistake.\n*   **Use `` ` `` for the in-query strings**: Not applicable, no in-query strings are used.\n*   **Using the correct number of arguments for functions**: No functions are used in a way that would cause this issue.\n*   **Casting to the correct data type**: As mentioned, Spark SQL's default behavior for division of integers is to produce a `DOUBLE`, so explicit casting (e.g., `CAST(T1.NumGE1500 AS DOUBLE) / T1.NumTstTakr`) is not strictly necessary to achieve a floating-point result for the ratio. The current form is correct.\n*   **Using the proper columns for joins**: `T1.cds = T2.CDSCode` is a logical and common join condition between a `satscores` table and a `schools` table, assuming `cds` in `satscores` refers to the school's CDS code.\n\nThe query is robust, especially with the explicit checks for `NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0` to prevent division by zero errors.\n\n```sql\nSELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr IS NOT NULL AND T1.NumTstTakr != 0 ORDER BY (T1.NumGE1500 / T1.NumTstTakr) ASC LIMIT 1\n```", "final_answer": "", "replica": 7, "timestamp": 1768939675.8851614}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.Street, T1.City, T1.Zip, T1.State FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.NumTstTakr IS NOT NULL AND T2.NumTstTakr != 0 ORDER BY (CAST(T2.NumGE1500 AS DOUBLE) / T2.NumTstTakr) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["390 Monte Vista Avenue", "Costa Mesa", "92627-1495", "CA"]], "spark_error": null, "total_time": 18.75383234024048, "spark_time": 0.17400169372558594, "translation_time": 18.579830646514893, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='41f4fdb2-330b-4c06-ac43-d866c94acfec'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='3779316c-672a-44a1-b89c-6b2251782f22'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.Street, T1.City, T1.Zip, T1.State FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.NumTstTakr IS NOT NULL AND T2.NumTstTakr != 0 ORDER BY (T2.NumGE1500 / T2.NumTstTakr) ASC LIMIT 1'}", "Observation: content=\"The query has a potential mistake related to data type handling in the `ORDER BY` clause. If `T2.NumGE1500` and `T2.NumTstTakr` are integer types, the division `(T2.NumGE1500 / T2.NumTstTakr)` will perform integer division, truncating any fractional part. This means, for example, both 1/2 and 10/100 would result in 0, which might not accurately represent the desired ratio for sorting (e.g., percentage of students). To ensure floating-point division and thus a more precise ratio for ordering, one of the operands should be cast to a floating-point type (like `DOUBLE`).\\n\\nHere's the rewritten query:\\n\\n```sql\\nSELECT T1.Street, T1.City, T1.Zip, T1.State FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.NumTstTakr IS NOT NULL AND T2.NumTstTakr != 0 ORDER BY (CAST(T2.NumGE1500 AS DOUBLE) / T2.NumTstTakr) ASC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='356bf549-a558-4338-83d3-f52c330b592b'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.Street, T1.City, T1.Zip, T1.State FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.NumTstTakr IS NOT NULL AND T2.NumTstTakr != 0 ORDER BY (CAST(T2.NumGE1500 AS DOUBLE) / T2.NumTstTakr) ASC LIMIT 1'}"], "input_tokens": 4144, "output_tokens": 2667, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Street, T1.City, T1.Zip, T1.State FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.NumTstTakr IS NOT NULL AND T2.NumTstTakr != 0 ORDER BY (T2.NumGE1500 / T2.NumTstTakr) ASC LIMIT 1\"}'}\nTool: The query has a potential mistake related to data type handling in the `ORDER BY` clause. If `T2.NumGE1500` and `T2.NumTstTakr` are integer types, the division `(T2.NumGE1500 / T2.NumTstTakr)` will perform integer division, truncating any fractional part. This means, for example, both 1/2 and 10/100 would result in 0, which might not accurately represent the desired ratio for sorting (e.g., percentage of students). To ensure floating-point division and thus a more precise ratio for ordering, one of the operands should be cast to a floating-point type (like `DOUBLE`).\n\nHere's the rewritten query:\n\n```sql\nSELECT T1.Street, T1.City, T1.Zip, T1.State FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.NumTstTakr IS NOT NULL AND T2.NumTstTakr != 0 ORDER BY (CAST(T2.NumGE1500 AS DOUBLE) / T2.NumTstTakr) ASC LIMIT 1\n```", "final_answer": "", "replica": 8, "timestamp": 1768939695.2966988}
{"query_id": 37, "provider": "google", "db": "california_schools", "nl_query": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code", "gold_sqlite": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1", "gold_spark": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS FLOAT) / T1.NumTstTakr ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE sat.NumTstTakr > 0 ORDER BY (sat.NumGE1500 / sat.NumTstTakr) ASC LIMIT 1;", "execution_status": "VALID", "query_result": [["220 North Kenwood", "Glendale", "91206-4209", "CA"]], "spark_error": null, "total_time": 17.353971004486084, "spark_time": 0.15548396110534668, "translation_time": 17.198487043380737, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='24d560b7-f03e-44d7-9819-905a817b4b22'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='0bf6d6f0-bb79-4e03-bbb6-682f3c3e55f9'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='4060bccf-702b-45d3-99da-54562a04509e'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='67d1c045-e783-4a8f-b36f-1423420adc57'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE sat.NumTstTakr > 0 ORDER BY (sat.NumGE1500 / sat.NumTstTakr) ASC LIMIT 1;'}", "Observation: content='The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULLs.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (`s.CDSCode = sat.cds`, `sat.NumTstTakr > 0`) are assumed to be compatible, which is standard for such join conditions and filters. The division `(sat.NumGE1500 / sat.NumTstTakr)` will correctly perform floating-point division in Spark SQL.\\n*   Identifiers are properly unquoted as they are not keywords and do not contain special characters.\\n*   There are no in-query strings requiring backticks.\\n*   No functions are used that could have an incorrect number of arguments.\\n*   No explicit casting is needed; implicit type promotion for division is appropriate.\\n*   The join condition `s.CDSCode = sat.cds` uses appropriate columns to link schools and SAT scores.\\n*   The `WHERE sat.NumTstTakr > 0` clause correctly prevents division by zero in the `ORDER BY` clause.\\n\\nThe query is logically sound for its stated purpose: finding the school with the lowest ratio of students scoring 1500 or higher to the total number of test takers, among schools where at least one student took the test.\\n\\n```sql\\nSELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE sat.NumTstTakr > 0 ORDER BY (sat.NumGE1500 / sat.NumTstTakr) ASC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='fb17b434-f66e-4316-b165-42dc898d395b'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE sat.NumTstTakr > 0 ORDER BY (sat.NumGE1500 / sat.NumTstTakr) ASC LIMIT 1;'}"], "input_tokens": 6148, "output_tokens": 2359, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State. Execellence Rate = NumGE1500 / NumTstTakr; complete address has Street, City, State, Zip code\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE sat.NumTstTakr > 0 ORDER BY (sat.NumGE1500 / sat.NumTstTakr) ASC LIMIT 1;\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULLs.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (`s.CDSCode = sat.cds`, `sat.NumTstTakr > 0`) are assumed to be compatible, which is standard for such join conditions and filters. The division `(sat.NumGE1500 / sat.NumTstTakr)` will correctly perform floating-point division in Spark SQL.\n*   Identifiers are properly unquoted as they are not keywords and do not contain special characters.\n*   There are no in-query strings requiring backticks.\n*   No functions are used that could have an incorrect number of arguments.\n*   No explicit casting is needed; implicit type promotion for division is appropriate.\n*   The join condition `s.CDSCode = sat.cds` uses appropriate columns to link schools and SAT scores.\n*   The `WHERE sat.NumTstTakr > 0` clause correctly prevents division by zero in the `ORDER BY` clause.\n\nThe query is logically sound for its stated purpose: finding the school with the lowest ratio of students scoring 1500 or higher to the total number of test takers, among schools where at least one student took the test.\n\n```sql\nSELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE sat.NumTstTakr > 0 ORDER BY (sat.NumGE1500 / sat.NumTstTakr) ASC LIMIT 1;\n```", "final_answer": "", "replica": 9, "timestamp": 1768939713.3426654}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 15.475133895874023, "spark_time": 0.12336540222167969, "translation_time": 15.351768493652344, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='06e5d58e-41b3-4048-a4f3-ce5944048094'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='9c01af82-649c-45a9-8a6c-e7fa5d2fd6f3'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}", "Observation: content=\"```sql\\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\\n```\" name='query_checker_sql_db' tool_call_id='5dff7401-f0ba-413f-861c-d41c2a86023d'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}"], "input_tokens": 3786, "output_tokens": 2346, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}'}\nTool: ```sql\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\n```", "final_answer": "", "replica": 0, "timestamp": 1768939729.3915434}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 27.88594937324524, "spark_time": 0.09817886352539062, "translation_time": 27.78777050971985, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='32a7d0b4-3d1a-45cc-8f2a-556869088863'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='4475e5c0-4808-496c-9a0a-da597b7d6eac'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` in SQL (and Spark SQL) is inclusive, meaning `X BETWEEN A AND B` is equivalent to `X >= A AND X <= B`. Assuming an inclusive range is intended for `NumTstTakr` (2000 to 3000), its usage is correct.\\n*   **Data type mismatch in predicates**: The comparisons (`T1.County = 'Los Angeles'`, `T2.NumTstTakr BETWEEN 2000 AND 3000`, `T1.CDSCode = T2.cds`) appear to involve compatible data types (string with string, numeric with numeric, and join keys with compatible types).\\n*   **Properly quoting identifiers**: The identifiers (`Website`, `CDSCode`, `County`, `cds`, `NumTstTakr`) are simple and do not contain special characters or reserved keywords, so they do not require explicit quoting (e.g., with backticks). String literals like `'Los Angeles'` are correctly quoted with single quotes.\\n*   **Use ` for the in-query strings**: This instruction typically refers to using backticks for identifiers that might be keywords or contain special characters. As noted above, the identifiers in this query are simple and do not require backticks. String literals are correctly enclosed in single quotes.\\n*   **Using the correct number of arguments for functions**: The query does not use any functions.\\n*   **Casting to the correct data type**: No explicit `CAST` operations are used, and implicit type coercion for the given predicates is likely handled correctly by Spark SQL.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` logically connects schools to their SAT scores using what appear to be common identifier columns.\\n\\nThe query is well-formed and follows standard SQL practices.\\n\\n```sql\\nSELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\\n```\" name='query_checker_sql_db' tool_call_id='beb59d78-5168-425e-a72d-b4a684f02ac3'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}"], "input_tokens": 4255, "output_tokens": 3106, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}'}\nTool: The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` in SQL (and Spark SQL) is inclusive, meaning `X BETWEEN A AND B` is equivalent to `X >= A AND X <= B`. Assuming an inclusive range is intended for `NumTstTakr` (2000 to 3000), its usage is correct.\n*   **Data type mismatch in predicates**: The comparisons (`T1.County = 'Los Angeles'`, `T2.NumTstTakr BETWEEN 2000 AND 3000`, `T1.CDSCode = T2.cds`) appear to involve compatible data types (string with string, numeric with numeric, and join keys with compatible types).\n*   **Properly quoting identifiers**: The identifiers (`Website`, `CDSCode`, `County`, `cds`, `NumTstTakr`) are simple and do not contain special characters or reserved keywords, so they do not require explicit quoting (e.g., with backticks). String literals like `'Los Angeles'` are correctly quoted with single quotes.\n*   **Use ` for the in-query strings**: This instruction typically refers to using backticks for identifiers that might be keywords or contain special characters. As noted above, the identifiers in this query are simple and do not require backticks. String literals are correctly enclosed in single quotes.\n*   **Using the correct number of arguments for functions**: The query does not use any functions.\n*   **Casting to the correct data type**: No explicit `CAST` operations are used, and implicit type coercion for the given predicates is likely handled correctly by Spark SQL.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` logically connects schools to their SAT scores using what appear to be common identifier columns.\n\nThe query is well-formed and follows standard SQL practices.\n\n```sql\nSELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\n```", "final_answer": "", "replica": 1, "timestamp": 1768939757.9195662}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.Website FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles County' AND T2.NumTstTakr BETWEEN 2000 AND 3000", "execution_status": "VALID", "query_result": [], "spark_error": null, "total_time": 12.299456119537354, "spark_time": 0.059911251068115234, "translation_time": 12.239544868469238, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='e22adfee-cff1-4612-9304-7e9e1ae235e5'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='b57dcaf3-a8b1-4dd7-95d2-64cdb0d36b4e'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles County' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}", "Observation: content=\"SELECT T1.Website FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles County' AND T2.NumTstTakr BETWEEN 2000 AND 3000\" name='query_checker_sql_db' tool_call_id='8fe7145d-b2c2-4a52-a056-debf123fa5c6'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles County' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}"], "input_tokens": 3770, "output_tokens": 1455, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles County\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}'}\nTool: SELECT T1.Website FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles County' AND T2.NumTstTakr BETWEEN 2000 AND 3000", "final_answer": "", "replica": 2, "timestamp": 1768939770.772512}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 14.905115842819214, "spark_time": 0.10566115379333496, "translation_time": 14.799454689025879, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a8cf178f-440b-48a4-b4a8-abf40aa33eab'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='8f526b02-b43e-421e-893d-2903fdd8631b'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}", "Observation: content=\"```sql\\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\\n```\" name='query_checker_sql_db' tool_call_id='474edc4d-11ad-4f41-be9b-3ba7117c7bbe'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}"], "input_tokens": 3786, "output_tokens": 2351, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}'}\nTool: ```sql\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\n```", "final_answer": "", "replica": 3, "timestamp": 1768939786.2519803}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 17.499730825424194, "spark_time": 0.12537240982055664, "translation_time": 17.374358415603638, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='098f515a-6614-410c-a8af-c65e52f979d5'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='31308c7c-dc09-40b4-98af-44ec5b796e70'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}", "Observation: content='The original query has a minor issue regarding the explicit instruction to \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". In Spark SQL, identifiers (table names, column names) are typically quoted with backticks (`` ` ``) if they contain special characters, spaces, or are reserved keywords. While the identifiers in the original query might not strictly *require* backticks, the instruction implies that they should be used for robustness and consistency.\\n\\nHere\\'s the rewritten query with backticks applied to all identifiers:\\n\\n```sql\\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = \\'Los Angeles\\' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\\n```' name='query_checker_sql_db' tool_call_id='8e556afa-07b2-4bde-9b9e-63c659d03fa1'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\"}"], "input_tokens": 3900, "output_tokens": 2444, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}'}\nTool: The original query has a minor issue regarding the explicit instruction to \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". In Spark SQL, identifiers (table names, column names) are typically quoted with backticks (`` ` ``) if they contain special characters, spaces, or are reserved keywords. While the identifiers in the original query might not strictly *require* backticks, the instruction implies that they should be used for robustness and consistency.\n\nHere's the rewritten query with backticks applied to all identifiers:\n\n```sql\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\n```", "final_answer": "", "replica": 4, "timestamp": 1768939804.327928}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 24.560945749282837, "spark_time": 0.09616637229919434, "translation_time": 24.464779376983643, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c1e95641-cc22-4869-adbb-8ba9bf55f29f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='749a5580-d77d-4a29-a5b2-6e2c7dea34bb'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` in SQL (and Spark SQL) is inclusive, meaning `X BETWEEN A AND B` is equivalent to `X >= A AND X <= B`. Assuming an inclusive range is intended for `NumTstTakr` (2000 to 3000), its usage is correct.\\n*   **Data type mismatch in predicates**: The comparisons (`T1.County = 'Los Angeles'`, `T2.NumTstTakr BETWEEN 2000 AND 3000`, `T1.CDSCode = T2.cds`) appear to involve compatible data types (string with string, numeric with numeric, and join keys with compatible types).\\n*   **Properly quoting identifiers**: The identifiers (`Website`, `CDSCode`, `County`, `cds`, `NumTstTakr`) are simple and do not contain special characters or reserved keywords, so they do not require explicit quoting (e.g., with backticks). String literals like `'Los Angeles'` are correctly quoted with single quotes.\\n*   **Use ` for the in-query strings**: This instruction typically refers to using backticks for identifiers that might be keywords or contain special characters. As noted above, the identifiers in this query are simple and do not require backticks. String literals are correctly enclosed in single quotes.\\n*   **Using the correct number of arguments for functions**: The query does not use any functions.\\n*   **Casting to the correct data type**: No explicit `CAST` operations are used, and implicit type coercion for the given predicates is likely handled correctly by Spark SQL.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` logically connects schools to their SAT scores using what appear to be common identifier columns.\\n\\nThe query is well-formed and follows standard SQL practices.\\n\\n```sql\\nSELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\\n```\" name='query_checker_sql_db' tool_call_id='c378fbf1-384d-4592-ae82-d0cbad4c6789'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}"], "input_tokens": 4255, "output_tokens": 3106, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}'}\nTool: The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: The query does not use `NOT IN`.\n*   **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` in SQL (and Spark SQL) is inclusive, meaning `X BETWEEN A AND B` is equivalent to `X >= A AND X <= B`. Assuming an inclusive range is intended for `NumTstTakr` (2000 to 3000), its usage is correct.\n*   **Data type mismatch in predicates**: The comparisons (`T1.County = 'Los Angeles'`, `T2.NumTstTakr BETWEEN 2000 AND 3000`, `T1.CDSCode = T2.cds`) appear to involve compatible data types (string with string, numeric with numeric, and join keys with compatible types).\n*   **Properly quoting identifiers**: The identifiers (`Website`, `CDSCode`, `County`, `cds`, `NumTstTakr`) are simple and do not contain special characters or reserved keywords, so they do not require explicit quoting (e.g., with backticks). String literals like `'Los Angeles'` are correctly quoted with single quotes.\n*   **Use ` for the in-query strings**: This instruction typically refers to using backticks for identifiers that might be keywords or contain special characters. As noted above, the identifiers in this query are simple and do not require backticks. String literals are correctly enclosed in single quotes.\n*   **Using the correct number of arguments for functions**: The query does not use any functions.\n*   **Casting to the correct data type**: No explicit `CAST` operations are used, and implicit type coercion for the given predicates is likely handled correctly by Spark SQL.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` logically connects schools to their SAT scores using what appear to be common identifier columns.\n\nThe query is well-formed and follows standard SQL practices.\n\n```sql\nSELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\n```", "final_answer": "", "replica": 5, "timestamp": 1768939829.471906}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 16.55689787864685, "spark_time": 0.1280806064605713, "translation_time": 16.42881727218628, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='6c006931-859c-4c84-bdc3-2f314a0c13e8'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='c0e45fc4-2902-4196-b4f0-b157ffef68ca'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain the common mistakes listed:\\n\\n1.  **Using NOT IN with NULL values**: The query does not use `NOT IN`.\\n2.  **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\\n3.  **Using BETWEEN for exclusive ranges**: `BETWEEN` in SQL is inclusive (`>= AND <=`). The query uses `T2.NumTstTakr BETWEEN 2000 AND 3000`, which correctly translates to `T2.NumTstTakr >= 2000 AND T2.NumTstTakr <= 3000`. If an exclusive range was intended, the query would need to be changed (e.g., `> 2000 AND < 3000`), but `BETWEEN` itself is not being used for an exclusive range.\\n4.  **Data type mismatch in predicates**:\\n    *   `T1.County = 'Los Angeles'`: `County` is likely a string, and `'Los Angeles'` is a string literal. This is fine.\\n    *   `T2.NumTstTakr BETWEEN 2000 AND 3000`: `NumTstTakr` is likely a numeric type, and `2000`, `3000` are integer literals. This is fine.\\n    *   `T1.CDSCode = T2.cds`: Assuming `CDSCode` and `cds` are compatible types (e.g., both numeric or both string), this is fine for a join condition. Spark SQL often handles implicit casting for equality if types are coercible.\\n5.  **Properly quoting identifiers**: The identifiers (`Website`, `CDSCode`, `County`, `cds`, `NumTstTakr`) are standard SQL identifiers and do not contain special characters or reserved keywords that would require quoting.\\n6.  **Use ` for the in-query strings**: String literals in SQL (including Spark SQL) are typically enclosed in single quotes (`'`). The query uses `'Los Angeles'`, which is correct for a string literal. Backticks (`` ` ``) are generally used for quoting identifiers (column names, table names) that contain special characters or are reserved keywords, not for string literals.\\n7.  **Using the correct number of arguments for functions**: The query does not use any functions.\\n8.  **Casting to the correct data type**: No explicit casting is used, and implicit casting for the predicates and join condition appears to be handled correctly by Spark SQL.\\n9.  **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` correctly links the `schools` table (aliased as `T1`) with the `satscores` table (aliased as `T2`) using what appear to be common key columns.\\n\\nThe query is well-formed and follows standard SQL practices.\\n\\n```sql\\nSELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\\n```\" name='query_checker_sql_db' tool_call_id='0861fb98-80f3-46a0-baad-624cbf0b4052'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}"], "input_tokens": 4430, "output_tokens": 2806, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain the common mistakes listed:\n\n1.  **Using NOT IN with NULL values**: The query does not use `NOT IN`.\n2.  **Using UNION when UNION ALL should have been used**: The query does not use `UNION` or `UNION ALL`.\n3.  **Using BETWEEN for exclusive ranges**: `BETWEEN` in SQL is inclusive (`>= AND <=`). The query uses `T2.NumTstTakr BETWEEN 2000 AND 3000`, which correctly translates to `T2.NumTstTakr >= 2000 AND T2.NumTstTakr <= 3000`. If an exclusive range was intended, the query would need to be changed (e.g., `> 2000 AND < 3000`), but `BETWEEN` itself is not being used for an exclusive range.\n4.  **Data type mismatch in predicates**:\n    *   `T1.County = 'Los Angeles'`: `County` is likely a string, and `'Los Angeles'` is a string literal. This is fine.\n    *   `T2.NumTstTakr BETWEEN 2000 AND 3000`: `NumTstTakr` is likely a numeric type, and `2000`, `3000` are integer literals. This is fine.\n    *   `T1.CDSCode = T2.cds`: Assuming `CDSCode` and `cds` are compatible types (e.g., both numeric or both string), this is fine for a join condition. Spark SQL often handles implicit casting for equality if types are coercible.\n5.  **Properly quoting identifiers**: The identifiers (`Website`, `CDSCode`, `County`, `cds`, `NumTstTakr`) are standard SQL identifiers and do not contain special characters or reserved keywords that would require quoting.\n6.  **Use ` for the in-query strings**: String literals in SQL (including Spark SQL) are typically enclosed in single quotes (`'`). The query uses `'Los Angeles'`, which is correct for a string literal. Backticks (`` ` ``) are generally used for quoting identifiers (column names, table names) that contain special characters or are reserved keywords, not for string literals.\n7.  **Using the correct number of arguments for functions**: The query does not use any functions.\n8.  **Casting to the correct data type**: No explicit casting is used, and implicit casting for the predicates and join condition appears to be handled correctly by Spark SQL.\n9.  **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` correctly links the `schools` table (aliased as `T1`) with the `satscores` table (aliased as `T2`) using what appear to be common key columns.\n\nThe query is well-formed and follows standard SQL practices.\n\n```sql\nSELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;\n```", "final_answer": "", "replica": 6, "timestamp": 1768939846.7980394}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 16.30126690864563, "spark_time": 0.1368870735168457, "translation_time": 16.164379835128784, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d4182e55-dcae-4207-80c4-626457026db1'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='986facc5-0f1e-4508-801c-93153c076007'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}", "Observation: content='The original query has a minor issue regarding the explicit instruction to \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". In Spark SQL, identifiers (table names, column names) are typically quoted with backticks (`` ` ``) if they contain special characters, spaces, or are reserved keywords. While the identifiers in the original query might not strictly *require* backticks, the instruction implies that they should be used for robustness and consistency.\\n\\nHere\\'s the rewritten query with backticks applied to all identifiers:\\n\\n```sql\\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = \\'Los Angeles\\' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\\n```' name='query_checker_sql_db' tool_call_id='ebd372d5-7e38-4c55-8daf-a01998dde03e'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\"}"], "input_tokens": 3900, "output_tokens": 2444, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}'}\nTool: The original query has a minor issue regarding the explicit instruction to \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". In Spark SQL, identifiers (table names, column names) are typically quoted with backticks (`` ` ``) if they contain special characters, spaces, or are reserved keywords. While the identifiers in the original query might not strictly *require* backticks, the instruction implies that they should be used for robustness and consistency.\n\nHere's the rewritten query with backticks applied to all identifiers:\n\n```sql\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\n```", "final_answer": "", "replica": 7, "timestamp": 1768939863.830303}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 15.634716749191284, "spark_time": 0.12074756622314453, "translation_time": 15.51396918296814, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a90a7da9-1e7a-4a05-976e-ea2e17fd4f46'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='3d225ccc-d8f2-4368-97c4-883ad1b76eb3'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}", "Observation: content=\"```sql\\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\\n```\" name='query_checker_sql_db' tool_call_id='4a9cc44e-3894-4128-8925-53d49c4ecd9c'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}"], "input_tokens": 3786, "output_tokens": 2346, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}'}\nTool: ```sql\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\n```", "final_answer": "", "replica": 8, "timestamp": 1768939880.0630171}
{"query_id": 38, "provider": "google", "db": "california_schools", "nl_query": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? ", "gold_sqlite": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "gold_spark": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000", "execution_status": "VALID", "query_result": [["www.avdistrict.org"], ["www.lbschools.net"], ["www.hartdistrict.org"]], "spark_error": null, "total_time": 17.12016201019287, "spark_time": 0.14603018760681152, "translation_time": 16.97413182258606, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='af64a24a-2d2b-40b4-937c-f5df27d1ba7d'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='d138dc78-419d-4829-948b-40135a63fa07'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}", "Observation: content=\"```sql\\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\\n```\" name='query_checker_sql_db' tool_call_id='6f748e3e-9d6f-4774-b36c-77872ab802d0'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}"], "input_tokens": 3786, "output_tokens": 2346, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Website FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.County = \\'Los Angeles\\' AND T2.NumTstTakr BETWEEN 2000 AND 3000\"}'}\nTool: ```sql\nSELECT T1.`Website` FROM `schools` AS T1 INNER JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`County` = 'Los Angeles' AND T2.`NumTstTakr` BETWEEN 2000 AND 3000\n```", "final_answer": "", "replica": 9, "timestamp": 1768939897.773176}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 42.03162431716919, "spark_time": 0.3030669689178467, "translation_time": 41.72855734825134, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cd2f35ab-327a-435b-9251-732a49ecbec2'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='dcfe8d13-a4da-4759-bcfb-d2be155a28c0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content='The provided Spark SQL query has a couple of potential issues based on common mistakes and best practices:\\n\\n1.  **Properly quoting identifiers:** While not strictly necessary for simple alphanumeric column names, it\\'s a best practice in Spark SQL to quote all identifiers (table names, column names) with backticks (`` ` ``) to avoid conflicts with reserved keywords or special characters. The prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which is usually interpreted as identifiers).\\n2.  **Incorrect function for date extraction / Data type mismatch:** The `SUBSTRING(T1.OpenDate, 7, 4)` function call assumes `T1.OpenDate` is a string in a specific format (e.g., \\'MM/DD/YYYY\\' or \\'DD-MM-YYYY\\'). If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common for a column named `OpenDate`), then `SUBSTRING` would implicitly cast it to a string (often \\'YYYY-MM-DD\\' format), and `SUBSTRING(..., 7, 4)` would extract an incorrect part of the date (e.g., \\'M-DD\\' from \\'YYYY-MM-DD\\'). The correct and more robust way to extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL is to use the `YEAR()` function. This also allows for a direct integer comparison (`= 1980`) instead of a string comparison.\\n\\nAssuming `T1.OpenDate` is intended to be a `DATE` or `TIMESTAMP` type, or at least should be treated as such for robust year extraction, the query should be rewritten.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.`NumTstTakr`)\\nFROM `schools` AS T1\\nJOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds`\\nWHERE T1.`City` = \\'Fresno\\' AND YEAR(T1.`OpenDate`) = 1980\\n```' name='query_checker_sql_db' tool_call_id='aa1575ce-c172-4ad3-a05e-a4760e607815'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULLs.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (`T1.`City` = 'Fresno'`, `YEAR(...) = 1980`) are correctly handled. `CAST(T1.`OpenDate` AS DATE)` correctly converts `OpenDate` to a `DATE` type before extracting the year.\\n*   Identifiers (`T1.`CDSCode``, `T2.`cds``, etc.) are properly quoted using backticks (` `).\\n*   String literals (`'Fresno'`) use single quotes, which is correct.\\n*   Functions (`AVG`, `YEAR`, `CAST`) are used with the correct number of arguments.\\n*   Casting (`CAST(T1.`OpenDate` AS DATE)`) is appropriate for the operation.\\n*   The join condition (`T1.`CDSCode` = T2.`cds``) uses columns that are logically expected to link schools to their SAT scores.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\\n```\" name='query_checker_sql_db' tool_call_id='2fa5d0ac-d1a1-4f79-8889-206e54738dd5'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}"], "input_tokens": 6597, "output_tokens": 6950, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The provided Spark SQL query has a couple of potential issues based on common mistakes and best practices:\n\n1.  **Properly quoting identifiers:** While not strictly necessary for simple alphanumeric column names, it's a best practice in Spark SQL to quote all identifiers (table names, column names) with backticks (`` ` ``) to avoid conflicts with reserved keywords or special characters. The prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which is usually interpreted as identifiers).\n2.  **Incorrect function for date extraction / Data type mismatch:** The `SUBSTRING(T1.OpenDate, 7, 4)` function call assumes `T1.OpenDate` is a string in a specific format (e.g., 'MM/DD/YYYY' or 'DD-MM-YYYY'). If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common for a column named `OpenDate`), then `SUBSTRING` would implicitly cast it to a string (often 'YYYY-MM-DD' format), and `SUBSTRING(..., 7, 4)` would extract an incorrect part of the date (e.g., 'M-DD' from 'YYYY-MM-DD'). The correct and more robust way to extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL is to use the `YEAR()` function. This also allows for a direct integer comparison (`= 1980`) instead of a string comparison.\n\nAssuming `T1.OpenDate` is intended to be a `DATE` or `TIMESTAMP` type, or at least should be treated as such for robust year extraction, the query should be rewritten.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.`NumTstTakr`)\nFROM `schools` AS T1\nJOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds`\nWHERE T1.`City` = 'Fresno' AND YEAR(T1.`OpenDate`) = 1980\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = \\'Fresno\\' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULLs.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (`T1.`City` = 'Fresno'`, `YEAR(...) = 1980`) are correctly handled. `CAST(T1.`OpenDate` AS DATE)` correctly converts `OpenDate` to a `DATE` type before extracting the year.\n*   Identifiers (`T1.`CDSCode``, `T2.`cds``, etc.) are properly quoted using backticks (` `).\n*   String literals (`'Fresno'`) use single quotes, which is correct.\n*   Functions (`AVG`, `YEAR`, `CAST`) are used with the correct number of arguments.\n*   Casting (`CAST(T1.`OpenDate` AS DATE)`) is appropriate for the operation.\n*   The join condition (`T1.`CDSCode` = T2.`cds``) uses columns that are logically expected to link schools to their SAT scores.\n\nThe query is correct as written.\n\n```sql\nSELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\n```", "final_answer": "", "replica": 0, "timestamp": 1768939940.5278306}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 23.636162042617798, "spark_time": 0.14748716354370117, "translation_time": 23.488674879074097, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='2b6644b0-5ab1-4a9e-a9ce-18578fde462f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='11d1c934-907a-4029-b494-0a39cf6f95dd'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content=\"The query has a potential mistake related to extracting the year from the `OpenDate` column.\\n\\n**Mistake:**\\n*   **Data type mismatch/Incorrect function usage for date extraction**: The expression `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` assumes that `T1.OpenDate` is a string column formatted as `MM/DD/YYYY`. If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common and best practice for date columns), then `SUBSTRING` would first implicitly cast the date to a string (usually in `YYYY-MM-DD` format in Spark SQL). In that case, `SUBSTRING('YYYY-MM-DD', 7, 4)` would extract 'MM-D', not the year 'YYYY'. This would lead to incorrect filtering or an error.\\n\\n**Correction:**\\nTo correctly extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL, the `YEAR()` function should be used. If `OpenDate` is indeed a string in `MM/DD/YYYY` format, it's still more robust to cast it to a date first or use `DATE_FORMAT`. However, assuming `OpenDate` is a `DATE` type (as its name suggests and is good practice), `YEAR(T1.OpenDate) = 1980` is the correct and robust way to filter by year.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\\n```\" name='query_checker_sql_db' tool_call_id='2d2aeb4a-8341-4edf-a2ec-d1e3af3916d6'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}"], "input_tokens": 4278, "output_tokens": 4093, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The query has a potential mistake related to extracting the year from the `OpenDate` column.\n\n**Mistake:**\n*   **Data type mismatch/Incorrect function usage for date extraction**: The expression `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` assumes that `T1.OpenDate` is a string column formatted as `MM/DD/YYYY`. If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common and best practice for date columns), then `SUBSTRING` would first implicitly cast the date to a string (usually in `YYYY-MM-DD` format in Spark SQL). In that case, `SUBSTRING('YYYY-MM-DD', 7, 4)` would extract 'MM-D', not the year 'YYYY'. This would lead to incorrect filtering or an error.\n\n**Correction:**\nTo correctly extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL, the `YEAR()` function should be used. If `OpenDate` is indeed a string in `MM/DD/YYYY` format, it's still more robust to cast it to a date first or use `DATE_FORMAT`. However, assuming `OpenDate` is a `DATE` type (as its name suggests and is good practice), `YEAR(T1.OpenDate) = 1980` is the correct and robust way to filter by year.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```", "final_answer": "", "replica": 1, "timestamp": 1768939964.863399}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 42.135714530944824, "spark_time": 0.13344120979309082, "translation_time": 42.00227332115173, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0afaa35a-4189-4124-bb53-f19c74b3470b'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='2dd799ad-88bb-4e2a-b2e5-62e4acd78b84'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content='The provided Spark SQL query has a couple of potential issues based on common mistakes and best practices:\\n\\n1.  **Properly quoting identifiers:** While not strictly necessary for simple alphanumeric column names, it\\'s a best practice in Spark SQL to quote all identifiers (table names, column names) with backticks (`` ` ``) to avoid conflicts with reserved keywords or special characters. The prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which is usually interpreted as identifiers).\\n2.  **Incorrect function for date extraction / Data type mismatch:** The `SUBSTRING(T1.OpenDate, 7, 4)` function call assumes `T1.OpenDate` is a string in a specific format (e.g., \\'MM/DD/YYYY\\' or \\'DD-MM-YYYY\\'). If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common for a column named `OpenDate`), then `SUBSTRING` would implicitly cast it to a string (often \\'YYYY-MM-DD\\' format), and `SUBSTRING(..., 7, 4)` would extract an incorrect part of the date (e.g., \\'M-DD\\' from \\'YYYY-MM-DD\\'). The correct and more robust way to extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL is to use the `YEAR()` function. This also allows for a direct integer comparison (`= 1980`) instead of a string comparison.\\n\\nAssuming `T1.OpenDate` is intended to be a `DATE` or `TIMESTAMP` type, or at least should be treated as such for robust year extraction, the query should be rewritten.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.`NumTstTakr`)\\nFROM `schools` AS T1\\nJOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds`\\nWHERE T1.`City` = \\'Fresno\\' AND YEAR(T1.`OpenDate`) = 1980\\n```' name='query_checker_sql_db' tool_call_id='ab22d13c-689e-41da-aef9-4a34a5185e80'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**:\\n    *   `T1.`City` = 'Fresno'` is a string comparison, which is correct.\\n    *   `YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980` correctly casts `OpenDate` to a `DATE` type, extracts the year as an integer, and compares it to an integer literal. This is correct.\\n    *   The join condition `T1.`CDSCode` = T2.`cds`` assumes `CDSCode` and `cds` are compatible types (e.g., both integers or both strings), which is a standard practice for join keys.\\n*   **Properly quoting identifiers**: All table and column identifiers (`T1.`CDSCode``, `T2.`cds``, `T1.`City``, `T1.`OpenDate``, `T2.`NumTstTakr``) are correctly quoted using backticks (` `), which is standard for Spark SQL.\\n*   **Use `` for the in-query strings**: String literals like `'Fresno'` are correctly enclosed in single quotes (`'`). Backticks are for identifiers, not string literals. This usage is correct SQL.\\n*   **Using the correct number of arguments for functions**: `AVG()`, `YEAR()`, and `CAST()` are all used with the correct number of arguments.\\n*   **Casting to the correct data type**: `CAST(T1.`OpenDate` AS DATE)` is an appropriate cast to ensure the `YEAR` function operates on a date type, especially if `OpenDate` might be a string or a timestamp.\\n*   **Using the proper columns for joins**: `T1.`CDSCode` = T2.`cds`` is a logical join condition between a `schools` table and an `satscores` table, assuming these columns represent the school identifier.\\n\\nThe query is well-formed and follows best practices for Spark SQL.\\n\\n```sql\\nSELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\\n```\" name='query_checker_sql_db' tool_call_id='2d674233-c8c3-4c76-a6ea-880552078fcc'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}"], "input_tokens": 6844, "output_tokens": 7497, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The provided Spark SQL query has a couple of potential issues based on common mistakes and best practices:\n\n1.  **Properly quoting identifiers:** While not strictly necessary for simple alphanumeric column names, it's a best practice in Spark SQL to quote all identifiers (table names, column names) with backticks (`` ` ``) to avoid conflicts with reserved keywords or special characters. The prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which is usually interpreted as identifiers).\n2.  **Incorrect function for date extraction / Data type mismatch:** The `SUBSTRING(T1.OpenDate, 7, 4)` function call assumes `T1.OpenDate` is a string in a specific format (e.g., 'MM/DD/YYYY' or 'DD-MM-YYYY'). If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common for a column named `OpenDate`), then `SUBSTRING` would implicitly cast it to a string (often 'YYYY-MM-DD' format), and `SUBSTRING(..., 7, 4)` would extract an incorrect part of the date (e.g., 'M-DD' from 'YYYY-MM-DD'). The correct and more robust way to extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL is to use the `YEAR()` function. This also allows for a direct integer comparison (`= 1980`) instead of a string comparison.\n\nAssuming `T1.OpenDate` is intended to be a `DATE` or `TIMESTAMP` type, or at least should be treated as such for robust year extraction, the query should be rewritten.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.`NumTstTakr`)\nFROM `schools` AS T1\nJOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds`\nWHERE T1.`City` = 'Fresno' AND YEAR(T1.`OpenDate`) = 1980\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = \\'Fresno\\' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**:\n    *   `T1.`City` = 'Fresno'` is a string comparison, which is correct.\n    *   `YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980` correctly casts `OpenDate` to a `DATE` type, extracts the year as an integer, and compares it to an integer literal. This is correct.\n    *   The join condition `T1.`CDSCode` = T2.`cds`` assumes `CDSCode` and `cds` are compatible types (e.g., both integers or both strings), which is a standard practice for join keys.\n*   **Properly quoting identifiers**: All table and column identifiers (`T1.`CDSCode``, `T2.`cds``, `T1.`City``, `T1.`OpenDate``, `T2.`NumTstTakr``) are correctly quoted using backticks (` `), which is standard for Spark SQL.\n*   **Use `` for the in-query strings**: String literals like `'Fresno'` are correctly enclosed in single quotes (`'`). Backticks are for identifiers, not string literals. This usage is correct SQL.\n*   **Using the correct number of arguments for functions**: `AVG()`, `YEAR()`, and `CAST()` are all used with the correct number of arguments.\n*   **Casting to the correct data type**: `CAST(T1.`OpenDate` AS DATE)` is an appropriate cast to ensure the `YEAR` function operates on a date type, especially if `OpenDate` might be a string or a timestamp.\n*   **Using the proper columns for joins**: `T1.`CDSCode` = T2.`cds`` is a logical join condition between a `schools` table and an `satscores` table, assuming these columns represent the school identifier.\n\nThe query is well-formed and follows best practices for Spark SQL.\n\n```sql\nSELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\n```", "final_answer": "", "replica": 2, "timestamp": 1768940007.6361728}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 39.31859517097473, "spark_time": 0.14087986946105957, "translation_time": 39.17771530151367, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a660244e-6c8e-44ae-b648-d6a28e137d1c'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='88d6465c-ec28-48cc-b2bb-aba1feb83aea'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content='The original query has a potential mistake related to data type handling and string manipulation for the `OpenDate` column.\\n\\n**Mistake:**\\nThe condition `SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'` is problematic if `T1.OpenDate` is a `DATE` type (which is common for an \"OpenDate\" column).\\n1.  If `T1.OpenDate` is a `DATE` type, Spark SQL will implicitly cast it to a string before applying `SUBSTRING`. The default string format for dates in Spark is typically \\'YYYY-MM-DD\\'.\\n2.  If `OpenDate` is \\'1980-01-15\\', casting it to string yields \\'1980-01-15\\'.\\n3.  `SUBSTRING(\\'1980-01-15\\', 7, 4)` would extract \\'01-1\\' (starting at the 7th character, for a length of 4). This will not match `\\'1980\\'`.\\nTherefore, if `T1.OpenDate` is a `DATE` type, this condition will incorrectly filter out all rows, or at least not filter them as intended.\\n\\nIf `T1.OpenDate` is a `STRING` type, this condition *could* be correct, but only if the string format is \\'MM/DD/YYYY\\' (where the year starts at position 7). If it\\'s \\'YYYY-MM-DD\\', the year starts at position 1, and the `SUBSTRING` arguments would be wrong. Relying on specific string formats with `SUBSTRING` for dates is generally fragile.\\n\\n**Correction:**\\nThe most robust and standard way to extract the year from a `DATE` type in Spark SQL is to use the `YEAR()` function. If `OpenDate` is a `DATE` type, `YEAR(T1.OpenDate)` will return an integer representing the year. This should then be compared with an integer.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND YEAR(T1.OpenDate) = 1980\\n```' name='query_checker_sql_db' tool_call_id='a5eda21f-d398-459b-9992-e2969b69c856'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\\n```\" name='query_checker_sql_db' tool_call_id='8017b39c-dcea-4462-8c42-2814efe68f27'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}"], "input_tokens": 6463, "output_tokens": 5827, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The original query has a potential mistake related to data type handling and string manipulation for the `OpenDate` column.\n\n**Mistake:**\nThe condition `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` is problematic if `T1.OpenDate` is a `DATE` type (which is common for an \"OpenDate\" column).\n1.  If `T1.OpenDate` is a `DATE` type, Spark SQL will implicitly cast it to a string before applying `SUBSTRING`. The default string format for dates in Spark is typically 'YYYY-MM-DD'.\n2.  If `OpenDate` is '1980-01-15', casting it to string yields '1980-01-15'.\n3.  `SUBSTRING('1980-01-15', 7, 4)` would extract '01-1' (starting at the 7th character, for a length of 4). This will not match `'1980'`.\nTherefore, if `T1.OpenDate` is a `DATE` type, this condition will incorrectly filter out all rows, or at least not filter them as intended.\n\nIf `T1.OpenDate` is a `STRING` type, this condition *could* be correct, but only if the string format is 'MM/DD/YYYY' (where the year starts at position 7). If it's 'YYYY-MM-DD', the year starts at position 1, and the `SUBSTRING` arguments would be wrong. Relying on specific string formats with `SUBSTRING` for dates is generally fragile.\n\n**Correction:**\nThe most robust and standard way to extract the year from a `DATE` type in Spark SQL is to use the `YEAR()` function. If `OpenDate` is a `DATE` type, `YEAR(T1.OpenDate)` will return an integer representing the year. This should then be compared with an integer.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND YEAR(T1.OpenDate) = 1980\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```", "final_answer": "", "replica": 3, "timestamp": 1768940047.6280918}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 37.788082122802734, "spark_time": 0.14698076248168945, "translation_time": 37.641101360321045, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='de2cacb7-e9f4-4231-842b-f1f0ad404d85'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='034cfaa1-9b39-45ff-ade0-6840002d1115'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content='The original query has a potential mistake related to data type handling and string manipulation for the `OpenDate` column.\\n\\n**Mistake:**\\nThe condition `SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'` is problematic if `T1.OpenDate` is a `DATE` type (which is common for an \"OpenDate\" column).\\n1.  If `T1.OpenDate` is a `DATE` type, Spark SQL will implicitly cast it to a string before applying `SUBSTRING`. The default string format for dates in Spark is typically \\'YYYY-MM-DD\\'.\\n2.  If `OpenDate` is \\'1980-01-15\\', casting it to string yields \\'1980-01-15\\'.\\n3.  `SUBSTRING(\\'1980-01-15\\', 7, 4)` would extract \\'01-1\\' (starting at the 7th character, for a length of 4). This will not match `\\'1980\\'`.\\nTherefore, if `T1.OpenDate` is a `DATE` type, this condition will incorrectly filter out all rows, or at least not filter them as intended.\\n\\nIf `T1.OpenDate` is a `STRING` type, this condition *could* be correct, but only if the string format is \\'MM/DD/YYYY\\' (where the year starts at position 7). If it\\'s \\'YYYY-MM-DD\\', the year starts at position 1, and the `SUBSTRING` arguments would be wrong. Relying on specific string formats with `SUBSTRING` for dates is generally fragile.\\n\\n**Correction:**\\nThe most robust and standard way to extract the year from a `DATE` type in Spark SQL is to use the `YEAR()` function. If `OpenDate` is a `DATE` type, `YEAR(T1.OpenDate)` will return an integer representing the year. This should then be compared with an integer.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND YEAR(T1.OpenDate) = 1980\\n```' name='query_checker_sql_db' tool_call_id='c457491a-1a53-4312-81bd-c761b2cf5a5c'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\\n```\" name='query_checker_sql_db' tool_call_id='c2b0e953-9f72-4fbb-9a44-ad75415fcaff'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}"], "input_tokens": 6463, "output_tokens": 5986, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The original query has a potential mistake related to data type handling and string manipulation for the `OpenDate` column.\n\n**Mistake:**\nThe condition `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` is problematic if `T1.OpenDate` is a `DATE` type (which is common for an \"OpenDate\" column).\n1.  If `T1.OpenDate` is a `DATE` type, Spark SQL will implicitly cast it to a string before applying `SUBSTRING`. The default string format for dates in Spark is typically 'YYYY-MM-DD'.\n2.  If `OpenDate` is '1980-01-15', casting it to string yields '1980-01-15'.\n3.  `SUBSTRING('1980-01-15', 7, 4)` would extract '01-1' (starting at the 7th character, for a length of 4). This will not match `'1980'`.\nTherefore, if `T1.OpenDate` is a `DATE` type, this condition will incorrectly filter out all rows, or at least not filter them as intended.\n\nIf `T1.OpenDate` is a `STRING` type, this condition *could* be correct, but only if the string format is 'MM/DD/YYYY' (where the year starts at position 7). If it's 'YYYY-MM-DD', the year starts at position 1, and the `SUBSTRING` arguments would be wrong. Relying on specific string formats with `SUBSTRING` for dates is generally fragile.\n\n**Correction:**\nThe most robust and standard way to extract the year from a `DATE` type in Spark SQL is to use the `YEAR()` function. If `OpenDate` is a `DATE` type, `YEAR(T1.OpenDate)` will return an integer representing the year. This should then be compared with an integer.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND YEAR(T1.OpenDate) = 1980\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```", "final_answer": "", "replica": 4, "timestamp": 1768940086.0192716}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 34.854976654052734, "spark_time": 0.162001371383667, "translation_time": 34.69297528266907, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a979b450-6647-4247-98c4-1118b7fdf97b'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='5fd7675a-94ff-4e8a-8bba-383a4ab421a8'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content=\"The query has a potential mistake related to extracting the year from the `OpenDate` column.\\n\\n**Mistake:**\\n*   **Data type mismatch/Incorrect function usage for date extraction**: The expression `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` assumes that `T1.OpenDate` is a string column formatted as `MM/DD/YYYY`. If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common and best practice for date columns), then `SUBSTRING` would first implicitly cast the date to a string (usually in `YYYY-MM-DD` format in Spark SQL). In that case, `SUBSTRING('YYYY-MM-DD', 7, 4)` would extract 'MM-D', not the year 'YYYY'. This would lead to incorrect filtering or an error.\\n\\n**Correction:**\\nTo correctly extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL, the `YEAR()` function should be used. If `OpenDate` is indeed a string in `MM/DD/YYYY` format, it's still more robust to cast it to a date first or use `DATE_FORMAT`. However, assuming `OpenDate` is a `DATE` type (as its name suggests and is good practice), `YEAR(T1.OpenDate) = 1980` is the correct and robust way to filter by year.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\\n```\" name='query_checker_sql_db' tool_call_id='1a949429-bc97-4454-b4d1-1f85b54eb2f7'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}"], "input_tokens": 4278, "output_tokens": 3957, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The query has a potential mistake related to extracting the year from the `OpenDate` column.\n\n**Mistake:**\n*   **Data type mismatch/Incorrect function usage for date extraction**: The expression `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` assumes that `T1.OpenDate` is a string column formatted as `MM/DD/YYYY`. If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common and best practice for date columns), then `SUBSTRING` would first implicitly cast the date to a string (usually in `YYYY-MM-DD` format in Spark SQL). In that case, `SUBSTRING('YYYY-MM-DD', 7, 4)` would extract 'MM-D', not the year 'YYYY'. This would lead to incorrect filtering or an error.\n\n**Correction:**\nTo correctly extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL, the `YEAR()` function should be used. If `OpenDate` is indeed a string in `MM/DD/YYYY` format, it's still more robust to cast it to a date first or use `DATE_FORMAT`. However, assuming `OpenDate` is a `DATE` type (as its name suggests and is good practice), `YEAR(T1.OpenDate) = 1980` is the correct and robust way to filter by year.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```", "final_answer": "", "replica": 5, "timestamp": 1768940121.5346856}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 44.04352283477783, "spark_time": 0.1265089511871338, "translation_time": 43.9170138835907, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c1c0df24-f389-4d44-95f8-813424a6c04b'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='cc422a75-4b21-4849-8a46-1c47b9169e74'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content='The provided Spark SQL query has a couple of potential issues based on common mistakes and best practices:\\n\\n1.  **Properly quoting identifiers:** While not strictly necessary for simple alphanumeric column names, it\\'s a best practice in Spark SQL to quote all identifiers (table names, column names) with backticks (`` ` ``) to avoid conflicts with reserved keywords or special characters. The prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which is usually interpreted as identifiers).\\n2.  **Incorrect function for date extraction / Data type mismatch:** The `SUBSTRING(T1.OpenDate, 7, 4)` function call assumes `T1.OpenDate` is a string in a specific format (e.g., \\'MM/DD/YYYY\\' or \\'DD-MM-YYYY\\'). If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common for a column named `OpenDate`), then `SUBSTRING` would implicitly cast it to a string (often \\'YYYY-MM-DD\\' format), and `SUBSTRING(..., 7, 4)` would extract an incorrect part of the date (e.g., \\'M-DD\\' from \\'YYYY-MM-DD\\'). The correct and more robust way to extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL is to use the `YEAR()` function. This also allows for a direct integer comparison (`= 1980`) instead of a string comparison.\\n\\nAssuming `T1.OpenDate` is intended to be a `DATE` or `TIMESTAMP` type, or at least should be treated as such for robust year extraction, the query should be rewritten.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.`NumTstTakr`)\\nFROM `schools` AS T1\\nJOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds`\\nWHERE T1.`City` = \\'Fresno\\' AND YEAR(T1.`OpenDate`) = 1980\\n```' name='query_checker_sql_db' tool_call_id='68270d11-5608-476e-a2aa-11043f76ff4f'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULLs.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (`T1.`City` = 'Fresno'`, `YEAR(...) = 1980`) are correctly handled. `CAST(T1.`OpenDate` AS DATE)` correctly converts `OpenDate` to a `DATE` type before extracting the year.\\n*   Identifiers (`T1.`CDSCode``, `T2.`cds``, etc.) are properly quoted using backticks (` `).\\n*   String literals (`'Fresno'`) use single quotes, which is correct.\\n*   Functions (`AVG`, `YEAR`, `CAST`) are used with the correct number of arguments.\\n*   Casting (`CAST(T1.`OpenDate` AS DATE)`) is appropriate for the operation.\\n*   The join condition (`T1.`CDSCode` = T2.`cds``) uses columns that are logically expected to link schools to their SAT scores.\\n\\nThe query is correct as written.\\n\\n```sql\\nSELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\\n```\" name='query_checker_sql_db' tool_call_id='cfff6699-d30e-4273-b8f8-9e68d58e9c23'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}"], "input_tokens": 6597, "output_tokens": 6833, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The provided Spark SQL query has a couple of potential issues based on common mistakes and best practices:\n\n1.  **Properly quoting identifiers:** While not strictly necessary for simple alphanumeric column names, it's a best practice in Spark SQL to quote all identifiers (table names, column names) with backticks (`` ` ``) to avoid conflicts with reserved keywords or special characters. The prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which is usually interpreted as identifiers).\n2.  **Incorrect function for date extraction / Data type mismatch:** The `SUBSTRING(T1.OpenDate, 7, 4)` function call assumes `T1.OpenDate` is a string in a specific format (e.g., 'MM/DD/YYYY' or 'DD-MM-YYYY'). If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common for a column named `OpenDate`), then `SUBSTRING` would implicitly cast it to a string (often 'YYYY-MM-DD' format), and `SUBSTRING(..., 7, 4)` would extract an incorrect part of the date (e.g., 'M-DD' from 'YYYY-MM-DD'). The correct and more robust way to extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL is to use the `YEAR()` function. This also allows for a direct integer comparison (`= 1980`) instead of a string comparison.\n\nAssuming `T1.OpenDate` is intended to be a `DATE` or `TIMESTAMP` type, or at least should be treated as such for robust year extraction, the query should be rewritten.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.`NumTstTakr`)\nFROM `schools` AS T1\nJOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds`\nWHERE T1.`City` = 'Fresno' AND YEAR(T1.`OpenDate`) = 1980\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = \\'Fresno\\' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULLs.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (`T1.`City` = 'Fresno'`, `YEAR(...) = 1980`) are correctly handled. `CAST(T1.`OpenDate` AS DATE)` correctly converts `OpenDate` to a `DATE` type before extracting the year.\n*   Identifiers (`T1.`CDSCode``, `T2.`cds``, etc.) are properly quoted using backticks (` `).\n*   String literals (`'Fresno'`) use single quotes, which is correct.\n*   Functions (`AVG`, `YEAR`, `CAST`) are used with the correct number of arguments.\n*   Casting (`CAST(T1.`OpenDate` AS DATE)`) is appropriate for the operation.\n*   The join condition (`T1.`CDSCode` = T2.`cds``) uses columns that are logically expected to link schools to their SAT scores.\n\nThe query is correct as written.\n\n```sql\nSELECT AVG(T2.`NumTstTakr`) FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`City` = 'Fresno' AND YEAR(CAST(T1.`OpenDate` AS DATE)) = 1980\n```", "final_answer": "", "replica": 6, "timestamp": 1768940166.390961}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 41.27789568901062, "spark_time": 0.13552331924438477, "translation_time": 41.142372369766235, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='3bd81199-3596-45dc-8f9d-2f16e47d4362'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='4f33d053-c745-4529-aaca-1e28d0e181fb'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content='The original query has a potential mistake related to data type handling and string manipulation for the `OpenDate` column.\\n\\n**Mistake:**\\nThe condition `SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'` is problematic if `T1.OpenDate` is a `DATE` type (which is common for an \"OpenDate\" column).\\n1.  If `T1.OpenDate` is a `DATE` type, Spark SQL will implicitly cast it to a string before applying `SUBSTRING`. The default string format for dates in Spark is typically \\'YYYY-MM-DD\\'.\\n2.  If `OpenDate` is \\'1980-01-15\\', casting it to string yields \\'1980-01-15\\'.\\n3.  `SUBSTRING(\\'1980-01-15\\', 7, 4)` would extract \\'01-1\\' (starting at the 7th character, for a length of 4). This will not match `\\'1980\\'`.\\nTherefore, if `T1.OpenDate` is a `DATE` type, this condition will incorrectly filter out all rows, or at least not filter them as intended.\\n\\nIf `T1.OpenDate` is a `STRING` type, this condition *could* be correct, but only if the string format is \\'MM/DD/YYYY\\' (where the year starts at position 7). If it\\'s \\'YYYY-MM-DD\\', the year starts at position 1, and the `SUBSTRING` arguments would be wrong. Relying on specific string formats with `SUBSTRING` for dates is generally fragile.\\n\\n**Correction:**\\nThe most robust and standard way to extract the year from a `DATE` type in Spark SQL is to use the `YEAR()` function. If `OpenDate` is a `DATE` type, `YEAR(T1.OpenDate)` will return an integer representing the year. This should then be compared with an integer.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND YEAR(T1.OpenDate) = 1980\\n```' name='query_checker_sql_db' tool_call_id='19e98b32-4c1a-4335-ae5c-19c6f3b32e73'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}", "Observation: content='The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION` or `UNION ALL`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (`T1.City = \\'Fresno\\'`, `YEAR(T1.OpenDate) = 1980`) seem compatible. `YEAR()` extracts an integer, which is compared to an integer.\\n*   Identifiers (`CDSCode`, `NumTstTakr`, `City`, `OpenDate`, `cds`) are simple and do not require quoting with backticks.\\n*   String literals (`\\'Fresno\\'`) are correctly enclosed in single quotes. (Assuming the prompt\\'s \"Use ` for the in-query strings\" was a typo and meant single quotes for string literals, or backticks for identifiers if needed).\\n*   Functions (`AVG`, `YEAR`) are used with the correct number of arguments.\\n*   No explicit casting is used, and none seems necessary for the operations performed.\\n*   The join condition `T1.CDSCode = T2.cds` uses appropriate columns for linking the `schools` and `satscores` tables.\\n\\nThe query is well-formed and follows standard SQL practices.\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND YEAR(T1.OpenDate) = 1980\\n```' name='query_checker_sql_db' tool_call_id='8a13eed8-43d8-4ecb-88ec-c99dc5e752e3'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}"], "input_tokens": 6733, "output_tokens": 6039, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The original query has a potential mistake related to data type handling and string manipulation for the `OpenDate` column.\n\n**Mistake:**\nThe condition `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` is problematic if `T1.OpenDate` is a `DATE` type (which is common for an \"OpenDate\" column).\n1.  If `T1.OpenDate` is a `DATE` type, Spark SQL will implicitly cast it to a string before applying `SUBSTRING`. The default string format for dates in Spark is typically 'YYYY-MM-DD'.\n2.  If `OpenDate` is '1980-01-15', casting it to string yields '1980-01-15'.\n3.  `SUBSTRING('1980-01-15', 7, 4)` would extract '01-1' (starting at the 7th character, for a length of 4). This will not match `'1980'`.\nTherefore, if `T1.OpenDate` is a `DATE` type, this condition will incorrectly filter out all rows, or at least not filter them as intended.\n\nIf `T1.OpenDate` is a `STRING` type, this condition *could* be correct, but only if the string format is 'MM/DD/YYYY' (where the year starts at position 7). If it's 'YYYY-MM-DD', the year starts at position 1, and the `SUBSTRING` arguments would be wrong. Relying on specific string formats with `SUBSTRING` for dates is generally fragile.\n\n**Correction:**\nThe most robust and standard way to extract the year from a `DATE` type in Spark SQL is to use the `YEAR()` function. If `OpenDate` is a `DATE` type, `YEAR(T1.OpenDate)` will return an integer representing the year. This should then be compared with an integer.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND YEAR(T1.OpenDate) = 1980\"}'}\nTool: The provided Spark SQL query appears to be correct and does not exhibit any of the common mistakes listed:\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION` or `UNION ALL`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (`T1.City = 'Fresno'`, `YEAR(T1.OpenDate) = 1980`) seem compatible. `YEAR()` extracts an integer, which is compared to an integer.\n*   Identifiers (`CDSCode`, `NumTstTakr`, `City`, `OpenDate`, `cds`) are simple and do not require quoting with backticks.\n*   String literals (`'Fresno'`) are correctly enclosed in single quotes. (Assuming the prompt's \"Use ` for the in-query strings\" was a typo and meant single quotes for string literals, or backticks for identifiers if needed).\n*   Functions (`AVG`, `YEAR`) are used with the correct number of arguments.\n*   No explicit casting is used, and none seems necessary for the operations performed.\n*   The join condition `T1.CDSCode = T2.cds` uses appropriate columns for linking the `schools` and `satscores` tables.\n\nThe query is well-formed and follows standard SQL practices.\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```", "final_answer": "", "replica": 7, "timestamp": 1768940208.274442}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'FRESNO' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'", "execution_status": "VALID", "query_result": [["None"]], "spark_error": null, "total_time": 29.706666707992554, "spark_time": 0.1149904727935791, "translation_time": 29.591676235198975, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d9517d0a-2e2d-423e-b99c-40f1740644c1'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='ecfad9f8-6560-499a-a731-4fb56c2e3c09'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'FRESNO' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content=\"The provided Spark SQL query appears to be free of the common mistakes listed.\\n\\nLet's review each point:\\n\\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\\n*   **Data type mismatch in predicates**:\\n    *   `T1.City = 'FRESNO'`: Assumes `T1.City` is a string type, which is compared to a string literal. This is fine.\\n    *   `T1.CDSCode = T2.cds`: Assumes `CDSCode` and `cds` columns have compatible data types (e.g., both integers or both strings). This is a standard join condition.\\n    *   `SUBSTRING(T1.OpenDate, 7, 4) = '1980'`: The `SUBSTRING` function extracts a portion of a string. It's applied to `T1.OpenDate`. This implies `T1.OpenDate` is expected to be a string (e.g., 'MM/DD/YYYY' where the year starts at position 7). The result of `SUBSTRING` is a string, which is then compared to the string literal `'1980'`. There is no data type mismatch here. If `T1.OpenDate` were a `DATE` or `TIMESTAMP` type, Spark SQL would implicitly cast it to a string before applying `SUBSTRING`, and while this might lead to incorrect results if the default string format isn't 'MM/DD/YYYY', it's not a *data type mismatch* in the predicate itself.\\n*   **Properly quoting identifiers**: Identifiers like `T1.City`, `T1.OpenDate`, `T1.CDSCode`, `T2.cds`, `T2.NumTstTakr` are not quoted with backticks. This is generally acceptable in Spark SQL for standard column names that are not reserved keywords or contain special characters.\\n*   **Use `` ` `` for the in-query strings**: The query correctly uses single quotes `'` for string literals (`'FRESNO'`, `'1980'`). Backticks `` ` `` are used for identifiers in Spark SQL, not for string literals. So, this point is handled correctly by *not* using backticks for strings.\\n*   **Using the correct number of arguments for functions**:\\n    *   `AVG(T2.NumTstTakr)`: `AVG` takes one argument, which is correct.\\n    *   `SUBSTRING(T1.OpenDate, 7, 4)`: `SUBSTRING` takes three arguments (string, start position, length), which is correct.\\n*   **Casting to the correct data type**: No explicit casting is performed, but the implicit type handling (e.g., string comparison, substring on string) is consistent.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a plausible and common join condition between `schools` and `satscores` tables.\\n\\nThe query is syntactically correct and adheres to the specified guidelines.\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'FRESNO' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\\n```\" name='query_checker_sql_db' tool_call_id='e8cd5d21-881c-4c39-b1f0-a6df92c31e5b'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'FRESNO' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}"], "input_tokens": 4680, "output_tokens": 4390, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'FRESNO\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The provided Spark SQL query appears to be free of the common mistakes listed.\n\nLet's review each point:\n\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\n*   **Data type mismatch in predicates**:\n    *   `T1.City = 'FRESNO'`: Assumes `T1.City` is a string type, which is compared to a string literal. This is fine.\n    *   `T1.CDSCode = T2.cds`: Assumes `CDSCode` and `cds` columns have compatible data types (e.g., both integers or both strings). This is a standard join condition.\n    *   `SUBSTRING(T1.OpenDate, 7, 4) = '1980'`: The `SUBSTRING` function extracts a portion of a string. It's applied to `T1.OpenDate`. This implies `T1.OpenDate` is expected to be a string (e.g., 'MM/DD/YYYY' where the year starts at position 7). The result of `SUBSTRING` is a string, which is then compared to the string literal `'1980'`. There is no data type mismatch here. If `T1.OpenDate` were a `DATE` or `TIMESTAMP` type, Spark SQL would implicitly cast it to a string before applying `SUBSTRING`, and while this might lead to incorrect results if the default string format isn't 'MM/DD/YYYY', it's not a *data type mismatch* in the predicate itself.\n*   **Properly quoting identifiers**: Identifiers like `T1.City`, `T1.OpenDate`, `T1.CDSCode`, `T2.cds`, `T2.NumTstTakr` are not quoted with backticks. This is generally acceptable in Spark SQL for standard column names that are not reserved keywords or contain special characters.\n*   **Use `` ` `` for the in-query strings**: The query correctly uses single quotes `'` for string literals (`'FRESNO'`, `'1980'`). Backticks `` ` `` are used for identifiers in Spark SQL, not for string literals. So, this point is handled correctly by *not* using backticks for strings.\n*   **Using the correct number of arguments for functions**:\n    *   `AVG(T2.NumTstTakr)`: `AVG` takes one argument, which is correct.\n    *   `SUBSTRING(T1.OpenDate, 7, 4)`: `SUBSTRING` takes three arguments (string, start position, length), which is correct.\n*   **Casting to the correct data type**: No explicit casting is performed, but the implicit type handling (e.g., string comparison, substring on string) is consistent.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a plausible and common join condition between `schools` and `satscores` tables.\n\nThe query is syntactically correct and adheres to the specified guidelines.\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'FRESNO' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\n```", "final_answer": "", "replica": 8, "timestamp": 1768940238.634158}
{"query_id": 39, "provider": "google", "db": "california_schools", "nl_query": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980", "gold_sqlite": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'", "gold_spark": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE DATE_FORMAT(CAST(T2.OpenDate AS TIMESTAMP), 'yyyy') = '1980' AND T2.County = 'Fresno'", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980", "execution_status": "VALID", "query_result": [["203.8"]], "spark_error": null, "total_time": 22.370428562164307, "spark_time": 0.13005661964416504, "translation_time": 22.24037194252014, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='f387b8ce-28ed-4464-9c9a-a2c9cf363d6f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='e1ed057a-cfd2-4ef5-992c-d4c668ad38a1'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND SUBSTRING(T1.OpenDate, 7, 4) = '1980'\"}", "Observation: content=\"The query has a potential mistake related to extracting the year from the `OpenDate` column.\\n\\n**Mistake:**\\n*   **Data type mismatch/Incorrect function usage for date extraction**: The expression `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` assumes that `T1.OpenDate` is a string column formatted as `MM/DD/YYYY`. If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common and best practice for date columns), then `SUBSTRING` would first implicitly cast the date to a string (usually in `YYYY-MM-DD` format in Spark SQL). In that case, `SUBSTRING('YYYY-MM-DD', 7, 4)` would extract 'MM-D', not the year 'YYYY'. This would lead to incorrect filtering or an error.\\n\\n**Correction:**\\nTo correctly extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL, the `YEAR()` function should be used. If `OpenDate` is indeed a string in `MM/DD/YYYY` format, it's still more robust to cast it to a date first or use `DATE_FORMAT`. However, assuming `OpenDate` is a `DATE` type (as its name suggests and is good practice), `YEAR(T1.OpenDate) = 1980` is the correct and robust way to filter by year.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\\n```\" name='query_checker_sql_db' tool_call_id='6ae37699-b8b2-401a-8a02-88f885556562'", "Action: query_sql_db\nAction Input: {'query': \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\"}"], "input_tokens": 4278, "output_tokens": 4040, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980? between 1/1/1980 and 12/31/1980 means the year = 1980\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = \\'Fresno\\' AND SUBSTRING(T1.OpenDate, 7, 4) = \\'1980\\'\"}'}\nTool: The query has a potential mistake related to extracting the year from the `OpenDate` column.\n\n**Mistake:**\n*   **Data type mismatch/Incorrect function usage for date extraction**: The expression `SUBSTRING(T1.OpenDate, 7, 4) = '1980'` assumes that `T1.OpenDate` is a string column formatted as `MM/DD/YYYY`. If `T1.OpenDate` is actually a `DATE` or `TIMESTAMP` data type (which is common and best practice for date columns), then `SUBSTRING` would first implicitly cast the date to a string (usually in `YYYY-MM-DD` format in Spark SQL). In that case, `SUBSTRING('YYYY-MM-DD', 7, 4)` would extract 'MM-D', not the year 'YYYY'. This would lead to incorrect filtering or an error.\n\n**Correction:**\nTo correctly extract the year from a `DATE` or `TIMESTAMP` column in Spark SQL, the `YEAR()` function should be used. If `OpenDate` is indeed a string in `MM/DD/YYYY` format, it's still more robust to cast it to a date first or use `DATE_FORMAT`. However, assuming `OpenDate` is a `DATE` type (as its name suggests and is good practice), `YEAR(T1.OpenDate) = 1980` is the correct and robust way to filter by year.\n\n**Rewritten Query:**\n\n```sql\nSELECT AVG(T2.NumTstTakr) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.City = 'Fresno' AND YEAR(T1.OpenDate) = 1980\n```", "final_answer": "", "replica": 9, "timestamp": 1768940261.5734644}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 22.55924701690674, "spark_time": 0.13577771186828613, "translation_time": 22.423469305038452, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='8f275c55-ba41-430e-9ae1-5dc22f708746'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='9a80565a-27c8-472a-a279-d2363beccb35'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a993b847-606c-4fc9-a762-931085bf0b57'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='9abe9114-38c9-42bc-81a9-e7040dd2242c'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content='The original query is largely correct and would execute successfully in Spark SQL, assuming the column and table names do not contain special characters or are not reserved keywords.\\n\\nHowever, addressing the point \"Properly quoting identifiers\" and interpreting \"Use ` for the in-query strings\" as referring to identifiers (as using backticks for string literals would be incorrect SQL syntax), it\\'s best practice to quote all identifiers with backticks (`` ` ``) in Spark SQL for robustness and clarity. String literals, like `\\'Fresno Unified\\'`, should always use single quotes (`\\'`).\\n\\nHere\\'s the rewritten query with identifiers properly quoted:\\n\\n```sql\\nSELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = \\'Fresno Unified\\' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='2563f622-0485-4e4e-b86c-435f9ec55bf2'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\"}"], "input_tokens": 5765, "output_tokens": 3579, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The original query is largely correct and would execute successfully in Spark SQL, assuming the column and table names do not contain special characters or are not reserved keywords.\n\nHowever, addressing the point \"Properly quoting identifiers\" and interpreting \"Use ` for the in-query strings\" as referring to identifiers (as using backticks for string literals would be incorrect SQL syntax), it's best practice to quote all identifiers with backticks (`` ` ``) in Spark SQL for robustness and clarity. String literals, like `'Fresno Unified'`, should always use single quotes (`'`).\n\nHere's the rewritten query with identifiers properly quoted:\n\n```sql\nSELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\n```", "final_answer": "", "replica": 0, "timestamp": 1768940284.8132453}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 23.26801824569702, "spark_time": 0.13486742973327637, "translation_time": 23.133150815963745, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='278813dc-9628-4b19-bc0b-bbb4c78a1b50'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='7c6502ca-12f0-4e0a-9de3-dfd7894b63f6'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='6d870a7d-6ce3-4551-aef2-875ec8a1e18c'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='3f6b49ce-a02c-42f4-81ef-c061a195ec9c'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content='The original query is largely correct and would execute successfully in Spark SQL, assuming the column and table names do not contain special characters or are not reserved keywords.\\n\\nHowever, addressing the point \"Properly quoting identifiers\" and interpreting \"Use ` for the in-query strings\" as referring to identifiers (as using backticks for string literals would be incorrect SQL syntax), it\\'s best practice to quote all identifiers with backticks (`` ` ``) in Spark SQL for robustness and clarity. String literals, like `\\'Fresno Unified\\'`, should always use single quotes (`\\'`).\\n\\nHere\\'s the rewritten query with identifiers properly quoted:\\n\\n```sql\\nSELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = \\'Fresno Unified\\' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='1f96616d-1b96-44a1-bfa3-599cb911d8d6'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\"}"], "input_tokens": 5765, "output_tokens": 3675, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The original query is largely correct and would execute successfully in Spark SQL, assuming the column and table names do not contain special characters or are not reserved keywords.\n\nHowever, addressing the point \"Properly quoting identifiers\" and interpreting \"Use ` for the in-query strings\" as referring to identifiers (as using backticks for string literals would be incorrect SQL syntax), it's best practice to quote all identifiers with backticks (`` ` ``) in Spark SQL for robustness and clarity. String literals, like `'Fresno Unified'`, should always use single quotes (`'`).\n\nHere's the rewritten query with identifiers properly quoted:\n\n```sql\nSELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\n```", "final_answer": "", "replica": 1, "timestamp": 1768940308.6302614}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 24.7095947265625, "spark_time": 0.12494611740112305, "translation_time": 24.584648609161377, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='059e300b-f155-4fbf-938e-20c7d2dff85c'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='042ea828-0d85-45ab-94a2-84d1cc9e6830'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='1809de3f-3d3b-40b1-9ba0-787a32966794'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='052026eb-11f8-438b-9fef-c0996c2e1fbd'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content='The original query is largely correct and would execute successfully in Spark SQL, assuming the column and table names do not contain special characters or are not reserved keywords.\\n\\nHowever, addressing the point \"Properly quoting identifiers\" and interpreting \"Use ` for the in-query strings\" as referring to identifiers (as using backticks for string literals would be incorrect SQL syntax), it\\'s best practice to quote all identifiers with backticks (`` ` ``) in Spark SQL for robustness and clarity. String literals, like `\\'Fresno Unified\\'`, should always use single quotes (`\\'`).\\n\\nHere\\'s the rewritten query with identifiers properly quoted:\\n\\n```sql\\nSELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = \\'Fresno Unified\\' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='19a743ae-c416-4753-a509-a7387384dea9'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\"}"], "input_tokens": 5765, "output_tokens": 3579, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The original query is largely correct and would execute successfully in Spark SQL, assuming the column and table names do not contain special characters or are not reserved keywords.\n\nHowever, addressing the point \"Properly quoting identifiers\" and interpreting \"Use ` for the in-query strings\" as referring to identifiers (as using backticks for string literals would be incorrect SQL syntax), it's best practice to quote all identifiers with backticks (`` ` ``) in Spark SQL for robustness and clarity. String literals, like `'Fresno Unified'`, should always use single quotes (`'`).\n\nHere's the rewritten query with identifiers properly quoted:\n\n```sql\nSELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\n```", "final_answer": "", "replica": 2, "timestamp": 1768940333.9733846}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead LIMIT 1;", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 25.19526433944702, "spark_time": 0.11199474334716797, "translation_time": 25.083269596099854, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='16edc4d4-cd4b-47cf-bf3b-20325539c9f3'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='90fd4c6a-e574-4b0c-875f-69f41e7d45db'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='f7bd2069-4795-40ad-8bdd-2111dd0b71ba'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='c5c7f608-9d8b-4b8c-8b3c-f657c755966e'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead LIMIT 1;\"}", "Observation: content=\"The query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` with `NULL` values is not used.\\n*   `UNION` is not used.\\n*   `BETWEEN` is not used.\\n*   Data types in predicates (`T1.District = 'Fresno Unified'`, `T1.CDSCode = T2.cds`) are assumed to be compatible, which is standard for such comparisons and joins.\\n*   Identifiers (`schools`, `satscores`, `Phone`, `CDSCode`, `cds`, `District`, `AvgScrRead`) are not quoted with backticks, but this is only strictly necessary if they contain special characters or are reserved keywords. For standard names, it's optional. String literals like `'Fresno Unified'` are correctly enclosed in single quotes.\\n*   No functions are used, so argument count is not an issue.\\n*   No explicit casting is performed, assuming implicit casting or compatible types.\\n*   The join condition `T1.CDSCode = T2.cds` uses appropriate columns to link schools with their SAT scores.\\n\\nThe query correctly selects the phone number of the school in the 'Fresno Unified' district that has the lowest average reading score.\\n\\n```sql\\nSELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead LIMIT 1;\\n```\" name='query_checker_sql_db' tool_call_id='58df4300-5690-415d-b71c-305b586dac83'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead LIMIT 1;\"}"], "input_tokens": 5895, "output_tokens": 2239, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead LIMIT 1;\"}'}\nTool: The query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   `NOT IN` with `NULL` values is not used.\n*   `UNION` is not used.\n*   `BETWEEN` is not used.\n*   Data types in predicates (`T1.District = 'Fresno Unified'`, `T1.CDSCode = T2.cds`) are assumed to be compatible, which is standard for such comparisons and joins.\n*   Identifiers (`schools`, `satscores`, `Phone`, `CDSCode`, `cds`, `District`, `AvgScrRead`) are not quoted with backticks, but this is only strictly necessary if they contain special characters or are reserved keywords. For standard names, it's optional. String literals like `'Fresno Unified'` are correctly enclosed in single quotes.\n*   No functions are used, so argument count is not an issue.\n*   No explicit casting is performed, assuming implicit casting or compatible types.\n*   The join condition `T1.CDSCode = T2.cds` uses appropriate columns to link schools with their SAT scores.\n\nThe query correctly selects the phone number of the school in the 'Fresno Unified' district that has the lowest average reading score.\n\n```sql\nSELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead LIMIT 1;\n```", "final_answer": "", "replica": 3, "timestamp": 1768940359.796629}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.School = T2.sname AND T1.District = T2.dname WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 229-3529"]], "spark_error": null, "total_time": 18.435008764266968, "spark_time": 0.1733870506286621, "translation_time": 18.261621713638306, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='202f1003-4fe2-4a49-94b1-3a0e8ef2bb21'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='e26db7a0-4d04-4b70-a809-b80bd1619662'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='724ad64c-8e8b-4087-bb27-dbdbca519f22'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='2903e728-b367-47e3-927d-b0f44b59d425'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.School = T2.sname AND T1.District = T2.dname WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content='The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\\n\\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\\n*   **BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The join conditions (`T1.School = T2.sname`, `T1.District = T2.dname`) and the `WHERE` clause (`T1.District = \\'Fresno Unified\\'`) compare columns and a string literal that are expected to be compatible (e.g., string to string). `T2.AvgScrRead` for `ORDER BY` is expected to be numeric. This seems correct.\\n*   **Properly quoting identifiers**: Identifiers (table and column names) are not quoted, which is standard practice when they don\\'t contain special characters or are not reserved keywords. The string literal `\\'Fresno Unified\\'` is correctly quoted with single quotes. The instruction \"Use ` for the in-query strings\" typically refers to quoting identifiers, not string literals. String literals correctly use single quotes.\\n*   **Using the correct number of arguments for functions**: No functions are used.\\n*   **Casting to the correct data type**: No explicit casting is used, and none appears necessary.\\n*   **Using the proper columns for joins**: The join condition `T1.School = T2.sname AND T1.District = T2.dname` correctly links the `schools` and `satscores` tables using both school name and district name, which is a robust way to ensure correct matching.\\n\\nThe query is well-formed and logically sound for its intended purpose.\\n\\n```sql\\nSELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.School = T2.sname AND T1.District = T2.dname WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='9f1c7e36-8e9d-4c92-9015-cf80ac3fc231'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.School = T2.sname AND T1.District = T2.dname WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}"], "input_tokens": 6050, "output_tokens": 2133, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.School = T2.sname AND T1.District = T2.dname WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\n\n*   **NOT IN with NULL values**: Not applicable, `NOT IN` is not used.\n*   **UNION when UNION ALL should have been used**: Not applicable, `UNION` is not used.\n*   **BETWEEN for exclusive ranges**: Not applicable, `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The join conditions (`T1.School = T2.sname`, `T1.District = T2.dname`) and the `WHERE` clause (`T1.District = 'Fresno Unified'`) compare columns and a string literal that are expected to be compatible (e.g., string to string). `T2.AvgScrRead` for `ORDER BY` is expected to be numeric. This seems correct.\n*   **Properly quoting identifiers**: Identifiers (table and column names) are not quoted, which is standard practice when they don't contain special characters or are not reserved keywords. The string literal `'Fresno Unified'` is correctly quoted with single quotes. The instruction \"Use ` for the in-query strings\" typically refers to quoting identifiers, not string literals. String literals correctly use single quotes.\n*   **Using the correct number of arguments for functions**: No functions are used.\n*   **Casting to the correct data type**: No explicit casting is used, and none appears necessary.\n*   **Using the proper columns for joins**: The join condition `T1.School = T2.sname AND T1.District = T2.dname` correctly links the `schools` and `satscores` tables using both school name and district name, which is a robust way to ensure correct matching.\n\nThe query is well-formed and logically sound for its intended purpose.\n\n```sql\nSELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.School = T2.sname AND T1.District = T2.dname WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\n```", "final_answer": "", "replica": 4, "timestamp": 1768940378.8606408}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT `T1`.`Phone` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T1`.`District` = 'Fresno Unified' ORDER BY `T2`.`AvgScrRead` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 26.381642818450928, "spark_time": 0.10295224189758301, "translation_time": 26.278690576553345, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a0e964a6-6f45-4e6e-97b2-08df59d2d2d5'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='9d47be52-47d9-4a87-a34c-b087ff0517e1'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='b2fbe191-f14a-491f-a959-e03a7df63c19'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='66ca3851-9b8a-4ae8-b964-f073b6defa0a'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content='The original query is syntactically valid in Spark SQL for simple identifiers. However, the prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". Interpreting \"Use ` for the in-query strings\" as applying backticks to identifiers (table names, column names, and aliases) for robustness and adherence to the prompt\\'s specific quoting requirement, the original query can be improved by adding these backticks. String literals (like `\\'Fresno Unified\\'`) should correctly remain in single quotes.\\n\\nHere\\'s the rewritten query with backticks applied to all identifiers:\\n\\n```sql\\nSELECT `T1`.`Phone` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T1`.`District` = \\'Fresno Unified\\' ORDER BY `T2`.`AvgScrRead` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='1ca7b653-4d75-458d-b826-027ec64fd796'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `T1`.`Phone` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T1`.`District` = 'Fresno Unified' ORDER BY `T2`.`AvgScrRead` ASC LIMIT 1\"}"], "input_tokens": 5771, "output_tokens": 3045, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The original query is syntactically valid in Spark SQL for simple identifiers. However, the prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". Interpreting \"Use ` for the in-query strings\" as applying backticks to identifiers (table names, column names, and aliases) for robustness and adherence to the prompt's specific quoting requirement, the original query can be improved by adding these backticks. String literals (like `'Fresno Unified'`) should correctly remain in single quotes.\n\nHere's the rewritten query with backticks applied to all identifiers:\n\n```sql\nSELECT `T1`.`Phone` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T1`.`District` = 'Fresno Unified' ORDER BY `T2`.`AvgScrRead` ASC LIMIT 1\n```", "final_answer": "", "replica": 5, "timestamp": 1768940405.8803573}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT `T1`.`Phone` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T1`.`District` = 'Fresno Unified' ORDER BY `T2`.`AvgScrRead` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 26.57759714126587, "spark_time": 0.1430208683013916, "translation_time": 26.434576272964478, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='fba56aff-d98e-470d-92d5-ef3e7ac66d32'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='7b741522-85d2-4466-9318-b468fd90fc30'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='d6fe8536-9024-47c3-a3ee-7ee90f74df1e'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='31b62963-0985-457a-9ceb-9e6a3c3146c4'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content='The original query is syntactically valid in Spark SQL for simple identifiers. However, the prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". Interpreting \"Use ` for the in-query strings\" as applying backticks to identifiers (table names, column names, and aliases) for robustness and adherence to the prompt\\'s specific quoting requirement, the original query can be improved by adding these backticks. String literals (like `\\'Fresno Unified\\'`) should correctly remain in single quotes.\\n\\nHere\\'s the rewritten query with backticks applied to all identifiers:\\n\\n```sql\\nSELECT `T1`.`Phone` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T1`.`District` = \\'Fresno Unified\\' ORDER BY `T2`.`AvgScrRead` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='d70714ff-eebf-47ca-97be-cbad5f968a8e'", "Action: query_sql_db\nAction Input: {'query': \"SELECT `T1`.`Phone` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T1`.`District` = 'Fresno Unified' ORDER BY `T2`.`AvgScrRead` ASC LIMIT 1\"}"], "input_tokens": 5771, "output_tokens": 3045, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The original query is syntactically valid in Spark SQL for simple identifiers. However, the prompt explicitly mentions \"Properly quoting identifiers\" and \"Use ` for the in-query strings\". Interpreting \"Use ` for the in-query strings\" as applying backticks to identifiers (table names, column names, and aliases) for robustness and adherence to the prompt's specific quoting requirement, the original query can be improved by adding these backticks. String literals (like `'Fresno Unified'`) should correctly remain in single quotes.\n\nHere's the rewritten query with backticks applied to all identifiers:\n\n```sql\nSELECT `T1`.`Phone` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE `T1`.`District` = 'Fresno Unified' ORDER BY `T2`.`AvgScrRead` ASC LIMIT 1\n```", "final_answer": "", "replica": 6, "timestamp": 1768940433.1071224}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 14.406205654144287, "spark_time": 0.1681990623474121, "translation_time": 14.238006591796875, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c618cd8a-0baf-4a86-aef2-96adfeb3a57e'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='ba640b30-0716-419a-87d2-f705784474ea'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values**: Not used in the query.\\n*   **UNION when UNION ALL should have been used**: Not used in the query.\\n*   **BETWEEN for exclusive ranges**: Not used in the query.\\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.cds` and the filter `T2.dname = 'Fresno Unified'` are comparing columns that are expected to have compatible data types (e.g., `CDSCode` and `cds` as numeric or string IDs, `dname` as a string). `AvgScrRead` is likely numeric for ordering. This seems correct.\\n*   **Properly quoting identifiers**: All identifiers (table aliases `T1`, `T2`, and column names like `Phone`, `CDSCode`, `cds`, `dname`, `AvgScrRead`) are simple and correctly referenced using dot notation. No special quoting (like backticks) is needed for these identifiers.\\n*   **Use \\\\` for the in-query strings**: String literals in SQL (including Spark SQL) are correctly enclosed in single quotes (`'string'`). The query uses `'Fresno Unified'`, which is the correct syntax for a string literal. Backticks (\\\\`identifier\\\\`) are used for quoting identifiers (table or column names) that might be reserved keywords or contain special characters, not for string literals.\\n*   **Using the correct number of arguments for functions**: No functions are used in the query.\\n*   **Casting to the correct data type**: No explicit casting is performed or appears necessary.\\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` is a logical and common way to link school information with SAT scores, assuming `CDSCode` and `cds` represent the same unique school identifier.\\n\\nThe query correctly selects the phone number of the school within the 'Fresno Unified' district that has the lowest average reading SAT score.\\n\\n```sql\\nSELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='7f37511b-f90c-4029-8d76-9410c162f0a1'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}"], "input_tokens": 4194, "output_tokens": 2250, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values**: Not used in the query.\n*   **UNION when UNION ALL should have been used**: Not used in the query.\n*   **BETWEEN for exclusive ranges**: Not used in the query.\n*   **Data type mismatch in predicates**: The join condition `T1.CDSCode = T2.cds` and the filter `T2.dname = 'Fresno Unified'` are comparing columns that are expected to have compatible data types (e.g., `CDSCode` and `cds` as numeric or string IDs, `dname` as a string). `AvgScrRead` is likely numeric for ordering. This seems correct.\n*   **Properly quoting identifiers**: All identifiers (table aliases `T1`, `T2`, and column names like `Phone`, `CDSCode`, `cds`, `dname`, `AvgScrRead`) are simple and correctly referenced using dot notation. No special quoting (like backticks) is needed for these identifiers.\n*   **Use \\` for the in-query strings**: String literals in SQL (including Spark SQL) are correctly enclosed in single quotes (`'string'`). The query uses `'Fresno Unified'`, which is the correct syntax for a string literal. Backticks (\\`identifier\\`) are used for quoting identifiers (table or column names) that might be reserved keywords or contain special characters, not for string literals.\n*   **Using the correct number of arguments for functions**: No functions are used in the query.\n*   **Casting to the correct data type**: No explicit casting is performed or appears necessary.\n*   **Using the proper columns for joins**: The join condition `T1.CDSCode = T2.cds` is a logical and common way to link school information with SAT scores, assuming `CDSCode` and `cds` represent the same unique school identifier.\n\nThe query correctly selects the phone number of the school within the 'Fresno Unified' district that has the lowest average reading SAT score.\n\n```sql\nSELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\n```", "final_answer": "", "replica": 7, "timestamp": 1768940448.1433308}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 27.916310787200928, "spark_time": 0.11100363731384277, "translation_time": 27.805307149887085, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='39c147e4-fb4e-4baf-96ea-414b0262011f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='3957c4ee-dbd4-46b8-9d15-c93a207431e3'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='85c06880-803f-4070-9379-6ff2fda68223'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='aa6809d4-67a2-4885-bb3c-5dc1378560cb'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content='The original query is largely correct and would execute successfully in Spark SQL, assuming the column and table names do not contain special characters or are not reserved keywords.\\n\\nHowever, addressing the point \"Properly quoting identifiers\" and interpreting \"Use ` for the in-query strings\" as referring to identifiers (as using backticks for string literals would be incorrect SQL syntax), it\\'s best practice to quote all identifiers with backticks (`` ` ``) in Spark SQL for robustness and clarity. String literals, like `\\'Fresno Unified\\'`, should always use single quotes (`\\'`).\\n\\nHere\\'s the rewritten query with identifiers properly quoted:\\n\\n```sql\\nSELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = \\'Fresno Unified\\' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='1d07c231-f79f-4b9d-9c85-e797be10cd40'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\"}"], "input_tokens": 5765, "output_tokens": 3681, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.District = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The original query is largely correct and would execute successfully in Spark SQL, assuming the column and table names do not contain special characters or are not reserved keywords.\n\nHowever, addressing the point \"Properly quoting identifiers\" and interpreting \"Use ` for the in-query strings\" as referring to identifiers (as using backticks for string literals would be incorrect SQL syntax), it's best practice to quote all identifiers with backticks (`` ` ``) in Spark SQL for robustness and clarity. String literals, like `'Fresno Unified'`, should always use single quotes (`'`).\n\nHere's the rewritten query with identifiers properly quoted:\n\n```sql\nSELECT T1.`Phone` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`District` = 'Fresno Unified' ORDER BY T2.`AvgScrRead` ASC LIMIT 1\n```", "final_answer": "", "replica": 8, "timestamp": 1768940476.6226404}
{"query_id": 40, "provider": "google", "db": "california_schools", "nl_query": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;", "gold_sqlite": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "gold_spark": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1", "execution_status": "VALID", "query_result": [["(559) 490-4290"]], "spark_error": null, "total_time": 14.528380393981934, "spark_time": 0.1326909065246582, "translation_time": 14.395689487457275, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='5603e44f-631a-4e96-bcf2-aa1482db561f'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='199222ed-c51f-41d7-9393-0e8fd5026b09'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}", "Observation: content=\"The query appears to be correct and follows standard Spark SQL practices.\\n\\n*   **Joins**: The join condition `T1.CDSCode = T2.cds` is logical for connecting schools to their SAT scores.\\n*   **Filtering**: The `WHERE T2.dname = 'Fresno Unified'` clause correctly filters for the specified district.\\n*   **Ordering and Limiting**: `ORDER BY T2.AvgScrRead ASC LIMIT 1` correctly identifies the school with the lowest average reading score for that district.\\n*   **Quoting**: String literals like `'Fresno Unified'` are correctly enclosed in single quotes. Identifiers (table and column names) do not contain special characters or reserved words that would require backticks.\\n*   **Data Types**: The comparisons and operations seem to involve compatible data types (e.g., string to string, likely integer/string codes for join, numeric for ordering).\\n*   No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, or function argument issues are present.\\n\\n```sql\\nSELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='ef33b79e-01ea-4c35-954d-657554a93998'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}"], "input_tokens": 3976, "output_tokens": 1915, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the telephone number for the school with the lowest average score in reading in Fresno Unified? Fresno Unified is a name of district;\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = \\'Fresno Unified\\' ORDER BY T2.AvgScrRead ASC LIMIT 1\"}'}\nTool: The query appears to be correct and follows standard Spark SQL practices.\n\n*   **Joins**: The join condition `T1.CDSCode = T2.cds` is logical for connecting schools to their SAT scores.\n*   **Filtering**: The `WHERE T2.dname = 'Fresno Unified'` clause correctly filters for the specified district.\n*   **Ordering and Limiting**: `ORDER BY T2.AvgScrRead ASC LIMIT 1` correctly identifies the school with the lowest average reading score for that district.\n*   **Quoting**: String literals like `'Fresno Unified'` are correctly enclosed in single quotes. Identifiers (table and column names) do not contain special characters or reserved words that would require backticks.\n*   **Data Types**: The comparisons and operations seem to involve compatible data types (e.g., string to string, likely integer/string codes for join, numeric for ordering).\n*   No `NOT IN` with NULLs, `UNION` vs `UNION ALL`, `BETWEEN` for exclusive ranges, or function argument issues are present.\n\n```sql\nSELECT T1.Phone FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.dname = 'Fresno Unified' ORDER BY T2.AvgScrRead ASC LIMIT 1\n```", "final_answer": "", "replica": 9, "timestamp": 1768940491.7815435}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 101)\n\n== SQL ==\nSELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\n-----------------------------------------------------------------------------------------------------^^^\n", "total_time": 28.651190519332886, "spark_time": 0.02100086212158203, "translation_time": 28.630189657211304, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='142880d7-676c-4a57-beb8-3abaa642b921'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='a7b29dca-31ed-4305-948b-9b4d99845631'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}", "Observation: content='The provided Spark SQL query is well-structured and uses standard Spark SQL syntax, including the `QUALIFY` clause for filtering window function results.\\n\\nLet\\'s review it against the specified common mistakes:\\n\\n1.  **Using NOT IN with NULL values**: `NOT IN` is not used in this query.\\n2.  **Using UNION when UNION ALL should have been used**: `UNION` is not used in this query.\\n3.  **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in this query.\\n4.  **Data type mismatch in predicates**:\\n    *   `s.Virtual = \\'F\\'`: Assuming `s.Virtual` is a `CHAR` or `VARCHAR` type (which is common for \\'True\\'/\\'False\\' flags represented as \\'T\\'/\\'F\\'), this comparison is valid. If `s.Virtual` were a `BOOLEAN` type, it would typically be compared with `FALSE` or `true`/`false` string literals (e.g., `s.Virtual = FALSE` or `s.Virtual = \\'false\\'`). Given `\\'F\\'`, a string/char type is the most probable and compatible.\\n    *   `ROW_NUMBER() OVER (...) <= 5`: `ROW_NUMBER()` returns an integer, and `5` is an integer. This comparison is perfectly valid.\\n5.  **Properly quoting identifiers**: Identifiers like `s.School`, `s.CDSCode`, `sat.cds`, `s.Virtual`, `s.County`, `sat.AvgScrRead`, `schools`, and `satscores` are unquoted. In Spark SQL, identifiers do not require backticks if they do not contain spaces, special characters, or conflict with reserved keywords. The identifiers used here appear to be valid unquoted identifiers.\\n6.  **Use ` for the in-query strings**: This instruction typically refers to quoting identifiers (like table or column names) that contain special characters or spaces, or are keywords. String *literals* in SQL (including Spark SQL) are enclosed in single quotes (e.g., `\\'F\\'`). The query correctly uses single quotes for the string literal `\\'F\\'`. Using backticks for string literals (e.g., ``F``) is not standard SQL and would likely result in a syntax error in Spark SQL. Assuming the instruction refers to standard SQL string literal quoting, `\\'F\\'` is correct.\\n7.  **Using the correct number of arguments for functions**: `ROW_NUMBER()` is a window function that takes no arguments, which is correctly used here.\\n8.  **Casting to the correct data type**: No explicit casts are used. Implicit casting for `s.Virtual = \\'F\\'` is assumed to be handled correctly if `s.Virtual` is a character type.\\n9.  **Using the proper columns for joins**: The join condition `s.CDSCode = sat.cds` appears to correctly link the `schools` and `satscores` tables based on a common identifier.\\n\\nBased on the review, the query adheres to standard Spark SQL practices and does not exhibit the common mistakes listed, assuming `s.Virtual` is a character/string type and interpreting \"Use ` for the in-query strings\" in the context of standard SQL string literals.\\n\\n```sql\\nSELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\\n```' name='query_checker_sql_db' tool_call_id='f3999fc2-22eb-47ac-a80f-c6eed3dad2fd'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}"], "input_tokens": 4517, "output_tokens": 4733, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}'}\nTool: The provided Spark SQL query is well-structured and uses standard Spark SQL syntax, including the `QUALIFY` clause for filtering window function results.\n\nLet's review it against the specified common mistakes:\n\n1.  **Using NOT IN with NULL values**: `NOT IN` is not used in this query.\n2.  **Using UNION when UNION ALL should have been used**: `UNION` is not used in this query.\n3.  **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in this query.\n4.  **Data type mismatch in predicates**:\n    *   `s.Virtual = 'F'`: Assuming `s.Virtual` is a `CHAR` or `VARCHAR` type (which is common for 'True'/'False' flags represented as 'T'/'F'), this comparison is valid. If `s.Virtual` were a `BOOLEAN` type, it would typically be compared with `FALSE` or `true`/`false` string literals (e.g., `s.Virtual = FALSE` or `s.Virtual = 'false'`). Given `'F'`, a string/char type is the most probable and compatible.\n    *   `ROW_NUMBER() OVER (...) <= 5`: `ROW_NUMBER()` returns an integer, and `5` is an integer. This comparison is perfectly valid.\n5.  **Properly quoting identifiers**: Identifiers like `s.School`, `s.CDSCode`, `sat.cds`, `s.Virtual`, `s.County`, `sat.AvgScrRead`, `schools`, and `satscores` are unquoted. In Spark SQL, identifiers do not require backticks if they do not contain spaces, special characters, or conflict with reserved keywords. The identifiers used here appear to be valid unquoted identifiers.\n6.  **Use ` for the in-query strings**: This instruction typically refers to quoting identifiers (like table or column names) that contain special characters or spaces, or are keywords. String *literals* in SQL (including Spark SQL) are enclosed in single quotes (e.g., `'F'`). The query correctly uses single quotes for the string literal `'F'`. Using backticks for string literals (e.g., ``F``) is not standard SQL and would likely result in a syntax error in Spark SQL. Assuming the instruction refers to standard SQL string literal quoting, `'F'` is correct.\n7.  **Using the correct number of arguments for functions**: `ROW_NUMBER()` is a window function that takes no arguments, which is correctly used here.\n8.  **Casting to the correct data type**: No explicit casts are used. Implicit casting for `s.Virtual = 'F'` is assumed to be handled correctly if `s.Virtual` is a character type.\n9.  **Using the proper columns for joins**: The join condition `s.CDSCode = sat.cds` appears to correctly link the `schools` and `satscores` tables based on a common identifier.\n\nBased on the review, the query adheres to standard Spark SQL practices and does not exhibit the common mistakes listed, assuming `s.Virtual` is a character/string type and interpreting \"Use ` for the in-query strings\" in the context of standard SQL string literals.\n\n```sql\nSELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 0, "timestamp": 1768940520.5667958}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 103)\n\n== SQL ==\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n-------------------------------------------------------------------------------------------------------^^^\n", "total_time": 15.477092981338501, "spark_time": 0.012000322341918945, "translation_time": 15.465092658996582, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='343dc245-9807-40cf-b59c-19c4cf70c122'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='58f0f7a4-3283-4935-bcde-f32c94efc901'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` is not used.\\n*   `UNION` is not used.\\n*   `BETWEEN` is not used.\\n*   Data types in predicates and joins are assumed to be compatible based on common schema designs (e.g., `CDSCode` and `cds` as matching identifiers, `Virtual` as a character/string, `AvgScrRead` as numeric).\\n*   Identifiers like `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead` are unquoted, which is standard practice and acceptable in Spark SQL unless they are reserved keywords or contain special characters.\\n*   String literals (e.g., `'F'`) are correctly quoted with single quotes.\\n*   `ROW_NUMBER()` is used correctly without arguments.\\n*   No explicit `CAST` operations are used, and implicit casting is assumed to be handled correctly where necessary.\\n*   The join condition `T1.CDSCode = T2.cds` is a logical way to link schools to their SAT scores.\\n*   The `QUALIFY` clause is correctly used for filtering based on the window function `ROW_NUMBER()`.\\n\\n```sql\\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\\n```\" name='query_checker_sql_db' tool_call_id='1e6bef00-3ce8-4dce-8a50-7420d695bf69'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}"], "input_tokens": 4103, "output_tokens": 2033, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   `NOT IN` is not used.\n*   `UNION` is not used.\n*   `BETWEEN` is not used.\n*   Data types in predicates and joins are assumed to be compatible based on common schema designs (e.g., `CDSCode` and `cds` as matching identifiers, `Virtual` as a character/string, `AvgScrRead` as numeric).\n*   Identifiers like `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead` are unquoted, which is standard practice and acceptable in Spark SQL unless they are reserved keywords or contain special characters.\n*   String literals (e.g., `'F'`) are correctly quoted with single quotes.\n*   `ROW_NUMBER()` is used correctly without arguments.\n*   No explicit `CAST` operations are used, and implicit casting is assumed to be handled correctly where necessary.\n*   The join condition `T1.CDSCode = T2.cds` is a logical way to link schools to their SAT scores.\n*   The `QUALIFY` clause is correctly used for filtering based on the window function `ROW_NUMBER()`.\n\n```sql\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 1, "timestamp": 1768940536.2118902}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 103)\n\n== SQL ==\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n-------------------------------------------------------------------------------------------------------^^^\n", "total_time": 14.078009128570557, "spark_time": 0.0167233943939209, "translation_time": 14.061285734176636, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='507e83f3-1c02-414e-a3ce-78e1ff00c2e1'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='a936df18-e148-4eed-9a0e-379503fcd321'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` is not used.\\n*   `UNION` is not used.\\n*   `BETWEEN` is not used.\\n*   Data types in predicates and joins are assumed to be compatible based on common schema designs (e.g., `CDSCode` and `cds` as matching identifiers, `Virtual` as a character/string, `AvgScrRead` as numeric).\\n*   Identifiers like `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead` are unquoted, which is standard practice and acceptable in Spark SQL unless they are reserved keywords or contain special characters.\\n*   String literals (e.g., `'F'`) are correctly quoted with single quotes.\\n*   `ROW_NUMBER()` is used correctly without arguments.\\n*   No explicit `CAST` operations are used, and implicit casting is assumed to be handled correctly where necessary.\\n*   The join condition `T1.CDSCode = T2.cds` is a logical way to link schools to their SAT scores.\\n*   The `QUALIFY` clause is correctly used for filtering based on the window function `ROW_NUMBER()`.\\n\\n```sql\\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\\n```\" name='query_checker_sql_db' tool_call_id='e808d704-1dca-440f-a2f2-1260173e0edf'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}"], "input_tokens": 4103, "output_tokens": 2033, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   `NOT IN` is not used.\n*   `UNION` is not used.\n*   `BETWEEN` is not used.\n*   Data types in predicates and joins are assumed to be compatible based on common schema designs (e.g., `CDSCode` and `cds` as matching identifiers, `Virtual` as a character/string, `AvgScrRead` as numeric).\n*   Identifiers like `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead` are unquoted, which is standard practice and acceptable in Spark SQL unless they are reserved keywords or contain special characters.\n*   String literals (e.g., `'F'`) are correctly quoted with single quotes.\n*   `ROW_NUMBER()` is used correctly without arguments.\n*   No explicit `CAST` operations are used, and implicit casting is assumed to be handled correctly where necessary.\n*   The join condition `T1.CDSCode = T2.cds` is a logical way to link schools to their SAT scores.\n*   The `QUALIFY` clause is correctly used for filtering based on the window function `ROW_NUMBER()`.\n\n```sql\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 2, "timestamp": 1768940550.451912}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.`School` FROM `schools` AS s JOIN `satscores` AS sat ON s.`School` = sat.`sname` AND s.`County` = sat.`cname` WHERE s.`Virtual` = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.`County` ORDER BY sat.`AvgScrRead` DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 143)\n\n== SQL ==\nSELECT s.`School` FROM `schools` AS s JOIN `satscores` AS sat ON s.`School` = sat.`sname` AND s.`County` = sat.`cname` WHERE s.`Virtual` = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.`County` ORDER BY sat.`AvgScrRead` DESC) <= 5\n-----------------------------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 27.350868940353394, "spark_time": 0.022998571395874023, "translation_time": 27.32787036895752, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='6eeb1d24-db50-4915-ab71-1ac6f9d70a71'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='e06cbaca-e992-4fc4-8e9e-d836e83bcbdf'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='9610544b-2996-43ab-a29f-3ca0530466c5'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='89ad58c5-3ba6-4794-a69e-163d9eec08b0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}", "Observation: content='The original query has a potential mistake regarding the proper quoting of identifiers, as specified in the checklist (\"Properly quoting identifiers\" and \"Use ` for the in-query strings\"). While Spark SQL often allows simple identifiers without backticks, it\\'s best practice and sometimes necessary to quote them, especially when the prompt explicitly mentions it.\\n\\nThe corrected query uses backticks (`` ` ``) to properly quote table and column identifiers.\\n\\n```sql\\nSELECT s.`School`\\nFROM `schools` AS s\\nJOIN `satscores` AS sat ON s.`School` = sat.`sname` AND s.`County` = sat.`cname`\\nWHERE s.`Virtual` = \\'F\\'\\nQUALIFY ROW_NUMBER() OVER (PARTITION BY s.`County` ORDER BY sat.`AvgScrRead` DESC) <= 5\\n```' name='query_checker_sql_db' tool_call_id='c77e1b83-1ee2-4a1f-a7c1-a47bc74ca378'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.`School` FROM `schools` AS s JOIN `satscores` AS sat ON s.`School` = sat.`sname` AND s.`County` = sat.`cname` WHERE s.`Virtual` = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.`County` ORDER BY sat.`AvgScrRead` DESC) <= 5\"}"], "input_tokens": 5854, "output_tokens": 3338, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}'}\nTool: The original query has a potential mistake regarding the proper quoting of identifiers, as specified in the checklist (\"Properly quoting identifiers\" and \"Use ` for the in-query strings\"). While Spark SQL often allows simple identifiers without backticks, it's best practice and sometimes necessary to quote them, especially when the prompt explicitly mentions it.\n\nThe corrected query uses backticks (`` ` ``) to properly quote table and column identifiers.\n\n```sql\nSELECT s.`School`\nFROM `schools` AS s\nJOIN `satscores` AS sat ON s.`School` = sat.`sname` AND s.`County` = sat.`cname`\nWHERE s.`Virtual` = 'F'\nQUALIFY ROW_NUMBER() OVER (PARTITION BY s.`County` ORDER BY sat.`AvgScrRead` DESC) <= 5\n```", "final_answer": "", "replica": 3, "timestamp": 1768940577.9706874}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 103)\n\n== SQL ==\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n-------------------------------------------------------------------------------------------------------^^^\n", "total_time": 25.2289879322052, "spark_time": 0.05099678039550781, "translation_time": 25.177991151809692, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='5fa3630a-9f1d-413d-99d3-9c87035a01dc'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='18d65054-9edc-4d5d-ad0d-154cd06c523c'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\\n*   **Data type mismatch in predicates**:\\n    *   `T1.Virtual = 'F'`: If `Virtual` is a boolean, Spark SQL typically handles the conversion of `'F'` to `FALSE`. If it's a string/char, it's a direct comparison. This is generally not a mistake.\\n    *   `T1.CDSCode = T2.cds`: These are typically numeric or string identifiers. Assuming they are compatible or Spark can implicitly convert them without issue. This is a standard join condition.\\n    *   `T2.AvgScrRead DESC`: `AvgScrRead` is expected to be a numeric type, which is appropriate for ordering.\\n    *   `ROW_NUMBER() ... <= 5`: `ROW_NUMBER()` returns an integer, and `5` is an integer. The comparison is valid.\\n*   **Properly quoting identifiers**: Identifiers like `schools`, `satscores`, `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead`, `cds` are simple and do not contain special characters or conflict with reserved keywords. Therefore, they do not strictly require backticks (`` ` ``) in Spark SQL. Not quoting them is not considered a mistake in this context.\\n*   **Use `` ` `` for the in-query strings**: String literals (like `'F'`) correctly use single quotes. Backticks (`` ` ``) are used for identifiers, not string literals. The query uses single quotes correctly for the string literal.\\n*   **Using the correct number of arguments for functions**: `ROW_NUMBER()` is used correctly without arguments.\\n*   **Casting to the correct data type**: No explicit casts are used, and implicit conversions are expected to work for the given predicates.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a logical and common way to join school information with SAT scores.\\n\\nThe query uses `QUALIFY`, which is supported in Spark SQL 3.3.0 and later for filtering results of window functions. Assuming a compatible Spark version, the syntax is correct.\\n\\nTherefore, no changes are needed.\\n\\n```sql\\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\\n```\" name='query_checker_sql_db' tool_call_id='c7a4c666-4f2b-4327-a236-336c44a4f83b'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}"], "input_tokens": 4390, "output_tokens": 4025, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\n*   **Data type mismatch in predicates**:\n    *   `T1.Virtual = 'F'`: If `Virtual` is a boolean, Spark SQL typically handles the conversion of `'F'` to `FALSE`. If it's a string/char, it's a direct comparison. This is generally not a mistake.\n    *   `T1.CDSCode = T2.cds`: These are typically numeric or string identifiers. Assuming they are compatible or Spark can implicitly convert them without issue. This is a standard join condition.\n    *   `T2.AvgScrRead DESC`: `AvgScrRead` is expected to be a numeric type, which is appropriate for ordering.\n    *   `ROW_NUMBER() ... <= 5`: `ROW_NUMBER()` returns an integer, and `5` is an integer. The comparison is valid.\n*   **Properly quoting identifiers**: Identifiers like `schools`, `satscores`, `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead`, `cds` are simple and do not contain special characters or conflict with reserved keywords. Therefore, they do not strictly require backticks (`` ` ``) in Spark SQL. Not quoting them is not considered a mistake in this context.\n*   **Use `` ` `` for the in-query strings**: String literals (like `'F'`) correctly use single quotes. Backticks (`` ` ``) are used for identifiers, not string literals. The query uses single quotes correctly for the string literal.\n*   **Using the correct number of arguments for functions**: `ROW_NUMBER()` is used correctly without arguments.\n*   **Casting to the correct data type**: No explicit casts are used, and implicit conversions are expected to work for the given predicates.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a logical and common way to join school information with SAT scores.\n\nThe query uses `QUALIFY`, which is supported in Spark SQL 3.3.0 and later for filtering results of window functions. Assuming a compatible Spark version, the syntax is correct.\n\nTherefore, no changes are needed.\n\n```sql\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 4, "timestamp": 1768940603.3557847}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 103)\n\n== SQL ==\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n-------------------------------------------------------------------------------------------------------^^^\n", "total_time": 25.186038970947266, "spark_time": 0.01900482177734375, "translation_time": 25.167034149169922, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='66188a99-0d7b-4d0c-942f-9493c3ee1c89'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='f0d7a3d4-01f3-4c77-ae91-81da23166c7b'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\\n*   **Data type mismatch in predicates**:\\n    *   `T1.Virtual = 'F'`: If `Virtual` is a boolean, Spark SQL typically handles the conversion of `'F'` to `FALSE`. If it's a string/char, it's a direct comparison. This is generally not a mistake.\\n    *   `T1.CDSCode = T2.cds`: These are typically numeric or string identifiers. Assuming they are compatible or Spark can implicitly convert them without issue. This is a standard join condition.\\n    *   `T2.AvgScrRead DESC`: `AvgScrRead` is expected to be a numeric type, which is appropriate for ordering.\\n    *   `ROW_NUMBER() ... <= 5`: `ROW_NUMBER()` returns an integer, and `5` is an integer. The comparison is valid.\\n*   **Properly quoting identifiers**: Identifiers like `schools`, `satscores`, `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead`, `cds` are simple and do not contain special characters or conflict with reserved keywords. Therefore, they do not strictly require backticks (`` ` ``) in Spark SQL. Not quoting them is not considered a mistake in this context.\\n*   **Use `` ` `` for the in-query strings**: String literals (like `'F'`) correctly use single quotes. Backticks (`` ` ``) are used for identifiers, not string literals. The query uses single quotes correctly for the string literal.\\n*   **Using the correct number of arguments for functions**: `ROW_NUMBER()` is used correctly without arguments.\\n*   **Casting to the correct data type**: No explicit casts are used, and implicit conversions are expected to work for the given predicates.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a logical and common way to join school information with SAT scores.\\n\\nThe query uses `QUALIFY`, which is supported in Spark SQL 3.3.0 and later for filtering results of window functions. Assuming a compatible Spark version, the syntax is correct.\\n\\nTherefore, no changes are needed.\\n\\n```sql\\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\\n```\" name='query_checker_sql_db' tool_call_id='74682e77-bc08-407d-a62f-311b882b28fd'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}"], "input_tokens": 4390, "output_tokens": 4027, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\n*   **Data type mismatch in predicates**:\n    *   `T1.Virtual = 'F'`: If `Virtual` is a boolean, Spark SQL typically handles the conversion of `'F'` to `FALSE`. If it's a string/char, it's a direct comparison. This is generally not a mistake.\n    *   `T1.CDSCode = T2.cds`: These are typically numeric or string identifiers. Assuming they are compatible or Spark can implicitly convert them without issue. This is a standard join condition.\n    *   `T2.AvgScrRead DESC`: `AvgScrRead` is expected to be a numeric type, which is appropriate for ordering.\n    *   `ROW_NUMBER() ... <= 5`: `ROW_NUMBER()` returns an integer, and `5` is an integer. The comparison is valid.\n*   **Properly quoting identifiers**: Identifiers like `schools`, `satscores`, `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead`, `cds` are simple and do not contain special characters or conflict with reserved keywords. Therefore, they do not strictly require backticks (`` ` ``) in Spark SQL. Not quoting them is not considered a mistake in this context.\n*   **Use `` ` `` for the in-query strings**: String literals (like `'F'`) correctly use single quotes. Backticks (`` ` ``) are used for identifiers, not string literals. The query uses single quotes correctly for the string literal.\n*   **Using the correct number of arguments for functions**: `ROW_NUMBER()` is used correctly without arguments.\n*   **Casting to the correct data type**: No explicit casts are used, and implicit conversions are expected to work for the given predicates.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a logical and common way to join school information with SAT scores.\n\nThe query uses `QUALIFY`, which is supported in Spark SQL 3.3.0 and later for filtering results of window functions. Assuming a compatible Spark version, the syntax is correct.\n\nTherefore, no changes are needed.\n\n```sql\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 5, "timestamp": 1768940628.7028215}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 103)\n\n== SQL ==\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n-------------------------------------------------------------------------------------------------------^^^\n", "total_time": 24.271502256393433, "spark_time": 0.013014793395996094, "translation_time": 24.258487462997437, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='aef89aff-1f7e-4fac-927f-391e3b8df3b2'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='f2f7419c-90c3-4ca2-a76a-c8ed3938c66a'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\\n*   **Data type mismatch in predicates**:\\n    *   `T1.Virtual = 'F'`: If `Virtual` is a boolean, Spark SQL typically handles the conversion of `'F'` to `FALSE`. If it's a string/char, it's a direct comparison. This is generally not a mistake.\\n    *   `T1.CDSCode = T2.cds`: These are typically numeric or string identifiers. Assuming they are compatible or Spark can implicitly convert them without issue. This is a standard join condition.\\n    *   `T2.AvgScrRead DESC`: `AvgScrRead` is expected to be a numeric type, which is appropriate for ordering.\\n    *   `ROW_NUMBER() ... <= 5`: `ROW_NUMBER()` returns an integer, and `5` is an integer. The comparison is valid.\\n*   **Properly quoting identifiers**: Identifiers like `schools`, `satscores`, `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead`, `cds` are simple and do not contain special characters or conflict with reserved keywords. Therefore, they do not strictly require backticks (`` ` ``) in Spark SQL. Not quoting them is not considered a mistake in this context.\\n*   **Use `` ` `` for the in-query strings**: String literals (like `'F'`) correctly use single quotes. Backticks (`` ` ``) are used for identifiers, not string literals. The query uses single quotes correctly for the string literal.\\n*   **Using the correct number of arguments for functions**: `ROW_NUMBER()` is used correctly without arguments.\\n*   **Casting to the correct data type**: No explicit casts are used, and implicit conversions are expected to work for the given predicates.\\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a logical and common way to join school information with SAT scores.\\n\\nThe query uses `QUALIFY`, which is supported in Spark SQL 3.3.0 and later for filtering results of window functions. Assuming a compatible Spark version, the syntax is correct.\\n\\nTherefore, no changes are needed.\\n\\n```sql\\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\\n```\" name='query_checker_sql_db' tool_call_id='0f12512c-053d-4024-81d5-c8188919a786'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}"], "input_tokens": 4390, "output_tokens": 4027, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: `NOT IN` is not used in the query.\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used in the query.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used in the query.\n*   **Data type mismatch in predicates**:\n    *   `T1.Virtual = 'F'`: If `Virtual` is a boolean, Spark SQL typically handles the conversion of `'F'` to `FALSE`. If it's a string/char, it's a direct comparison. This is generally not a mistake.\n    *   `T1.CDSCode = T2.cds`: These are typically numeric or string identifiers. Assuming they are compatible or Spark can implicitly convert them without issue. This is a standard join condition.\n    *   `T2.AvgScrRead DESC`: `AvgScrRead` is expected to be a numeric type, which is appropriate for ordering.\n    *   `ROW_NUMBER() ... <= 5`: `ROW_NUMBER()` returns an integer, and `5` is an integer. The comparison is valid.\n*   **Properly quoting identifiers**: Identifiers like `schools`, `satscores`, `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead`, `cds` are simple and do not contain special characters or conflict with reserved keywords. Therefore, they do not strictly require backticks (`` ` ``) in Spark SQL. Not quoting them is not considered a mistake in this context.\n*   **Use `` ` `` for the in-query strings**: String literals (like `'F'`) correctly use single quotes. Backticks (`` ` ``) are used for identifiers, not string literals. The query uses single quotes correctly for the string literal.\n*   **Using the correct number of arguments for functions**: `ROW_NUMBER()` is used correctly without arguments.\n*   **Casting to the correct data type**: No explicit casts are used, and implicit conversions are expected to work for the given predicates.\n*   **Using the proper columns for joins**: `T1.CDSCode = T2.cds` is a logical and common way to join school information with SAT scores.\n\nThe query uses `QUALIFY`, which is supported in Spark SQL 3.3.0 and later for filtering results of window functions. Assuming a compatible Spark version, the syntax is correct.\n\nTherefore, no changes are needed.\n\n```sql\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 6, "timestamp": 1768940653.1743653}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 103)\n\n== SQL ==\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n-------------------------------------------------------------------------------------------------------^^^\n", "total_time": 12.804229021072388, "spark_time": 0.022002696990966797, "translation_time": 12.782226324081421, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='7fc4449f-a62d-4f65-9c1e-bcc0291803ac'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='a6ba60aa-2fae-4cc7-8f29-de2897714156'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}", "Observation: content=\"The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` is not used.\\n*   `UNION` is not used.\\n*   `BETWEEN` is not used.\\n*   Data types in predicates and joins are assumed to be compatible based on common schema designs (e.g., `CDSCode` and `cds` as matching identifiers, `Virtual` as a character/string, `AvgScrRead` as numeric).\\n*   Identifiers like `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead` are unquoted, which is standard practice and acceptable in Spark SQL unless they are reserved keywords or contain special characters.\\n*   String literals (e.g., `'F'`) are correctly quoted with single quotes.\\n*   `ROW_NUMBER()` is used correctly without arguments.\\n*   No explicit `CAST` operations are used, and implicit casting is assumed to be handled correctly where necessary.\\n*   The join condition `T1.CDSCode = T2.cds` is a logical way to link schools to their SAT scores.\\n*   The `QUALIFY` clause is correctly used for filtering based on the window function `ROW_NUMBER()`.\\n\\n```sql\\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\\n```\" name='query_checker_sql_db' tool_call_id='7012e403-2bcf-4ad0-a4ea-2ef3b7a0bab1'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}"], "input_tokens": 4103, "output_tokens": 2033, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   `NOT IN` is not used.\n*   `UNION` is not used.\n*   `BETWEEN` is not used.\n*   Data types in predicates and joins are assumed to be compatible based on common schema designs (e.g., `CDSCode` and `cds` as matching identifiers, `Virtual` as a character/string, `AvgScrRead` as numeric).\n*   Identifiers like `School`, `CDSCode`, `Virtual`, `County`, `AvgScrRead` are unquoted, which is standard practice and acceptable in Spark SQL unless they are reserved keywords or contain special characters.\n*   String literals (e.g., `'F'`) are correctly quoted with single quotes.\n*   `ROW_NUMBER()` is used correctly without arguments.\n*   No explicit `CAST` operations are used, and implicit casting is assumed to be handled correctly where necessary.\n*   The join condition `T1.CDSCode = T2.cds` is a logical way to link schools to their SAT scores.\n*   The `QUALIFY` clause is correctly used for filtering based on the window function `ROW_NUMBER()`.\n\n```sql\nSELECT T1.School FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY T1.County ORDER BY T2.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 7, "timestamp": 1768940666.117855}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 101)\n\n== SQL ==\nSELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\n-----------------------------------------------------------------------------------------------------^^^\n", "total_time": 13.227765083312988, "spark_time": 0.0160067081451416, "translation_time": 13.211758375167847, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='61f227d8-6c61-4bdc-8e94-8cb31a911b9d'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='c9e895da-0015-47b8-ad49-e93fb97d785c'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}", "Observation: content=\"```sql\\nSELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\\n```\" name='query_checker_sql_db' tool_call_id='c2921f5e-9293-4f07-89c7-fd70795c19e9'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}"], "input_tokens": 3808, "output_tokens": 2103, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = \\'F\\' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}'}\nTool: ```sql\nSELECT s.School FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE s.Virtual = 'F' QUALIFY ROW_NUMBER() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 8, "timestamp": 1768940679.6136234}
{"query_id": 41, "provider": "google", "db": "california_schools", "nl_query": "List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County", "gold_sqlite": "SELECT School FROM (SELECT T2.School,T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ) ranked_schools WHERE rnk <= 5", "gold_spark": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5", "jaccard": null, "spider_em": null, "sparksql_query": "SELECT s.School FROM schools s JOIN satscores sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = 'F' QUALIFY RANK() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5", "execution_status": "ERROR", "query_result": null, "spark_error": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'QUALIFY'. SQLSTATE: 42601 (line 1, pos 121)\n\n== SQL ==\nSELECT s.School FROM schools s JOIN satscores sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = 'F' QUALIFY RANK() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\n-------------------------------------------------------------------------------------------------------------------------^^^\n", "total_time": 16.5191752910614, "spark_time": 0.013979434967041016, "translation_time": 16.50519585609436, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='f46fa1fa-3926-437e-bee0-c035634e6c20'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='11253776-3832-4500-bead-343f8338e5df'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a6a170dd-48cb-408b-ae28-980e90fcda6a'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='b1b0e555-a67e-4586-abec-6374807e2931'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School FROM schools s JOIN satscores sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = 'F' QUALIFY RANK() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **`NOT IN` with `NULL` values**: Not used.\\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\\n*   **`BETWEEN` for exclusive ranges**: Not used.\\n*   **Data type mismatch in predicates**: The predicates `s.Virtual = 'F'`, `s.School = sat.sname`, `s.County = sat.cname` and the `ORDER BY sat.AvgScrRead DESC` imply compatible data types (e.g., string for names/county, char/string for `Virtual`, numeric for `AvgScrRead`). `RANK()` returns an integer, which is correctly compared with `5`.\\n*   **Properly quoting identifiers**: The identifiers (`s.School`, `s.County`, `s.Virtual`, `sat.sname`, `sat.cname`, `sat.AvgScrRead`, `schools`, `satscores`) are simple and do not contain spaces or special characters, nor are they reserved keywords in a way that would necessitate backticks in Spark SQL. They are correctly unquoted.\\n*   **Using `` ` `` for in-query strings**: There are no in-query strings that would require backticks. The string literal `'F'` uses single quotes, which is correct.\\n*   **Using the correct number of arguments for functions**: `RANK()` is a window function that takes no direct arguments but operates within the `OVER` clause, which is correctly specified with `PARTITION BY` and `ORDER BY`.\\n*   **Casting to the correct data type**: No explicit casting is used or appears necessary based on the context.\\n*   **Using the proper columns for joins**: The join condition `s.School = sat.sname AND s.County = sat.cname` uses appropriate columns from both tables to link schools with their SAT scores, ensuring a more precise match.\\n*   **`QUALIFY` clause**: This is a valid Spark SQL (and other modern SQL dialects) clause used correctly to filter the results of the window function `RANK()`.\\n\\nThe query is syntactically correct and follows best practices for Spark SQL.\\n\\n```sql\\nSELECT s.School FROM schools s JOIN satscores sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = 'F' QUALIFY RANK() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\\n```\" name='query_checker_sql_db' tool_call_id='9bcf526d-f101-42e7-bf70-f7cb0b4086a0'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School FROM schools s JOIN satscores sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = 'F' QUALIFY RANK() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}"], "input_tokens": 6219, "output_tokens": 2416, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: List the names of virtual schools that are among the top 5 in their respective counties based on average reading scores. Exclusively virtual refers to Virtual = 'F'; respective counties means PARTITION BY County\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School FROM schools s JOIN satscores sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = \\'F\\' QUALIFY RANK() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **`NOT IN` with `NULL` values**: Not used.\n*   **`UNION` when `UNION ALL` should have been used**: Not used.\n*   **`BETWEEN` for exclusive ranges**: Not used.\n*   **Data type mismatch in predicates**: The predicates `s.Virtual = 'F'`, `s.School = sat.sname`, `s.County = sat.cname` and the `ORDER BY sat.AvgScrRead DESC` imply compatible data types (e.g., string for names/county, char/string for `Virtual`, numeric for `AvgScrRead`). `RANK()` returns an integer, which is correctly compared with `5`.\n*   **Properly quoting identifiers**: The identifiers (`s.School`, `s.County`, `s.Virtual`, `sat.sname`, `sat.cname`, `sat.AvgScrRead`, `schools`, `satscores`) are simple and do not contain spaces or special characters, nor are they reserved keywords in a way that would necessitate backticks in Spark SQL. They are correctly unquoted.\n*   **Using `` ` `` for in-query strings**: There are no in-query strings that would require backticks. The string literal `'F'` uses single quotes, which is correct.\n*   **Using the correct number of arguments for functions**: `RANK()` is a window function that takes no direct arguments but operates within the `OVER` clause, which is correctly specified with `PARTITION BY` and `ORDER BY`.\n*   **Casting to the correct data type**: No explicit casting is used or appears necessary based on the context.\n*   **Using the proper columns for joins**: The join condition `s.School = sat.sname AND s.County = sat.cname` uses appropriate columns from both tables to link schools with their SAT scores, ensuring a more precise match.\n*   **`QUALIFY` clause**: This is a valid Spark SQL (and other modern SQL dialects) clause used correctly to filter the results of the window function `RANK()`.\n\nThe query is syntactically correct and follows best practices for Spark SQL.\n\n```sql\nSELECT s.School FROM schools s JOIN satscores sat ON s.School = sat.sname AND s.County = sat.cname WHERE s.Virtual = 'F' QUALIFY RANK() OVER (PARTITION BY s.County ORDER BY sat.AvgScrRead DESC) <= 5\n```", "final_answer": "", "replica": 9, "timestamp": 1768940696.269723}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School ORDER BY ss.AvgScrMath DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 34.23464298248291, "spark_time": 0.6517593860626221, "translation_time": 33.58288359642029, "llm_requests": 9, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='19628cd7-40a8-48a4-be09-f2c2d695af12'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='e7e6774a-e4fb-43bc-9a0a-eb6f195b00b7'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='df470675-7454-41cf-84f9-c3d9565cfdf4'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='ac3ac9fc-dad8-41dd-9363-a61887abc47c'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School GROUP BY s.GSoffered, ss.sname ORDER BY AVG(ss.AvgScrMath) DESC LIMIT 1'}", "Observation: content='The original query has a mistake in the `GROUP BY` clause.\\n\\n**Mistake:**\\nThe `GROUP BY` clause includes both `s.GSoffered` and `ss.sname`. When `ss.sname` (which represents individual schools) is included in the `GROUP BY`, the `AVG(ss.AvgScrMath)` will be calculated for each individual school within each `GSoffered` category. This effectively means `AVG(ss.AvgScrMath)` will just be the `AvgScrMath` for each school (assuming one entry per school in `satscores`). Consequently, `ORDER BY AVG(ss.AvgScrMath) DESC LIMIT 1` would return the `GSoffered` value associated with the *single school* that has the highest `AvgScrMath`, rather than the `GSoffered` category that has the highest *average* `AvgScrMath` across all schools in that category.\\n\\n**Correction:**\\nTo find the `GSoffered` category with the highest *average* `AvgScrMath` across all schools belonging to that category, the aggregation should be performed solely on `s.GSoffered`. Therefore, `ss.sname` should be removed from the `GROUP BY` clause.\\n\\n**Rewritten Query:**\\n\\n```sql\\nSELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School GROUP BY s.GSoffered ORDER BY AVG(ss.AvgScrMath) DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='0f6abad0-afa9-4192-9eeb-980f6df338cf'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School ORDER BY ss.AvgScrMath DESC LIMIT 1'}", "Observation: content='The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n```sql\\nSELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School ORDER BY ss.AvgScrMath DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='6a2b56b1-32d7-467c-9374-0e943196a79c'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School ORDER BY ss.AvgScrMath DESC LIMIT 1'}"], "input_tokens": 7627, "output_tokens": 4777, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School GROUP BY s.GSoffered, ss.sname ORDER BY AVG(ss.AvgScrMath) DESC LIMIT 1\"}'}\nTool: The original query has a mistake in the `GROUP BY` clause.\n\n**Mistake:**\nThe `GROUP BY` clause includes both `s.GSoffered` and `ss.sname`. When `ss.sname` (which represents individual schools) is included in the `GROUP BY`, the `AVG(ss.AvgScrMath)` will be calculated for each individual school within each `GSoffered` category. This effectively means `AVG(ss.AvgScrMath)` will just be the `AvgScrMath` for each school (assuming one entry per school in `satscores`). Consequently, `ORDER BY AVG(ss.AvgScrMath) DESC LIMIT 1` would return the `GSoffered` value associated with the *single school* that has the highest `AvgScrMath`, rather than the `GSoffered` category that has the highest *average* `AvgScrMath` across all schools in that category.\n\n**Correction:**\nTo find the `GSoffered` category with the highest *average* `AvgScrMath` across all schools belonging to that category, the aggregation should be performed solely on `s.GSoffered`. Therefore, `ss.sname` should be removed from the `GROUP BY` clause.\n\n**Rewritten Query:**\n\n```sql\nSELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School GROUP BY s.GSoffered ORDER BY AVG(ss.AvgScrMath) DESC LIMIT 1\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School ORDER BY ss.AvgScrMath DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n```sql\nSELECT s.GSoffered FROM satscores AS ss JOIN schools AS s ON ss.sname = s.School ORDER BY ss.AvgScrMath DESC LIMIT 1\n```", "final_answer": "", "replica": 0, "timestamp": 1768940731.1543398}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 22.768452167510986, "spark_time": 0.32422852516174316, "translation_time": 22.444223642349243, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='de2556c3-1315-4f46-a9d6-20650a6244e8'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='73670231-47bc-4dd5-bc32-a7c72fdc8797'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1'}", "Observation: content='The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='5e3bc940-7f24-4a72-9096-f0a2a2ed78a6'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values:** Not used.\\n*   **UNION vs. UNION ALL:** Not used.\\n*   **BETWEEN for exclusive ranges:** Not used.\\n*   **Data type mismatch in predicates:** The join condition `T1.`CDSCode` = T2.`cds`` assumes compatible data types, which is standard for such identifiers. Without schema, it's impossible to be 100% certain, but it's a common and usually correct pattern.\\n*   **Properly quoting identifiers:** All identifiers (`GSoffered`, `schools`, `CDSCode`, etc.) are correctly quoted with backticks (` `).\\n*   **Use ` for the in-query strings:** This point likely refers to quoting identifiers, which is correctly done with backticks. If it refers to string literals, there are none in the query.\\n*   **Correct number of arguments for functions:** `AVG(T2.`AvgScrMath`)` correctly uses one argument.\\n*   **Casting to the correct data type:** No explicit casting is performed, assuming `AvgScrMath` is a numeric type, which is appropriate for an average calculation.\\n*   **Proper columns for joins:** The join condition `T1.`CDSCode` = T2.`cds`` is a logical and common way to link school data.\\n\\nThe query correctly groups by `T1.`School`` and `T1.`GSoffered`` because `T1.`GSoffered`` is in the `SELECT` list and `T1.`School`` is likely used to define the granularity for the average calculation. It then orders by the average math score and limits to the top result, returning the `GSoffered` value for that school.\\n\\nThe original query is correct.\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='73353b13-5c4c-4fe5-bf51-dacf38f85388'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}"], "input_tokens": 5762, "output_tokens": 3571, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1\"}'}\nTool: The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values:** Not used.\n*   **UNION vs. UNION ALL:** Not used.\n*   **BETWEEN for exclusive ranges:** Not used.\n*   **Data type mismatch in predicates:** The join condition `T1.`CDSCode` = T2.`cds`` assumes compatible data types, which is standard for such identifiers. Without schema, it's impossible to be 100% certain, but it's a common and usually correct pattern.\n*   **Properly quoting identifiers:** All identifiers (`GSoffered`, `schools`, `CDSCode`, etc.) are correctly quoted with backticks (` `).\n*   **Use ` for the in-query strings:** This point likely refers to quoting identifiers, which is correctly done with backticks. If it refers to string literals, there are none in the query.\n*   **Correct number of arguments for functions:** `AVG(T2.`AvgScrMath`)` correctly uses one argument.\n*   **Casting to the correct data type:** No explicit casting is performed, assuming `AvgScrMath` is a numeric type, which is appropriate for an average calculation.\n*   **Proper columns for joins:** The join condition `T1.`CDSCode` = T2.`cds`` is a logical and common way to link school data.\n\nThe query correctly groups by `T1.`School`` and `T1.`GSoffered`` because `T1.`GSoffered`` is in the `SELECT` list and `T1.`School`` is likely used to define the granularity for the average calculation. It then orders by the average math score and limits to the top result, returning the `GSoffered` value for that school.\n\nThe original query is correct.\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\n```", "final_answer": "", "replica": 1, "timestamp": 1768940754.6455882}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 36.44504380226135, "spark_time": 0.22507309913635254, "translation_time": 36.219970703125, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='d6fb40c9-19d3-4f3d-8cf0-d7d5a868e933'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='daa1a239-047a-47fc-b888-b7ec712f963b'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1'}", "Observation: content='The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='240d3650-320a-49e9-98a9-c3134cbb7469'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}", "Observation: content='```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='ec2ef23e-4ee0-4106-a4c6-699d952ba727'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}"], "input_tokens": 5362, "output_tokens": 3312, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1\"}'}\nTool: The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\"}'}\nTool: ```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\n```", "final_answer": "", "replica": 2, "timestamp": 1768940791.7031527}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds GROUP BY T1.School, T1.GSoffered ORDER BY AVG(T2.AvgScrMath) DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 14.312804937362671, "spark_time": 0.20845341682434082, "translation_time": 14.10435152053833, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='96e63dee-6a83-4db9-8219-e6486d409a82'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools,satscores'}", "Observation: content='' name='schema_sql_db' tool_call_id='0483a32e-375b-42d6-ac78-28f261557a09'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='5b75f186-467c-4b97-97a2-f7b439db2389'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='bcc9765e-b06c-4db1-bd13-1bd3bc1ea2ec'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds GROUP BY T1.School, T1.GSoffered ORDER BY AVG(T2.AvgScrMath) DESC LIMIT 1'}", "Observation: content='SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds GROUP BY T1.School, T1.GSoffered ORDER BY AVG(T2.AvgScrMath) DESC LIMIT 1' name='query_checker_sql_db' tool_call_id='b1c9086e-ece6-4db4-9577-b26453a8dc94'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds GROUP BY T1.School, T1.GSoffered ORDER BY AVG(T2.AvgScrMath) DESC LIMIT 1'}"], "input_tokens": 5585, "output_tokens": 1919, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools,satscores\"}'}\nTool: \nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds GROUP BY T1.School, T1.GSoffered ORDER BY AVG(T2.AvgScrMath) DESC LIMIT 1\"}'}\nTool: SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds GROUP BY T1.School, T1.GSoffered ORDER BY AVG(T2.AvgScrMath) DESC LIMIT 1", "final_answer": "", "replica": 3, "timestamp": 1768940806.688464}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 26.25563883781433, "spark_time": 0.19568133354187012, "translation_time": 26.05995750427246, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1a337ac8-a55d-4d3d-a730-52e748610500'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='4f9a8a44-7100-4ceb-bbf0-b03b1bb1f0fa'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1'}", "Observation: content='The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='0d8f4c19-88be-4733-a8a9-b853025bf523'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}", "Observation: content='```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='57133568-fbca-468e-8825-4036c1fa525a'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}"], "input_tokens": 5362, "output_tokens": 3360, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1\"}'}\nTool: The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\"}'}\nTool: ```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\n```", "final_answer": "", "replica": 4, "timestamp": 1768940833.5441089}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 24.350179433822632, "spark_time": 0.12054038047790527, "translation_time": 24.229639053344727, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='5f4183c5-0bff-496a-9960-8270c295fed8'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='37ddfa86-1508-4f0a-b68c-a6679401345d'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1'}", "Observation: content='The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='a5ca399e-f740-4fcf-ab81-4c07fab5ab60'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1'}", "Observation: content='```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='eea56815-a098-4745-97d3-1dc6f3689f5c'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1'}"], "input_tokens": 5314, "output_tokens": 3258, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1\"}'}\nTool: The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\"}'}\nTool: ```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```", "final_answer": "", "replica": 5, "timestamp": 1768940858.44226}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 18.288925170898438, "spark_time": 0.24985790252685547, "translation_time": 18.039067268371582, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0172303a-0ab1-4438-8747-9a98b3d6ba64'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='aa970221-febb-40b5-ac21-e028e3c29a04'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1'}", "Observation: content='The original query is logically sound and achieves its intended purpose: to find the `GSoffered` value for the school with the highest `AvgScrMath`.\\n\\nHowever, based on the specific instructions provided, particularly \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", it\\'s good practice in Spark SQL to quote all identifiers (table names, column names) with backticks, even if they don\\'t contain special characters or keywords. This ensures robustness and avoids potential issues with reserved words or future changes.\\n\\nApplying backticks to all identifiers:\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='a7396fc6-776b-47cf-91fd-41dca6c42b9e'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1'}"], "input_tokens": 3812, "output_tokens": 2481, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1\"}'}\nTool: The original query is logically sound and achieves its intended purpose: to find the `GSoffered` value for the school with the highest `AvgScrMath`.\n\nHowever, based on the specific instructions provided, particularly \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", it's good practice in Spark SQL to quote all identifiers (table names, column names) with backticks, even if they don't contain special characters or keywords. This ensures robustness and avoids potential issues with reserved words or future changes.\n\nApplying backticks to all identifiers:\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```", "final_answer": "", "replica": 6, "timestamp": 1768940877.4071727}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 34.466596841812134, "spark_time": 0.35091519355773926, "translation_time": 34.115681648254395, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='8814114e-8cfc-4ba6-8d02-859fecc0345c'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='5b614ddc-5260-4900-a75a-1eee0d64313c'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1'}", "Observation: content='The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='48cf5c07-aabc-4139-b034-804769d8e02a'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values:** Not used.\\n*   **UNION vs. UNION ALL:** Not used.\\n*   **BETWEEN for exclusive ranges:** Not used.\\n*   **Data type mismatch in predicates:** The join condition `T1.`CDSCode` = T2.`cds`` assumes compatible data types, which is standard for such identifiers. Without schema, it's impossible to be 100% certain, but it's a common and usually correct pattern.\\n*   **Properly quoting identifiers:** All identifiers (`GSoffered`, `schools`, `CDSCode`, etc.) are correctly quoted with backticks (` `).\\n*   **Use ` for the in-query strings:** This point likely refers to quoting identifiers, which is correctly done with backticks. If it refers to string literals, there are none in the query.\\n*   **Correct number of arguments for functions:** `AVG(T2.`AvgScrMath`)` correctly uses one argument.\\n*   **Casting to the correct data type:** No explicit casting is performed, assuming `AvgScrMath` is a numeric type, which is appropriate for an average calculation.\\n*   **Proper columns for joins:** The join condition `T1.`CDSCode` = T2.`cds`` is a logical and common way to link school data.\\n\\nThe query correctly groups by `T1.`School`` and `T1.`GSoffered`` because `T1.`GSoffered`` is in the `SELECT` list and `T1.`School`` is likely used to define the granularity for the average calculation. It then orders by the average math score and limits to the top result, returning the `GSoffered` value for that school.\\n\\nThe original query is correct.\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='b8e0d7f0-5e0a-4689-94d1-c27990dadc64'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}"], "input_tokens": 5762, "output_tokens": 3619, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1\"}'}\nTool: The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values:** Not used.\n*   **UNION vs. UNION ALL:** Not used.\n*   **BETWEEN for exclusive ranges:** Not used.\n*   **Data type mismatch in predicates:** The join condition `T1.`CDSCode` = T2.`cds`` assumes compatible data types, which is standard for such identifiers. Without schema, it's impossible to be 100% certain, but it's a common and usually correct pattern.\n*   **Properly quoting identifiers:** All identifiers (`GSoffered`, `schools`, `CDSCode`, etc.) are correctly quoted with backticks (` `).\n*   **Use ` for the in-query strings:** This point likely refers to quoting identifiers, which is correctly done with backticks. If it refers to string literals, there are none in the query.\n*   **Correct number of arguments for functions:** `AVG(T2.`AvgScrMath`)` correctly uses one argument.\n*   **Casting to the correct data type:** No explicit casting is performed, assuming `AvgScrMath` is a numeric type, which is appropriate for an average calculation.\n*   **Proper columns for joins:** The join condition `T1.`CDSCode` = T2.`cds`` is a logical and common way to link school data.\n\nThe query correctly groups by `T1.`School`` and `T1.`GSoffered`` because `T1.`GSoffered`` is in the `SELECT` list and `T1.`School`` is likely used to define the granularity for the average calculation. It then orders by the average math score and limits to the top result, returning the `GSoffered` value for that school.\n\nThe original query is correct.\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\n```", "final_answer": "", "replica": 7, "timestamp": 1768940912.8542993}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 25.707764387130737, "spark_time": 0.23357629776000977, "translation_time": 25.474188089370728, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b0a673e3-ac1b-4af6-86f3-1e8e3530b75a'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='349a4043-6a38-4568-a96b-dede3ffcfe49'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1'}", "Observation: content='The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='87b0b08c-5b77-4d3b-90b4-082867691ffb'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\\n\\n*   **NOT IN with NULL values:** Not used.\\n*   **UNION vs. UNION ALL:** Not used.\\n*   **BETWEEN for exclusive ranges:** Not used.\\n*   **Data type mismatch in predicates:** The join condition `T1.`CDSCode` = T2.`cds`` assumes compatible data types, which is standard for such identifiers. Without schema, it's impossible to be 100% certain, but it's a common and usually correct pattern.\\n*   **Properly quoting identifiers:** All identifiers (`GSoffered`, `schools`, `CDSCode`, etc.) are correctly quoted with backticks (` `).\\n*   **Use ` for the in-query strings:** This point likely refers to quoting identifiers, which is correctly done with backticks. If it refers to string literals, there are none in the query.\\n*   **Correct number of arguments for functions:** `AVG(T2.`AvgScrMath`)` correctly uses one argument.\\n*   **Casting to the correct data type:** No explicit casting is performed, assuming `AvgScrMath` is a numeric type, which is appropriate for an average calculation.\\n*   **Proper columns for joins:** The join condition `T1.`CDSCode` = T2.`cds`` is a logical and common way to link school data.\\n\\nThe query correctly groups by `T1.`School`` and `T1.`GSoffered`` because `T1.`GSoffered`` is in the `SELECT` list and `T1.`School`` is likely used to define the granularity for the average calculation. It then orders by the average math score and limits to the top result, returning the `GSoffered` value for that school.\\n\\nThe original query is correct.\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\\n```\" name='query_checker_sql_db' tool_call_id='238669b1-9ee1-41a0-9782-ec015676cc62'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1'}"], "input_tokens": 5762, "output_tokens": 3619, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1\"}'}\nTool: The query has a potential mistake regarding the quoting of identifiers. The prompt explicitly states \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", which implies that identifiers (table names, column names) should be enclosed in backticks, especially in Spark SQL, for clarity and to avoid issues with reserved keywords or special characters.\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed.\n\n*   **NOT IN with NULL values:** Not used.\n*   **UNION vs. UNION ALL:** Not used.\n*   **BETWEEN for exclusive ranges:** Not used.\n*   **Data type mismatch in predicates:** The join condition `T1.`CDSCode` = T2.`cds`` assumes compatible data types, which is standard for such identifiers. Without schema, it's impossible to be 100% certain, but it's a common and usually correct pattern.\n*   **Properly quoting identifiers:** All identifiers (`GSoffered`, `schools`, `CDSCode`, etc.) are correctly quoted with backticks (` `).\n*   **Use ` for the in-query strings:** This point likely refers to quoting identifiers, which is correctly done with backticks. If it refers to string literals, there are none in the query.\n*   **Correct number of arguments for functions:** `AVG(T2.`AvgScrMath`)` correctly uses one argument.\n*   **Casting to the correct data type:** No explicit casting is performed, assuming `AvgScrMath` is a numeric type, which is appropriate for an average calculation.\n*   **Proper columns for joins:** The join condition `T1.`CDSCode` = T2.`cds`` is a logical and common way to link school data.\n\nThe query correctly groups by `T1.`School`` and `T1.`GSoffered`` because `T1.`GSoffered`` is in the `SELECT` list and `T1.`School`` is likely used to define the granularity for the average calculation. It then orders by the average math score and limits to the top result, returning the `GSoffered` value for that school.\n\nThe original query is correct.\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` GROUP BY T1.`School`, T1.`GSoffered` ORDER BY AVG(T2.`AvgScrMath`) DESC LIMIT 1\n```", "final_answer": "", "replica": 8, "timestamp": 1768940939.2881157}
{"query_id": 42, "provider": "google", "db": "california_schools", "nl_query": "What is the type of education offered in the school who scored the highest average in Math? ", "gold_sqlite": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "gold_spark": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["9-12"]], "spark_error": null, "total_time": 20.99824333190918, "spark_time": 0.1324927806854248, "translation_time": 20.865750551223755, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='4a7e5c16-03d9-4703-92a5-a739bd67999b'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='f2fda5ad-bba9-42e7-be58-b7849f83eec2'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1'}", "Observation: content='The original query is logically sound and achieves its intended purpose: to find the `GSoffered` value for the school with the highest `AvgScrMath`.\\n\\nHowever, based on the specific instructions provided, particularly \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", it\\'s good practice in Spark SQL to quote all identifiers (table names, column names) with backticks, even if they don\\'t contain special characters or keywords. This ensures robustness and avoids potential issues with reserved words or future changes.\\n\\nApplying backticks to all identifiers:\\n\\n```sql\\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='bc965b9f-6078-49ef-811e-464526c504e6'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1'}"], "input_tokens": 3812, "output_tokens": 2481, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the type of education offered in the school who scored the highest average in Math? \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.GSoffered FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1\"}'}\nTool: The original query is logically sound and achieves its intended purpose: to find the `GSoffered` value for the school with the highest `AvgScrMath`.\n\nHowever, based on the specific instructions provided, particularly \"Properly quoting identifiers\" and \"Use ` for the in-query strings\", it's good practice in Spark SQL to quote all identifiers (table names, column names) with backticks, even if they don't contain special characters or keywords. This ensures robustness and avoids potential issues with reserved words or future changes.\n\nApplying backticks to all identifiers:\n\n```sql\nSELECT T1.`GSoffered` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` ORDER BY T2.`AvgScrMath` DESC LIMIT 1\n```", "final_answer": "", "replica": 9, "timestamp": 1768940960.8307936}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)", "execution_status": "VALID", "query_result": [["289.0", "Contra Costa"]], "spark_error": null, "total_time": 14.812065362930298, "spark_time": 0.4604806900024414, "translation_time": 14.351584672927856, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='b596858d-1533-4ea3-bf47-9c99cf5271d3'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='5df95d87-160b-4f5b-ada6-7e4ff1d43685'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` with `NULL` values: Not used.\\n*   `UNION` when `UNION ALL` should have been used: Not used.\\n*   `BETWEEN` for exclusive ranges: Not used.\\n*   Data type mismatch in predicates: The sum of `AvgScrMath`, `AvgScrRead`, and `AvgScrWrite` (presumably numeric types) is compared to the minimum of the same sum, which is a valid numeric comparison.\\n*   Properly quoting identifiers: The identifiers `AvgScrMath`, `cname`, `satscores`, `AvgScrRead`, `AvgScrWrite` are standard SQL identifiers and do not require quoting with backticks unless they contain special characters or are reserved keywords, which is not the case here.\\n*   Use `` for the in-query strings: No in-query strings are present.\\n*   Using the correct number of arguments for functions: `MIN()` is used correctly with a single expression argument.\\n*   Casting to the correct data type: No explicit casting is needed as the operations are on compatible numeric types.\\n*   Using the proper columns for joins: No joins are present.\\n\\nThe query correctly identifies the rows where the total SAT score (Math + Read + Write) is the minimum among all entries in the `satscores` table.\\n\\n```sql\\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)\\n```' name='query_checker_sql_db' tool_call_id='6b968daa-403d-46e5-ad13-78f93883bd10'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)'}"], "input_tokens": 4155, "output_tokens": 1727, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   `NOT IN` with `NULL` values: Not used.\n*   `UNION` when `UNION ALL` should have been used: Not used.\n*   `BETWEEN` for exclusive ranges: Not used.\n*   Data type mismatch in predicates: The sum of `AvgScrMath`, `AvgScrRead`, and `AvgScrWrite` (presumably numeric types) is compared to the minimum of the same sum, which is a valid numeric comparison.\n*   Properly quoting identifiers: The identifiers `AvgScrMath`, `cname`, `satscores`, `AvgScrRead`, `AvgScrWrite` are standard SQL identifiers and do not require quoting with backticks unless they contain special characters or are reserved keywords, which is not the case here.\n*   Use `` for the in-query strings: No in-query strings are present.\n*   Using the correct number of arguments for functions: `MIN()` is used correctly with a single expression argument.\n*   Casting to the correct data type: No explicit casting is needed as the operations are on compatible numeric types.\n*   Using the proper columns for joins: No joins are present.\n\nThe query correctly identifies the rows where the total SAT score (Math + Read + Write) is the minimum among all entries in the `satscores` table.\n\n```sql\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)\n```", "final_answer": "", "replica": 0, "timestamp": 1768940976.3249395}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 JOIN (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) AS min_total_avg_score FROM satscores) AS T2 ON (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = T2.min_total_avg_score", "execution_status": "VALID", "query_result": [["289.0", "Contra Costa"]], "spark_error": null, "total_time": 13.589155435562134, "spark_time": 0.19102740287780762, "translation_time": 13.398128032684326, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='fa3e279b-a4ed-446f-86c2-20e380358230'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='c2e017ef-ab22-4ec8-9f73-a96ef86749ad'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 JOIN (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) AS min_total_avg_score FROM satscores) AS T2 ON (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = T2.min_total_avg_score'}", "Observation: content='```sql\\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 JOIN (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) AS min_total_avg_score FROM satscores) AS T2 ON (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = T2.min_total_avg_score\\n```' name='query_checker_sql_db' tool_call_id='bb3faf4f-bb8f-48b3-80c1-0498819ccf41'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 JOIN (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) AS min_total_avg_score FROM satscores) AS T2 ON (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = T2.min_total_avg_score'}"], "input_tokens": 3919, "output_tokens": 1597, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 JOIN (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) AS min_total_avg_score FROM satscores) AS T2 ON (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = T2.min_total_avg_score\"}'}\nTool: ```sql\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 JOIN (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) AS min_total_avg_score FROM satscores) AS T2 ON (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = T2.min_total_avg_score\n```", "final_answer": "", "replica": 1, "timestamp": 1768940990.571094}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["None", "Los Angeles"]], "spark_error": null, "total_time": 12.754482507705688, "spark_time": 0.051759958267211914, "translation_time": 12.702722549438477, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='f44425e2-79fb-4c82-9bc5-f4f04b363bc3'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='98a075a2-77e5-4992-b980-ae1f87be3506'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}", "Observation: content='SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1' name='query_checker_sql_db' tool_call_id='fb30a49b-1d89-4851-aec0-3ae77cbb49da'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}"], "input_tokens": 3798, "output_tokens": 1228, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\"}'}\nTool: SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "final_answer": "", "replica": 2, "timestamp": 1768941003.9364805}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["None", "Alameda"]], "spark_error": null, "total_time": 24.05830407142639, "spark_time": 0.05335688591003418, "translation_time": 24.004947185516357, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='9d31cb1d-df1c-44ea-b781-c7cf25193d63'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a93e542a-6b75-4d71-ab3f-dc04b35e9196'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}", "Observation: content='No mistakes were found in the query based on the provided list of common issues. The query is well-formed and achieves its apparent goal of finding the college with the lowest total SAT score.\\n\\n```sql\\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='c23813fd-ce30-48fa-b256-44c81f788d6e'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}"], "input_tokens": 3846, "output_tokens": 1855, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\"}'}\nTool: No mistakes were found in the query based on the provided list of common issues. The query is well-formed and achieves its apparent goal of finding the college with the lowest total SAT score.\n\n```sql\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\n```", "final_answer": "", "replica": 3, "timestamp": 1768941028.635587}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["None", "Alameda"]], "spark_error": null, "total_time": 11.872966289520264, "spark_time": 0.053153276443481445, "translation_time": 11.819813013076782, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='eb252651-ffbd-43f9-a4e2-ab70ca3dfebc'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='c7116212-5b8d-47ff-ab85-aa9236068f04'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}", "Observation: content='No mistakes were found in the query based on the provided list of common issues. The query is well-formed and achieves its apparent goal of finding the college with the lowest total SAT score.\\n\\n```sql\\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='ef7e5f31-f18f-42e3-8cde-57a742557d1c'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}"], "input_tokens": 3846, "output_tokens": 1872, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\"}'}\nTool: No mistakes were found in the query based on the provided list of common issues. The query is well-formed and achieves its apparent goal of finding the college with the lowest total SAT score.\n\n```sql\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\n```", "final_answer": "", "replica": 4, "timestamp": 1768941041.1161711}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["None", "Orange"]], "spark_error": null, "total_time": 14.230928182601929, "spark_time": 0.08046412467956543, "translation_time": 14.150464057922363, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='13297490-654d-4552-9b9c-2f5579b9d32e'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='4b4ca064-2e89-43e6-874f-3c3444c1f4b5'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}", "Observation: content='No mistakes were found in the query based on the provided list of common issues. The query is well-formed and achieves its apparent goal of finding the college with the lowest total SAT score.\\n\\n```sql\\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='26c92fc8-c51a-4c9b-8af1-95e143c642d8'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}"], "input_tokens": 3846, "output_tokens": 1855, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\"}'}\nTool: No mistakes were found in the query based on the provided list of common issues. The query is well-formed and achieves its apparent goal of finding the college with the lowest total SAT score.\n\n```sql\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\n```", "final_answer": "", "replica": 5, "timestamp": 1768941056.0305743}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["None", "Los Angeles"]], "spark_error": null, "total_time": 10.281392335891724, "spark_time": 0.08184504508972168, "translation_time": 10.199547290802002, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='3ec050a3-250b-4657-8185-c3da8817fde2'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='3e03f875-28ac-414a-8ef6-166e6c9bf188'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}", "Observation: content='SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1' name='query_checker_sql_db' tool_call_id='7a4a71c4-0a6c-4c1f-a9fb-86cdbd488a46'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}"], "input_tokens": 3798, "output_tokens": 1265, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\"}'}\nTool: SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "final_answer": "", "replica": 6, "timestamp": 1768941066.9189658}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["None", "Orange"]], "spark_error": null, "total_time": 21.661391973495483, "spark_time": 0.04787445068359375, "translation_time": 21.61351752281189, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='7f76ca16-864e-4114-9c95-f34b444e349e'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='49bfd99f-4a4f-4889-9d1b-f99ad55e1ac0'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}", "Observation: content='No mistakes were found in the query based on the provided list of common issues. The query is well-formed and achieves its apparent goal of finding the college with the lowest total SAT score.\\n\\n```sql\\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='287f3500-2f5e-4b0d-a88a-ae5159e252ca'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}"], "input_tokens": 3846, "output_tokens": 1855, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\"}'}\nTool: No mistakes were found in the query based on the provided list of common issues. The query is well-formed and achieves its apparent goal of finding the college with the lowest total SAT score.\n\n```sql\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\n```", "final_answer": "", "replica": 7, "timestamp": 1768941089.16938}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "execution_status": "VALID", "query_result": [["None", "Orange"]], "spark_error": null, "total_time": 10.237035751342773, "spark_time": 0.04334735870361328, "translation_time": 10.19368839263916, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1b230adf-3aeb-43bf-8fda-90031fd43f1f'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='1073a296-a672-40b1-aa29-f2c690c458bc'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}", "Observation: content='SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1' name='query_checker_sql_db' tool_call_id='d1abba30-242f-4540-a98e-869ed6c588c0'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1'}"], "input_tokens": 3798, "output_tokens": 1228, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1\"}'}\nTool: SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 ORDER BY (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) ASC LIMIT 1", "final_answer": "", "replica": 8, "timestamp": 1768941100.0735166}
{"query_id": 43, "provider": "google", "db": "california_schools", "nl_query": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite", "gold_sqlite": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "gold_spark": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE NOT T1.AvgScrMath IS NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1", "jaccard": 0.0, "spider_em": 0, "sparksql_query": "SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)", "execution_status": "VALID", "query_result": [["289.0", "Contra Costa"]], "spark_error": null, "total_time": 11.922077178955078, "spark_time": 0.13889765739440918, "translation_time": 11.783179521560669, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='967e1619-f002-473d-89b0-b85136df6b95'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='d4b4ffec-b3cf-47a7-9629-5646f90449c6'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)'}", "Observation: content='The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` with `NULL` values: Not used.\\n*   `UNION` when `UNION ALL` should have been used: Not used.\\n*   `BETWEEN` for exclusive ranges: Not used.\\n*   Data type mismatch in predicates: The sum of `AvgScrMath`, `AvgScrRead`, and `AvgScrWrite` (presumably numeric types) is compared to the minimum of the same sum, which is a valid numeric comparison.\\n*   Properly quoting identifiers: The identifiers `AvgScrMath`, `cname`, `satscores`, `AvgScrRead`, `AvgScrWrite` are standard SQL identifiers and do not require quoting with backticks unless they contain special characters or are reserved keywords, which is not the case here.\\n*   Use `` for the in-query strings: No in-query strings are present.\\n*   Using the correct number of arguments for functions: `MIN()` is used correctly with a single expression argument.\\n*   Casting to the correct data type: No explicit casting is needed as the operations are on compatible numeric types.\\n*   Using the proper columns for joins: No joins are present.\\n\\nThe query correctly identifies the rows where the total SAT score (Math + Read + Write) is the minimum among all entries in the `satscores` table.\\n\\n```sql\\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)\\n```' name='query_checker_sql_db' tool_call_id='91dc3a0b-8fb1-467c-ab57-6d211d6e5e28'", "Action: query_sql_db\nAction Input: {'query': 'SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)'}"], "input_tokens": 4155, "output_tokens": 1727, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average math score of the school with the lowest average score for all subjects, and in which county is it located? Average score for all subjects can be computed by AvgScrMath + AvgScrRead + AvgScrWrite\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)\"}'}\nTool: The provided Spark SQL query is well-formed and does not contain any of the common mistakes listed.\n\n*   `NOT IN` with `NULL` values: Not used.\n*   `UNION` when `UNION ALL` should have been used: Not used.\n*   `BETWEEN` for exclusive ranges: Not used.\n*   Data type mismatch in predicates: The sum of `AvgScrMath`, `AvgScrRead`, and `AvgScrWrite` (presumably numeric types) is compared to the minimum of the same sum, which is a valid numeric comparison.\n*   Properly quoting identifiers: The identifiers `AvgScrMath`, `cname`, `satscores`, `AvgScrRead`, `AvgScrWrite` are standard SQL identifiers and do not require quoting with backticks unless they contain special characters or are reserved keywords, which is not the case here.\n*   Use `` for the in-query strings: No in-query strings are present.\n*   Using the correct number of arguments for functions: `MIN()` is used correctly with a single expression argument.\n*   Casting to the correct data type: No explicit casting is needed as the operations are on compatible numeric types.\n*   Using the proper columns for joins: No joins are present.\n\nThe query correctly identifies the rows where the total SAT score (Math + Read + Write) is the minimum among all entries in the `satscores` table.\n\n```sql\nSELECT T1.AvgScrMath, T1.cname FROM satscores AS T1 WHERE (T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite) = (SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite) FROM satscores)\n```", "final_answer": "", "replica": 9, "timestamp": 1768941112.597104}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT `s`.`AvgScrWrite`, `sch`.`City` FROM `satscores` AS `s` JOIN `schools` AS `sch` ON `s`.`cds` = `sch`.`CDSCode` WHERE `s`.`NumGE1500` IS NOT NULL AND `s`.`NumGE1500` > 0 ORDER BY `s`.`NumGE1500` DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["435.0", "Los Angeles"]], "spark_error": null, "total_time": 21.16614317893982, "spark_time": 0.2016897201538086, "translation_time": 20.96445345878601, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='65814b57-ab42-457a-a682-59613ce17776'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='020eb8ed-6f3c-41bc-aec8-8a85400e7b3d'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;'}", "Observation: content='The query has a potential mistake based on the guideline \"Use ` for the in-query strings\", which typically refers to quoting identifiers in Spark SQL for robustness and consistency, even if they don\\'t strictly require it in standard SQL. The original query does not use backticks for its identifiers (table aliases, column names).\\n\\nHere\\'s the rewritten query with backticks around all identifiers:\\n\\n```sql\\nSELECT `s`.`AvgScrWrite`, `sch`.`City` FROM `satscores` AS `s` JOIN `schools` AS `sch` ON `s`.`cds` = `sch`.`CDSCode` WHERE `s`.`NumGE1500` IS NOT NULL AND `s`.`NumGE1500` > 0 ORDER BY `s`.`NumGE1500` DESC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='ea56d5f9-ee5c-4382-874d-814bad6d9988'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `s`.`AvgScrWrite`, `sch`.`City` FROM `satscores` AS `s` JOIN `schools` AS `sch` ON `s`.`cds` = `sch`.`CDSCode` WHERE `s`.`NumGE1500` IS NOT NULL AND `s`.`NumGE1500` > 0 ORDER BY `s`.`NumGE1500` DESC LIMIT 1;'}"], "input_tokens": 3968, "output_tokens": 3088, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;\"}'}\nTool: The query has a potential mistake based on the guideline \"Use ` for the in-query strings\", which typically refers to quoting identifiers in Spark SQL for robustness and consistency, even if they don't strictly require it in standard SQL. The original query does not use backticks for its identifiers (table aliases, column names).\n\nHere's the rewritten query with backticks around all identifiers:\n\n```sql\nSELECT `s`.`AvgScrWrite`, `sch`.`City` FROM `satscores` AS `s` JOIN `schools` AS `sch` ON `s`.`cds` = `sch`.`CDSCode` WHERE `s`.`NumGE1500` IS NOT NULL AND `s`.`NumGE1500` > 0 ORDER BY `s`.`NumGE1500` DESC LIMIT 1;\n```", "final_answer": "", "replica": 0, "timestamp": 1768941134.4202454}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 1, "sparksql_query": "SELECT s.`AvgScrWrite`, sch.`City` FROM `satscores` s JOIN `schools` sch ON s.`sname` = sch.`School` ORDER BY s.`NumGE1500` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["594.0", "Whittier"]], "spark_error": null, "total_time": 25.242125511169434, "spark_time": 0.17350506782531738, "translation_time": 25.068620443344116, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='7ef974d0-0a74-4825-b5c1-939c03a1041e'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='330abbda-4773-41f7-82dc-c4c53391c4cb'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores s JOIN schools sch ON s.sname = sch.School ORDER BY s.NumGE1500 DESC LIMIT 1'}", "Observation: content='The original query is mostly correct and would likely execute successfully in Spark SQL, as simple identifiers do not strictly require backticks. However, the prompt explicitly states:\\n- \"Properly quoting identifiers\"\\n- \"Use ` for the in-query strings\"\\n\\nFollowing these instructions, all identifiers (table names and column names) should be enclosed in backticks.\\n\\nHere\\'s the rewritten query with backticks applied to all identifiers:\\n\\n```sql\\nSELECT s.`AvgScrWrite`, sch.`City` FROM `satscores` s JOIN `schools` sch ON s.`sname` = sch.`School` ORDER BY s.`NumGE1500` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='1675aae9-1dd4-46c9-a12c-0ed5c69ff6a7'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.`AvgScrWrite`, sch.`City` FROM `satscores` s JOIN `schools` sch ON s.`sname` = sch.`School` ORDER BY s.`NumGE1500` DESC LIMIT 1'}"], "input_tokens": 3879, "output_tokens": 3026, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores s JOIN schools sch ON s.sname = sch.School ORDER BY s.NumGE1500 DESC LIMIT 1\"}'}\nTool: The original query is mostly correct and would likely execute successfully in Spark SQL, as simple identifiers do not strictly require backticks. However, the prompt explicitly states:\n- \"Properly quoting identifiers\"\n- \"Use ` for the in-query strings\"\n\nFollowing these instructions, all identifiers (table names and column names) should be enclosed in backticks.\n\nHere's the rewritten query with backticks applied to all identifiers:\n\n```sql\nSELECT s.`AvgScrWrite`, sch.`City` FROM `satscores` s JOIN `schools` sch ON s.`sname` = sch.`School` ORDER BY s.`NumGE1500` DESC LIMIT 1\n```", "final_answer": "", "replica": 1, "timestamp": 1768941160.3773873}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["435.0", "Los Angeles"]], "spark_error": null, "total_time": 13.383275270462036, "spark_time": 0.14685511589050293, "translation_time": 13.236420154571533, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='48540749-9978-4cc3-ae7d-7055fd4de7c9'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='b30acf76-a570-4838-be90-db2b1a37edbc'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;'}", "Observation: content='SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;' name='query_checker_sql_db' tool_call_id='05c1d84a-4144-47c6-a97a-3e74603cfa30'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;'}"], "input_tokens": 3778, "output_tokens": 1663, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;\"}'}\nTool: SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;", "final_answer": "", "replica": 2, "timestamp": 1768941174.3569477}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["435.0", "Los Angeles"]], "spark_error": null, "total_time": 19.37248730659485, "spark_time": 0.12624883651733398, "translation_time": 19.246238470077515, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='bb3eada1-4d2e-4208-997a-d10ab9f6d1ba'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='32746285-8bcd-4b5c-86ca-998910b103d4'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;'}", "Observation: content='SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;' name='query_checker_sql_db' tool_call_id='865f391d-8b8f-497d-82cd-084b30f2f600'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;'}"], "input_tokens": 3778, "output_tokens": 1663, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;\"}'}\nTool: SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;", "final_answer": "", "replica": 3, "timestamp": 1768941194.3640466}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["435.0", "Los Angeles"]], "spark_error": null, "total_time": 15.273613452911377, "spark_time": 0.13100910186767578, "translation_time": 15.142604351043701, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='78eb4218-4b87-4179-9d39-434b2fa72779'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='b145f4c5-49c4-430a-8adf-e42082e15106'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;'}", "Observation: content='```sparksql\\nSELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='f801c802-b4bd-4992-a84a-bc3ba26b4ed2'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;'}"], "input_tokens": 3857, "output_tokens": 1849, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;\"}'}\nTool: ```sparksql\nSELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1\n```", "final_answer": "", "replica": 4, "timestamp": 1768941210.3516922}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT `s`.`AvgScrWrite`, `sch`.`City` FROM `satscores` AS `s` JOIN `schools` AS `sch` ON `s`.`cds` = `sch`.`CDSCode` WHERE `s`.`NumGE1500` IS NOT NULL AND `s`.`NumGE1500` > 0 ORDER BY `s`.`NumGE1500` DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["435.0", "Los Angeles"]], "spark_error": null, "total_time": 18.295587062835693, "spark_time": 0.15049242973327637, "translation_time": 18.145094633102417, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='30c27a0c-e6e6-42f6-a2cd-2387f5408730'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='a211dd34-c6df-4781-b66e-3a76c39b6dab'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;'}", "Observation: content='The query has a potential mistake based on the guideline \"Use ` for the in-query strings\", which typically refers to quoting identifiers in Spark SQL for robustness and consistency, even if they don\\'t strictly require it in standard SQL. The original query does not use backticks for its identifiers (table aliases, column names).\\n\\nHere\\'s the rewritten query with backticks around all identifiers:\\n\\n```sql\\nSELECT `s`.`AvgScrWrite`, `sch`.`City` FROM `satscores` AS `s` JOIN `schools` AS `sch` ON `s`.`cds` = `sch`.`CDSCode` WHERE `s`.`NumGE1500` IS NOT NULL AND `s`.`NumGE1500` > 0 ORDER BY `s`.`NumGE1500` DESC LIMIT 1;\\n```' name='query_checker_sql_db' tool_call_id='b890459b-6036-46aa-8ab1-6533e7b39678'", "Action: query_sql_db\nAction Input: {'query': 'SELECT `s`.`AvgScrWrite`, `sch`.`City` FROM `satscores` AS `s` JOIN `schools` AS `sch` ON `s`.`cds` = `sch`.`CDSCode` WHERE `s`.`NumGE1500` IS NOT NULL AND `s`.`NumGE1500` > 0 ORDER BY `s`.`NumGE1500` DESC LIMIT 1;'}"], "input_tokens": 3968, "output_tokens": 3073, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;\"}'}\nTool: The query has a potential mistake based on the guideline \"Use ` for the in-query strings\", which typically refers to quoting identifiers in Spark SQL for robustness and consistency, even if they don't strictly require it in standard SQL. The original query does not use backticks for its identifiers (table aliases, column names).\n\nHere's the rewritten query with backticks around all identifiers:\n\n```sql\nSELECT `s`.`AvgScrWrite`, `sch`.`City` FROM `satscores` AS `s` JOIN `schools` AS `sch` ON `s`.`cds` = `sch`.`CDSCode` WHERE `s`.`NumGE1500` IS NOT NULL AND `s`.`NumGE1500` > 0 ORDER BY `s`.`NumGE1500` DESC LIMIT 1;\n```", "final_answer": "", "replica": 5, "timestamp": 1768941229.2671611}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 0.0, "spider_em": 1, "sparksql_query": "SELECT s.`AvgScrWrite`, sch.`City` FROM `satscores` s JOIN `schools` sch ON s.`sname` = sch.`School` ORDER BY s.`NumGE1500` DESC LIMIT 1", "execution_status": "VALID", "query_result": [["594.0", "San Francisco"]], "spark_error": null, "total_time": 19.839759349822998, "spark_time": 0.13573861122131348, "translation_time": 19.704020738601685, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='c766fd2c-9f58-4054-aa8e-ea1ac4271d1b'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='11596f35-5966-4a56-a16b-4ed4a8784cc7'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores s JOIN schools sch ON s.sname = sch.School ORDER BY s.NumGE1500 DESC LIMIT 1'}", "Observation: content='The original query is mostly correct and would likely execute successfully in Spark SQL, as simple identifiers do not strictly require backticks. However, the prompt explicitly states:\\n- \"Properly quoting identifiers\"\\n- \"Use ` for the in-query strings\"\\n\\nFollowing these instructions, all identifiers (table names and column names) should be enclosed in backticks.\\n\\nHere\\'s the rewritten query with backticks applied to all identifiers:\\n\\n```sql\\nSELECT s.`AvgScrWrite`, sch.`City` FROM `satscores` s JOIN `schools` sch ON s.`sname` = sch.`School` ORDER BY s.`NumGE1500` DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='4312e410-9646-4873-861b-13765ba62602'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.`AvgScrWrite`, sch.`City` FROM `satscores` s JOIN `schools` sch ON s.`sname` = sch.`School` ORDER BY s.`NumGE1500` DESC LIMIT 1'}"], "input_tokens": 3879, "output_tokens": 3026, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores s JOIN schools sch ON s.sname = sch.School ORDER BY s.NumGE1500 DESC LIMIT 1\"}'}\nTool: The original query is mostly correct and would likely execute successfully in Spark SQL, as simple identifiers do not strictly require backticks. However, the prompt explicitly states:\n- \"Properly quoting identifiers\"\n- \"Use ` for the in-query strings\"\n\nFollowing these instructions, all identifiers (table names and column names) should be enclosed in backticks.\n\nHere's the rewritten query with backticks applied to all identifiers:\n\n```sql\nSELECT s.`AvgScrWrite`, sch.`City` FROM `satscores` s JOIN `schools` sch ON s.`sname` = sch.`School` ORDER BY s.`NumGE1500` DESC LIMIT 1\n```", "final_answer": "", "replica": 6, "timestamp": 1768941249.6939151}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["435.0", "Los Angeles"]], "spark_error": null, "total_time": 11.401817321777344, "spark_time": 0.16088080406188965, "translation_time": 11.240936517715454, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='31a33e14-336c-4622-8169-a6172d3e1dde'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='2a921814-fe35-46e2-9212-1a75ea18d79a'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;'}", "Observation: content='SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;' name='query_checker_sql_db' tool_call_id='749ed155-57fa-4024-b4b0-98ebca004938'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;'}"], "input_tokens": 3778, "output_tokens": 1663, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;\"}'}\nTool: SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode ORDER BY s.NumGE1500 DESC LIMIT 1;", "final_answer": "", "replica": 7, "timestamp": 1768941261.746596}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;", "execution_status": "VALID", "query_result": [["435.0", "Los Angeles"]], "spark_error": null, "total_time": 13.34484577178955, "spark_time": 0.16533303260803223, "translation_time": 13.179512739181519, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='173c788a-17f6-4e93-8f60-e4966f2129ad'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='77abb5ad-cc9e-4b3b-b3aa-0ab156a27a34'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;'}", "Observation: content='```sparksql\\nSELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1\\n```' name='query_checker_sql_db' tool_call_id='6065dcf5-bafb-4ef3-9302-aad26e2f8c10'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;'}"], "input_tokens": 3857, "output_tokens": 1849, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1;\"}'}\nTool: ```sparksql\nSELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 IS NOT NULL AND s.NumGE1500 > 0 ORDER BY s.NumGE1500 DESC LIMIT 1\n```", "final_answer": "", "replica": 8, "timestamp": 1768941275.6774428}
{"query_id": 44, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. ", "gold_sqlite": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "gold_spark": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores)", "execution_status": "VALID", "query_result": [["435.0", "Los Angeles"]], "spark_error": null, "total_time": 16.032670736312866, "spark_time": 0.2509348392486572, "translation_time": 15.781735897064209, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='e7ab1cb1-fc2c-4f06-a51b-7686d77bf88b'", "Action: schema_sql_db\nAction Input: {'table_names': 'satscores, schools'}", "Observation: content='CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);' name='schema_sql_db' tool_call_id='638df0b7-78fe-4d7d-ab73-a250cce32fd2'", "Action: query_checker_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores)'}", "Observation: content='The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   `NOT IN` with `NULL` values: Not used.\\n*   `UNION` when `UNION ALL` should have been used: Not used.\\n*   `BETWEEN` for exclusive ranges: Not used.\\n*   Data type mismatch in predicates: The join condition `s.cds = sch.CDSCode` assumes compatible types, which is standard. The `WHERE` clause `s.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores)` compares a column to the result of an aggregate function on that same column, ensuring type compatibility.\\n*   Properly quoting identifiers: The identifiers used (`satscores`, `schools`, `AvgScrWrite`, `City`, `cds`, `CDSCode`, `NumGE1500`) are simple and do not contain special characters or reserved words, so backticks are not strictly necessary.\\n*   Use `` ` `` for the in-query strings: No string literals are present in the query that would require backticks.\\n*   Using the correct number of arguments for functions: `MAX(NumGE1500)` uses the correct number of arguments.\\n*   Casting to the correct data type: No explicit casting is needed or performed, and no implicit casting issues are apparent.\\n*   Using the proper columns for joins: `s.cds = sch.CDSCode` is a logical join condition, assuming `cds` and `CDSCode` represent the same unique identifier for schools in their respective tables.\\n\\nThe query is well-formed and achieves its intended purpose of selecting the average writing score and city for schools that have the maximum number of students scoring 1500 or higher on the SAT.\\n\\n```sql\\nSELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores)\\n```' name='query_checker_sql_db' tool_call_id='11e09d72-667f-4750-949a-89afd10e919b'", "Action: query_sql_db\nAction Input: {'query': 'SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores)'}"], "input_tokens": 4200, "output_tokens": 2630, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated. \n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"satscores, schools\"}'}\nTool: CREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores)\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   `NOT IN` with `NULL` values: Not used.\n*   `UNION` when `UNION ALL` should have been used: Not used.\n*   `BETWEEN` for exclusive ranges: Not used.\n*   Data type mismatch in predicates: The join condition `s.cds = sch.CDSCode` assumes compatible types, which is standard. The `WHERE` clause `s.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores)` compares a column to the result of an aggregate function on that same column, ensuring type compatibility.\n*   Properly quoting identifiers: The identifiers used (`satscores`, `schools`, `AvgScrWrite`, `City`, `cds`, `CDSCode`, `NumGE1500`) are simple and do not contain special characters or reserved words, so backticks are not strictly necessary.\n*   Use `` ` `` for the in-query strings: No string literals are present in the query that would require backticks.\n*   Using the correct number of arguments for functions: `MAX(NumGE1500)` uses the correct number of arguments.\n*   Casting to the correct data type: No explicit casting is needed or performed, and no implicit casting issues are apparent.\n*   Using the proper columns for joins: `s.cds = sch.CDSCode` is a logical join condition, assuming `cds` and `CDSCode` represent the same unique identifier for schools in their respective tables.\n\nThe query is well-formed and achieves its intended purpose of selecting the average writing score and city for schools that have the maximum number of students scoring 1500 or higher on the SAT.\n\n```sql\nSELECT s.AvgScrWrite, sch.City FROM satscores AS s JOIN schools AS sch ON s.cds = sch.CDSCode WHERE s.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores)\n```", "final_answer": "", "replica": 9, "timestamp": 1768941292.2897718}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T2.sname, AVG(T2.AvgScrWrite) AS AverageWritingScore FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich') OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich') OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich') GROUP BY T2.sname", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 17.238935470581055, "spark_time": 0.2314896583557129, "translation_time": 17.007445812225342, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='34c30294-4c7f-47f6-98f3-0f2591eece92'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='28403954-0f04-4963-b958-57c6a9578dd0'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T2.sname, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich') OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich') OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich')\"}", "Observation: content='The query has a potential mistake regarding the quoting of identifiers. The instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which is likely a confusing way to refer to identifiers in Spark SQL) suggests that identifiers should be enclosed in backticks. The original query does not use backticks for table names, column names, or aliases.\\n\\nHere\\'s the rewritten query with backticks for all identifiers:\\n\\n```sql\\nSELECT `T2`.`sname`, `T2`.`AvgScrWrite` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE (`T1`.`AdmFName1` = \\'Ricci\\' AND `T1`.`AdmLName1` = \\'Ulrich\\') OR (`T1`.`AdmFName2` = \\'Ricci\\' AND `T1`.`AdmLName2` = \\'Ulrich\\') OR (`T1`.`AdmFName3` = \\'Ricci\\' AND `T1`.`AdmLName3` = \\'Ulrich\\')\\n```' name='query_checker_sql_db' tool_call_id='264a0dbf-a659-412f-87ea-ff4a3ad82655'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T2.sname, AVG(T2.AvgScrWrite) AS AverageWritingScore FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich') OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich') OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich') GROUP BY T2.sname\"}"], "input_tokens": 4088, "output_tokens": 2903, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T2.sname, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = \\'Ricci\\' AND T1.AdmLName1 = \\'Ulrich\\') OR (T1.AdmFName2 = \\'Ricci\\' AND T1.AdmLName2 = \\'Ulrich\\') OR (T1.AdmFName3 = \\'Ricci\\' AND T1.AdmLName3 = \\'Ulrich\\')\"}'}\nTool: The query has a potential mistake regarding the quoting of identifiers. The instruction \"Properly quoting identifiers\" and \"Use ` for the in-query strings\" (which is likely a confusing way to refer to identifiers in Spark SQL) suggests that identifiers should be enclosed in backticks. The original query does not use backticks for table names, column names, or aliases.\n\nHere's the rewritten query with backticks for all identifiers:\n\n```sql\nSELECT `T2`.`sname`, `T2`.`AvgScrWrite` FROM `schools` AS `T1` JOIN `satscores` AS `T2` ON `T1`.`CDSCode` = `T2`.`cds` WHERE (`T1`.`AdmFName1` = 'Ricci' AND `T1`.`AdmLName1` = 'Ulrich') OR (`T1`.`AdmFName2` = 'Ricci' AND `T1`.`AdmLName2` = 'Ulrich') OR (`T1`.`AdmFName3` = 'Ricci' AND `T1`.`AdmLName3` = 'Ulrich')\n```", "final_answer": "", "replica": 0, "timestamp": 1768941310.1647093}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 21.79266619682312, "spark_time": 0.18460369110107422, "translation_time": 21.608062505722046, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='21dd8c8e-519e-468d-8e28-1d98319b55bf'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='13e03971-02de-4fad-b83a-4233fa1b1d80'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The `WHERE` clause compares string literals to string columns, which is appropriate. The join condition `s.CDSCode = sat.cds` assumes compatible data types, which is standard for join keys. `AVG(sat.AvgScrWrite)` assumes `AvgScrWrite` is a numeric type, which is correct for an average.\\n*   **Properly quoting identifiers**: Identifiers like `s.School`, `sat.AvgScrWrite`, `s.CDSCode`, etc., are simple and do not contain special characters or reserved keywords, so they do not strictly require backticks (`) in Spark SQL. The query is syntactically valid as is.\\n*   **Use ` for the in-query strings**: String literals ('Ricci', 'Ulrich') are correctly quoted with single quotes (`'`). If this instruction refers to identifiers, see the point above.\\n*   **Using the correct number of arguments for functions**: `AVG()` is used with one argument, which is correct.\\n*   **Casting to the correct data type**: No explicit casting is used, and implicit type handling seems appropriate for the operations performed.\\n*   **Using the proper columns for joins**: `s.CDSCode = sat.cds` is a logical join condition to link schools with their SAT scores.\\n\\nThe query correctly filters for schools associated with 'Ricci Ulrich' (in any of the three administrator slots), calculates the average writing score for those schools, groups by school, and orders the results.\\n\\n```sql\\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\\n```\" name='query_checker_sql_db' tool_call_id='432ccf91-4fbf-4bc9-9f67-ba12af67739e'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}"], "input_tokens": 4859, "output_tokens": 3069, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = \\'Ricci\\' AND s.AdmLName1 = \\'Ulrich\\') OR (s.AdmFName2 = \\'Ricci\\' AND s.AdmLName2 = \\'Ulrich\\') OR (s.AdmFName3 = \\'Ricci\\' AND s.AdmLName3 = \\'Ulrich\\') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The `WHERE` clause compares string literals to string columns, which is appropriate. The join condition `s.CDSCode = sat.cds` assumes compatible data types, which is standard for join keys. `AVG(sat.AvgScrWrite)` assumes `AvgScrWrite` is a numeric type, which is correct for an average.\n*   **Properly quoting identifiers**: Identifiers like `s.School`, `sat.AvgScrWrite`, `s.CDSCode`, etc., are simple and do not contain special characters or reserved keywords, so they do not strictly require backticks (`) in Spark SQL. The query is syntactically valid as is.\n*   **Use ` for the in-query strings**: String literals ('Ricci', 'Ulrich') are correctly quoted with single quotes (`'`). If this instruction refers to identifiers, see the point above.\n*   **Using the correct number of arguments for functions**: `AVG()` is used with one argument, which is correct.\n*   **Casting to the correct data type**: No explicit casting is used, and implicit type handling seems appropriate for the operations performed.\n*   **Using the proper columns for joins**: `s.CDSCode = sat.cds` is a logical join condition to link schools with their SAT scores.\n\nThe query correctly filters for schools associated with 'Ricci Ulrich' (in any of the three administrator slots), calculates the average writing score for those schools, groups by school, and orders the results.\n\n```sql\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\n```", "final_answer": "", "replica": 1, "timestamp": 1768941332.5339904}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 16.334742069244385, "spark_time": 0.16335129737854004, "translation_time": 16.171390771865845, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='1b9deee7-da7c-42a6-9955-65218730c9d1'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='f80e9da0-fb1a-424e-ad8a-665f9b2789fc'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;\"}", "Observation: content=\"```sparksql\\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;\\n```\" name='query_checker_sql_db' tool_call_id='228d777a-0876-45a7-a201-508e946cd62d'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;\"}"], "input_tokens": 3976, "output_tokens": 1863, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = \\'Ricci\\' AND s.AdmLName1 = \\'Ulrich\\') OR (s.AdmFName2 = \\'Ricci\\' AND s.AdmLName2 = \\'Ulrich\\') OR (s.AdmFName3 = \\'Ricci\\' AND s.AdmLName3 = \\'Ulrich\\') GROUP BY s.School ORDER BY s.School;\"}'}\nTool: ```sparksql\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;\n```", "final_answer": "", "replica": 2, "timestamp": 1768941349.5463836}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.School, AVG(T2.AvgScrWrite) AS AverageWritingScore FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich') OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich') OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich') GROUP BY T1.School ORDER BY T1.School;", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 21.13417077064514, "spark_time": 0.14999961853027344, "translation_time": 20.984171152114868, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='08eb582b-a03b-4422-8c75-d7512f808a38'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='c3006df9-1e72-4a1f-b128-87bf7a827864'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, AVG(T2.AvgScrWrite) AS AverageWritingScore FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich') OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich') OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich') GROUP BY T1.School ORDER BY T1.School;\"}", "Observation: content=\"The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\\n\\n*   It does not use `NOT IN` with NULL values.\\n*   It does not use `UNION`.\\n*   It does not use `BETWEEN`.\\n*   Data types in predicates (string comparisons, numeric IDs for join) appear consistent.\\n*   Identifiers are properly handled (unquoted for standard names, single quotes for string literals). Backticks (`) are used for identifiers that are reserved keywords or contain special characters, but the current identifiers don't seem to require them, and string literals correctly use single quotes.\\n*   The `AVG` function has the correct number of arguments.\\n*   No explicit casting is used, assuming `AvgScrWrite` is a numeric type suitable for averaging.\\n*   The join columns `T1.CDSCode = T2.cds` are appropriate for linking schools to their SAT scores.\\n\\n```sql\\nSELECT T1.School, AVG(T2.AvgScrWrite) AS AverageWritingScore FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich') OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich') OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich') GROUP BY T1.School ORDER BY T1.School;\\n```\" name='query_checker_sql_db' tool_call_id='9437c7f0-92bd-4821-b5e5-36da65905586'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, AVG(T2.AvgScrWrite) AS AverageWritingScore FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich') OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich') OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich') GROUP BY T1.School ORDER BY T1.School;\"}"], "input_tokens": 4696, "output_tokens": 2165, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, AVG(T2.AvgScrWrite) AS AverageWritingScore FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = \\'Ricci\\' AND T1.AdmLName1 = \\'Ulrich\\') OR (T1.AdmFName2 = \\'Ricci\\' AND T1.AdmLName2 = \\'Ulrich\\') OR (T1.AdmFName3 = \\'Ricci\\' AND T1.AdmLName3 = \\'Ulrich\\') GROUP BY T1.School ORDER BY T1.School;\"}'}\nTool: The provided Spark SQL query appears to be correct and does not contain any of the common mistakes listed.\n\n*   It does not use `NOT IN` with NULL values.\n*   It does not use `UNION`.\n*   It does not use `BETWEEN`.\n*   Data types in predicates (string comparisons, numeric IDs for join) appear consistent.\n*   Identifiers are properly handled (unquoted for standard names, single quotes for string literals). Backticks (`) are used for identifiers that are reserved keywords or contain special characters, but the current identifiers don't seem to require them, and string literals correctly use single quotes.\n*   The `AVG` function has the correct number of arguments.\n*   No explicit casting is used, assuming `AvgScrWrite` is a numeric type suitable for averaging.\n*   The join columns `T1.CDSCode = T2.cds` are appropriate for linking schools to their SAT scores.\n\n```sql\nSELECT T1.School, AVG(T2.AvgScrWrite) AS AverageWritingScore FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich') OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich') OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich') GROUP BY T1.School ORDER BY T1.School;\n```", "final_answer": "", "replica": 3, "timestamp": 1768941371.3545535}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 1, "sparksql_query": "SELECT T1.School, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich'", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 17.506989002227783, "spark_time": 0.12200021743774414, "translation_time": 17.38498878479004, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='cada43ae-76d3-4f01-90a3-eb49fa61223a'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='2db49761-7558-45c1-94dc-2a5bf097f9a4'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich'\"}", "Observation: content=\"```sql\\nSELECT T1.School, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich'\\n```\" name='query_checker_sql_db' tool_call_id='4655d7a1-b374-43e6-a5a9-3af4f44219ca'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.School, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich'\"}"], "input_tokens": 3793, "output_tokens": 2868, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.AdmFName1 = \\'Ricci\\' AND T1.AdmLName1 = \\'Ulrich\\'\"}'}\nTool: ```sql\nSELECT T1.School, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich'\n```", "final_answer": "", "replica": 4, "timestamp": 1768941389.449543}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT T1.`School`, AVG(T2.`AvgScrWrite`) AS AverageWritingScore FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`AdmFName1` = 'Ricci' AND T1.`AdmLName1` = 'Ulrich' GROUP BY T1.`School`", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 28.365268230438232, "spark_time": 0.16444873809814453, "translation_time": 28.200819492340088, "llm_requests": 7, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='a7b6c4bd-1598-4edd-8a1c-45848c419aa2'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='1672cbbf-856b-424d-b12a-1434daf5cb49'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.School, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich'\"}", "Observation: content='The query has one potential area for improvement based on the provided checklist:\\n\\n*   **Properly quoting identifiers / Use ` for the in-query strings**: The instruction \"Use ` for the in-query strings\" typically refers to quoting identifiers (table names, column names) with backticks in Spark SQL, especially for robustness or consistency, even if not strictly necessary for simple alphanumeric names. The original query does not use backticks for identifiers.\\n\\nRewriting the query to include backticks for identifiers:\\n\\n```sql\\nSELECT T1.`School`, T2.`AvgScrWrite` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`AdmFName1` = \\'Ricci\\' AND T1.`AdmLName1` = \\'Ulrich`\\n```' name='query_checker_sql_db' tool_call_id='4ebf9e08-e259-4da1-8c43-d122891ec311'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT T1.`School`, AVG(T2.`AvgScrWrite`) AS AverageWritingScore FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`AdmFName1` = 'Ricci' AND T1.`AdmLName1` = 'Ulrich' GROUP BY T1.`School`\"}", "Observation: content=\"SELECT T1.`School`, AVG(T2.`AvgScrWrite`) AS AverageWritingScore FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`AdmFName1` = 'Ricci' AND T1.`AdmLName1` = 'Ulrich' GROUP BY T1.`School`\" name='query_checker_sql_db' tool_call_id='9c5366d8-6016-4758-ac2b-30ef6fcf7bbc'", "Action: query_sql_db\nAction Input: {'query': \"SELECT T1.`School`, AVG(T2.`AvgScrWrite`) AS AverageWritingScore FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`AdmFName1` = 'Ricci' AND T1.`AdmLName1` = 'Ulrich' GROUP BY T1.`School`\"}"], "input_tokens": 5612, "output_tokens": 4378, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.School, T2.AvgScrWrite FROM schools AS T1 JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.AdmFName1 = \\'Ricci\\' AND T1.AdmLName1 = \\'Ulrich\\'\"}'}\nTool: The query has one potential area for improvement based on the provided checklist:\n\n*   **Properly quoting identifiers / Use ` for the in-query strings**: The instruction \"Use ` for the in-query strings\" typically refers to quoting identifiers (table names, column names) with backticks in Spark SQL, especially for robustness or consistency, even if not strictly necessary for simple alphanumeric names. The original query does not use backticks for identifiers.\n\nRewriting the query to include backticks for identifiers:\n\n```sql\nSELECT T1.`School`, T2.`AvgScrWrite` FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`AdmFName1` = 'Ricci' AND T1.`AdmLName1` = 'Ulrich`\n```\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT T1.`School`, AVG(T2.`AvgScrWrite`) AS AverageWritingScore FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`AdmFName1` = \\'Ricci\\' AND T1.`AdmLName1` = \\'Ulrich\\' GROUP BY T1.`School`\"}'}\nTool: SELECT T1.`School`, AVG(T2.`AvgScrWrite`) AS AverageWritingScore FROM `schools` AS T1 JOIN `satscores` AS T2 ON T1.`CDSCode` = T2.`cds` WHERE T1.`AdmFName1` = 'Ricci' AND T1.`AdmLName1` = 'Ulrich' GROUP BY T1.`School`", "final_answer": "", "replica": 5, "timestamp": 1768941418.4030209}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 15.27512526512146, "spark_time": 0.1589043140411377, "translation_time": 15.116220951080322, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='32a1d898-7f99-4d2e-81e7-f5a2ada26e82'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='fb433b65-0b71-431c-b255-24229665d3cf'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;\"}", "Observation: content=\"```sparksql\\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;\\n```\" name='query_checker_sql_db' tool_call_id='4b618226-05c7-41bd-8cc1-08bc0bf07247'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;\"}"], "input_tokens": 3976, "output_tokens": 1833, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = \\'Ricci\\' AND s.AdmLName1 = \\'Ulrich\\') OR (s.AdmFName2 = \\'Ricci\\' AND s.AdmLName2 = \\'Ulrich\\') OR (s.AdmFName3 = \\'Ricci\\' AND s.AdmLName3 = \\'Ulrich\\') GROUP BY s.School ORDER BY s.School;\"}'}\nTool: ```sparksql\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY s.School;\n```", "final_answer": "", "replica": 6, "timestamp": 1768941434.2572265}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 17.414193630218506, "spark_time": 0.186753511428833, "translation_time": 17.227440118789673, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0a067073-6bd0-43b4-a766-85646792fd74'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='8ecc9f3b-dea1-4147-8370-35a3d1d0a05c'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}", "Observation: content=\"The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\\n\\n*   **Using NOT IN with NULL values**: `NOT IN` is not used.\\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used.\\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used.\\n*   **Data type mismatch in predicates**: The `WHERE` clause compares string literals to string columns, which is appropriate. The join condition `s.CDSCode = sat.cds` assumes compatible data types, which is standard for join keys. `AVG(sat.AvgScrWrite)` assumes `AvgScrWrite` is a numeric type, which is correct for an average.\\n*   **Properly quoting identifiers**: Identifiers like `s.School`, `sat.AvgScrWrite`, `s.CDSCode`, etc., are simple and do not contain special characters or reserved keywords, so they do not strictly require backticks (`) in Spark SQL. The query is syntactically valid as is.\\n*   **Use ` for the in-query strings**: String literals ('Ricci', 'Ulrich') are correctly quoted with single quotes (`'`). If this instruction refers to identifiers, see the point above.\\n*   **Using the correct number of arguments for functions**: `AVG()` is used with one argument, which is correct.\\n*   **Casting to the correct data type**: No explicit casting is used, and implicit type handling seems appropriate for the operations performed.\\n*   **Using the proper columns for joins**: `s.CDSCode = sat.cds` is a logical join condition to link schools with their SAT scores.\\n\\nThe query correctly filters for schools associated with 'Ricci Ulrich' (in any of the three administrator slots), calculates the average writing score for those schools, groups by school, and orders the results.\\n\\n```sql\\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\\n```\" name='query_checker_sql_db' tool_call_id='e62bb7de-639b-416a-a43c-dbde8e59a175'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}"], "input_tokens": 4385, "output_tokens": 2931, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = \\'Ricci\\' AND s.AdmLName1 = \\'Ulrich\\') OR (s.AdmFName2 = \\'Ricci\\' AND s.AdmLName2 = \\'Ulrich\\') OR (s.AdmFName3 = \\'Ricci\\' AND s.AdmLName3 = \\'Ulrich\\') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}'}\nTool: The provided Spark SQL query appears to be well-formed and does not contain any of the common mistakes listed:\n\n*   **Using NOT IN with NULL values**: `NOT IN` is not used.\n*   **Using UNION when UNION ALL should have been used**: `UNION` is not used.\n*   **Using BETWEEN for exclusive ranges**: `BETWEEN` is not used.\n*   **Data type mismatch in predicates**: The `WHERE` clause compares string literals to string columns, which is appropriate. The join condition `s.CDSCode = sat.cds` assumes compatible data types, which is standard for join keys. `AVG(sat.AvgScrWrite)` assumes `AvgScrWrite` is a numeric type, which is correct for an average.\n*   **Properly quoting identifiers**: Identifiers like `s.School`, `sat.AvgScrWrite`, `s.CDSCode`, etc., are simple and do not contain special characters or reserved keywords, so they do not strictly require backticks (`) in Spark SQL. The query is syntactically valid as is.\n*   **Use ` for the in-query strings**: String literals ('Ricci', 'Ulrich') are correctly quoted with single quotes (`'`). If this instruction refers to identifiers, see the point above.\n*   **Using the correct number of arguments for functions**: `AVG()` is used with one argument, which is correct.\n*   **Casting to the correct data type**: No explicit casting is used, and implicit type handling seems appropriate for the operations performed.\n*   **Using the proper columns for joins**: `s.CDSCode = sat.cds` is a logical join condition to link schools with their SAT scores.\n\nThe query correctly filters for schools associated with 'Ricci Ulrich' (in any of the three administrator slots), calculates the average writing score for those schools, groups by school, and orders the results.\n\n```sql\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\n```", "final_answer": "", "replica": 7, "timestamp": 1768941452.3824172}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 14.451449155807495, "spark_time": 0.14852046966552734, "translation_time": 14.302928686141968, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='0c60f1ab-1b46-40dc-9593-28dd920b1080'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);' name='schema_sql_db' tool_call_id='c23208da-f1ab-4c95-9df7-7ffc8738ea70'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}", "Observation: content=\"```sparksql\\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\\n```\" name='query_checker_sql_db' tool_call_id='3f896d12-d4be-46a1-9817-c8308c5a8942'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}"], "input_tokens": 3977, "output_tokens": 2042, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = \\'Ricci\\' AND s.AdmLName1 = \\'Ulrich\\') OR (s.AdmFName2 = \\'Ricci\\' AND s.AdmLName2 = \\'Ulrich\\') OR (s.AdmFName3 = \\'Ricci\\' AND s.AdmLName3 = \\'Ulrich\\') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}'}\nTool: ```sparksql\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\n```", "final_answer": "", "replica": 8, "timestamp": 1768941467.3955224}
{"query_id": 45, "provider": "google", "db": "california_schools", "nl_query": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.", "gold_sqlite": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "gold_spark": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'", "jaccard": 1.0, "spider_em": 0, "sparksql_query": "SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC", "execution_status": "VALID", "query_result": [["Buchanan High", "507.0"]], "spark_error": null, "total_time": 15.652697563171387, "spark_time": 0.14948058128356934, "translation_time": 15.503216981887817, "llm_requests": 5, "chain_of_thought": ["Action: list_tables_sql_db\nAction Input: {}", "Observation: content='frpm, satscores, schools' name='list_tables_sql_db' tool_call_id='15aea946-7409-4649-a1fb-1d3492fed3e1'", "Action: schema_sql_db\nAction Input: {'table_names': 'schools, satscores, frpm'}", "Observation: content='CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\\n\\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\\n\\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);' name='schema_sql_db' tool_call_id='2743d3d9-c27a-4c18-939a-def9781c6506'", "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}", "Observation: content=\"```sparksql\\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\\n```\" name='query_checker_sql_db' tool_call_id='5b644a87-0c03-4170-bf29-dcb7b22be16a'", "Action: query_sql_db\nAction Input: {'query': \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}"], "input_tokens": 4451, "output_tokens": 2013, "cloudflare_neurons": null, "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores. Usually, administrators manage the school stuff.\n\nYou are an agent with access to tools.CRITICAL RULES: - Do NOT write Scala, Python, or pseudocode. - Do NOT describe steps. - You MUST call the tool 'query_sql_db' (or the Spark SQL execution tool available) exactly once to answer. - The tool input MUST be a single Spark SQL query string. - Use only tables and columns that exist. - After the tool returns, respond with the result only. -Match literal types: if schema shows numeric/double, compare using a number (no quotes).\nAI: {'name': 'list_tables_sql_db', 'arguments': '{}'}\nTool: frpm, satscores, schools\nAI: {'name': 'schema_sql_db', 'arguments': '{\"table_names\": \"schools, satscores, frpm\"}'}\nTool: CREATE TABLE schools (CDSCode string, NCESDist string, NCESSchool string, StatusType string, County string, District string, School string, Street string, StreetAbr string, City string, Zip string, State string, MailStreet string, MailStrAbr string, MailCity string, MailZip string, MailState string, Phone string, Ext string, Website string, OpenDate string, ClosedDate string, Charter double, CharterNum string, FundingType string, DOC string, DOCType string, SOC string, SOCType string, EdOpsCode string, EdOpsName string, EILCode string, EILName string, GSoffered string, GSserved string, Virtual string, Magnet double, Latitude double, Longitude double, AdmFName1 string, AdmLName1 string, AdmEmail1 string, AdmFName2 string, AdmLName2 string, AdmEmail2 string, AdmFName3 string, AdmLName3 string, AdmEmail3 string, LastUpdate string);\n\nCREATE TABLE satscores (cds string, rtype string, sname string, dname string, cname string, enroll12 bigint, NumTstTakr bigint, AvgScrRead double, AvgScrMath double, AvgScrWrite double, NumGE1500 double);\n\nCREATE TABLE frpm (CDSCode string, Academic Year string, County Code string, District Code bigint, School Code string, County Name string, District Name string, School Name string, District Type string, School Type string, Educational Option Type string, NSLP Provision Status string, Charter School (Y/N) double, Charter School Number string, Charter Funding Type string, IRC double, Low Grade string, High Grade string, Enrollment (K-12) double, Free Meal Count (K-12) double, Percent (%) Eligible Free (K-12) double, FRPM Count (K-12) double, Percent (%) Eligible FRPM (K-12) double, Enrollment (Ages 5-17) double, Free Meal Count (Ages 5-17) double, Percent (%) Eligible Free (Ages 5-17) double, FRPM Count (Ages 5-17) double, Percent (%) Eligible FRPM (Ages 5-17) double, 2013-14 CALPADS Fall 1 Certification Status bigint);\nAI: {'name': 'query_checker_sql_db', 'arguments': '{\"query\": \"SELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = \\'Ricci\\' AND s.AdmLName1 = \\'Ulrich\\') OR (s.AdmFName2 = \\'Ricci\\' AND s.AdmLName2 = \\'Ulrich\\') OR (s.AdmFName3 = \\'Ricci\\' AND s.AdmLName3 = \\'Ulrich\\') GROUP BY s.School ORDER BY AverageWritingScore DESC\"}'}\nTool: ```sparksql\nSELECT s.School, AVG(sat.AvgScrWrite) AS AverageWritingScore FROM schools AS s JOIN satscores AS sat ON s.CDSCode = sat.cds WHERE (s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich') OR (s.AdmFName2 = 'Ricci' AND s.AdmLName2 = 'Ulrich') OR (s.AdmFName3 = 'Ricci' AND s.AdmLName3 = 'Ulrich') GROUP BY s.School ORDER BY AverageWritingScore DESC\n```", "final_answer": "", "replica": 9, "timestamp": 1768941483.6652336}
